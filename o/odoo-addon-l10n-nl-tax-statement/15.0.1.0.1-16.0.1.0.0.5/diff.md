# Comparing `tmp/odoo_addon_l10n_nl_tax_statement-15.0.1.0.1-py3-none-any.whl.zip` & `tmp/odoo_addon_l10n_nl_tax_statement-16.0.1.0.0.5-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,36 +1,37 @@
-Zip file size: 55507 bytes, number of entries: 34
--rw-r--r--  2.0 unx     7798 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/README.rst
--rw-r--r--  2.0 unx       21 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/__init__.py
--rw-r--r--  2.0 unx      760 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/__manifest__.py
--rw-r--r--  2.0 unx      882 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/data/paperformat.xml
--rw-r--r--  2.0 unx    22368 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/i18n/l10n_nl_tax_statement.pot
--rw-r--r--  2.0 unx    29361 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/i18n/nl.po
--rw-r--r--  2.0 unx      196 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/models/__init__.py
--rw-r--r--  2.0 unx     1910 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/models/account_move.py
--rw-r--r--  2.0 unx     1901 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/models/account_move_line.py
--rw-r--r--  2.0 unx    21709 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py
--rw-r--r--  2.0 unx     4196 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement_line.py
--rw-r--r--  2.0 unx      327 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/models/res_company.py
--rw-r--r--  2.0 unx      394 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/models/res_config_settings.py
--rw-r--r--  2.0 unx     1607 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/readme/CONFIGURE.rst
--rw-r--r--  2.0 unx       83 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/readme/CONTRIBUTORS.rst
--rw-r--r--  2.0 unx      889 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/readme/DESCRIPTION.rst
--rw-r--r--  2.0 unx       48 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/readme/INSTALL.rst
--rw-r--r--  2.0 unx      244 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/readme/ROADMAP.rst
--rw-r--r--  2.0 unx     2193 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/readme/USAGE.rst
--rw-r--r--  2.0 unx     5851 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/report/report_tax_statement.xml
--rw-r--r--  2.0 unx      340 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/security/ir.model.access.csv
--rw-r--r--  2.0 unx      584 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/security/tax_statement_security_rule.xml
--rw-r--r--  2.0 unx     9455 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/static/description/icon.png
--rw-r--r--  2.0 unx    19013 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/static/description/index.html
--rw-r--r--  2.0 unx     1030 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/static/src/css/report.css
--rw-r--r--  2.0 unx       41 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/tests/__init__.py
--rw-r--r--  2.0 unx    22883 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/tests/test_l10n_nl_vat_statement.py
--rw-r--r--  2.0 unx    15676 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/views/l10n_nl_vat_statement_view.xml
--rw-r--r--  2.0 unx      807 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/views/report_tax_statement.xml
--rw-r--r--  2.0 unx     1469 b- defN 22-Sep-19 07:20 odoo/addons/l10n_nl_tax_statement/views/res_config_settings.xml
--rw-r--r--  2.0 unx     8401 b- defN 22-Sep-19 07:20 odoo_addon_l10n_nl_tax_statement-15.0.1.0.1.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 22-Sep-19 07:20 odoo_addon_l10n_nl_tax_statement-15.0.1.0.1.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 22-Sep-19 07:20 odoo_addon_l10n_nl_tax_statement-15.0.1.0.1.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     3859 b- defN 22-Sep-19 07:20 odoo_addon_l10n_nl_tax_statement-15.0.1.0.1.dist-info/RECORD
-34 files, 186393 bytes uncompressed, 48917 bytes compressed:  73.8%
+Zip file size: 57960 bytes, number of entries: 35
+-rw-r--r--  2.0 unx     7880 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/README.rst
+-rw-r--r--  2.0 unx       42 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/__init__.py
+-rw-r--r--  2.0 unx      761 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/__manifest__.py
+-rw-r--r--  2.0 unx      882 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/data/paperformat.xml
+-rw-r--r--  2.0 unx    24340 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/i18n/l10n_nl_tax_statement.pot
+-rw-r--r--  2.0 unx    29361 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/i18n/nl.po
+-rw-r--r--  2.0 unx      196 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/models/__init__.py
+-rw-r--r--  2.0 unx     1910 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/models/account_move.py
+-rw-r--r--  2.0 unx     1878 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/models/account_move_line.py
+-rw-r--r--  2.0 unx    21361 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py
+-rw-r--r--  2.0 unx     4257 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement_line.py
+-rw-r--r--  2.0 unx      327 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/models/res_company.py
+-rw-r--r--  2.0 unx      394 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/models/res_config_settings.py
+-rw-r--r--  2.0 unx     1607 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/readme/CONFIGURE.rst
+-rw-r--r--  2.0 unx       83 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/readme/CONTRIBUTORS.rst
+-rw-r--r--  2.0 unx      889 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/readme/DESCRIPTION.rst
+-rw-r--r--  2.0 unx      244 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/readme/ROADMAP.rst
+-rw-r--r--  2.0 unx     2351 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/readme/USAGE.rst
+-rw-r--r--  2.0 unx       41 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/report/__init__.py
+-rw-r--r--  2.0 unx     8038 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/report/l10n_nl_tax_statement_xlsx.py
+-rw-r--r--  2.0 unx     5851 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/report/report_tax_statement.xml
+-rw-r--r--  2.0 unx      340 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/security/ir.model.access.csv
+-rw-r--r--  2.0 unx      584 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/security/tax_statement_security_rule.xml
+-rw-r--r--  2.0 unx     9455 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/static/description/icon.png
+-rw-r--r--  2.0 unx    18931 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/static/description/index.html
+-rw-r--r--  2.0 unx     1030 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/static/src/css/report.css
+-rw-r--r--  2.0 unx       41 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/tests/__init__.py
+-rw-r--r--  2.0 unx    22313 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/tests/test_l10n_nl_vat_statement.py
+-rw-r--r--  2.0 unx    15952 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/views/l10n_nl_vat_statement_view.xml
+-rw-r--r--  2.0 unx     1475 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/views/report_tax_statement.xml
+-rw-r--r--  2.0 unx     1561 b- defN 23-Jul-12 12:52 odoo/addons/l10n_nl_tax_statement/views/res_config_settings.xml
+-rw-r--r--  2.0 unx     8487 b- defN 23-Jul-12 12:52 odoo_addon_l10n_nl_tax_statement-16.0.1.0.0.5.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jul-12 12:52 odoo_addon_l10n_nl_tax_statement-16.0.1.0.0.5.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 23-Jul-12 12:52 odoo_addon_l10n_nl_tax_statement-16.0.1.0.0.5.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     3995 b- defN 23-Jul-12 12:52 odoo_addon_l10n_nl_tax_statement-16.0.1.0.0.5.dist-info/RECORD
+35 files, 196954 bytes uncompressed, 51138 bytes compressed:  74.0%
```

## zipnote {}

```diff
@@ -42,23 +42,26 @@
 
 Filename: odoo/addons/l10n_nl_tax_statement/readme/CONTRIBUTORS.rst
 Comment: 
 
 Filename: odoo/addons/l10n_nl_tax_statement/readme/DESCRIPTION.rst
 Comment: 
 
-Filename: odoo/addons/l10n_nl_tax_statement/readme/INSTALL.rst
-Comment: 
-
 Filename: odoo/addons/l10n_nl_tax_statement/readme/ROADMAP.rst
 Comment: 
 
 Filename: odoo/addons/l10n_nl_tax_statement/readme/USAGE.rst
 Comment: 
 
+Filename: odoo/addons/l10n_nl_tax_statement/report/__init__.py
+Comment: 
+
+Filename: odoo/addons/l10n_nl_tax_statement/report/l10n_nl_tax_statement_xlsx.py
+Comment: 
+
 Filename: odoo/addons/l10n_nl_tax_statement/report/report_tax_statement.xml
 Comment: 
 
 Filename: odoo/addons/l10n_nl_tax_statement/security/ir.model.access.csv
 Comment: 
 
 Filename: odoo/addons/l10n_nl_tax_statement/security/tax_statement_security_rule.xml
@@ -84,20 +87,20 @@
 
 Filename: odoo/addons/l10n_nl_tax_statement/views/report_tax_statement.xml
 Comment: 
 
 Filename: odoo/addons/l10n_nl_tax_statement/views/res_config_settings.xml
 Comment: 
 
-Filename: odoo_addon_l10n_nl_tax_statement-15.0.1.0.1.dist-info/METADATA
+Filename: odoo_addon_l10n_nl_tax_statement-16.0.1.0.0.5.dist-info/METADATA
 Comment: 
 
-Filename: odoo_addon_l10n_nl_tax_statement-15.0.1.0.1.dist-info/WHEEL
+Filename: odoo_addon_l10n_nl_tax_statement-16.0.1.0.0.5.dist-info/WHEEL
 Comment: 
 
-Filename: odoo_addon_l10n_nl_tax_statement-15.0.1.0.1.dist-info/top_level.txt
+Filename: odoo_addon_l10n_nl_tax_statement-16.0.1.0.0.5.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo_addon_l10n_nl_tax_statement-15.0.1.0.1.dist-info/RECORD
+Filename: odoo_addon_l10n_nl_tax_statement-16.0.1.0.0.5.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/l10n_nl_tax_statement/README.rst

```diff
@@ -10,21 +10,21 @@
 .. |badge1| image:: https://img.shields.io/badge/maturity-Beta-yellow.png
     :target: https://odoo-community.org/page/development-status
     :alt: Beta
 .. |badge2| image:: https://img.shields.io/badge/licence-AGPL--3-blue.png
     :target: http://www.gnu.org/licenses/agpl-3.0-standalone.html
     :alt: License: AGPL-3
 .. |badge3| image:: https://img.shields.io/badge/github-OCA%2Fl10n--netherlands-lightgray.png?logo=github
-    :target: https://github.com/OCA/l10n-netherlands/tree/15.0/l10n_nl_tax_statement
+    :target: https://github.com/OCA/l10n-netherlands/tree/16.0/l10n_nl_tax_statement
     :alt: OCA/l10n-netherlands
 .. |badge4| image:: https://img.shields.io/badge/weblate-Translate%20me-F47D42.png
-    :target: https://translation.odoo-community.org/projects/l10n-netherlands-15-0/l10n-netherlands-15-0-l10n_nl_tax_statement
+    :target: https://translation.odoo-community.org/projects/l10n-netherlands-16-0/l10n-netherlands-16-0-l10n_nl_tax_statement
     :alt: Translate me on Weblate
 .. |badge5| image:: https://img.shields.io/badge/runbot-Try%20me-875A7B.png
-    :target: https://runbot.odoo-community.org/runbot/176/15.0
+    :target: https://runbot.odoo-community.org/runbot/176/16.0
     :alt: Try me on Runbot
 
 |badge1| |badge2| |badge3| |badge4| |badge5| 
 
 This module provides you with the Tax Statement in the Dutch format.
 
 The Tax Statement can be generated in two ways, according to
@@ -41,19 +41,14 @@
 in: https://www.belastingdienst.nl/wps/wcm/connect/bldcontentnl/belastingdienst/zakelijk/btw/btw_aangifte_doen_en_betalen/bereken_het_bedrag/hoe_berekent_u_het_btw_bedrag/kasstelsel/kasstelsel
 
 **Table of contents**
 
 .. contents::
    :local:
 
-Installation
-============
-
-* This module depends on module ``date_range``.
-
 Configuration
 =============
 
 This module makes use of the tax tags (eg.: 1a, 1b, 1c, 1d, 2a...) as prescribed by the Dutch tax laws.
 
 If the default Odoo Dutch chart of accounts is installed (module ``l10n_nl``) then these tags are automatically present in the database.
 
@@ -79,15 +74,15 @@
 #. Go to ``Invoicing -> Configuration -> Settings``, enable/disable ``NL Tax Invoice Basis (Factuurstelsel)`` and ``Apply``.
 
 Usage
 =====
 
 To create a statement you need to:
 
-#. Verify that you have enough permits. You need to belong to the *Show Full Accounting Features* group.
+#. Verify that you have enough permits. You need to belong at least to the *Billing Manager* or the *Accountant* group.
 #. Go to the menu: `Invoicing -> Reporting > NL BTW Statement`
 #. Create a statement, providing a name and specifying start date and end date
 #. Press the Update button to calculate the report: the report lines will be displayed in the tab `Statement`
 #. Manually enter the BTW amounts of lines '5d', '5e', '5f' (in Edit mode, click on the amount of the line to be able to change it)
 #. Press the Post button to set the status of the statement to Posted; the statements set to this state cannot be modified
 
 To add past undeclared invoices/moves:
@@ -102,14 +97,18 @@
 #. If you need to recalculate or modify or delete a statement already set to Posted status you need first to set it back to Draft status: press the button Reset to Draft
 #. Instead, if you send the statement to the Tax Authority, you may want to avoid that the statement is set back to Draft: to avoid this, press the button Final. If you then confirm, it will be not possible to modify this Statement or reset it back to draft anymore.
 
 Printing a PDF report:
 
 #. If you need to print the report in PDF, open a statement form and click: `Print -> NL Tax Statement`
 
+Exporting a XLS report:
+
+#. If you need to export the report in XLSX, open a statement form and click: `Print -> NL Tax Statement XLS export`
+
 Multicompany fiscal unit:
 
 #. According the Dutch Tax Authority, for all the companies belonging to a
    fiscal unit, it's possible to declare one single tax statement.
 #. To create one tax statement for a fiscal unit, log in into the parent
    company and select the child companies in the statement (be sure the user
    belongs to the multicompany group).
@@ -126,15 +125,15 @@
 
 Bug Tracker
 ===========
 
 Bugs are tracked on `GitHub Issues <https://github.com/OCA/l10n-netherlands/issues>`_.
 In case of trouble, please check there if your issue has already been reported.
 If you spotted it first, help us smashing it by providing a detailed and welcomed
-`feedback <https://github.com/OCA/l10n-netherlands/issues/new?body=module:%20l10n_nl_tax_statement%0Aversion:%2015.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**>`_.
+`feedback <https://github.com/OCA/l10n-netherlands/issues/new?body=module:%20l10n_nl_tax_statement%0Aversion:%2016.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**>`_.
 
 Do not contact contributors directly about support or help with technical issues.
 
 Credits
 =======
 
 Authors
@@ -157,10 +156,10 @@
    :alt: Odoo Community Association
    :target: https://odoo-community.org
 
 OCA, or the Odoo Community Association, is a nonprofit organization whose
 mission is to support the collaborative development of Odoo features and
 promote its widespread use.
 
-This module is part of the `OCA/l10n-netherlands <https://github.com/OCA/l10n-netherlands/tree/15.0/l10n_nl_tax_statement>`_ project on GitHub.
+This module is part of the `OCA/l10n-netherlands <https://github.com/OCA/l10n-netherlands/tree/16.0/l10n_nl_tax_statement>`_ project on GitHub.
 
 You are welcome to contribute. To learn how please visit https://odoo-community.org/page/Contribute.
```

## odoo/addons/l10n_nl_tax_statement/__init__.py

```diff
@@ -1 +1,2 @@
 from . import models
+from . import report
```

## odoo/addons/l10n_nl_tax_statement/__manifest__.py

```diff
@@ -1,18 +1,18 @@
 # Copyright 2017-2019 Onestein (<https://www.onestein.eu>)
 # License AGPL-3.0 or later (https://www.gnu.org/licenses/agpl).
 
 {
     "name": "Netherlands BTW Statement",
-    "version": "15.0.1.0.1",
+    "version": "16.0.1.0.0",
     "category": "Localization",
     "license": "AGPL-3",
     "author": "Onestein, Odoo Community Association (OCA)",
     "website": "https://github.com/OCA/l10n-netherlands",
-    "depends": ["account", "date_range"],
+    "depends": ["account", "report_xlsx"],
     "data": [
         "security/ir.model.access.csv",
         "security/tax_statement_security_rule.xml",
         "data/paperformat.xml",
         "views/l10n_nl_vat_statement_view.xml",
         "views/report_tax_statement.xml",
         "views/res_config_settings.xml",
```

## odoo/addons/l10n_nl_tax_statement/i18n/l10n_nl_tax_statement.pot

```diff
@@ -1,14 +1,14 @@
 # Translation of Odoo Server.
 # This file contains the translation of the following modules:
 # 	* l10n_nl_tax_statement
 #
 msgid ""
 msgstr ""
-"Project-Id-Version: Odoo Server 15.0\n"
+"Project-Id-Version: Odoo Server 16.0\n"
 "Report-Msgid-Bugs-To: \n"
 "Last-Translator: \n"
 "Language-Team: \n"
 "MIME-Version: 1.0\n"
 "Content-Type: text/plain; charset=UTF-8\n"
 "Content-Transfer-Encoding: \n"
 "Plural-Forms: \n"
@@ -20,14 +20,15 @@
 
 #. module: l10n_nl_tax_statement
 #: model_terms:ir.ui.view,arch_db:l10n_nl_tax_statement.report_tax_statement
 msgid "&amp;nbsp; &amp;nbsp; 5g - Totaal"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid "1d Prive-gebruik"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
 #: model:ir.model.fields,field_description:l10n_nl_tax_statement.field_l10n_nl_vat_statement__format_btw_total
@@ -45,16 +46,16 @@
 "<i class=\"fa fa-long-arrow-right mx-2\" aria-label=\"Arrow icon\" "
 "title=\"Arrow\"/>"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
 #: model_terms:ir.ui.view,arch_db:l10n_nl_tax_statement.res_config_settings_view_form
 msgid ""
-"<span class=\"fa fa-lg fa-building-o\" title=\"Values set here are company-"
-"specific.\" groups=\"base.group_multi_company\"/>"
+"<span class=\"o_form_label\">NL Tax Invoice Basis</span>\n"
+"                        <span class=\"fa fa-lg fa-building-o\" title=\"Values set here are company-specific.\" aria-label=\"Values set here are company-specific.\" groups=\"base.group_multi_company\"/>"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
 #: model_terms:ir.ui.view,arch_db:l10n_nl_tax_statement.report_tax_statement
 msgid "Aangifte omzetbelasting"
 msgstr ""
 
@@ -85,15 +86,18 @@
 
 #. module: l10n_nl_tax_statement
 #: model_terms:ir.ui.view,arch_db:l10n_nl_tax_statement.view_l10n_nl_vat_report_form
 msgid "Check the statement of the parent Company."
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
+#: code:addons/l10n_nl_tax_statement/report/l10n_nl_tax_statement_xlsx.py:0
 #: model:ir.model.fields,field_description:l10n_nl_tax_statement.field_l10n_nl_vat_statement_line__code
+#, python-format
 msgid "Code"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
 #: model:ir.model,name:l10n_nl_tax_statement.model_res_company
 msgid "Companies"
 msgstr ""
@@ -139,25 +143,38 @@
 
 #. module: l10n_nl_tax_statement
 #: model:ir.model.fields,field_description:l10n_nl_tax_statement.field_l10n_nl_vat_statement__date_update
 msgid "Date Update"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
+#: code:addons/l10n_nl_tax_statement/report/l10n_nl_tax_statement_xlsx.py:0
+#, python-format
+msgid "Date from"
+msgstr ""
+
+#. module: l10n_nl_tax_statement
 #: model_terms:ir.ui.view,arch_db:l10n_nl_tax_statement.report_tax_statement_filters
 msgid "Date posted"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
-#: model:ir.model.fields,field_description:l10n_nl_tax_statement.field_l10n_nl_vat_statement__date_range_id
 #: model_terms:ir.ui.view,arch_db:l10n_nl_tax_statement.report_tax_statement_filters
 msgid "Date range"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
+#: code:addons/l10n_nl_tax_statement/report/l10n_nl_tax_statement_xlsx.py:0
+#, python-format
+msgid "Date to"
+msgstr ""
+
+#. module: l10n_nl_tax_statement
 #: model_terms:ir.ui.view,arch_db:l10n_nl_tax_statement.report_tax_statement_filters
 msgid "Date update"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
 #: model:ir.model.fields,field_description:l10n_nl_tax_statement.field_l10n_nl_vat_statement__display_button_add_all_undeclared_invoices
 msgid "Display Button Add All Undeclared Invoices"
@@ -212,14 +229,15 @@
 #. module: l10n_nl_tax_statement
 #: model:ir.model.fields,field_description:l10n_nl_tax_statement.field_l10n_nl_vat_statement__from_date
 #: model_terms:ir.ui.view,arch_db:l10n_nl_tax_statement.view_l10n_nl_vat_report_form
 msgid "From Date"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid "Heffing van omzetbelasting is naar u verlegd"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
 #: model:ir.model.fields,field_description:l10n_nl_tax_statement.field_l10n_nl_vat_statement__id
@@ -251,14 +269,15 @@
 #: model:ir.model.fields,field_description:l10n_nl_tax_statement.field_account_move__l10n_nl_vat_statement_include
 #: model:ir.model.fields,field_description:l10n_nl_tax_statement.field_account_move_line__l10n_nl_vat_statement_include
 #: model:ir.model.fields,field_description:l10n_nl_tax_statement.field_account_payment__l10n_nl_vat_statement_include
 msgid "Include in VAT Statement"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid "Installatie/afstandsverkopen binnen de EU"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
 #: model:ir.model.fields,field_description:l10n_nl_tax_statement.field_l10n_nl_vat_statement_line__is_group
@@ -307,62 +326,71 @@
 #. module: l10n_nl_tax_statement
 #: model:ir.model.fields,field_description:l10n_nl_tax_statement.field_l10n_nl_vat_statement__write_date
 #: model:ir.model.fields,field_description:l10n_nl_tax_statement.field_l10n_nl_vat_statement_line__write_date
 msgid "Last Updated on"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid "Leveringen en/of diensten binnenland"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid "Leveringen naar het buitenland"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid "Leveringen naar landen binnen de EU"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid "Leveringen naar landen buiten de EU"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid "Leveringen vanuit het buitenland"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid "Leveringen/diensten belast met 0%"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid "Leveringen/diensten belast met hoog tarief"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid "Leveringen/diensten belast met laag tarief"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid "Leveringen/diensten belast met overige tarieven behalve 0%"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
 #: model:ir.model.fields,field_description:l10n_nl_tax_statement.field_l10n_nl_vat_statement__line_ids
@@ -394,15 +422,28 @@
 
 #. module: l10n_nl_tax_statement
 #: model:ir.actions.report,name:l10n_nl_tax_statement.action_report_tax_statement
 msgid "NL Tax Statement"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#: model:ir.actions.report,name:l10n_nl_tax_statement.action_report_tax_statement_xls_export
+msgid "NL Tax Statement XLS export"
+msgstr ""
+
+#. module: l10n_nl_tax_statement
+#: model:ir.model,name:l10n_nl_tax_statement.model_report_l10n_nl_tax_statement_report_tax_statement_xlsx
+msgid "NL Tax Statement XLSX report"
+msgstr ""
+
+#. module: l10n_nl_tax_statement
+#. odoo-python
+#: code:addons/l10n_nl_tax_statement/report/l10n_nl_tax_statement_xlsx.py:0
 #: model:ir.model.fields,field_description:l10n_nl_tax_statement.field_l10n_nl_vat_statement_line__name
+#, python-format
 msgid "Name"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
 #: model:ir.model,name:l10n_nl_tax_statement.model_l10n_nl_vat_statement
 msgid "Netherlands Vat Statement"
 msgstr ""
@@ -454,20 +495,22 @@
 
 #. module: l10n_nl_tax_statement
 #: model_terms:ir.ui.view,arch_db:l10n_nl_tax_statement.view_l10n_nl_vat_report_form
 msgid "Reset to Draft"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid "Schatting deze aangifte"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid "Schatting vorige aangifte(n)"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
 #: model:ir.model.fields,field_description:l10n_nl_tax_statement.field_l10n_nl_vat_statement_line__statement_id
@@ -476,59 +519,66 @@
 
 #. module: l10n_nl_tax_statement
 #: model:ir.model.fields,field_description:l10n_nl_tax_statement.field_l10n_nl_vat_statement__state
 msgid "Status"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid "Subtotaal (rubriek 5a min 5b)"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid ""
 "Tags mapping not configured for The Netherlands! Check the NL BTW Tags "
 "Configuration."
 msgstr ""
 
 #. module: l10n_nl_tax_statement
 #: model:ir.model.fields,field_description:l10n_nl_tax_statement.field_l10n_nl_vat_statement__name
 msgid "Tax Statement"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid "The Companies belonging to a fiscal unit must be in The Netherlands."
 msgstr ""
 
 #. module: l10n_nl_tax_statement
 #: model:ir.model.fields,field_description:l10n_nl_tax_statement.field_l10n_nl_vat_statement__to_date
 msgid "To Date"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
+#: code:addons/l10n_nl_tax_statement/report/l10n_nl_tax_statement_xlsx.py:0
 #: model:ir.model.fields,field_description:l10n_nl_tax_statement.field_l10n_nl_vat_statement_line__omzet
+#, python-format
 msgid "Turnover"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
 #: model:ir.model.fields,field_description:l10n_nl_tax_statement.field_l10n_nl_vat_statement__unreported_move_ids
 msgid "Unreported Journal Entries"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
 #: model:ir.model.fields,field_description:l10n_nl_tax_statement.field_l10n_nl_vat_statement__unreported_move_from_date
 msgid "Unreported Move From Date"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid "Unreported moves: unsupported search operator"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
 #: model_terms:ir.ui.view,arch_db:l10n_nl_tax_statement.view_l10n_nl_vat_report_form
@@ -537,113 +587,142 @@
 
 #. module: l10n_nl_tax_statement
 #: model:ir.model.fields,help:l10n_nl_tax_statement.field_l10n_nl_vat_statement_line__currency_id
 msgid "Utility field to express amount currency"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
+#: code:addons/l10n_nl_tax_statement/report/l10n_nl_tax_statement_xlsx.py:0
 #: model:ir.model.fields,field_description:l10n_nl_tax_statement.field_l10n_nl_vat_statement_line__btw
+#, python-format
 msgid "VAT"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid "Verleggingsregelingen: BTW naar u verlegd"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid "Vermindering volgens de kleineondernemersregeling"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid "Verschuldigde omzetbelasting (rubrieken 1a t/m 4b)"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid "Verwerving uit landen buiten de EU"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid "Verwerving van goederen uit landen binnen de EU"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#: model_terms:ir.ui.view,arch_db:l10n_nl_tax_statement.view_l10n_nl_vat_report_form
+msgid "View Base Lines"
+msgstr ""
+
+#. module: l10n_nl_tax_statement
+#: model_terms:ir.ui.view,arch_db:l10n_nl_tax_statement.view_l10n_nl_vat_report_form
+msgid "View Tax Lines"
+msgstr ""
+
+#. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid "Voorbelasting"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid ""
 "You cannot delete a posted statement! Reset the statement to draft first."
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid "You cannot delete a statement set as final!"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement_line.py:0
 #, python-format
 msgid ""
 "You cannot delete lines of a posted statement! Reset the statement to draft "
 "first."
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement_line.py:0
 #, python-format
 msgid "You cannot delete lines of a statement set as final!"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/account_move.py:0
 #, python-format
 msgid "You cannot modify a Journal Entry in a posted/final tax statement: %s"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/account_move_line.py:0
 #, python-format
 msgid "You cannot modify a Journal Item in a posted/final tax statement: %s"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid "You cannot modify a posted statement!"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid ""
 "You cannot modify a posted statement! Reset the statement to draft first."
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid "You cannot modify a statement set as final!"
 msgstr ""
 
 #. module: l10n_nl_tax_statement
+#. odoo-python
 #: code:addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py:0
 #, python-format
 msgid ""
 "You cannot post a statement if all the previous statements are not yet "
 "posted! Please Post all the other statements first."
 msgstr ""
```

## odoo/addons/l10n_nl_tax_statement/models/account_move_line.py

```diff
@@ -21,15 +21,14 @@
     @api.model
     def _get_l10n_nl_vat_statement_protected_fields(self):
         """Hook for extensions"""
         return [
             "date",
             "debit",
             "credit",
-            "balance",
             "tax_ids",
             "l10n_nl_vat_statement_include",
             "tax_tag_ids",
         ]
 
     def write(self, values):
         if self._l10n_nl_vat_statement_should_check_write(values):
```

## odoo/addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py

```diff
@@ -33,21 +33,16 @@
     company_id = fields.Many2one(
         "res.company",
         "Company",
         required=True,
         readonly=True,
         default=lambda self: self.env.company,
     )
-    from_date = fields.Date(
-        required=True, store=True, readonly=False, compute="_compute_date_range"
-    )
-    to_date = fields.Date(
-        required=True, store=True, readonly=False, compute="_compute_date_range"
-    )
-    date_range_id = fields.Many2one("date.range", "Date range")
+    from_date = fields.Date(required=True)
+    to_date = fields.Date(required=True)
     currency_id = fields.Many2one("res.currency", related="company_id.currency_id")
     date_posted = fields.Datetime(readonly=True)
     date_update = fields.Datetime(readonly=True)
 
     btw_total = fields.Monetary(
         compute="_compute_btw_total", string="5g. Total (5c + 5d)"
     )
@@ -200,35 +195,36 @@
 
     @api.model
     def default_get(self, fields_list):
         defaults = super().default_get(fields_list)
         fy_dates = self.env.company.compute_fiscalyear_dates(datetime.now())
         defaults.setdefault("from_date", fy_dates["date_from"])
         defaults.setdefault("to_date", fy_dates["date_to"])
-        defaults.setdefault("name", self.env.company.name)
+        defaults.setdefault(
+            "name",
+            self._statement_display_name(
+                self.env.company.name, fy_dates["date_from"], fy_dates["date_to"]
+            ),
+        )
         return defaults
 
-    @api.depends("date_range_id")
-    def _compute_date_range(self):
-        for statement in self:
-            if statement.date_range_id and statement.state == "draft":
-                statement.from_date = statement.date_range_id.date_start
-                statement.to_date = statement.date_range_id.date_end
-            statement.from_date = statement.from_date
-            statement.to_date = statement.to_date
-
     @api.depends("from_date", "to_date")
     def _compute_name(self):
         for statement in self:
-            display_name = statement.company_id.name
-            if statement.from_date and statement.to_date:
-                from_date = fields.Date.to_string(statement.from_date)
-                to_date = fields.Date.to_string(statement.to_date)
-                display_name += ": " + " ".join([from_date, to_date])
-            statement.name = display_name
+            statement.name = self._statement_display_name(
+                statement.company_id.name, statement.from_date, statement.to_date
+            )
+
+    @api.model
+    def _statement_display_name(self, display_name, from_date, to_date):
+        if from_date and to_date:
+            from_date = fields.Date.to_string(from_date)
+            to_date = fields.Date.to_string(to_date)
+            display_name += ": " + " ".join([from_date, to_date])
+        return display_name
 
     @api.depends("from_date")
     def _compute_unreported_move_from_date(self):
         # by default the unreported_move_from_date is set to
         # a quarter (three months) before the from_date of the statement
         for statement in self:
             date_from = (
@@ -478,18 +474,18 @@
         self.ensure_one()
         self._check_prev_open_statements()
 
         self.write({"state": "posted", "date_posted": fields.Datetime.now()})
         self.unreported_move_ids.filtered(
             lambda m: m.l10n_nl_vat_statement_include
         ).write({"l10n_nl_vat_statement_id": self.id})
-        self.unreported_move_ids.flush()
+        self.unreported_move_ids.flush_recordset()
         move_lines = self._compute_move_lines()
         move_lines.move_id.write({"l10n_nl_vat_statement_id": self.id})
-        move_lines.move_id.flush()
+        move_lines.move_id.flush_recordset()
 
     def _get_move_lines_domain(self):
         domain = self._init_move_line_domain()
         if self.is_invoice_basis:
             domain += [
                 "|",
                 "&",
```

## odoo/addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement_line.py

```diff
@@ -100,19 +100,19 @@
 
     def view_base_lines(self):
         self.ensure_one()
         return self.get_lines_action(tax_or_base="base")
 
     def get_lines_action(self, tax_or_base="tax"):
         self.ensure_one()
-        action = self.env.ref("account.action_account_moves_all_tree")
-        vals = action.read()[0]
-        vals["context"] = {}
-        vals["domain"] = self._get_move_lines_domain(tax_or_base)
-        return vals
+        action_name = "account.action_account_moves_all_tree"
+        action_vals = self.env["ir.actions.act_window"]._for_xml_id(action_name)
+        action_vals["context"] = {}
+        action_vals["domain"] = self._get_move_lines_domain(tax_or_base)
+        return action_vals
 
     def _get_move_lines_domain(self, tax_or_base):
         all_amls = self.statement_id._get_all_statement_move_lines()
         domain_lines_ids = []
         tags_map = self.statement_id._get_tags_map()
         for line in all_amls:
             for tag in line.tax_tag_ids:
```

## odoo/addons/l10n_nl_tax_statement/readme/USAGE.rst

```diff
@@ -1,10 +1,10 @@
 To create a statement you need to:
 
-#. Verify that you have enough permits. You need to belong to the *Show Full Accounting Features* group.
+#. Verify that you have enough permits. You need to belong at least to the *Billing Manager* or the *Accountant* group.
 #. Go to the menu: `Invoicing -> Reporting > NL BTW Statement`
 #. Create a statement, providing a name and specifying start date and end date
 #. Press the Update button to calculate the report: the report lines will be displayed in the tab `Statement`
 #. Manually enter the BTW amounts of lines '5d', '5e', '5f' (in Edit mode, click on the amount of the line to be able to change it)
 #. Press the Post button to set the status of the statement to Posted; the statements set to this state cannot be modified
 
 To add past undeclared invoices/moves:
@@ -19,14 +19,18 @@
 #. If you need to recalculate or modify or delete a statement already set to Posted status you need first to set it back to Draft status: press the button Reset to Draft
 #. Instead, if you send the statement to the Tax Authority, you may want to avoid that the statement is set back to Draft: to avoid this, press the button Final. If you then confirm, it will be not possible to modify this Statement or reset it back to draft anymore.
 
 Printing a PDF report:
 
 #. If you need to print the report in PDF, open a statement form and click: `Print -> NL Tax Statement`
 
+Exporting a XLS report:
+
+#. If you need to export the report in XLSX, open a statement form and click: `Print -> NL Tax Statement XLS export`
+
 Multicompany fiscal unit:
 
 #. According the Dutch Tax Authority, for all the companies belonging to a
    fiscal unit, it's possible to declare one single tax statement.
 #. To create one tax statement for a fiscal unit, log in into the parent
    company and select the child companies in the statement (be sure the user
    belongs to the multicompany group).
```

## odoo/addons/l10n_nl_tax_statement/static/description/index.html

### odoo/addons/l10n_nl_tax_statement/static/description/index.html

```diff
@@ -367,21 +367,21 @@
       <p>
         <a class="reference external" href="https://odoo-community.org/page/development-status">
           <img alt="Beta" src="https://img.shields.io/badge/maturity-Beta-yellow.png"/>
         </a>
         <a class="reference external" href="http://www.gnu.org/licenses/agpl-3.0-standalone.html">
           <img alt="License: AGPL-3" src="https://img.shields.io/badge/licence-AGPL--3-blue.png"/>
         </a>
-        <a class="reference external" href="https://github.com/OCA/l10n-netherlands/tree/15.0/l10n_nl_tax_statement">
+        <a class="reference external" href="https://github.com/OCA/l10n-netherlands/tree/16.0/l10n_nl_tax_statement">
           <img alt="OCA/l10n-netherlands" src="https://img.shields.io/badge/github-OCA%2Fl10n--netherlands-lightgray.png?logo=github"/>
         </a>
-        <a class="reference external" href="https://translation.odoo-community.org/projects/l10n-netherlands-15-0/l10n-netherlands-15-0-l10n_nl_tax_statement">
+        <a class="reference external" href="https://translation.odoo-community.org/projects/l10n-netherlands-16-0/l10n-netherlands-16-0-l10n_nl_tax_statement">
           <img alt="Translate me on Weblate" src="https://img.shields.io/badge/weblate-Translate%20me-F47D42.png"/>
         </a>
-        <a class="reference external" href="https://runbot.odoo-community.org/runbot/176/15.0">
+        <a class="reference external" href="https://runbot.odoo-community.org/runbot/176/16.0">
           <img alt="Try me on Runbot" src="https://img.shields.io/badge/runbot-Try%20me-875A7B.png"/>
         </a>
       </p>
       <p>This module provides you with the Tax Statement in the Dutch format.</p>
       <p>The Tax Statement can be generated in two ways, according to
 the chosen Dutch accounting system:</p>
       <ul class="simple">
@@ -405,59 +405,44 @@
       </p>
       <p>
         <strong>Table of contents</strong>
       </p>
       <div class="contents local topic" id="contents">
         <ul class="simple">
           <li>
-            <a class="reference internal" href="#installation" id="id1">Installation</a>
+            <a class="reference internal" href="#configuration" id="id1">Configuration</a>
           </li>
           <li>
-            <a class="reference internal" href="#configuration" id="id2">Configuration</a>
+            <a class="reference internal" href="#usage" id="id2">Usage</a>
           </li>
           <li>
-            <a class="reference internal" href="#usage" id="id3">Usage</a>
+            <a class="reference internal" href="#known-issues-roadmap" id="id3">Known issues / Roadmap</a>
           </li>
           <li>
-            <a class="reference internal" href="#known-issues-roadmap" id="id4">Known issues / Roadmap</a>
+            <a class="reference internal" href="#bug-tracker" id="id4">Bug Tracker</a>
           </li>
           <li>
-            <a class="reference internal" href="#bug-tracker" id="id5">Bug Tracker</a>
-          </li>
-          <li>
-            <a class="reference internal" href="#credits" id="id6">Credits</a>
+            <a class="reference internal" href="#credits" id="id5">Credits</a>
             <ul>
               <li>
-                <a class="reference internal" href="#authors" id="id7">Authors</a>
+                <a class="reference internal" href="#authors" id="id6">Authors</a>
               </li>
               <li>
-                <a class="reference internal" href="#contributors" id="id8">Contributors</a>
+                <a class="reference internal" href="#contributors" id="id7">Contributors</a>
               </li>
               <li>
-                <a class="reference internal" href="#maintainers" id="id9">Maintainers</a>
+                <a class="reference internal" href="#maintainers" id="id8">Maintainers</a>
               </li>
             </ul>
           </li>
         </ul>
       </div>
-      <div class="section" id="installation">
-        <h1>
-          <a class="toc-backref" href="#id1">Installation</a>
-        </h1>
-        <ul class="simple">
-          <li>
-            This module depends on module
-            <tt class="docutils literal">date_range</tt>
-            .
-          </li>
-        </ul>
-      </div>
       <div class="section" id="configuration">
         <h1>
-          <a class="toc-backref" href="#id2">Configuration</a>
+          <a class="toc-backref" href="#id1">Configuration</a>
         </h1>
         <p>This module makes use of the tax tags (eg.: 1a, 1b, 1c, 1d, 2a…) as prescribed by the Dutch tax laws.</p>
         <p>
           If the default Odoo Dutch chart of accounts is installed (module
           <tt class="docutils literal">l10n_nl</tt>
           ) then these tags are automatically present in the database.
         </p>
@@ -515,21 +500,23 @@
             <tt class="docutils literal">Apply</tt>
             .
           </li>
         </ol>
       </div>
       <div class="section" id="usage">
         <h1>
-          <a class="toc-backref" href="#id3">Usage</a>
+          <a class="toc-backref" href="#id2">Usage</a>
         </h1>
         <p>To create a statement you need to:</p>
         <ol class="arabic simple">
           <li>
-            Verify that you have enough permits. You need to belong to the
-            <em>Show Full Accounting Features</em>
+            Verify that you have enough permits. You need to belong at least to the
+            <em>Billing Manager</em>
+            or the
+            <em>Accountant</em>
             group.
           </li>
           <li>
             Go to the menu:
             <cite>Invoicing -&gt; Reporting &gt; NL BTW Statement</cite>
           </li>
           <li>Create a statement, providing a name and specifying start date and end date</li>
@@ -563,66 +550,73 @@
         <p>Printing a PDF report:</p>
         <ol class="arabic simple">
           <li>
             If you need to print the report in PDF, open a statement form and click:
             <cite>Print -&gt; NL Tax Statement</cite>
           </li>
         </ol>
+        <p>Exporting a XLS report:</p>
+        <ol class="arabic simple">
+          <li>
+            If you need to export the report in XLSX, open a statement form and click:
+            <cite>Print -&gt; NL Tax Statement XLS export</cite>
+          </li>
+        </ol>
         <p>Multicompany fiscal unit:</p>
         <ol class="arabic simple">
           <li>According the Dutch Tax Authority, for all the companies belonging to a
 fiscal unit, it’s possible to declare one single tax statement.</li>
           <li>To create one tax statement for a fiscal unit, log in into the parent
 company and select the child companies in the statement (be sure the user
 belongs to the multicompany group).</li>
           <li>The child companies must have the same Tax codes labels (Tax Tags) as the
 parent company, the same currency as the parent company and must be located
 in The Netherlands.</li>
         </ol>
       </div>
       <div class="section" id="known-issues-roadmap">
         <h1>
-          <a class="toc-backref" href="#id4">Known issues / Roadmap</a>
+          <a class="toc-backref" href="#id3">Known issues / Roadmap</a>
         </h1>
         <ul class="simple">
           <li>Exporting in SBR/XBLR format not yet available</li>
           <li>Limit invoices to last 5 year based on fiscal year end date (legal requirement)</li>
           <li>The unreported from date is calculate as 1 quarter, it should take 1 fiscal year based on fiscal year end date</li>
         </ul>
       </div>
       <div class="section" id="bug-tracker">
         <h1>
-          <a class="toc-backref" href="#id5">Bug Tracker</a>
+          <a class="toc-backref" href="#id4">Bug Tracker</a>
         </h1>
         <p>
           Bugs are tracked on
           <a class="reference external" href="https://github.com/OCA/l10n-netherlands/issues">GitHub Issues</a>
           .
 In case of trouble, please check there if your issue has already been reported.
 If you spotted it first, help us smashing it by providing a detailed and welcomed
-          <a class="reference external" href="https://github.com/OCA/l10n-netherlands/issues/new?body=module:%20l10n_nl_tax_statement%0Aversion:%2015.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**">feedback</a>
+          <a class="reference external" href="https://github.com/OCA/l10n-netherlands/issues/new?body=module:%20l10n_nl_tax_statement%0Aversion:%2016.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**">feedback</a>
           .
         </p>
         <p>Do not contact contributors directly about support or help with technical issues.</p>
       </div>
       <div class="section" id="credits">
         <h1>
-          <a class="toc-backref" href="#id6">Credits</a>
+          <a class="toc-backref" href="#id5">Credits</a>
         </h1>
         <div class="section" id="authors">
           <h2>
-            <a class="toc-backref" href="#id7">Authors</a>
+            <a class="toc-backref" href="#id6">Authors</a>
           </h2>
           <ul class="simple">
             <li>Onestein</li>
           </ul>
         </div>
         <div class="section" id="contributors">
           <h2>
-            <a class="toc-backref" href="#id8">Contributors</a>
+            <a class="toc-backref" href="#id7">Contributors</a>
           </h2>
           <ul class="simple">
             <li>
               Andrea Stirpe &lt;
               <a class="reference external" href="mailto:a.stirpe@onestein.nl">a.stirpe@onestein.nl</a>
               &gt;
             </li>
@@ -631,26 +625,26 @@
               <a class="reference external" href="mailto:a.esposito@onestein.nl">a.esposito@onestein.nl</a>
               &gt;
             </li>
           </ul>
         </div>
         <div class="section" id="maintainers">
           <h2>
-            <a class="toc-backref" href="#id9">Maintainers</a>
+            <a class="toc-backref" href="#id8">Maintainers</a>
           </h2>
           <p>This module is maintained by the OCA.</p>
           <a class="reference external image-reference" href="https://odoo-community.org">
             <img alt="Odoo Community Association" src="https://odoo-community.org/logo.png"/>
           </a>
           <p>OCA, or the Odoo Community Association, is a nonprofit organization whose
 mission is to support the collaborative development of Odoo features and
 promote its widespread use.</p>
           <p>
             This module is part of the
-            <a class="reference external" href="https://github.com/OCA/l10n-netherlands/tree/15.0/l10n_nl_tax_statement">OCA/l10n-netherlands</a>
+            <a class="reference external" href="https://github.com/OCA/l10n-netherlands/tree/16.0/l10n_nl_tax_statement">OCA/l10n-netherlands</a>
             project on GitHub.
           </p>
           <p>
             You are welcome to contribute. To learn how please visit
             <a class="reference external" href="https://odoo-community.org/page/Contribute">https://odoo-community.org/page/Contribute</a>
             .
           </p>
```

## odoo/addons/l10n_nl_tax_statement/tests/test_l10n_nl_vat_statement.py

```diff
@@ -4,33 +4,19 @@
 import datetime
 
 from dateutil.relativedelta import relativedelta
 
 import odoo
 from odoo import fields
 from odoo.exceptions import UserError, ValidationError
-from odoo.modules.module import get_resource_path
 from odoo.tests import Form
 from odoo.tests.common import TransactionCase
-from odoo.tools import convert_file
 
 
 class TestVatStatement(TransactionCase):
-    def _load(self, module, *args):
-        convert_file(
-            self.cr,
-            "l10n_nl",
-            get_resource_path(module, *args),
-            {},
-            "init",
-            False,
-            "test",
-            self.registry._assertion_report,
-        )
-
     def _create_company_children(self):
         self.company_child_1 = self.env["res.company"].create(
             {
                 "name": "Child 1 Company",
                 "country_id": self.env.ref("base.nl").id,
                 "parent_id": self.company_parent.id,
             }
@@ -41,144 +27,126 @@
                 "name": "Child 2 Company",
                 "country_id": self.env.ref("base.be").id,
                 "parent_id": self.company_parent.id,
             }
         )
         self.coa.try_loading(company=self.company_child_2, install_demo=False)
 
-    def setUp(self):
-        super().setUp()
-        self.eur = self.env.ref("base.EUR")
-        self.coa = self.env.ref("l10n_nl.l10nnl_chart_template", False)
-        self.coa = self.coa or self.env.ref(
-            "l10n_generic_coa.configurable_chart_template"
-        )
-        self.company_parent = self.env["res.company"].create(
+    @classmethod
+    def setUpClass(cls):
+        super().setUpClass()
+        cls.eur = cls.env.ref("base.EUR")
+        cls.coa = cls.env.ref("l10n_nl.l10nnl_chart_template", False)
+        cls.coa = cls.coa or cls.env.ref("l10n_generic_coa.configurable_chart_template")
+        cls.company_parent = cls.env["res.company"].create(
             {
                 "name": "Parent Company",
-                "country_id": self.env.ref("base.nl").id,
-                "currency_id": self.eur.id,
+                "country_id": cls.env.ref("base.nl").id,
+                "currency_id": cls.eur.id,
             }
         )
-        self.env.user.company_id = self.company_parent
-        self.coa.try_loading(company=self.company_parent, install_demo=False)
+        cls.env.user.company_id = cls.company_parent
+        cls.coa.try_loading(company=cls.company_parent, install_demo=False)
 
-        self.env["l10n.nl.vat.statement"].search([]).unlink()
+        cls.env["l10n.nl.vat.statement"].search([]).unlink()
 
-        self.tag_1 = self.env["account.account.tag"].create(
+        cls.tag_1 = cls.env["account.account.tag"].create(
             {
                 "name": "+1a omzet",
                 "applicability": "taxes",
-                "country_id": self.env.ref("base.nl").id,
+                "country_id": cls.env.ref("base.nl").id,
             }
         )
-        self.tag_2 = self.env["account.account.tag"].create(
+        cls.tag_2 = cls.env["account.account.tag"].create(
             {
                 "name": "+1a btw",
                 "applicability": "taxes",
-                "country_id": self.env.ref("base.nl").id,
+                "country_id": cls.env.ref("base.nl").id,
             }
         )
-        self.tag_3 = self.env["account.account.tag"].create(
+        cls.tag_3 = cls.env["account.account.tag"].create(
             {
                 "name": "+2a omzet",
                 "applicability": "taxes",
-                "country_id": self.env.ref("base.nl").id,
+                "country_id": cls.env.ref("base.nl").id,
             }
         )
-        self.tag_4 = self.env["account.account.tag"].create(
+        cls.tag_4 = cls.env["account.account.tag"].create(
             {
                 "name": "-2a omzet",
                 "applicability": "taxes",
-                "country_id": self.env.ref("base.nl").id,
+                "country_id": cls.env.ref("base.nl").id,
             }
         )
-        self.tag_5 = self.env["account.account.tag"].create(
+        cls.tag_5 = cls.env["account.account.tag"].create(
             {
                 "name": "+3b omzet",
                 "applicability": "taxes",
-                "country_id": self.env.ref("base.nl").id,
+                "country_id": cls.env.ref("base.nl").id,
             }
         )
-        self.tag_6 = self.env["account.account.tag"].create(
+        cls.tag_6 = cls.env["account.account.tag"].create(
             {
                 "name": "+3b omzet d",
                 "applicability": "taxes",
-                "country_id": self.env.ref("base.nl").id,
+                "country_id": cls.env.ref("base.nl").id,
             }
         )
 
-        self.tax_1 = self.env["account.tax"].create(
-            {"name": "Tax 1", "amount": 21, "country_id": self.env.ref("base.nl").id}
+        cls.tax_1 = cls.env["account.tax"].create(
+            {"name": "Tax 1", "amount": 21, "country_id": cls.env.ref("base.nl").id}
         )
-        self.tax_1.invoice_repartition_line_ids[0].tag_ids = self.tag_1
-        self.tax_1.invoice_repartition_line_ids[1].tag_ids = self.tag_2
+        cls.tax_1.invoice_repartition_line_ids[0].tag_ids = cls.tag_1
+        cls.tax_1.invoice_repartition_line_ids[1].tag_ids = cls.tag_2
 
-        self.tax_2 = self.env["account.tax"].create(
-            {"name": "Tax 2", "amount": 21, "country_id": self.env.ref("base.nl").id}
+        cls.tax_2 = cls.env["account.tax"].create(
+            {"name": "Tax 2", "amount": 21, "country_id": cls.env.ref("base.nl").id}
         )
-        self.tax_2.invoice_repartition_line_ids[0].tag_ids = self.tag_3
-        self.tax_2.invoice_repartition_line_ids[1].tag_ids = self.tag_4
+        cls.tax_2.invoice_repartition_line_ids[0].tag_ids = cls.tag_3
+        cls.tax_2.invoice_repartition_line_ids[1].tag_ids = cls.tag_4
 
-        self.statement_1 = self.env["l10n.nl.vat.statement"].create(
+        cls.statement_1 = cls.env["l10n.nl.vat.statement"].create(
             {"name": "Statement 1"}
         )
 
     def _create_test_invoice(self):
         self.company_parent.compute_account_tax_fiscal_country()
-        journal = self.env["account.journal"].create(
-            {
-                "name": "Journal 1",
-                "code": "Jou1",
-                "type": "sale",
-                "company_id": self.company_parent.id,
-            }
-        )
+
         partner = self.env["res.partner"].create({"name": "Test partner"})
-        account_receivable = self.env["account.account"].create(
+        self.env["account.account"].create(
             {
-                "user_type_id": self.env.ref("account.data_account_type_expenses").id,
+                "account_type": "expense",
                 "code": "EXPTEST",
                 "name": "Test expense account",
             }
         )
         invoice_form = Form(
             self.env["account.move"].with_context(default_move_type="out_invoice")
         )
         invoice_form.partner_id = partner
-        invoice_form.journal_id = journal
+
         with invoice_form.invoice_line_ids.new() as line:
             line.name = "Test line"
             line.quantity = 1.0
-            line.account_id = account_receivable
             line.price_unit = 100.0
             line.tax_ids.clear()
             line.tax_ids.add(self.tax_1)
         with invoice_form.invoice_line_ids.new() as line:
             line.name = "Test line"
             line.quantity = 1.0
-            line.account_id = account_receivable
             line.price_unit = 50.0
             line.tax_ids.clear()
             line.tax_ids.add(self.tax_2)
         self.invoice_1 = invoice_form.save()
         self.assertEqual(len(self.invoice_1.line_ids), 5)
 
     def test_01_onchange(self):
-        daterange_type = self.env["date.range.type"].create({"name": "Type 1"})
-        daterange = self.env["date.range"].create(
-            {
-                "name": "Daterange 1",
-                "type_id": daterange_type.id,
-                "date_start": "2016-01-01",
-                "date_end": "2016-12-31",
-            }
-        )
         form = Form(self.statement_1)
-        form.date_range_id = daterange
+        form.from_date = datetime.date(2016, 1, 1)
+        form.to_date = datetime.date(2016, 12, 31)
         statement = form.save()
         self.assertEqual(statement.from_date, datetime.date(2016, 1, 1))
         self.assertEqual(statement.to_date, datetime.date(2016, 12, 31))
 
         check_name = statement.company_id.name
         str_from_date = fields.Date.to_string(statement.from_date)
         str_to_date = fields.Date.to_string(statement.to_date)
@@ -563,7 +531,19 @@
         statement_child_1.statement_update()
         self.assertFalse(statement_child_1.line_ids)
         statement_child_2.statement_update()
         self.assertFalse(statement_child_1.line_ids)
 
         company_ids_full_list = statement_parent._get_company_ids_full_list()
         self.assertEqual(len(company_ids_full_list), 3)
+
+    def test_21_action_xls(self):
+        """Generate XLS report from action"""
+        report = "l10n_nl_tax_statement.action_report_tax_statement_xls_export"
+        self.report_action = self.env.ref(report)
+        self.assertEqual(self.report_action.report_type, "xlsx")
+        model = self.env["report.%s" % self.report_action["report_name"]].with_context(
+            active_model="l10n.nl.vat.statement"
+        )
+        res = model.create_xlsx_report(self.statement_1.ids, data=None)
+        self.assertTrue(res[0])
+        self.assertEqual(res[1], "xlsx")
```

## odoo/addons/l10n_nl_tax_statement/views/l10n_nl_vat_statement_view.xml

### odoo/addons/l10n_nl_tax_statement/views/l10n_nl_vat_statement_view.xml

```diff
@@ -12,27 +12,28 @@
         <sheet>
           <div class="oe_button_box" name="button_box">
             <button name="statement_update" string="Update" states="draft" type="object" class="oe_stat_button" icon="fa-repeat"/>
             <button name="post" string="Post" states="draft" type="object" class="oe_stat_button" icon="fa-arrow-right text-success"/>
             <button name="reset" string="Reset to Draft" states="posted" type="object" class="oe_stat_button" icon="fa-arrow-left text-success"/>
             <button name="finalize" string="Finalize" states="posted" type="object" class="oe_stat_button" icon="fa-stop-circle-o text-success" confirm="If you confirm, it will be not possible to modify this Statement or reset it back to draft anymore. Do you confirm?"/>
           </div>
-          <label for="name"/>
-          <h1>
-            <field name="name"/>
-          </h1>
+          <div class="oe_title" colspan="4">
+            <label for="name"/>
+            <h1>
+              <field name="name"/>
+            </h1>
+          </div>
           <group>
             <group name="tax_report">
               <field name="company_id" options="{'no_create': True}" groups="base.group_multi_company"/>
               <field name="is_invoice_basis"/>
-              <field name="parent_id" attrs="{'invisible': [('parent_id', '=', False)]}" groups="base.group_multi_company"/>
+              <field name="parent_id" attrs="{'invisible': [('parent_id', '=', False)]}"/>
               <field name="display_multicompany_fiscal_unit" invisible="1" groups="base.group_multi_company"/>
               <field name="multicompany_fiscal_unit" attrs="{'readonly': [('state','in',['posted','final'])],'invisible': [('display_multicompany_fiscal_unit', '=', False)]}" groups="base.group_multi_company"/>
               <field name="fiscal_unit_company_ids" widget="many2many_tags" domain="[('parent_id', '=', company_id)]" attrs="{'readonly': [('state','in',['posted','final'])],'invisible': [('multicompany_fiscal_unit', '=', False)]}" groups="base.group_multi_company"/>
-              <field name="date_range_id" attrs="{'readonly': [('state','in',['posted','final'])]}"/>
               <label for="from_date" string="Date"/>
               <div class="o_row">
                 <field name="from_date" widget="daterange" nolabel="1" class="oe_inline" options="{'related_end_date': 'to_date'}" attrs="{'readonly': [('state','in',['posted','final'])]}"/>
                 <i class="fa fa-long-arrow-right mx-2" aria-label="Arrow icon" title="Arrow"/>
                 <field name="to_date" widget="daterange" nolabel="1" class="oe_inline" options="{'related_start_date': 'from_date'}" attrs="{'readonly': [('state','in',['posted','final'])]}"/>
               </div>
             </group>
@@ -41,19 +42,23 @@
               <field name="date_update"/>
               <field name="currency_id"/>
             </group>
           </group>
           <notebook name="notebook">
             <page name="statement" string="BTW Statement">
               <group attrs="{'invisible': [('parent_id','=',False)]}">
-                <div>Check the statement of the parent Company.</div>
+                <span class="text-muted"/>
+                <div class="o_row o_row_readonly">Check the statement of the parent Company.</div>
               </group>
               <group name="statement_lines" string="BTW Statement lines" attrs="{'invisible':['|',('state','!=','draft'),('parent_id','!=',False)]}">
-                <div states="draft">Press the Update button in order to recompute the statement lines!</div>
-                <button name="statement_update" string="Update" states="draft" type="object" class="oe_highlight" icon="fa-repeat"/>
+                <span class="text-muted"/>
+                <div class="o_row o_row_readonly">
+                  <div states="draft">Press the Update button in order to recompute the statement lines!</div>
+                  <button name="statement_update" string="Update" states="draft" type="object" class="oe_highlight" icon="fa-repeat"/>
+                </div>
               </group>
               <field name="line_ids" attrs="{'invisible': [('parent_id','!=',False)]}">
                 <form>
                   <group>
                     <group>
                       <field name="code"/>
                       <field name="name"/>
@@ -69,17 +74,17 @@
                   <field name="is_total" invisible="1"/>
                   <field name="is_readonly" invisible="1"/>
                   <field name="code" readonly="1"/>
                   <field name="name" readonly="1"/>
                   <field name="format_omzet" invisible="1"/>
                   <field name="format_btw" invisible="1"/>
                   <field name="omzet" attrs="{'invisible': [('format_omzet', '=', False)],'readonly': [('is_readonly', '=', True)]}"/>
-                  <button name="view_base_lines" type="object" icon="fa-search-plus" attrs="{'invisible': ['|',('format_omzet', '=', False),('is_total', '=', True)]}"/>
+                  <button name="view_base_lines" title="View Base Lines" type="object" icon="fa-search-plus" attrs="{'invisible': ['|',('format_omzet', '=', False),('is_total', '=', True)]}"/>
                   <field name="btw" attrs="{'invisible': [('format_btw', '=', False)],'readonly': [('is_readonly', '=', True)]}"/>
-                  <button name="view_tax_lines" type="object" icon="fa-search-plus" attrs="{'invisible': ['|',('format_btw', '=', False),('is_total', '=', True)]}"/>
+                  <button name="view_tax_lines" title="View Tax Lines" type="object" icon="fa-search-plus" attrs="{'invisible': ['|',('format_btw', '=', False),('is_total', '=', True)]}"/>
                 </tree>
               </field>
               <group attrs="{'invisible': [('parent_id','!=',False)]}">
                 <group/>
                 <group>
                   <label for="btw_total"/>
                   <field name="btw_total" nolabel="1"/>
```

## odoo/addons/l10n_nl_tax_statement/views/report_tax_statement.xml

### odoo/addons/l10n_nl_tax_statement/views/report_tax_statement.xml

```diff
@@ -8,8 +8,17 @@
     <field name="report_type">qweb-pdf</field>
     <field name="report_name">l10n_nl_tax_statement.report_tax_statement</field>
     <field name="report_file">l10n_nl_tax_statement.report_tax_statement</field>
     <field name="binding_model_id" ref="model_l10n_nl_vat_statement"/>
     <field name="binding_type">report</field>
     <field name="paperformat_id" ref="paperformat_nl_tax_statement"/>
   </record>
+  <record id="action_report_tax_statement_xls_export" model="ir.actions.report">
+    <field name="name">NL Tax Statement XLS export</field>
+    <field name="model">l10n.nl.vat.statement</field>
+    <field name="report_type">xlsx</field>
+    <field name="report_name">l10n_nl_tax_statement.report_tax_statement_xlsx</field>
+    <field name="report_file">l10n_nl_tax_statement.report_tax_statement_xlsx</field>
+    <field name="binding_model_id" ref="l10n_nl_tax_statement.model_l10n_nl_vat_statement"/>
+    <field name="binding_type">report</field>
+  </record>
 </odoo>
```

## odoo/addons/l10n_nl_tax_statement/views/res_config_settings.xml

### odoo/addons/l10n_nl_tax_statement/views/res_config_settings.xml

```diff
@@ -8,16 +8,16 @@
     <field name="arch" type="xml">
       <div id="eu_service" position="after">
         <div class="col-xs-12 col-md-6 o_setting_box" title="If this checkbox is ticked, you will enable the Netherlands Tax Invoice Basis (Factuurstelsel).">
           <div class="o_setting_left_pane">
             <field name="l10n_nl_tax_invoice_basis"/>
           </div>
           <div class="o_setting_right_pane">
-            <label for="l10n_nl_tax_invoice_basis"/>
-            <span class="fa fa-lg fa-building-o" title="Values set here are company-specific." groups="base.group_multi_company"/>
+            <span class="o_form_label">NL Tax Invoice Basis</span>
+            <span class="fa fa-lg fa-building-o" title="Values set here are company-specific." aria-label="Values set here are company-specific." groups="base.group_multi_company"/>
             <div class="text-muted">NL Tax Invoice Basis (Factuurstelsel)</div>
           </div>
         </div>
       </div>
     </field>
   </record>
 </odoo>
```

## Comparing `odoo_addon_l10n_nl_tax_statement-15.0.1.0.1.dist-info/METADATA` & `odoo_addon_l10n_nl_tax_statement-16.0.1.0.0.5.dist-info/METADATA`

 * *Files 4% similar despite different names*

```diff
@@ -1,23 +1,23 @@
 Metadata-Version: 2.1
 Name: odoo-addon-l10n-nl-tax-statement
-Version: 15.0.1.0.1
+Version: 16.0.1.0.0.5
 Summary: Netherlands BTW Statement
 Home-page: https://github.com/OCA/l10n-netherlands
 Author: Onestein, Odoo Community Association (OCA)
 Author-email: support@odoo-community.org
 License: AGPL-3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
 Classifier: Framework :: Odoo
-Classifier: Framework :: Odoo :: 15.0
+Classifier: Framework :: Odoo :: 16.0
 Classifier: License :: OSI Approved :: GNU Affero General Public License v3
-Requires-Python: >=3.8
-Requires-Dist: odoo-addon-date-range (<15.1dev,>=15.0dev)
-Requires-Dist: odoo (<15.1dev,>=15.0a)
+Requires-Python: >=3.10
+Requires-Dist: odoo-addon-report-xlsx (<16.1dev,>=16.0dev)
+Requires-Dist: odoo (<16.1dev,>=16.0a)
 
 =========================
 Netherlands BTW Statement
 =========================
 
 .. !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    !! This file is generated by oca-gen-addon-readme !!
@@ -27,21 +27,21 @@
 .. |badge1| image:: https://img.shields.io/badge/maturity-Beta-yellow.png
     :target: https://odoo-community.org/page/development-status
     :alt: Beta
 .. |badge2| image:: https://img.shields.io/badge/licence-AGPL--3-blue.png
     :target: http://www.gnu.org/licenses/agpl-3.0-standalone.html
     :alt: License: AGPL-3
 .. |badge3| image:: https://img.shields.io/badge/github-OCA%2Fl10n--netherlands-lightgray.png?logo=github
-    :target: https://github.com/OCA/l10n-netherlands/tree/15.0/l10n_nl_tax_statement
+    :target: https://github.com/OCA/l10n-netherlands/tree/16.0/l10n_nl_tax_statement
     :alt: OCA/l10n-netherlands
 .. |badge4| image:: https://img.shields.io/badge/weblate-Translate%20me-F47D42.png
-    :target: https://translation.odoo-community.org/projects/l10n-netherlands-15-0/l10n-netherlands-15-0-l10n_nl_tax_statement
+    :target: https://translation.odoo-community.org/projects/l10n-netherlands-16-0/l10n-netherlands-16-0-l10n_nl_tax_statement
     :alt: Translate me on Weblate
 .. |badge5| image:: https://img.shields.io/badge/runbot-Try%20me-875A7B.png
-    :target: https://runbot.odoo-community.org/runbot/176/15.0
+    :target: https://runbot.odoo-community.org/runbot/176/16.0
     :alt: Try me on Runbot
 
 |badge1| |badge2| |badge3| |badge4| |badge5| 
 
 This module provides you with the Tax Statement in the Dutch format.
 
 The Tax Statement can be generated in two ways, according to
@@ -58,19 +58,14 @@
 in: https://www.belastingdienst.nl/wps/wcm/connect/bldcontentnl/belastingdienst/zakelijk/btw/btw_aangifte_doen_en_betalen/bereken_het_bedrag/hoe_berekent_u_het_btw_bedrag/kasstelsel/kasstelsel
 
 **Table of contents**
 
 .. contents::
    :local:
 
-Installation
-============
-
-* This module depends on module ``date_range``.
-
 Configuration
 =============
 
 This module makes use of the tax tags (eg.: 1a, 1b, 1c, 1d, 2a...) as prescribed by the Dutch tax laws.
 
 If the default Odoo Dutch chart of accounts is installed (module ``l10n_nl``) then these tags are automatically present in the database.
 
@@ -96,15 +91,15 @@
 #. Go to ``Invoicing -> Configuration -> Settings``, enable/disable ``NL Tax Invoice Basis (Factuurstelsel)`` and ``Apply``.
 
 Usage
 =====
 
 To create a statement you need to:
 
-#. Verify that you have enough permits. You need to belong to the *Show Full Accounting Features* group.
+#. Verify that you have enough permits. You need to belong at least to the *Billing Manager* or the *Accountant* group.
 #. Go to the menu: `Invoicing -> Reporting > NL BTW Statement`
 #. Create a statement, providing a name and specifying start date and end date
 #. Press the Update button to calculate the report: the report lines will be displayed in the tab `Statement`
 #. Manually enter the BTW amounts of lines '5d', '5e', '5f' (in Edit mode, click on the amount of the line to be able to change it)
 #. Press the Post button to set the status of the statement to Posted; the statements set to this state cannot be modified
 
 To add past undeclared invoices/moves:
@@ -119,14 +114,18 @@
 #. If you need to recalculate or modify or delete a statement already set to Posted status you need first to set it back to Draft status: press the button Reset to Draft
 #. Instead, if you send the statement to the Tax Authority, you may want to avoid that the statement is set back to Draft: to avoid this, press the button Final. If you then confirm, it will be not possible to modify this Statement or reset it back to draft anymore.
 
 Printing a PDF report:
 
 #. If you need to print the report in PDF, open a statement form and click: `Print -> NL Tax Statement`
 
+Exporting a XLS report:
+
+#. If you need to export the report in XLSX, open a statement form and click: `Print -> NL Tax Statement XLS export`
+
 Multicompany fiscal unit:
 
 #. According the Dutch Tax Authority, for all the companies belonging to a
    fiscal unit, it's possible to declare one single tax statement.
 #. To create one tax statement for a fiscal unit, log in into the parent
    company and select the child companies in the statement (be sure the user
    belongs to the multicompany group).
@@ -143,15 +142,15 @@
 
 Bug Tracker
 ===========
 
 Bugs are tracked on `GitHub Issues <https://github.com/OCA/l10n-netherlands/issues>`_.
 In case of trouble, please check there if your issue has already been reported.
 If you spotted it first, help us smashing it by providing a detailed and welcomed
-`feedback <https://github.com/OCA/l10n-netherlands/issues/new?body=module:%20l10n_nl_tax_statement%0Aversion:%2015.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**>`_.
+`feedback <https://github.com/OCA/l10n-netherlands/issues/new?body=module:%20l10n_nl_tax_statement%0Aversion:%2016.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**>`_.
 
 Do not contact contributors directly about support or help with technical issues.
 
 Credits
 =======
 
 Authors
@@ -174,12 +173,12 @@
    :alt: Odoo Community Association
    :target: https://odoo-community.org
 
 OCA, or the Odoo Community Association, is a nonprofit organization whose
 mission is to support the collaborative development of Odoo features and
 promote its widespread use.
 
-This module is part of the `OCA/l10n-netherlands <https://github.com/OCA/l10n-netherlands/tree/15.0/l10n_nl_tax_statement>`_ project on GitHub.
+This module is part of the `OCA/l10n-netherlands <https://github.com/OCA/l10n-netherlands/tree/16.0/l10n_nl_tax_statement>`_ project on GitHub.
 
 You are welcome to contribute. To learn how please visit https://odoo-community.org/page/Contribute.
```

## Comparing `odoo_addon_l10n_nl_tax_statement-15.0.1.0.1.dist-info/RECORD` & `odoo_addon_l10n_nl_tax_statement-16.0.1.0.0.5.dist-info/RECORD`

 * *Files 9% similar despite different names*

```diff
@@ -1,34 +1,35 @@
-odoo/addons/l10n_nl_tax_statement/README.rst,sha256=OktXBU0pJ_-jba5VjG7Sm4G-jtcDBbKVjNxGczDw60g,7798
-odoo/addons/l10n_nl_tax_statement/__init__.py,sha256=X9EJGOE2GtZbS0G82PtSXmWSZ_R8jEM0rlJTDliQjp4,21
-odoo/addons/l10n_nl_tax_statement/__manifest__.py,sha256=iSrn-xmptnqy1zcXam3FPT9ULGhHnwmyshpI5K-9QXI,760
+odoo/addons/l10n_nl_tax_statement/README.rst,sha256=Ciiwzvpot9yDLgyj1EYtUp15d4fjgD6YlsxU3qHrTPE,7880
+odoo/addons/l10n_nl_tax_statement/__init__.py,sha256=RYGen4VvN9c8GXvMfZMuO7ERiyRCUJfuAbgo0aC3DEU,42
+odoo/addons/l10n_nl_tax_statement/__manifest__.py,sha256=KwmMggXQJcrKorRpifqJkYXoSsV6v2JExP6DjPlT18s,761
 odoo/addons/l10n_nl_tax_statement/data/paperformat.xml,sha256=166D_Dk3LJPngzko9EUApY96XJWjWdiG9xBX4FP64kg,882
-odoo/addons/l10n_nl_tax_statement/i18n/l10n_nl_tax_statement.pot,sha256=Sh63bMOF-Cz7mH16eQBYh5WFBPvMbtlO4BPQ-Apcauc,22368
+odoo/addons/l10n_nl_tax_statement/i18n/l10n_nl_tax_statement.pot,sha256=BW5ri7mfGs1I2UVQ4CEhTeR2S0XMtcrpvsgtvAno-Qc,24340
 odoo/addons/l10n_nl_tax_statement/i18n/nl.po,sha256=NpdhHvWm1RVvT5KNNSvt9h2bOSJnm_eqI8EoV-Si34Y,29361
 odoo/addons/l10n_nl_tax_statement/models/__init__.py,sha256=V73x7p45EZ9aNgnbmanly3svAuhjOxgyP4GMSyJAX3g,196
 odoo/addons/l10n_nl_tax_statement/models/account_move.py,sha256=q937ojl7fws0Xyt3BG4lzVzZ9mSGUK6-403J3msNFng,1910
-odoo/addons/l10n_nl_tax_statement/models/account_move_line.py,sha256=57_Mhj4x4z4UrgyZMmDLG4pHf4WNuYbNP-Y8N5IFSK0,1901
-odoo/addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py,sha256=BxRWgIkYRgeI6x-NEE-DY826wTZJG9d8ihCY6JuKRZ4,21709
-odoo/addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement_line.py,sha256=dxtlyAepeeZOw6cgaXzLg6vItEI92ywAHil2wViJ0iU,4196
+odoo/addons/l10n_nl_tax_statement/models/account_move_line.py,sha256=s6Cbnyek_p4ykg8g7G3zN1ENwTx15Tf2gz5wQT4x9Ds,1878
+odoo/addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement.py,sha256=sPTuUpXeEpCQ32CBI0m9QdShHnU51RBMXFszyLY0HcE,21361
+odoo/addons/l10n_nl_tax_statement/models/l10n_nl_vat_statement_line.py,sha256=hlIJ1aGU0fJiMFU-X4FGqTIzrFN5RWwrzyNRQ77ncdc,4257
 odoo/addons/l10n_nl_tax_statement/models/res_company.py,sha256=cNFn-0lvb6KE5nj2RqG91gQbow1pbWGYiYgdDzHkW9w,327
 odoo/addons/l10n_nl_tax_statement/models/res_config_settings.py,sha256=rtbPNe6bCbR0KLYYBZ9PcmeDoq8C71lRz4dwD_Sn42E,394
 odoo/addons/l10n_nl_tax_statement/readme/CONFIGURE.rst,sha256=rqw-PGz9G-akEUq9t7P8r_tB4TiQUGT0qRXd_ytTd9s,1607
 odoo/addons/l10n_nl_tax_statement/readme/CONTRIBUTORS.rst,sha256=32czXhQgO136Y80DL3zbnnd-5TQv3yOmJMuW4AbZkBM,83
 odoo/addons/l10n_nl_tax_statement/readme/DESCRIPTION.rst,sha256=NRkY2m2JaRfTI7oVOgp9AgHcf4HRqy8my8TZVqw-_pg,889
-odoo/addons/l10n_nl_tax_statement/readme/INSTALL.rst,sha256=9FRubwanKYPbpsVNmWhm23DDFQlOM33QUtPDyKMoGBQ,48
 odoo/addons/l10n_nl_tax_statement/readme/ROADMAP.rst,sha256=5lGvcIwJ5MHBIRZ74Au__EyAqYApd8h1KNClCxE5khc,244
-odoo/addons/l10n_nl_tax_statement/readme/USAGE.rst,sha256=AJUwjjbXZ36oCbb13Ibbqq3T-YwWOfCnv-EfNoXwcHw,2193
+odoo/addons/l10n_nl_tax_statement/readme/USAGE.rst,sha256=yYVuT_gLwqd6UAqP9VcAYeBQ91jyY5fyiMakXsZYN2s,2351
+odoo/addons/l10n_nl_tax_statement/report/__init__.py,sha256=LneQ4ium83VhqU3MWNo-pmzTyNRA2UIcf_CgyrmP2DA,41
+odoo/addons/l10n_nl_tax_statement/report/l10n_nl_tax_statement_xlsx.py,sha256=blwYkd8mKUfDsg80JWphbeCHdjX-SOU0ShiZDcqd_gc,8038
 odoo/addons/l10n_nl_tax_statement/report/report_tax_statement.xml,sha256=eAlIJsPE_gaGcLEmERgr9BhT_7uiNL2dXrczYJemh_I,5851
 odoo/addons/l10n_nl_tax_statement/security/ir.model.access.csv,sha256=jwqv0hFOap3xKJhC9yDVE7ic5LRb7ljZVQT-H9nZqiE,340
 odoo/addons/l10n_nl_tax_statement/security/tax_statement_security_rule.xml,sha256=q5Pq9xQh6aQB5KbxbEQux-lzk549OK2qlBb9XtTAFBw,584
 odoo/addons/l10n_nl_tax_statement/static/description/icon.png,sha256=6xBPJauaFOF0KDHfHgQopSc28kKvxMaeoQFQWZtfZDo,9455
-odoo/addons/l10n_nl_tax_statement/static/description/index.html,sha256=I8oEJ1xTVNZH_B-XSr0vk7wSsmR8MUTGHxbB0NxU4Dk,19013
+odoo/addons/l10n_nl_tax_statement/static/description/index.html,sha256=IchKS9pxw1oWQh8XfJIaKracGU_naOb9jEBB7nF1uE8,18931
 odoo/addons/l10n_nl_tax_statement/static/src/css/report.css,sha256=n_Qu3H0-rojqWLFfGSajgl7Jlb8RPaFmf-M398c_PS0,1030
 odoo/addons/l10n_nl_tax_statement/tests/__init__.py,sha256=YlzapWcinXK3Zbuo6L_NVId3RCNw0dpnHwPH0Ymu4cA,41
-odoo/addons/l10n_nl_tax_statement/tests/test_l10n_nl_vat_statement.py,sha256=iOWWWcp_2rur82V1c4sjfG_IS8mVMplQuOSNzpv2koU,22883
-odoo/addons/l10n_nl_tax_statement/views/l10n_nl_vat_statement_view.xml,sha256=KgZbiP63D_JX26QetCUMhJCPvI35oPGs6-4SoE-qWnQ,15676
-odoo/addons/l10n_nl_tax_statement/views/report_tax_statement.xml,sha256=BNw_j1MvsqS_N6uJUVREZNhPhx5HtQTdajuCXhwoYsM,807
-odoo/addons/l10n_nl_tax_statement/views/res_config_settings.xml,sha256=_pnsxcHtnve4KAjYlfms4w2PcPCudja0q1ulMrybuTU,1469
-odoo_addon_l10n_nl_tax_statement-15.0.1.0.1.dist-info/METADATA,sha256=UeIz6B6AHEhdps6eXaPxfplZp65x5ygIjunoQatPOIM,8401
-odoo_addon_l10n_nl_tax_statement-15.0.1.0.1.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
-odoo_addon_l10n_nl_tax_statement-15.0.1.0.1.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
-odoo_addon_l10n_nl_tax_statement-15.0.1.0.1.dist-info/RECORD,,
+odoo/addons/l10n_nl_tax_statement/tests/test_l10n_nl_vat_statement.py,sha256=5Lqx4je4DnPRhEpjB30jiF67-Alo1RiEYqjgxB6GE0M,22313
+odoo/addons/l10n_nl_tax_statement/views/l10n_nl_vat_statement_view.xml,sha256=pYfMut90ALJHgeOqGyXxBVoGxiPr13GwPkj_CT3peK0,15952
+odoo/addons/l10n_nl_tax_statement/views/report_tax_statement.xml,sha256=UZlBDLzCkHgcyUJkHi0ND6BYwXFJhW_9gXghitB_M9I,1475
+odoo/addons/l10n_nl_tax_statement/views/res_config_settings.xml,sha256=KABLhILXssPQ3G9MxJAzuSoG8FTJKn7hAI04ZlbUhsA,1561
+odoo_addon_l10n_nl_tax_statement-16.0.1.0.0.5.dist-info/METADATA,sha256=5WN7BSxNm1Esc2YYBEebCsResEQWMl2UYBO4fagFGfM,8487
+odoo_addon_l10n_nl_tax_statement-16.0.1.0.0.5.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+odoo_addon_l10n_nl_tax_statement-16.0.1.0.0.5.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
+odoo_addon_l10n_nl_tax_statement-16.0.1.0.0.5.dist-info/RECORD,,
```

