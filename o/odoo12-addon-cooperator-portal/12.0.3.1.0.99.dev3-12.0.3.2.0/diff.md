# Comparing `tmp/odoo12_addon_cooperator_portal-12.0.3.1.0.99.dev3-py3-none-any.whl.zip` & `tmp/odoo12_addon_cooperator_portal-12.0.3.2.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,23 +1,23 @@
-Zip file size: 31002 bytes, number of entries: 21
--rw-r--r--  2.0 unx     2774 b- defN 22-Oct-06 15:50 odoo/addons/cooperator_portal/README.rst
--rw-r--r--  2.0 unx       47 b- defN 22-Oct-06 15:50 odoo/addons/cooperator_portal/__init__.py
--rw-r--r--  2.0 unx      693 b- defN 22-Oct-06 15:50 odoo/addons/cooperator_portal/__manifest__.py
--rw-r--r--  2.0 unx       21 b- defN 22-Oct-06 15:50 odoo/addons/cooperator_portal/controllers/__init__.py
--rw-r--r--  2.0 unx    10409 b- defN 22-Oct-06 15:50 odoo/addons/cooperator_portal/controllers/portal.py
--rw-r--r--  2.0 unx     6016 b- defN 22-Oct-06 15:50 odoo/addons/cooperator_portal/i18n/cooperator_portal.pot
--rw-r--r--  2.0 unx     6744 b- defN 22-Oct-06 15:50 odoo/addons/cooperator_portal/i18n/fr.po
--rw-r--r--  2.0 unx     6105 b- defN 22-Oct-06 15:50 odoo/addons/cooperator_portal/i18n/fr_BE.po
--rw-r--r--  2.0 unx      923 b- defN 22-Oct-06 15:50 odoo/addons/cooperator_portal/migrations/12.0.3.0.0/pre-migration.py
--rw-r--r--  2.0 unx       26 b- defN 22-Oct-06 15:50 odoo/addons/cooperator_portal/models/__init__.py
--rw-r--r--  2.0 unx     1332 b- defN 22-Oct-06 15:50 odoo/addons/cooperator_portal/models/res_partner.py
--rw-r--r--  2.0 unx       18 b- defN 22-Oct-06 15:50 odoo/addons/cooperator_portal/readme/CONTRIBUTORS.rst
--rw-r--r--  2.0 unx      242 b- defN 22-Oct-06 15:50 odoo/addons/cooperator_portal/readme/DESCRIPTION.rst
--rw-r--r--  2.0 unx      106 b- defN 22-Oct-06 15:50 odoo/addons/cooperator_portal/readme/ROADMAP.rst
--rw-r--r--  2.0 unx     9455 b- defN 22-Oct-06 15:50 odoo/addons/cooperator_portal/static/description/icon.png
--rw-r--r--  2.0 unx    12137 b- defN 22-Oct-06 15:50 odoo/addons/cooperator_portal/static/description/index.html
--rw-r--r--  2.0 unx    13654 b- defN 22-Oct-06 15:50 odoo/addons/cooperator_portal/views/portal_templates.xml
--rw-r--r--  2.0 unx     3390 b- defN 22-Oct-06 15:50 odoo12_addon_cooperator_portal-12.0.3.1.0.99.dev3.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 22-Oct-06 15:50 odoo12_addon_cooperator_portal-12.0.3.1.0.99.dev3.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 22-Oct-06 15:50 odoo12_addon_cooperator_portal-12.0.3.1.0.99.dev3.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     2262 b- defN 22-Oct-06 15:50 odoo12_addon_cooperator_portal-12.0.3.1.0.99.dev3.dist-info/RECORD
-21 files, 76451 bytes uncompressed, 27118 bytes compressed:  64.5%
+Zip file size: 31052 bytes, number of entries: 21
+-rw-r--r--  2.0 unx     2774 b- defN 23-Jul-12 15:57 odoo/addons/cooperator_portal/README.rst
+-rw-r--r--  2.0 unx       47 b- defN 23-Jul-12 15:57 odoo/addons/cooperator_portal/__init__.py
+-rw-r--r--  2.0 unx      693 b- defN 23-Jul-12 15:57 odoo/addons/cooperator_portal/__manifest__.py
+-rw-r--r--  2.0 unx       21 b- defN 23-Jul-12 15:57 odoo/addons/cooperator_portal/controllers/__init__.py
+-rw-r--r--  2.0 unx    10806 b- defN 23-Jul-12 15:57 odoo/addons/cooperator_portal/controllers/portal.py
+-rw-r--r--  2.0 unx     6016 b- defN 23-Jul-12 15:57 odoo/addons/cooperator_portal/i18n/cooperator_portal.pot
+-rw-r--r--  2.0 unx     6744 b- defN 23-Jul-12 15:57 odoo/addons/cooperator_portal/i18n/fr.po
+-rw-r--r--  2.0 unx     6105 b- defN 23-Jul-12 15:57 odoo/addons/cooperator_portal/i18n/fr_BE.po
+-rw-r--r--  2.0 unx      923 b- defN 23-Jul-12 15:57 odoo/addons/cooperator_portal/migrations/12.0.3.0.0/pre-migration.py
+-rw-r--r--  2.0 unx       26 b- defN 23-Jul-12 15:57 odoo/addons/cooperator_portal/models/__init__.py
+-rw-r--r--  2.0 unx     1333 b- defN 23-Jul-12 15:57 odoo/addons/cooperator_portal/models/res_partner.py
+-rw-r--r--  2.0 unx       18 b- defN 23-Jul-12 15:57 odoo/addons/cooperator_portal/readme/CONTRIBUTORS.rst
+-rw-r--r--  2.0 unx      242 b- defN 23-Jul-12 15:57 odoo/addons/cooperator_portal/readme/DESCRIPTION.rst
+-rw-r--r--  2.0 unx      106 b- defN 23-Jul-12 15:57 odoo/addons/cooperator_portal/readme/ROADMAP.rst
+-rw-r--r--  2.0 unx     9455 b- defN 23-Jul-12 15:57 odoo/addons/cooperator_portal/static/description/icon.png
+-rw-r--r--  2.0 unx    12137 b- defN 23-Jul-12 15:57 odoo/addons/cooperator_portal/static/description/index.html
+-rw-r--r--  2.0 unx    13739 b- defN 23-Jul-12 15:57 odoo/addons/cooperator_portal/views/portal_templates.xml
+-rw-r--r--  2.0 unx     3382 b- defN 23-Jul-12 15:57 odoo12_addon_cooperator_portal-12.0.3.2.0.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jul-12 15:57 odoo12_addon_cooperator_portal-12.0.3.2.0.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 23-Jul-12 15:57 odoo12_addon_cooperator_portal-12.0.3.2.0.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     2230 b- defN 23-Jul-12 15:57 odoo12_addon_cooperator_portal-12.0.3.2.0.dist-info/RECORD
+21 files, 76894 bytes uncompressed, 27232 bytes compressed:  64.6%
```

## zipnote {}

```diff
@@ -45,20 +45,20 @@
 
 Filename: odoo/addons/cooperator_portal/static/description/index.html
 Comment: 
 
 Filename: odoo/addons/cooperator_portal/views/portal_templates.xml
 Comment: 
 
-Filename: odoo12_addon_cooperator_portal-12.0.3.1.0.99.dev3.dist-info/METADATA
+Filename: odoo12_addon_cooperator_portal-12.0.3.2.0.dist-info/METADATA
 Comment: 
 
-Filename: odoo12_addon_cooperator_portal-12.0.3.1.0.99.dev3.dist-info/WHEEL
+Filename: odoo12_addon_cooperator_portal-12.0.3.2.0.dist-info/WHEEL
 Comment: 
 
-Filename: odoo12_addon_cooperator_portal-12.0.3.1.0.99.dev3.dist-info/top_level.txt
+Filename: odoo12_addon_cooperator_portal-12.0.3.2.0.dist-info/top_level.txt
 Comment: 
 
-Filename: odoo12_addon_cooperator_portal-12.0.3.1.0.99.dev3.dist-info/RECORD
+Filename: odoo12_addon_cooperator_portal-12.0.3.2.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## odoo/addons/cooperator_portal/__manifest__.py

```diff
@@ -1,14 +1,14 @@
 # Copyright 2018 Coop IT Easy SC (<http://www.coopiteasy.be>)
 # - RÃ©my Taymans <remy@coopiteasy.be>
 # - Houssine Bakkali <houssine@coopiteasy.be>
 # License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl).
 {
     "name": "Cooperator Portal",
-    "version": "12.0.3.1.0",
+    "version": "12.0.3.2.0",
     "depends": [
         "account",
         "cooperator",
         "portal",
         "website",
     ],
     "summary": "Show cooperator information in the website portal",
```

## odoo/addons/cooperator_portal/controllers/portal.py

```diff
@@ -11,28 +11,25 @@
 
 from odoo.addons.payment.controllers.portal import PaymentProcessing
 from odoo.addons.portal.controllers.portal import CustomerPortal, pager as portal_pager
 
 
 class CooperatorPortalAccount(CustomerPortal):
     def __init__(self, *args, **kwargs):
-        super().__init__()
-        # Class scope is accessible throughout the server even on
-        # odoo instances that do not install this module.
-
-        # Therefore : bring back to instance scope if not already
-        #  if "MANDATORY_BILLING_FIELDS" in vars(self):
+        super().__init__(*args, **kwargs)
+        # these are class constants (shared between all running odoo
+        # instances), so they have to be copied to self to be modified only
+        # for the odoo instances using this module, but only if a sub-class
+        # did not already do it.
         if "MANDATORY_BILLING_FIELDS" not in vars(self):
-            self.MANDATORY_BILLING_FIELDS = (
-                CustomerPortal.MANDATORY_BILLING_FIELDS.copy()
-            )
-
-        self.MANDATORY_BILLING_FIELDS.extend(
-            ["iban", "birthdate_date", "gender", "lang"]
-        )
+            self.MANDATORY_BILLING_FIELDS = self.MANDATORY_BILLING_FIELDS.copy()
+        self.MANDATORY_BILLING_FIELDS.extend(["birthdate_date", "gender", "lang"])
+        if "OPTIONAL_BILLING_FIELDS" not in vars(self):
+            self.OPTIONAL_BILLING_FIELDS = self.OPTIONAL_BILLING_FIELDS.copy()
+        self.OPTIONAL_BILLING_FIELDS.extend(["iban"])
 
     def _prepare_portal_layout_values(self):
         values = super()._prepare_portal_layout_values()
         # We assume that commercial_partner_id always point to the
         # partner itself or to the linked partner. So there is no
         # need to check if the partner is a "contact" or not.
         partner = request.env.user.partner_id
@@ -74,37 +71,43 @@
         )
         return values
 
     def details_form_validate(self, data):
         error, error_message = super().details_form_validate(data)
         sub_req_model = request.env["subscription.request"]
         iban = data.get("iban")
-        valid = sub_req_model.check_iban(iban)
-
-        if not valid:
+        if iban and not sub_req_model.check_iban(iban):
             error["iban"] = "error"
             error_message.append(_("The IBAN account number is not valid."))
         return error, error_message
 
     @route(["/my/account"], type="http", auth="user", website=True)
     def account(self, redirect=None, **post):
         partner = request.env.user.partner_id
 
         res = super().account(redirect, **post)
-        if not res.qcontext.get("error"):
-            partner_bank = request.env["res.partner.bank"]
+        if (
+            post
+            and request.httprequest.method == "POST"
+            and not res.qcontext.get("error")
+        ):
             iban = post.get("iban")
             if iban:
                 if partner.bank_ids:
-                    bank_account = partner.bank_ids[0]
-                    bank_account.acc_number = iban
+                    # update existing bank account
+                    partner.bank_ids[0].acc_number = iban
                 else:
-                    partner_bank.sudo().create(
-                        {"partner_id": partner.id, "acc_number": iban}
-                    )
+                    # create a new bank account
+                    partner.bank_ids = [
+                        (0, 0, {"partner_id": partner.id, "acc_number": iban})
+                    ]
+            else:
+                if partner.bank_ids:
+                    # delete the existing bank account
+                    partner.bank_ids = [(2, partner.bank_ids[0].id, 0)]
         return res
 
     @route(
         ["/my/invoices", "/my/invoices/page/<int:page>"],
         type="http",
         auth="user",
         website=True,
```

## odoo/addons/cooperator_portal/i18n/cooperator_portal.pot

```diff
@@ -150,15 +150,15 @@
 
 #. module: cooperator_portal
 #: model_terms:ir.ui.view,arch_db:cooperator_portal.portal_my_capital_releases
 msgid "Request Date"
 msgstr ""
 
 #. module: cooperator_portal
-#: code:addons/cooperator_portal/controllers/portal.py:85
+#: code:addons/cooperator_portal/controllers/portal.py:80
 #, python-format
 msgid "The IBAN account number is not valid."
 msgstr ""
 
 #. module: cooperator_portal
 #: model_terms:ir.ui.view,arch_db:cooperator_portal.portal_my_capital_releases
 msgid "There are currently no capital release requests for your account."
```

## odoo/addons/cooperator_portal/models/res_partner.py

```diff
@@ -6,15 +6,15 @@
 
 class ResPartner(models.Model):
     _inherit = "res.partner"
 
     def write(self, vals):
         # Extremely awkward filter function.
         #
-        # In `prepare_portal_layout_values()` of portal.py in our module, the
+        # In `_prepare_portal_layout_values()` of portal.py in our module, the
         # "iban" key is added to the values dict. Later in `account()` (where
         # the latter method is called upstream), we read the key and write its
         # value to the partner's res.partner.bank.
         #
         # However, in between those steps, the `account()` method in upstream
         # `portal` writes the entire values dict to res.partner (where we
         # currently are!). This is bad, because "iban" is not a field of
```

## odoo/addons/cooperator_portal/views/portal_templates.xml

### odoo/addons/cooperator_portal/views/portal_templates.xml

```diff
@@ -12,41 +12,41 @@
     </input>
     <input name="email" position="attributes">
       <attribute name="t-att-readonly">True</attribute>
     </input>
     <xpath expr="//input[@name='phone']/.." position="after">
       <div t-attf-class="form-group #{error.get('gender') and 'o_has_error' or ''} col-xl-6">
         <label class="col-form-label" for="gender">Gender</label>
-        <select name="gender" t-attf-class="form-control #{error.get('gender') or ''}">
+        <select name="gender" t-attf-class="form-control #{error.get('gender') and 'is-invalid' or ''}">
           <option value=""/>
           <t t-foreach="genders or []" t-as="item">
             <option t-att-value="item[0]" t-att-selected="item[0] == partner.gender">
               <t t-esc="item[1]"/>
             </option>
           </t>
         </select>
       </div>
-      <div t-attf-class="form-group #{error.get('lang') and 'has-error' or ''} col-xl-6">
+      <div t-attf-class="form-group #{error.get('lang') and 'o_has_error' or ''} col-xl-6">
         <label class="col-form-label" for="lang">Language</label>
-        <select name="lang" t-attf-class="form-control #{error.get('lang') or ''}">
+        <select name="lang" t-attf-class="form-control #{error.get('lang') and 'is-invalid' or ''}">
           <option value=""/>
           <t t-foreach="langs or []" t-as="langue">
             <option t-att-value="langue.code" t-att-selected="langue.code == partner.lang">
               <t t-esc="langue.name"/>
             </option>
           </t>
         </select>
       </div>
       <div t-attf-class="form-group #{error.get('birthdate_date') and 'o_has_error' or ''} col-xl-6">
         <label class="col-form-label" for="birthdate_date">Date of Birth</label>
-        <input type="date" name="birthdate_date" t-attf-class="form-control #{error.get('birthdate_date') or ''}" t-att-value="birthdate_date or partner.birthdate_date"/>
+        <input type="date" name="birthdate_date" t-attf-class="form-control #{error.get('birthdate_date') and 'is-invalid' or ''}" t-att-value="birthdate_date or partner.birthdate_date"/>
       </div>
       <div t-attf-class="form-group #{error.get('iban') and 'o_has_error' or ''} col-xl-6">
-        <label class="col-form-label" for="iban">Bank Account Number</label>
-        <input type="input" name="iban" t-attf-class="form-control #{error.get('iban') or ''}" t-att-value="iban"/>
+        <label class="col-form-label label-optional" for="iban">Bank Account Number</label>
+        <input type="input" name="iban" t-attf-class="form-control #{error.get('iban') and 'is-invalid' or ''}" t-att-value="iban"/>
       </div>
     </xpath>
   </template>
   <!-- Add cooperator information -->
   <template id="portal_layout" name="Website Portal Details Form" inherit_id="portal.portal_layout">
     <xpath expr="//div[hasclass('o_portal_my_details')]" position="after">
       <div class="o_my_details_coop" t-if="coop.member">
```

## Comparing `odoo12_addon_cooperator_portal-12.0.3.1.0.99.dev3.dist-info/METADATA` & `odoo12_addon_cooperator_portal-12.0.3.2.0.dist-info/METADATA`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: odoo12-addon-cooperator-portal
-Version: 12.0.3.1.0.99.dev3
+Version: 12.0.3.2.0
 Summary: Show cooperator information in the website portal
 Home-page: https://github.com/OCA/cooperative
 Author: Coop IT Easy SC, Odoo Community Association (OCA)
 Author-email: support@odoo-community.org
 License: AGPL-3
 Platform: UNKNOWN
 Classifier: Programming Language :: Python
```

## Comparing `odoo12_addon_cooperator_portal-12.0.3.1.0.99.dev3.dist-info/RECORD` & `odoo12_addon_cooperator_portal-12.0.3.2.0.dist-info/RECORD`

 * *Files 8% similar despite different names*

```diff
@@ -1,21 +1,21 @@
 odoo/addons/cooperator_portal/README.rst,sha256=C-qKvmmJXdSNHJKpH_HGoCRI_uVhww5S_M5Mr42tr4Y,2774
 odoo/addons/cooperator_portal/__init__.py,sha256=zNT2NvGcEjwQgOVsavkpLiHe242IbOncVY4EC0mqhwk,47
-odoo/addons/cooperator_portal/__manifest__.py,sha256=uKWnVwkKEuZJIEmD_m2Ek3iKgsJXYFpY8TKx-gT8rpk,693
+odoo/addons/cooperator_portal/__manifest__.py,sha256=DuyzjX3reo_7opHbzJ03tw9qeu79AvO8FWcOMSQUFNw,693
 odoo/addons/cooperator_portal/controllers/__init__.py,sha256=pbQq5NM9NigzahTMibNoNS6EIjIX0NupxcT9qKMBdsM,21
-odoo/addons/cooperator_portal/controllers/portal.py,sha256=6tYdiDklcu4CXCWh9_2bsRiDiAJ628W4c1w1TMdvlHU,10409
-odoo/addons/cooperator_portal/i18n/cooperator_portal.pot,sha256=YnCTCdbVFcI3Yx3CILGxSgFHB6SqCV7BWmNNvAG8htY,6016
+odoo/addons/cooperator_portal/controllers/portal.py,sha256=5SPF7IVLBIpYJkoeJ1yMt2rA6GW7l5VvcWczyOjRMTQ,10806
+odoo/addons/cooperator_portal/i18n/cooperator_portal.pot,sha256=83Sq7Bpzf1-RtYjS2XPS8-cPz6SRPnmCxLmhexqsm4s,6016
 odoo/addons/cooperator_portal/i18n/fr.po,sha256=pVUsIu3WPrw3O_7qBti3JPXC5zW_pmyinHxe3SBGVjU,6744
 odoo/addons/cooperator_portal/i18n/fr_BE.po,sha256=CHFN9eKeZOwglxtiFCq6em-r1OYhl-irG9L0Vxz5kDc,6105
 odoo/addons/cooperator_portal/migrations/12.0.3.0.0/pre-migration.py,sha256=xQ4d95J6kjnaceKzGCLifJZAAHJIqCZxlTDsbwaPKaE,923
 odoo/addons/cooperator_portal/models/__init__.py,sha256=g-Dp2ZwN6oB4CqdQfgRInNSzdMWAVQg1vjWL7S-ZODM,26
-odoo/addons/cooperator_portal/models/res_partner.py,sha256=n8pRimfPAj2SG-aZZ9Gg09hWYVU0jdID0CbGOzHon3g,1332
+odoo/addons/cooperator_portal/models/res_partner.py,sha256=zfJNVTVCPD435v7HUh1V7L9SI-VLg2NKNVfZYrjDfSo,1333
 odoo/addons/cooperator_portal/readme/CONTRIBUTORS.rst,sha256=jZSoYmiU3IPeLac0s1aHy-axvutpCVeY76cpndsLQok,18
 odoo/addons/cooperator_portal/readme/DESCRIPTION.rst,sha256=fwCj0EOpJFu9w7AaiyzlDj_6J4cxdcRbvNE_jiim-q8,242
 odoo/addons/cooperator_portal/readme/ROADMAP.rst,sha256=nYzCYrWHdFeOfb9kVw-7luiWBpHNGWKore7GhfD059I,106
 odoo/addons/cooperator_portal/static/description/icon.png,sha256=6xBPJauaFOF0KDHfHgQopSc28kKvxMaeoQFQWZtfZDo,9455
 odoo/addons/cooperator_portal/static/description/index.html,sha256=mRi37rhvcDb25-vV3c1Ot-E4jWGBS0Tzz3g6kpB_eS8,12137
-odoo/addons/cooperator_portal/views/portal_templates.xml,sha256=HWQIMGz4D7kt8ij2Ud8Ze4DWzQpyiSbuBXR3ASluf-U,13654
-odoo12_addon_cooperator_portal-12.0.3.1.0.99.dev3.dist-info/METADATA,sha256=Gv68Vv8tlPxcQ-zgvA61-LNZhkaISweD9lDj6fdtaK0,3390
-odoo12_addon_cooperator_portal-12.0.3.1.0.99.dev3.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
-odoo12_addon_cooperator_portal-12.0.3.1.0.99.dev3.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
-odoo12_addon_cooperator_portal-12.0.3.1.0.99.dev3.dist-info/RECORD,,
+odoo/addons/cooperator_portal/views/portal_templates.xml,sha256=1lUaUrxIjEJihXF19CNXWFGmf1QfLjDIeHLgfv7hGWY,13739
+odoo12_addon_cooperator_portal-12.0.3.2.0.dist-info/METADATA,sha256=gR7LX56O2_4NPaRiDNwu2XvHrhO5Puto0NXuByWFWlg,3382
+odoo12_addon_cooperator_portal-12.0.3.2.0.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+odoo12_addon_cooperator_portal-12.0.3.2.0.dist-info/top_level.txt,sha256=qBj40grFkGOfDZ2WDSw3y1RnDlgG0u8rP8pvGNdbz4w,5
+odoo12_addon_cooperator_portal-12.0.3.2.0.dist-info/RECORD,,
```

