# Comparing `tmp/cercis-0.1.7.tar.gz` & `tmp/cercis-0.2.0.tar.gz`

## Comparing `cercis-0.1.7.tar` & `cercis-0.2.0.tar`

### file list

```diff
@@ -1,377 +1,385 @@
--rw-r--r--   0        0        0      106 2020-02-02 00:00:00.000000 cercis-0.1.7/.coveragerc
--rw-r--r--   0        0        0      360 2020-02-02 00:00:00.000000 cercis-0.1.7/.flake8
--rw-r--r--   0        0        0      125 2020-02-02 00:00:00.000000 cercis-0.1.7/.git_archival.txt
--rw-r--r--   0        0        0       32 2020-02-02 00:00:00.000000 cercis-0.1.7/.gitattributes
--rw-r--r--   0        0        0     1250 2020-02-02 00:00:00.000000 cercis-0.1.7/.pre-commit-config.yaml
--rw-r--r--   0        0        0      533 2020-02-02 00:00:00.000000 cercis-0.1.7/.pre-commit-hooks.yaml
--rw-r--r--   0        0        0       49 2020-02-02 00:00:00.000000 cercis-0.1.7/.prettierrc.yaml
--rw-r--r--   0        0        0      220 2020-02-02 00:00:00.000000 cercis-0.1.7/.readthedocs.yaml
--rw-r--r--   0        0        0     2273 2020-02-02 00:00:00.000000 cercis-0.1.7/CHANGELOG.md
--rw-r--r--   0        0        0    50085 2020-02-02 00:00:00.000000 cercis-0.1.7/CHANGES.md
--rw-r--r--   0        0        0      587 2020-02-02 00:00:00.000000 cercis-0.1.7/Dockerfile
--rw-r--r--   0        0        0    23227 2020-02-02 00:00:00.000000 cercis-0.1.7/README.md
--rw-r--r--   0        0        0     1618 2020-02-02 00:00:00.000000 cercis-0.1.7/action.yml
--rw-r--r--   0        0        0      796 2020-02-02 00:00:00.000000 cercis-0.1.7/mypy.ini
--rw-r--r--   0        0        0       99 2020-02-02 00:00:00.000000 cercis-0.1.7/test_requirements.txt
--rw-r--r--   0        0        0     2972 2020-02-02 00:00:00.000000 cercis-0.1.7/tox.ini
--rw-r--r--   0        0        0     1537 2020-02-02 00:00:00.000000 cercis-0.1.7/.github/PULL_REQUEST_TEMPLATE.md
--rw-r--r--   0        0        0      565 2020-02-02 00:00:00.000000 cercis-0.1.7/.github/dependabot.yml
--rw-r--r--   0        0        0     1557 2020-02-02 00:00:00.000000 cercis-0.1.7/.github/ISSUE_TEMPLATE/bug_report.md
--rw-r--r--   0        0        0      545 2020-02-02 00:00:00.000000 cercis-0.1.7/.github/ISSUE_TEMPLATE/config.yml
--rw-r--r--   0        0        0      692 2020-02-02 00:00:00.000000 cercis-0.1.7/.github/ISSUE_TEMPLATE/docs-issue.md
--rw-r--r--   0        0        0      649 2020-02-02 00:00:00.000000 cercis-0.1.7/.github/ISSUE_TEMPLATE/feature_request.md
--rw-r--r--   0        0        0      646 2020-02-02 00:00:00.000000 cercis-0.1.7/.github/ISSUE_TEMPLATE/style_issue.md
--rw-r--r--   0        0        0      795 2020-02-02 00:00:00.000000 cercis-0.1.7/.github/workflows/check-changelog.yml
--rw-r--r--   0        0        0     1534 2020-02-02 00:00:00.000000 cercis-0.1.7/.github/workflows/diff_shades_comment.yml
--rw-r--r--   0        0        0     1894 2020-02-02 00:00:00.000000 cercis-0.1.7/.github/workflows/docker.yml
--rw-r--r--   0        0        0     1127 2020-02-02 00:00:00.000000 cercis-0.1.7/.github/workflows/fuzz.yml
--rw-r--r--   0        0        0     1232 2020-02-02 00:00:00.000000 cercis-0.1.7/.github/workflows/lint.yml
--rw-r--r--   0        0        0      811 2020-02-02 00:00:00.000000 cercis-0.1.7/.github/workflows/python-package.yml
--rw-r--r--   0        0        0     1253 2020-02-02 00:00:00.000000 cercis-0.1.7/.github/workflows/python-publish.yml
--rw-r--r--   0        0        0     2998 2020-02-02 00:00:00.000000 cercis-0.1.7/.github/workflows/test.yml
--rw-r--r--   0        0        0     1910 2020-02-02 00:00:00.000000 cercis-0.1.7/.github/workflows/upload_binary.yml
--rw-r--r--   0        0        0      780 2020-02-02 00:00:00.000000 cercis-0.1.7/.github/workflows/version-check.yml
--rw-r--r--   0        0        0     2467 2020-02-02 00:00:00.000000 cercis-0.1.7/action/main.py
--rw-r--r--   0        0        0     7597 2020-02-02 00:00:00.000000 cercis-0.1.7/autoload/black.vim
--rw-r--r--   0        0        0      342 2020-02-02 00:00:00.000000 cercis-0.1.7/gallery/Dockerfile
--rw-r--r--   0        0        0     1595 2020-02-02 00:00:00.000000 cercis-0.1.7/gallery/README.md
--rwxr-xr-x   0        0        0     9123 2020-02-02 00:00:00.000000 cercis-0.1.7/gallery/gallery.py
--rw-r--r--   0        0        0     2176 2020-02-02 00:00:00.000000 cercis-0.1.7/plugin/black.vim
--rw-r--r--   0        0        0       55 2020-02-02 00:00:00.000000 cercis-0.1.7/scripts/README.md
--rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.1.7/scripts/__init__.py
--rw-r--r--   0        0        0     2500 2020-02-02 00:00:00.000000 cercis-0.1.7/scripts/check_version_and_changelog.py
--rw-r--r--   0        0        0     1586 2020-02-02 00:00:00.000000 cercis-0.1.7/scripts/check_version_in_basics_example.py
--rw-r--r--   0        0        0     8650 2020-02-02 00:00:00.000000 cercis-0.1.7/scripts/diff_shades_gha_helper.py
--rw-r--r--   0        0        0     3527 2020-02-02 00:00:00.000000 cercis-0.1.7/scripts/fuzz.py
--rw-r--r--   0        0        0     2458 2020-02-02 00:00:00.000000 cercis-0.1.7/scripts/make_width_table.py
--rwxr-xr-x   0        0        0     2993 2020-02-02 00:00:00.000000 cercis-0.1.7/scripts/migrate-black.py
--rw-r--r--   0        0        0       18 2020-02-02 00:00:00.000000 cercis-0.1.7/src/_cercis_version.py
--rw-r--r--   0        0        0     8177 2020-02-02 00:00:00.000000 cercis-0.1.7/src/blackd/__init__.py
--rw-r--r--   0        0        0       37 2020-02-02 00:00:00.000000 cercis-0.1.7/src/blackd/__main__.py
--rw-r--r--   0        0        0     1585 2020-02-02 00:00:00.000000 cercis-0.1.7/src/blackd/middlewares.py
--rw-r--r--   0        0        0    11530 2020-02-02 00:00:00.000000 cercis-0.1.7/src/blib2to3/Grammar.txt
--rw-r--r--   0        0        0    12762 2020-02-02 00:00:00.000000 cercis-0.1.7/src/blib2to3/LICENSE
--rw-r--r--   0        0        0      793 2020-02-02 00:00:00.000000 cercis-0.1.7/src/blib2to3/PatternGrammar.txt
--rw-r--r--   0        0        0     1071 2020-02-02 00:00:00.000000 cercis-0.1.7/src/blib2to3/README
--rw-r--r--   0        0        0        8 2020-02-02 00:00:00.000000 cercis-0.1.7/src/blib2to3/__init__.py
--rw-r--r--   0        0        0     5848 2020-02-02 00:00:00.000000 cercis-0.1.7/src/blib2to3/pygram.py
--rw-r--r--   0        0        0    32612 2020-02-02 00:00:00.000000 cercis-0.1.7/src/blib2to3/pytree.py
--rw-r--r--   0        0        0      143 2020-02-02 00:00:00.000000 cercis-0.1.7/src/blib2to3/pgen2/__init__.py
--rw-r--r--   0        0        0     9607 2020-02-02 00:00:00.000000 cercis-0.1.7/src/blib2to3/pgen2/conv.py
--rw-r--r--   0        0        0    10671 2020-02-02 00:00:00.000000 cercis-0.1.7/src/blib2to3/pgen2/driver.py
--rw-r--r--   0        0        0     6873 2020-02-02 00:00:00.000000 cercis-0.1.7/src/blib2to3/pgen2/grammar.py
--rw-r--r--   0        0        0     1628 2020-02-02 00:00:00.000000 cercis-0.1.7/src/blib2to3/pgen2/literals.py
--rw-r--r--   0        0        0    14859 2020-02-02 00:00:00.000000 cercis-0.1.7/src/blib2to3/pgen2/parse.py
--rw-r--r--   0        0        0    15508 2020-02-02 00:00:00.000000 cercis-0.1.7/src/blib2to3/pgen2/pgen.py
--rw-r--r--   0        0        0     1919 2020-02-02 00:00:00.000000 cercis-0.1.7/src/blib2to3/pgen2/token.py
--rw-r--r--   0        0        0    23120 2020-02-02 00:00:00.000000 cercis-0.1.7/src/blib2to3/pgen2/tokenize.py
--rw-r--r--   0        0        0    52612 2020-02-02 00:00:00.000000 cercis-0.1.7/src/cercis/__init__.py
--rw-r--r--   0        0        0       48 2020-02-02 00:00:00.000000 cercis-0.1.7/src/cercis/__main__.py
--rw-r--r--   0        0        0    10871 2020-02-02 00:00:00.000000 cercis-0.1.7/src/cercis/_width_table.py
--rw-r--r--   0        0        0    12274 2020-02-02 00:00:00.000000 cercis-0.1.7/src/cercis/brackets.py
--rw-r--r--   0        0        0     2952 2020-02-02 00:00:00.000000 cercis-0.1.7/src/cercis/cache.py
--rw-r--r--   0        0        0    12797 2020-02-02 00:00:00.000000 cercis-0.1.7/src/cercis/comments.py
--rw-r--r--   0        0        0     6343 2020-02-02 00:00:00.000000 cercis-0.1.7/src/cercis/concurrency.py
--rw-r--r--   0        0        0      772 2020-02-02 00:00:00.000000 cercis-0.1.7/src/cercis/const.py
--rw-r--r--   0        0        0     1597 2020-02-02 00:00:00.000000 cercis-0.1.7/src/cercis/debug.py
--rw-r--r--   0        0        0    13538 2020-02-02 00:00:00.000000 cercis-0.1.7/src/cercis/files.py
--rw-r--r--   0        0        0    13514 2020-02-02 00:00:00.000000 cercis-0.1.7/src/cercis/handle_ipynb_magics.py
--rw-r--r--   0        0        0     4612 2020-02-02 00:00:00.000000 cercis-0.1.7/src/cercis/indent.py
--rw-r--r--   0        0        0    64924 2020-02-02 00:00:00.000000 cercis-0.1.7/src/cercis/linegen.py
--rw-r--r--   0        0        0    40988 2020-02-02 00:00:00.000000 cercis-0.1.7/src/cercis/lines.py
--rw-r--r--   0        0        0     9145 2020-02-02 00:00:00.000000 cercis-0.1.7/src/cercis/mode.py
--rw-r--r--   0        0        0    25731 2020-02-02 00:00:00.000000 cercis-0.1.7/src/cercis/nodes.py
--rw-r--r--   0        0        0     1653 2020-02-02 00:00:00.000000 cercis-0.1.7/src/cercis/numerics.py
--rw-r--r--   0        0        0     3487 2020-02-02 00:00:00.000000 cercis-0.1.7/src/cercis/output.py
--rw-r--r--   0        0        0    10164 2020-02-02 00:00:00.000000 cercis-0.1.7/src/cercis/parsing.py
--rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.1.7/src/cercis/py.typed
--rw-r--r--   0        0        0     3452 2020-02-02 00:00:00.000000 cercis-0.1.7/src/cercis/report.py
--rw-r--r--   0        0        0      556 2020-02-02 00:00:00.000000 cercis-0.1.7/src/cercis/rusty.py
--rw-r--r--   0        0        0    14304 2020-02-02 00:00:00.000000 cercis-0.1.7/src/cercis/strings.py
--rw-r--r--   0        0        0    91890 2020-02-02 00:00:00.000000 cercis-0.1.7/src/cercis/trans.py
--rw-r--r--   0        0        0     2676 2020-02-02 00:00:00.000000 cercis-0.1.7/src/cercis/utils_line_wrapping.py
--rw-r--r--   0        0        0     3267 2020-02-02 00:00:00.000000 cercis-0.1.7/src/cercis/utils_linegen.py
--rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/__init__.py
--rw-r--r--   0        0        0       36 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/conftest.py
--rw-r--r--   0        0        0       89 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/empty.toml
--rw-r--r--   0        0        0     4133 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/optional.py
--rw-r--r--   0        0        0      389 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/test.toml
--rw-r--r--   0        0        0   102069 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/test_black.py
--rw-r--r--   0        0        0     9188 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/test_blackd.py
--rw-r--r--   0        0        0    16641 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/test_format.py
--rw-r--r--   0        0        0    16390 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/test_ipynb.py
--rw-r--r--   0        0        0     1292 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/test_no_ipynb.py
--rw-r--r--   0        0        0     2267 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/test_trans.py
--rw-r--r--   0        0        0     2546 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/test_utils_line_wrapping.py
--rw-r--r--   0        0        0     7023 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/util.py
--rw-r--r--   0        0        0     4160 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/conditional_expression.py
--rw-r--r--   0        0        0       99 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/empty_pyproject.toml
--rw-r--r--   0        0        0     1611 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/closing_bracket_indent/extra_indent.py
--rw-r--r--   0        0        0     1563 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/closing_bracket_indent/no_extra_indent.py
--rw-r--r--   0        0        0     4438 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/func_def_indent/func_def_extra_indent.py
--rw-r--r--   0        0        0     4262 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/func_def_indent/func_def_no_extra_indent.py
--rw-r--r--   0        0        0     3449 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=1/fdei=False_olcei=False.py
--rw-r--r--   0        0        0     3482 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=1/fdei=False_olcei=True.py
--rw-r--r--   0        0        0     3502 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=1/fdei=True_olcei=False.py
--rw-r--r--   0        0        0     3535 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=1/fdei=True_olcei=True.py
--rw-r--r--   0        0        0     3680 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=2/fdei=False_olcei=False.py
--rw-r--r--   0        0        0     3747 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=2/fdei=False_olcei=True.py
--rw-r--r--   0        0        0     3787 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=2/fdei=True_olcei=False.py
--rw-r--r--   0        0        0     3854 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=2/fdei=True_olcei=True.py
--rw-r--r--   0        0        0     3911 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=3/fdei=False_olcei=False.py
--rw-r--r--   0        0        0     4012 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=3/fdei=False_olcei=True.py
--rw-r--r--   0        0        0     4072 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=3/fdei=True_olcei=False.py
--rw-r--r--   0        0        0     4173 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=3/fdei=True_olcei=True.py
--rw-r--r--   0        0        0     4142 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=4/fdei=False_olcei=False.py
--rw-r--r--   0        0        0     4277 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=4/fdei=False_olcei=True.py
--rw-r--r--   0        0        0     4357 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=4/fdei=True_olcei=False.py
--rw-r--r--   0        0        0     4492 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=4/fdei=True_olcei=True.py
--rw-r--r--   0        0        0     5066 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=8/fdei=False_olcei=False.py
--rw-r--r--   0        0        0     5337 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=8/fdei=False_olcei=True.py
--rw-r--r--   0        0        0     5497 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=8/fdei=True_olcei=False.py
--rw-r--r--   0        0        0     5768 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=8/fdei=True_olcei=True.py
--rw-r--r--   0        0        0     3434 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=1/fdei=False_olcei=False.py
--rw-r--r--   0        0        0     3462 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=1/fdei=False_olcei=True.py
--rw-r--r--   0        0        0     3477 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=1/fdei=True_olcei=False.py
--rw-r--r--   0        0        0     3505 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=1/fdei=True_olcei=True.py
--rw-r--r--   0        0        0     3650 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=2/fdei=False_olcei=False.py
--rw-r--r--   0        0        0     3707 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=2/fdei=False_olcei=True.py
--rw-r--r--   0        0        0     3737 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=2/fdei=True_olcei=False.py
--rw-r--r--   0        0        0     3794 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=2/fdei=True_olcei=True.py
--rw-r--r--   0        0        0     3866 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=3/fdei=False_olcei=False.py
--rw-r--r--   0        0        0     3952 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=3/fdei=False_olcei=True.py
--rw-r--r--   0        0        0     3997 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=3/fdei=True_olcei=False.py
--rw-r--r--   0        0        0     4083 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=3/fdei=True_olcei=True.py
--rw-r--r--   0        0        0     4082 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=4/fdei=False_olcei=False.py
--rw-r--r--   0        0        0     4197 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=4/fdei=False_olcei=True.py
--rw-r--r--   0        0        0     4257 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=4/fdei=True_olcei=False.py
--rw-r--r--   0        0        0     4372 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=4/fdei=True_olcei=True.py
--rw-r--r--   0        0        0     4946 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=8/fdei=False_olcei=False.py
--rw-r--r--   0        0        0     5177 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=8/fdei=False_olcei=True.py
--rw-r--r--   0        0        0     5297 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=8/fdei=True_olcei=False.py
--rw-r--r--   0        0        0     5528 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=8/fdei=True_olcei=True.py
--rw-r--r--   0        0        0     3449 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_extra_indent/fdei=False_olcei=False.py
--rw-r--r--   0        0        0     3482 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_extra_indent/fdei=False_olcei=True.py
--rw-r--r--   0        0        0     3502 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_extra_indent/fdei=True_olcei=False.py
--rw-r--r--   0        0        0     3535 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_extra_indent/fdei=True_olcei=True.py
--rw-r--r--   0        0        0     3434 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_no_extra_indent/fdei=False_olcei=False.py
--rw-r--r--   0        0        0     3462 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_no_extra_indent/fdei=False_olcei=True.py
--rw-r--r--   0        0        0     3477 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_no_extra_indent/fdei=True_olcei=False.py
--rw-r--r--   0        0        0     3505 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_no_extra_indent/fdei=True_olcei=True.py
--rw-r--r--   0        0        0     1448 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_tabs/line_length_calculation/tab_width_1.py
--rw-r--r--   0        0        0     1453 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_tabs/line_length_calculation/tab_width_2.py
--rw-r--r--   0        0        0     1458 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_tabs/line_length_calculation/tab_width_3.py
--rw-r--r--   0        0        0     1463 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_tabs/line_length_calculation/tab_width_4.py
--rw-r--r--   0        0        0     1468 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_tabs/line_length_calculation/tab_width_5.py
--rw-r--r--   0        0        0     1475 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/indentation/use_tabs/line_length_calculation/tab_width_8.py
--rw-r--r--   0        0        0     1556 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/keep_blank_lines_in_brackets/false.py
--rw-r--r--   0        0        0     1579 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/keep_blank_lines_in_brackets/true.py
--rw-r--r--   0        0        0      190 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/line_with_comments/case_False_False.py
--rw-r--r--   0        0        0      190 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/line_with_comments/case_False_True.py
--rw-r--r--   0        0        0      397 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/line_with_comments/case_True_False.py
--rw-r--r--   0        0        0      403 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/line_with_comments/case_True_True.py
--rw-r--r--   0        0        0      863 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/line_with_long_string/edge_cases.py
--rw-r--r--   0        0        0    11060 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/line_with_long_string/long_strings_flag_disabled__Black_default.py
--rw-r--r--   0        0        0    22087 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/line_with_long_string/long_strings_flag_disabled__Cercis_default.py
--rw-r--r--   0        0        0     6138 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/line_with_long_string/test_cases__Black_default.py
--rw-r--r--   0        0        0     6056 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/line_with_long_string/test_cases__Cercis_default.py
--rw-r--r--   0        0        0     6193 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/nested_brackets/nested_brackets__Black_default.py
--rw-r--r--   0        0        0     2832 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/nested_brackets/nested_brackets__Cercis_default.py
--rw-r--r--   0        0        0     2011 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/nested_brackets/nested_brackets_explodes__Black_default.py
--rw-r--r--   0        0        0     2212 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/nested_brackets/nested_brackets_explodes__Cercis_default.py
--rw-r--r--   0        0        0     7699 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/pragma_comments/Black_default.py
--rw-r--r--   0        0        0     7703 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/pragma_comments/Black_default_2.py
--rw-r--r--   0        0        0    10763 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/pragma_comments/Cercis_default.py
--rw-r--r--   0        0        0    10787 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/pragma_comments/Cercis_default_2.py
--rw-r--r--   0        0        0     7702 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/single_quote/docstring.py
--rw-r--r--   0        0        0      140 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/single_quote/docstring_no_extra_empty_line_before_eof.py
--rw-r--r--   0        0        0     3513 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/single_quote/docstring_preview.py
--rw-r--r--   0        0        0      745 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/single_quote/more_quotes.py
--rw-r--r--   0        0        0      845 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/single_quote/string_prefixes.py
--rw-r--r--   0        0        0     2279 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/configurable_cases/single_quote/torture.py
--rw-r--r--   0        0        0      498 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/fast/pep_572_do_not_remove_parens.py
--rw-r--r--   0        0        0        5 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/gitignore_used_on_multiple_sources/.gitignore
--rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/gitignore_used_on_multiple_sources/dir1/a.py
--rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/gitignore_used_on_multiple_sources/dir1/b.py
--rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/gitignore_used_on_multiple_sources/dir2/a.py
--rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/gitignore_used_on_multiple_sources/dir2/b.py
--rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/ignore_subfolders_gitignore_tests/a.py
--rw-r--r--   0        0        0        4 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/ignore_subfolders_gitignore_tests/subdir/.gitignore
--rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/ignore_subfolders_gitignore_tests/subdir/b.py
--rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/ignore_subfolders_gitignore_tests/subdir/subdir/c.py
--rw-r--r--   0        0        0       14 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/include_exclude_tests/.gitignore
--rw-r--r--   0        0        0      114 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/include_exclude_tests/pyproject.toml
--rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/include_exclude_tests/b/.definitely_exclude/a.pie
--rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/include_exclude_tests/b/.definitely_exclude/a.py
--rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/include_exclude_tests/b/.definitely_exclude/a.pyi
--rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/include_exclude_tests/b/dont_exclude/a.pie
--rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/include_exclude_tests/b/dont_exclude/a.py
--rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/include_exclude_tests/b/dont_exclude/a.pyi
--rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/include_exclude_tests/b/exclude/a.pie
--rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/include_exclude_tests/b/exclude/a.py
--rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/include_exclude_tests/b/exclude/a.pyi
--rw-r--r--   0        0        0        2 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/invalid_gitignore_tests/.gitignore
--rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/invalid_gitignore_tests/a.py
--rw-r--r--   0        0        0       89 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/invalid_gitignore_tests/pyproject.toml
--rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/invalid_nested_gitignore_tests/a.py
--rw-r--r--   0        0        0       89 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/invalid_nested_gitignore_tests/pyproject.toml
--rw-r--r--   0        0        0        2 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/invalid_nested_gitignore_tests/a/.gitignore
--rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/invalid_nested_gitignore_tests/a/a.py
--rw-r--r--   0        0        0      436 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/jupyter/non_python_notebook.ipynb
--rw-r--r--   0        0        0      371 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/jupyter/notebook_empty_metadata.ipynb
--rw-r--r--   0        0        0      641 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/jupyter/notebook_no_trailing_newline.ipynb
--rw-r--r--   0        0        0      642 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/jupyter/notebook_trailing_newline.ipynb
--rw-r--r--   0        0        0        4 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/jupyter/notebook_which_cant_be_parsed.ipynb
--rw-r--r--   0        0        0      761 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/jupyter/notebook_without_changes.ipynb
--rw-r--r--   0        0        0      495 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/miscellaneous/async_as_identifier.py
--rw-r--r--   0        0        0      255 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/miscellaneous/blackd_diff.diff
--rw-r--r--   0        0        0       98 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/miscellaneous/blackd_diff.py
--rw-r--r--   0        0        0    15604 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/miscellaneous/debug_visitor.out
--rw-r--r--   0        0        0     1193 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/miscellaneous/debug_visitor.py
--rw-r--r--   0        0        0     1774 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/miscellaneous/decorators.py
--rw-r--r--   0        0        0     3601 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/miscellaneous/docstring_no_string_normalization.py
--rw-r--r--   0        0        0      357 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/miscellaneous/docstring_preview_no_string_normalization.py
--rw-r--r--   0        0        0    15711 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/miscellaneous/expression_skip_magic_trailing_comma.diff
--rw-r--r--   0        0        0      626 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/miscellaneous/force_py36.py
--rw-r--r--   0        0        0      793 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/miscellaneous/force_pyi.py
--rw-r--r--   0        0        0       59 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/miscellaneous/invalid_header.py
--rw-r--r--   0        0        0      101 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/miscellaneous/linelength6.py
--rw-r--r--   0        0        0    11583 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/miscellaneous/long_strings_flag_disabled.py
--rw-r--r--   0        0        0      293 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/miscellaneous/missing_final_newline.diff
--rw-r--r--   0        0        0      145 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/miscellaneous/missing_final_newline.py
--rw-r--r--   0        0        0      284 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/miscellaneous/nested_class_stub.pyi
--rw-r--r--   0        0        0      279 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/miscellaneous/pattern_matching_invalid.py
--rw-r--r--   0        0        0       69 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/miscellaneous/power_op_newline.py
--rw-r--r--   0        0        0      758 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/miscellaneous/python2_detection.py
--rw-r--r--   0        0        0     2361 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/miscellaneous/string_quotes.py
--rw-r--r--   0        0        0     2266 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/miscellaneous/stub.pyi
--rw-r--r--   0        0        0      114 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/nested_gitignore_tests/pyproject.toml
--rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/nested_gitignore_tests/x.py
--rw-r--r--   0        0        0        5 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/nested_gitignore_tests/root/.gitignore
--rw-r--r--   0        0        0       39 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/nested_gitignore_tests/root/a.py
--rw-r--r--   0        0        0       21 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/nested_gitignore_tests/root/b.py
--rw-r--r--   0        0        0       21 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/nested_gitignore_tests/root/c.py
--rw-r--r--   0        0        0        5 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/nested_gitignore_tests/root/child/.gitignore
--rw-r--r--   0        0        0       39 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/nested_gitignore_tests/root/child/a.py
--rw-r--r--   0        0        0       40 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/nested_gitignore_tests/root/child/b.py
--rw-r--r--   0        0        0       21 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/nested_gitignore_tests/root/child/c.py
--rw-r--r--   0        0        0      279 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/preview/async_stmts.py
--rw-r--r--   0        0        0     4107 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/preview/cantfit.py
--rw-r--r--   0        0        0     8294 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/preview/comments7.py
--rw-r--r--   0        0        0      613 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/preview/format_unicode_escape_seq.py
--rw-r--r--   0        0        0     2784 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/preview/long_dict_values.py
--rw-r--r--   0        0        0    33216 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/preview/long_strings.py
--rw-r--r--   0        0        0     1418 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/preview/long_strings__east_asian_width.py
--rw-r--r--   0        0        0     6536 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/preview/long_strings__edge_case.py
--rw-r--r--   0        0        0    45897 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/preview/long_strings__regression.py
--rw-r--r--   0        0        0     1105 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/preview/long_strings__type_annotations.py
--rw-r--r--   0        0        0     7207 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/preview/multiline_strings.py
--rw-r--r--   0        0        0      810 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/preview/no_blank_line_before_docstring.py
--rw-r--r--   0        0        0      481 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/preview/percent_precedence.py
--rw-r--r--   0        0        0     2525 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/preview/prefer_rhs_split.py
--rw-r--r--   0        0        0      342 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/preview/return_annotation_brackets_string.py
--rw-r--r--   0        0        0      655 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/preview/trailing_comma.py
--rw-r--r--   0        0        0     1140 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/preview_context_managers/targeting_py38.py
--rw-r--r--   0        0        0     3361 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/preview_context_managers/targeting_py39.py
--rw-r--r--   0        0        0      595 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/preview_context_managers/auto_detect/features_3_10.py
--rw-r--r--   0        0        0      553 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/preview_context_managers/auto_detect/features_3_11.py
--rw-r--r--   0        0        0     1058 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/preview_context_managers/auto_detect/features_3_8.py
--rw-r--r--   0        0        0      623 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/preview_context_managers/auto_detect/features_3_9.py
--rw-r--r--   0        0        0      133 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/project_metadata/both_pyproject.toml
--rw-r--r--   0        0        0       74 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/project_metadata/neither_pyproject.toml
--rw-r--r--   0        0        0      101 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/project_metadata/only_black_pyproject.toml
--rw-r--r--   0        0        0      106 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/project_metadata/only_metadata_pyproject.toml
--rw-r--r--   0        0        0      765 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/py_310/parenthesized_context_managers.py
--rw-r--r--   0        0        0     2668 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/py_310/pattern_matching_complex.py
--rw-r--r--   0        0        0     1965 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/py_310/pattern_matching_extras.py
--rw-r--r--   0        0        0     3066 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/py_310/pattern_matching_generic.py
--rw-r--r--   0        0        0     2641 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/py_310/pattern_matching_simple.py
--rw-r--r--   0        0        0     1061 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/py_310/pattern_matching_style.py
--rw-r--r--   0        0        0      491 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/py_310/pep_572_py310.py
--rw-r--r--   0        0        0      509 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/py_310/remove_newline_after_match.py
--rw-r--r--   0        0        0      380 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/py_310/starred_for_target.py
--rw-r--r--   0        0        0     2114 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/py_311/pep_646.py
--rw-r--r--   0        0        0      972 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/py_311/pep_654.py
--rw-r--r--   0        0        0     2033 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/py_311/pep_654_style.py
--rw-r--r--   0        0        0      141 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/py_312/type_aliases.py
--rw-r--r--   0        0        0     1112 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/py_312/type_params.py
--rw-r--r--   0        0        0      597 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/py_36/numeric_literals.py
--rw-r--r--   0        0        0      267 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/py_36/numeric_literals_skip_underscores.py
--rw-r--r--   0        0        0     1199 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/py_37/python37.py
--rw-r--r--   0        0        0      740 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/py_38/pep_570.py
--rw-r--r--   0        0        0      970 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/py_38/pep_572.py
--rw-r--r--   0        0        0     1895 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/py_38/pep_572_remove_parens.py
--rw-r--r--   0        0        0      834 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/py_38/python38.py
--rw-r--r--   0        0        0      251 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/py_39/pep_572_py39.py
--rw-r--r--   0        0        0      696 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/py_39/python39.py
--rw-r--r--   0        0        0     2575 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/py_39/remove_with_brackets.py
--rw-r--r--   0        0        0      907 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/attribute_access_on_number_literals.py
--rw-r--r--   0        0        0       63 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/beginning_backslash.py
--rw-r--r--   0        0        0      333 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/bracketmatch.py
--rw-r--r--   0        0        0     1091 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/class_blank_parentheses.py
--rw-r--r--   0        0        0     4318 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/class_methods_new_line.py
--rw-r--r--   0        0        0     3294 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/collections.py
--rw-r--r--   0        0        0      212 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/comment_after_escaped_newline.py
--rw-r--r--   0        0        0     1909 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/comments.py
--rw-r--r--   0        0        0     7639 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/comments2.py
--rw-r--r--   0        0        0     1573 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/comments3.py
--rw-r--r--   0        0        0     3536 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/comments4.py
--rw-r--r--   0        0        0     1196 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/comments5.py
--rw-r--r--   0        0        0     2567 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/comments6.py
--rw-r--r--   0        0        0      300 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/comments8.py
--rw-r--r--   0        0        0     5279 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/comments9.py
--rw-r--r--   0        0        0      994 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/comments_non_breaking_space.py
--rw-r--r--   0        0        0     5597 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/composition.py
--rw-r--r--   0        0        0    11198 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/composition_no_trailing_comma.py
--rw-r--r--   0        0        0     7699 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/docstring.py
--rw-r--r--   0        0        0      140 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/docstring_no_extra_empty_line_before_eof.py
--rw-r--r--   0        0        0     3513 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/docstring_preview.py
--rw-r--r--   0        0        0     4596 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/empty_lines.py
--rw-r--r--   0        0        0    15801 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/expression.diff
--rw-r--r--   0        0        0    18624 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/expression.py
--rw-r--r--   0        0        0     9681 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/fmtonoff.py
--rw-r--r--   0        0        0      604 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/fmtonoff2.py
--rw-r--r--   0        0        0      251 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/fmtonoff3.py
--rw-r--r--   0        0        0      278 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/fmtonoff4.py
--rw-r--r--   0        0        0     3627 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/fmtonoff5.py
--rw-r--r--   0        0        0      277 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/fmtpass_imports.py
--rw-r--r--   0        0        0       40 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/fmtskip.py
--rw-r--r--   0        0        0      555 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/fmtskip2.py
--rw-r--r--   0        0        0      362 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/fmtskip3.py
--rw-r--r--   0        0        0       92 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/fmtskip4.py
--rw-r--r--   0        0        0      301 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/fmtskip5.py
--rw-r--r--   0        0        0      235 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/fmtskip6.py
--rw-r--r--   0        0        0      356 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/fmtskip7.py
--rw-r--r--   0        0        0     1705 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/fmtskip8.py
--rw-r--r--   0        0        0      989 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/fstring.py
--rw-r--r--   0        0        0     6482 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/function.py
--rw-r--r--   0        0        0     2427 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/function2.py
--rw-r--r--   0        0        0     3657 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/function_trailing_comma.py
--rw-r--r--   0        0        0     2542 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/import_spacing.py
--rw-r--r--   0        0        0      674 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/one_element_subscript.py
--rw-r--r--   0        0        0      607 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/pep_604.py
--rw-r--r--   0        0        0     3359 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/power_op_spacing.py
--rw-r--r--   0        0        0     1106 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/prefer_rhs_split_reformatted.py
--rw-r--r--   0        0        0     3205 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/remove_await_parens.py
--rw-r--r--   0        0        0     2025 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/remove_except_parens.py
--rw-r--r--   0        0        0     1460 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/remove_for_brackets.py
--rw-r--r--   0        0        0     3351 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/remove_newline_after_code_block_open.py
--rw-r--r--   0        0        0     3493 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/remove_parens.py
--rw-r--r--   0        0        0     5141 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/return_annotation_brackets.py
--rw-r--r--   0        0        0     1398 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/skip_magic_trailing_comma.py
--rw-r--r--   0        0        0      787 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/slices.py
--rw-r--r--   0        0        0      845 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/string_prefixes.py
--rw-r--r--   0        0        0     2279 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/torture.py
--rw-r--r--   0        0        0     1615 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/trailing_comma_optional_parens1.py
--rw-r--r--   0        0        0      248 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/trailing_comma_optional_parens2.py
--rw-r--r--   0        0        0      967 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/trailing_comma_optional_parens3.py
--rw-r--r--   0        0        0     2123 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/trailing_commas_in_leading_parts.py
--rw-r--r--   0        0        0       80 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/tricky_unicode_symbols.py
--rw-r--r--   0        0        0      510 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/tupleassign.py
--rw-r--r--   0        0        0       27 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/simple_cases/whitespace.py
--rw-r--r--   0        0        0      101 2020-02-02 00:00:00.000000 cercis-0.1.7/tests/data/type_comments/type_comment_syntax_error.py
--rw-r--r--   0        0        0      273 2020-02-02 00:00:00.000000 cercis-0.1.7/.gitignore
--rw-r--r--   0        0        0     1061 2020-02-02 00:00:00.000000 cercis-0.1.7/LICENSE
--rw-r--r--   0        0        0     1080 2020-02-02 00:00:00.000000 cercis-0.1.7/LICENSE_ORIGINAL
--rw-r--r--   0        0        0     7372 2020-02-02 00:00:00.000000 cercis-0.1.7/pyproject.toml
--rw-r--r--   0        0        0    27417 2020-02-02 00:00:00.000000 cercis-0.1.7/PKG-INFO
+-rw-r--r--   0        0        0      106 2020-02-02 00:00:00.000000 cercis-0.2.0/.coveragerc
+-rw-r--r--   0        0        0      360 2020-02-02 00:00:00.000000 cercis-0.2.0/.flake8
+-rw-r--r--   0        0        0      125 2020-02-02 00:00:00.000000 cercis-0.2.0/.git_archival.txt
+-rw-r--r--   0        0        0       32 2020-02-02 00:00:00.000000 cercis-0.2.0/.gitattributes
+-rw-r--r--   0        0        0     1334 2020-02-02 00:00:00.000000 cercis-0.2.0/.pre-commit-config.yaml
+-rw-r--r--   0        0        0      533 2020-02-02 00:00:00.000000 cercis-0.2.0/.pre-commit-hooks.yaml
+-rw-r--r--   0        0        0       49 2020-02-02 00:00:00.000000 cercis-0.2.0/.prettierrc.yaml
+-rw-r--r--   0        0        0      220 2020-02-02 00:00:00.000000 cercis-0.2.0/.readthedocs.yaml
+-rw-r--r--   0        0        0     2497 2020-02-02 00:00:00.000000 cercis-0.2.0/CHANGELOG.md
+-rw-r--r--   0        0        0    51880 2020-02-02 00:00:00.000000 cercis-0.2.0/CHANGES.md
+-rw-r--r--   0        0        0      933 2020-02-02 00:00:00.000000 cercis-0.2.0/CITATION.cff
+-rw-r--r--   0        0        0      587 2020-02-02 00:00:00.000000 cercis-0.2.0/Dockerfile
+-rw-r--r--   0        0        0     1102 2020-02-02 00:00:00.000000 cercis-0.2.0/HOW_TO_REBASE.md
+-rw-r--r--   0        0        0    24909 2020-02-02 00:00:00.000000 cercis-0.2.0/README.md
+-rw-r--r--   0        0        0     1618 2020-02-02 00:00:00.000000 cercis-0.2.0/action.yml
+-rw-r--r--   0        0        0      796 2020-02-02 00:00:00.000000 cercis-0.2.0/mypy.ini
+-rw-r--r--   0        0        0       89 2020-02-02 00:00:00.000000 cercis-0.2.0/test_requirements.txt
+-rw-r--r--   0        0        0     2906 2020-02-02 00:00:00.000000 cercis-0.2.0/tox.ini
+-rw-r--r--   0        0        0     1537 2020-02-02 00:00:00.000000 cercis-0.2.0/.github/PULL_REQUEST_TEMPLATE.md
+-rw-r--r--   0        0        0      565 2020-02-02 00:00:00.000000 cercis-0.2.0/.github/dependabot.yml
+-rw-r--r--   0        0        0     1557 2020-02-02 00:00:00.000000 cercis-0.2.0/.github/ISSUE_TEMPLATE/bug_report.md
+-rw-r--r--   0        0        0      545 2020-02-02 00:00:00.000000 cercis-0.2.0/.github/ISSUE_TEMPLATE/config.yml
+-rw-r--r--   0        0        0      692 2020-02-02 00:00:00.000000 cercis-0.2.0/.github/ISSUE_TEMPLATE/docs-issue.md
+-rw-r--r--   0        0        0      649 2020-02-02 00:00:00.000000 cercis-0.2.0/.github/ISSUE_TEMPLATE/feature_request.md
+-rw-r--r--   0        0        0      646 2020-02-02 00:00:00.000000 cercis-0.2.0/.github/ISSUE_TEMPLATE/style_issue.md
+-rw-r--r--   0        0        0      795 2020-02-02 00:00:00.000000 cercis-0.2.0/.github/workflows/check-changelog.yml
+-rw-r--r--   0        0        0     1534 2020-02-02 00:00:00.000000 cercis-0.2.0/.github/workflows/diff_shades_comment.yml
+-rw-r--r--   0        0        0     1894 2020-02-02 00:00:00.000000 cercis-0.2.0/.github/workflows/docker.yml
+-rw-r--r--   0        0        0     1120 2020-02-02 00:00:00.000000 cercis-0.2.0/.github/workflows/fuzz.yml
+-rw-r--r--   0        0        0     1232 2020-02-02 00:00:00.000000 cercis-0.2.0/.github/workflows/lint.yml
+-rw-r--r--   0        0        0      811 2020-02-02 00:00:00.000000 cercis-0.2.0/.github/workflows/python-package.yml
+-rw-r--r--   0        0        0     1253 2020-02-02 00:00:00.000000 cercis-0.2.0/.github/workflows/python-publish.yml
+-rw-r--r--   0        0        0     3041 2020-02-02 00:00:00.000000 cercis-0.2.0/.github/workflows/test.yml
+-rw-r--r--   0        0        0     1910 2020-02-02 00:00:00.000000 cercis-0.2.0/.github/workflows/upload_binary.yml
+-rw-r--r--   0        0        0      780 2020-02-02 00:00:00.000000 cercis-0.2.0/.github/workflows/version-check.yml
+-rw-r--r--   0        0        0     2467 2020-02-02 00:00:00.000000 cercis-0.2.0/action/main.py
+-rw-r--r--   0        0        0     7597 2020-02-02 00:00:00.000000 cercis-0.2.0/autoload/black.vim
+-rw-r--r--   0        0        0      342 2020-02-02 00:00:00.000000 cercis-0.2.0/gallery/Dockerfile
+-rw-r--r--   0        0        0     1595 2020-02-02 00:00:00.000000 cercis-0.2.0/gallery/README.md
+-rwxr-xr-x   0        0        0     9163 2020-02-02 00:00:00.000000 cercis-0.2.0/gallery/gallery.py
+-rw-r--r--   0        0        0     2176 2020-02-02 00:00:00.000000 cercis-0.2.0/plugin/black.vim
+-rw-r--r--   0        0        0   933114 2020-02-02 00:00:00.000000 cercis-0.2.0/screenshots/how_to_rebase/1.png
+-rw-r--r--   0        0        0    95589 2020-02-02 00:00:00.000000 cercis-0.2.0/screenshots/how_to_rebase/2.png
+-rw-r--r--   0        0        0    93329 2020-02-02 00:00:00.000000 cercis-0.2.0/screenshots/how_to_rebase/3.png
+-rw-r--r--   0        0        0       55 2020-02-02 00:00:00.000000 cercis-0.2.0/scripts/README.md
+-rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.2.0/scripts/__init__.py
+-rw-r--r--   0        0        0     2500 2020-02-02 00:00:00.000000 cercis-0.2.0/scripts/check_version_and_changelog.py
+-rw-r--r--   0        0        0     1586 2020-02-02 00:00:00.000000 cercis-0.2.0/scripts/check_version_in_basics_example.py
+-rw-r--r--   0        0        0     8950 2020-02-02 00:00:00.000000 cercis-0.2.0/scripts/diff_shades_gha_helper.py
+-rw-r--r--   0        0        0     3531 2020-02-02 00:00:00.000000 cercis-0.2.0/scripts/fuzz.py
+-rw-r--r--   0        0        0     2326 2020-02-02 00:00:00.000000 cercis-0.2.0/scripts/make_width_table.py
+-rwxr-xr-x   0        0        0     2993 2020-02-02 00:00:00.000000 cercis-0.2.0/scripts/migrate-black.py
+-rw-r--r--   0        0        0       18 2020-02-02 00:00:00.000000 cercis-0.2.0/src/_cercis_version.py
+-rw-r--r--   0        0        0     8152 2020-02-02 00:00:00.000000 cercis-0.2.0/src/blackd/__init__.py
+-rw-r--r--   0        0        0       37 2020-02-02 00:00:00.000000 cercis-0.2.0/src/blackd/__main__.py
+-rw-r--r--   0        0        0     1585 2020-02-02 00:00:00.000000 cercis-0.2.0/src/blackd/middlewares.py
+-rw-r--r--   0        0        0    11530 2020-02-02 00:00:00.000000 cercis-0.2.0/src/blib2to3/Grammar.txt
+-rw-r--r--   0        0        0    12762 2020-02-02 00:00:00.000000 cercis-0.2.0/src/blib2to3/LICENSE
+-rw-r--r--   0        0        0      793 2020-02-02 00:00:00.000000 cercis-0.2.0/src/blib2to3/PatternGrammar.txt
+-rw-r--r--   0        0        0     1071 2020-02-02 00:00:00.000000 cercis-0.2.0/src/blib2to3/README
+-rw-r--r--   0        0        0        8 2020-02-02 00:00:00.000000 cercis-0.2.0/src/blib2to3/__init__.py
+-rw-r--r--   0        0        0     5815 2020-02-02 00:00:00.000000 cercis-0.2.0/src/blib2to3/pygram.py
+-rw-r--r--   0        0        0    32574 2020-02-02 00:00:00.000000 cercis-0.2.0/src/blib2to3/pytree.py
+-rw-r--r--   0        0        0      143 2020-02-02 00:00:00.000000 cercis-0.2.0/src/blib2to3/pgen2/__init__.py
+-rw-r--r--   0        0        0     9587 2020-02-02 00:00:00.000000 cercis-0.2.0/src/blib2to3/pgen2/conv.py
+-rw-r--r--   0        0        0    10605 2020-02-02 00:00:00.000000 cercis-0.2.0/src/blib2to3/pgen2/driver.py
+-rw-r--r--   0        0        0     6858 2020-02-02 00:00:00.000000 cercis-0.2.0/src/blib2to3/pgen2/grammar.py
+-rw-r--r--   0        0        0     1616 2020-02-02 00:00:00.000000 cercis-0.2.0/src/blib2to3/pgen2/literals.py
+-rw-r--r--   0        0        0    14816 2020-02-02 00:00:00.000000 cercis-0.2.0/src/blib2to3/pgen2/parse.py
+-rw-r--r--   0        0        0    15458 2020-02-02 00:00:00.000000 cercis-0.2.0/src/blib2to3/pgen2/pgen.py
+-rw-r--r--   0        0        0     1824 2020-02-02 00:00:00.000000 cercis-0.2.0/src/blib2to3/pgen2/token.py
+-rw-r--r--   0        0        0    23007 2020-02-02 00:00:00.000000 cercis-0.2.0/src/blib2to3/pgen2/tokenize.py
+-rw-r--r--   0        0        0    51721 2020-02-02 00:00:00.000000 cercis-0.2.0/src/cercis/__init__.py
+-rw-r--r--   0        0        0       48 2020-02-02 00:00:00.000000 cercis-0.2.0/src/cercis/__main__.py
+-rw-r--r--   0        0        0    10761 2020-02-02 00:00:00.000000 cercis-0.2.0/src/cercis/_width_table.py
+-rw-r--r--   0        0        0    12164 2020-02-02 00:00:00.000000 cercis-0.2.0/src/cercis/brackets.py
+-rw-r--r--   0        0        0     2952 2020-02-02 00:00:00.000000 cercis-0.2.0/src/cercis/cache.py
+-rw-r--r--   0        0        0    12686 2020-02-02 00:00:00.000000 cercis-0.2.0/src/cercis/comments.py
+-rw-r--r--   0        0        0     6417 2020-02-02 00:00:00.000000 cercis-0.2.0/src/cercis/concurrency.py
+-rw-r--r--   0        0        0      772 2020-02-02 00:00:00.000000 cercis-0.2.0/src/cercis/const.py
+-rw-r--r--   0        0        0     1597 2020-02-02 00:00:00.000000 cercis-0.2.0/src/cercis/debug.py
+-rw-r--r--   0        0        0    13937 2020-02-02 00:00:00.000000 cercis-0.2.0/src/cercis/files.py
+-rw-r--r--   0        0        0    13670 2020-02-02 00:00:00.000000 cercis-0.2.0/src/cercis/handle_ipynb_magics.py
+-rw-r--r--   0        0        0     4612 2020-02-02 00:00:00.000000 cercis-0.2.0/src/cercis/indent.py
+-rw-r--r--   0        0        0    65200 2020-02-02 00:00:00.000000 cercis-0.2.0/src/cercis/linegen.py
+-rw-r--r--   0        0        0    41008 2020-02-02 00:00:00.000000 cercis-0.2.0/src/cercis/lines.py
+-rw-r--r--   0        0        0     9035 2020-02-02 00:00:00.000000 cercis-0.2.0/src/cercis/mode.py
+-rw-r--r--   0        0        0    26481 2020-02-02 00:00:00.000000 cercis-0.2.0/src/cercis/nodes.py
+-rw-r--r--   0        0        0     1653 2020-02-02 00:00:00.000000 cercis-0.2.0/src/cercis/numerics.py
+-rw-r--r--   0        0        0     3487 2020-02-02 00:00:00.000000 cercis-0.2.0/src/cercis/output.py
+-rw-r--r--   0        0        0     7868 2020-02-02 00:00:00.000000 cercis-0.2.0/src/cercis/parsing.py
+-rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.2.0/src/cercis/py.typed
+-rw-r--r--   0        0        0     3452 2020-02-02 00:00:00.000000 cercis-0.2.0/src/cercis/report.py
+-rw-r--r--   0        0        0      556 2020-02-02 00:00:00.000000 cercis-0.2.0/src/cercis/rusty.py
+-rw-r--r--   0        0        0    14204 2020-02-02 00:00:00.000000 cercis-0.2.0/src/cercis/strings.py
+-rw-r--r--   0        0        0    91799 2020-02-02 00:00:00.000000 cercis-0.2.0/src/cercis/trans.py
+-rw-r--r--   0        0        0     2676 2020-02-02 00:00:00.000000 cercis-0.2.0/src/cercis/utils_line_wrapping.py
+-rw-r--r--   0        0        0     3267 2020-02-02 00:00:00.000000 cercis-0.2.0/src/cercis/utils_linegen.py
+-rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/__init__.py
+-rw-r--r--   0        0        0       36 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/conftest.py
+-rw-r--r--   0        0        0       89 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/empty.toml
+-rw-r--r--   0        0        0     4133 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/optional.py
+-rw-r--r--   0        0        0      389 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/test.toml
+-rw-r--r--   0        0        0   102206 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/test_black.py
+-rw-r--r--   0        0        0     9188 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/test_blackd.py
+-rw-r--r--   0        0        0    16897 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/test_format.py
+-rw-r--r--   0        0        0    16264 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/test_ipynb.py
+-rw-r--r--   0        0        0     1250 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/test_no_ipynb.py
+-rw-r--r--   0        0        0     2267 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/test_trans.py
+-rw-r--r--   0        0        0     2546 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/test_utils_line_wrapping.py
+-rw-r--r--   0        0        0     7082 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/util.py
+-rw-r--r--   0        0        0     4160 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/conditional_expression.py
+-rw-r--r--   0        0        0       99 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/empty_pyproject.toml
+-rw-r--r--   0        0        0     1611 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/closing_bracket_indent/extra_indent.py
+-rw-r--r--   0        0        0     1563 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/closing_bracket_indent/no_extra_indent.py
+-rw-r--r--   0        0        0     4438 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/func_def_indent/func_def_extra_indent.py
+-rw-r--r--   0        0        0     4262 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/func_def_indent/func_def_no_extra_indent.py
+-rw-r--r--   0        0        0     3449 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=1/fdei=False_olcei=False.py
+-rw-r--r--   0        0        0     3482 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=1/fdei=False_olcei=True.py
+-rw-r--r--   0        0        0     3502 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=1/fdei=True_olcei=False.py
+-rw-r--r--   0        0        0     3535 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=1/fdei=True_olcei=True.py
+-rw-r--r--   0        0        0     3680 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=2/fdei=False_olcei=False.py
+-rw-r--r--   0        0        0     3747 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=2/fdei=False_olcei=True.py
+-rw-r--r--   0        0        0     3787 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=2/fdei=True_olcei=False.py
+-rw-r--r--   0        0        0     3854 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=2/fdei=True_olcei=True.py
+-rw-r--r--   0        0        0     3911 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=3/fdei=False_olcei=False.py
+-rw-r--r--   0        0        0     4012 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=3/fdei=False_olcei=True.py
+-rw-r--r--   0        0        0     4072 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=3/fdei=True_olcei=False.py
+-rw-r--r--   0        0        0     4173 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=3/fdei=True_olcei=True.py
+-rw-r--r--   0        0        0     4142 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=4/fdei=False_olcei=False.py
+-rw-r--r--   0        0        0     4277 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=4/fdei=False_olcei=True.py
+-rw-r--r--   0        0        0     4357 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=4/fdei=True_olcei=False.py
+-rw-r--r--   0        0        0     4492 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=4/fdei=True_olcei=True.py
+-rw-r--r--   0        0        0     5066 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=8/fdei=False_olcei=False.py
+-rw-r--r--   0        0        0     5337 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=8/fdei=False_olcei=True.py
+-rw-r--r--   0        0        0     5497 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=8/fdei=True_olcei=False.py
+-rw-r--r--   0        0        0     5768 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=8/fdei=True_olcei=True.py
+-rw-r--r--   0        0        0     3434 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=1/fdei=False_olcei=False.py
+-rw-r--r--   0        0        0     3462 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=1/fdei=False_olcei=True.py
+-rw-r--r--   0        0        0     3477 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=1/fdei=True_olcei=False.py
+-rw-r--r--   0        0        0     3505 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=1/fdei=True_olcei=True.py
+-rw-r--r--   0        0        0     3650 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=2/fdei=False_olcei=False.py
+-rw-r--r--   0        0        0     3707 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=2/fdei=False_olcei=True.py
+-rw-r--r--   0        0        0     3737 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=2/fdei=True_olcei=False.py
+-rw-r--r--   0        0        0     3794 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=2/fdei=True_olcei=True.py
+-rw-r--r--   0        0        0     3866 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=3/fdei=False_olcei=False.py
+-rw-r--r--   0        0        0     3952 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=3/fdei=False_olcei=True.py
+-rw-r--r--   0        0        0     3997 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=3/fdei=True_olcei=False.py
+-rw-r--r--   0        0        0     4083 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=3/fdei=True_olcei=True.py
+-rw-r--r--   0        0        0     4082 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=4/fdei=False_olcei=False.py
+-rw-r--r--   0        0        0     4197 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=4/fdei=False_olcei=True.py
+-rw-r--r--   0        0        0     4257 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=4/fdei=True_olcei=False.py
+-rw-r--r--   0        0        0     4372 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=4/fdei=True_olcei=True.py
+-rw-r--r--   0        0        0     4946 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=8/fdei=False_olcei=False.py
+-rw-r--r--   0        0        0     5177 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=8/fdei=False_olcei=True.py
+-rw-r--r--   0        0        0     5297 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=8/fdei=True_olcei=False.py
+-rw-r--r--   0        0        0     5528 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=8/fdei=True_olcei=True.py
+-rw-r--r--   0        0        0     3449 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_extra_indent/fdei=False_olcei=False.py
+-rw-r--r--   0        0        0     3482 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_extra_indent/fdei=False_olcei=True.py
+-rw-r--r--   0        0        0     3502 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_extra_indent/fdei=True_olcei=False.py
+-rw-r--r--   0        0        0     3535 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_extra_indent/fdei=True_olcei=True.py
+-rw-r--r--   0        0        0     3434 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_no_extra_indent/fdei=False_olcei=False.py
+-rw-r--r--   0        0        0     3462 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_no_extra_indent/fdei=False_olcei=True.py
+-rw-r--r--   0        0        0     3477 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_no_extra_indent/fdei=True_olcei=False.py
+-rw-r--r--   0        0        0     3505 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_no_extra_indent/fdei=True_olcei=True.py
+-rw-r--r--   0        0        0     1448 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_tabs/line_length_calculation/tab_width_1.py
+-rw-r--r--   0        0        0     1453 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_tabs/line_length_calculation/tab_width_2.py
+-rw-r--r--   0        0        0     1458 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_tabs/line_length_calculation/tab_width_3.py
+-rw-r--r--   0        0        0     1463 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_tabs/line_length_calculation/tab_width_4.py
+-rw-r--r--   0        0        0     1468 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_tabs/line_length_calculation/tab_width_5.py
+-rw-r--r--   0        0        0     1475 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/indentation/use_tabs/line_length_calculation/tab_width_8.py
+-rw-r--r--   0        0        0     1556 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/keep_blank_lines_in_brackets/false.py
+-rw-r--r--   0        0        0     1579 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/keep_blank_lines_in_brackets/true.py
+-rw-r--r--   0        0        0      190 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/line_with_comments/case_False_False.py
+-rw-r--r--   0        0        0      190 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/line_with_comments/case_False_True.py
+-rw-r--r--   0        0        0      397 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/line_with_comments/case_True_False.py
+-rw-r--r--   0        0        0      403 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/line_with_comments/case_True_True.py
+-rw-r--r--   0        0        0      863 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/line_with_long_string/edge_cases.py
+-rw-r--r--   0        0        0    11060 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/line_with_long_string/long_strings_flag_disabled__Black_default.py
+-rw-r--r--   0        0        0    22087 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/line_with_long_string/long_strings_flag_disabled__Cercis_default.py
+-rw-r--r--   0        0        0     6138 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/line_with_long_string/test_cases__Black_default.py
+-rw-r--r--   0        0        0     6056 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/line_with_long_string/test_cases__Cercis_default.py
+-rw-r--r--   0        0        0     6193 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/nested_brackets/nested_brackets__Black_default.py
+-rw-r--r--   0        0        0     2832 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/nested_brackets/nested_brackets__Cercis_default.py
+-rw-r--r--   0        0        0     2011 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/nested_brackets/nested_brackets_explodes__Black_default.py
+-rw-r--r--   0        0        0     2212 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/nested_brackets/nested_brackets_explodes__Cercis_default.py
+-rw-r--r--   0        0        0      206 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/playground/playground.py
+-rw-r--r--   0        0        0     7699 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/pragma_comments/Black_default.py
+-rw-r--r--   0        0        0     7703 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/pragma_comments/Black_default_2.py
+-rw-r--r--   0        0        0    10763 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/pragma_comments/Cercis_default.py
+-rw-r--r--   0        0        0    10787 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/pragma_comments/Cercis_default_2.py
+-rw-r--r--   0        0        0     7702 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/single_quote/docstring.py
+-rw-r--r--   0        0        0      140 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/single_quote/docstring_no_extra_empty_line_before_eof.py
+-rw-r--r--   0        0        0     3513 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/single_quote/docstring_preview.py
+-rw-r--r--   0        0        0      745 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/single_quote/more_quotes.py
+-rw-r--r--   0        0        0      845 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/single_quote/string_prefixes.py
+-rw-r--r--   0        0        0     2279 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/configurable_cases/single_quote/torture.py
+-rw-r--r--   0        0        0      498 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/fast/pep_572_do_not_remove_parens.py
+-rw-r--r--   0        0        0        5 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/gitignore_used_on_multiple_sources/.gitignore
+-rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/gitignore_used_on_multiple_sources/dir1/a.py
+-rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/gitignore_used_on_multiple_sources/dir1/b.py
+-rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/gitignore_used_on_multiple_sources/dir2/a.py
+-rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/gitignore_used_on_multiple_sources/dir2/b.py
+-rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/ignore_subfolders_gitignore_tests/a.py
+-rw-r--r--   0        0        0        4 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/ignore_subfolders_gitignore_tests/subdir/.gitignore
+-rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/ignore_subfolders_gitignore_tests/subdir/b.py
+-rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/ignore_subfolders_gitignore_tests/subdir/subdir/c.py
+-rw-r--r--   0        0        0       14 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/include_exclude_tests/.gitignore
+-rw-r--r--   0        0        0      114 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/include_exclude_tests/pyproject.toml
+-rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/include_exclude_tests/b/.definitely_exclude/a.pie
+-rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/include_exclude_tests/b/.definitely_exclude/a.py
+-rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/include_exclude_tests/b/.definitely_exclude/a.pyi
+-rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/include_exclude_tests/b/dont_exclude/a.pie
+-rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/include_exclude_tests/b/dont_exclude/a.py
+-rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/include_exclude_tests/b/dont_exclude/a.pyi
+-rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/include_exclude_tests/b/exclude/a.pie
+-rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/include_exclude_tests/b/exclude/a.py
+-rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/include_exclude_tests/b/exclude/a.pyi
+-rw-r--r--   0        0        0        2 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/invalid_gitignore_tests/.gitignore
+-rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/invalid_gitignore_tests/a.py
+-rw-r--r--   0        0        0       89 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/invalid_gitignore_tests/pyproject.toml
+-rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/invalid_nested_gitignore_tests/a.py
+-rw-r--r--   0        0        0       89 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/invalid_nested_gitignore_tests/pyproject.toml
+-rw-r--r--   0        0        0        2 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/invalid_nested_gitignore_tests/a/.gitignore
+-rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/invalid_nested_gitignore_tests/a/a.py
+-rw-r--r--   0        0        0      436 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/jupyter/non_python_notebook.ipynb
+-rw-r--r--   0        0        0      371 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/jupyter/notebook_empty_metadata.ipynb
+-rw-r--r--   0        0        0      641 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/jupyter/notebook_no_trailing_newline.ipynb
+-rw-r--r--   0        0        0      642 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/jupyter/notebook_trailing_newline.ipynb
+-rw-r--r--   0        0        0        4 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/jupyter/notebook_which_cant_be_parsed.ipynb
+-rw-r--r--   0        0        0      761 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/jupyter/notebook_without_changes.ipynb
+-rw-r--r--   0        0        0      495 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/miscellaneous/async_as_identifier.py
+-rw-r--r--   0        0        0      255 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/miscellaneous/blackd_diff.diff
+-rw-r--r--   0        0        0       98 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/miscellaneous/blackd_diff.py
+-rw-r--r--   0        0        0    15604 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/miscellaneous/debug_visitor.out
+-rw-r--r--   0        0        0     1193 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/miscellaneous/debug_visitor.py
+-rw-r--r--   0        0        0     1774 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/miscellaneous/decorators.py
+-rw-r--r--   0        0        0     3601 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/miscellaneous/docstring_no_string_normalization.py
+-rw-r--r--   0        0        0      357 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/miscellaneous/docstring_preview_no_string_normalization.py
+-rw-r--r--   0        0        0    15711 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/miscellaneous/expression_skip_magic_trailing_comma.diff
+-rw-r--r--   0        0        0      626 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/miscellaneous/force_py36.py
+-rw-r--r--   0        0        0      793 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/miscellaneous/force_pyi.py
+-rw-r--r--   0        0        0       59 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/miscellaneous/invalid_header.py
+-rw-r--r--   0        0        0      101 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/miscellaneous/linelength6.py
+-rw-r--r--   0        0        0    11583 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/miscellaneous/long_strings_flag_disabled.py
+-rw-r--r--   0        0        0      293 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/miscellaneous/missing_final_newline.diff
+-rw-r--r--   0        0        0      145 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/miscellaneous/missing_final_newline.py
+-rw-r--r--   0        0        0      284 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/miscellaneous/nested_class_stub.pyi
+-rw-r--r--   0        0        0      279 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/miscellaneous/pattern_matching_invalid.py
+-rw-r--r--   0        0        0       69 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/miscellaneous/power_op_newline.py
+-rw-r--r--   0        0        0      758 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/miscellaneous/python2_detection.py
+-rw-r--r--   0        0        0     2361 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/miscellaneous/string_quotes.py
+-rw-r--r--   0        0        0     2266 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/miscellaneous/stub.pyi
+-rw-r--r--   0        0        0      114 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/nested_gitignore_tests/pyproject.toml
+-rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/nested_gitignore_tests/x.py
+-rw-r--r--   0        0        0        5 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/nested_gitignore_tests/root/.gitignore
+-rw-r--r--   0        0        0       39 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/nested_gitignore_tests/root/a.py
+-rw-r--r--   0        0        0       21 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/nested_gitignore_tests/root/b.py
+-rw-r--r--   0        0        0       21 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/nested_gitignore_tests/root/c.py
+-rw-r--r--   0        0        0        5 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/nested_gitignore_tests/root/child/.gitignore
+-rw-r--r--   0        0        0       39 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/nested_gitignore_tests/root/child/a.py
+-rw-r--r--   0        0        0       40 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/nested_gitignore_tests/root/child/b.py
+-rw-r--r--   0        0        0       21 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/nested_gitignore_tests/root/child/c.py
+-rw-r--r--   0        0        0      279 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/preview/async_stmts.py
+-rw-r--r--   0        0        0     4107 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/preview/cantfit.py
+-rw-r--r--   0        0        0     8294 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/preview/comments7.py
+-rw-r--r--   0        0        0      613 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/preview/format_unicode_escape_seq.py
+-rw-r--r--   0        0        0     2784 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/preview/long_dict_values.py
+-rw-r--r--   0        0        0    33216 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/preview/long_strings.py
+-rw-r--r--   0        0        0     1418 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/preview/long_strings__east_asian_width.py
+-rw-r--r--   0        0        0     6536 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/preview/long_strings__edge_case.py
+-rw-r--r--   0        0        0    45897 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/preview/long_strings__regression.py
+-rw-r--r--   0        0        0     1105 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/preview/long_strings__type_annotations.py
+-rw-r--r--   0        0        0     7207 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/preview/multiline_strings.py
+-rw-r--r--   0        0        0      810 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/preview/no_blank_line_before_docstring.py
+-rw-r--r--   0        0        0      481 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/preview/percent_precedence.py
+-rw-r--r--   0        0        0     2525 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/preview/prefer_rhs_split.py
+-rw-r--r--   0        0        0      342 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/preview/return_annotation_brackets_string.py
+-rw-r--r--   0        0        0      655 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/preview/trailing_comma.py
+-rw-r--r--   0        0        0     1140 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/preview_context_managers/targeting_py38.py
+-rw-r--r--   0        0        0     3361 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/preview_context_managers/targeting_py39.py
+-rw-r--r--   0        0        0      595 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/preview_context_managers/auto_detect/features_3_10.py
+-rw-r--r--   0        0        0      553 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/preview_context_managers/auto_detect/features_3_11.py
+-rw-r--r--   0        0        0     1058 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/preview_context_managers/auto_detect/features_3_8.py
+-rw-r--r--   0        0        0      623 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/preview_context_managers/auto_detect/features_3_9.py
+-rw-r--r--   0        0        0      133 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/project_metadata/both_pyproject.toml
+-rw-r--r--   0        0        0       74 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/project_metadata/neither_pyproject.toml
+-rw-r--r--   0        0        0      101 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/project_metadata/only_black_pyproject.toml
+-rw-r--r--   0        0        0      106 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/project_metadata/only_metadata_pyproject.toml
+-rw-r--r--   0        0        0      765 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/py_310/parenthesized_context_managers.py
+-rw-r--r--   0        0        0     2668 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/py_310/pattern_matching_complex.py
+-rw-r--r--   0        0        0     1965 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/py_310/pattern_matching_extras.py
+-rw-r--r--   0        0        0     3066 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/py_310/pattern_matching_generic.py
+-rw-r--r--   0        0        0     2641 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/py_310/pattern_matching_simple.py
+-rw-r--r--   0        0        0     1061 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/py_310/pattern_matching_style.py
+-rw-r--r--   0        0        0      491 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/py_310/pep_572_py310.py
+-rw-r--r--   0        0        0      509 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/py_310/remove_newline_after_match.py
+-rw-r--r--   0        0        0      380 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/py_310/starred_for_target.py
+-rw-r--r--   0        0        0     2114 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/py_311/pep_646.py
+-rw-r--r--   0        0        0      972 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/py_311/pep_654.py
+-rw-r--r--   0        0        0     2033 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/py_311/pep_654_style.py
+-rw-r--r--   0        0        0      141 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/py_312/type_aliases.py
+-rw-r--r--   0        0        0     1112 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/py_312/type_params.py
+-rw-r--r--   0        0        0      597 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/py_36/numeric_literals.py
+-rw-r--r--   0        0        0      267 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/py_36/numeric_literals_skip_underscores.py
+-rw-r--r--   0        0        0     1199 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/py_37/python37.py
+-rw-r--r--   0        0        0      740 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/py_38/pep_570.py
+-rw-r--r--   0        0        0      970 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/py_38/pep_572.py
+-rw-r--r--   0        0        0     1895 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/py_38/pep_572_remove_parens.py
+-rw-r--r--   0        0        0      834 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/py_38/python38.py
+-rw-r--r--   0        0        0      251 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/py_39/pep_572_py39.py
+-rw-r--r--   0        0        0      696 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/py_39/python39.py
+-rw-r--r--   0        0        0     2575 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/py_39/remove_with_brackets.py
+-rw-r--r--   0        0        0      907 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/attribute_access_on_number_literals.py
+-rw-r--r--   0        0        0       63 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/beginning_backslash.py
+-rw-r--r--   0        0        0      333 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/bracketmatch.py
+-rw-r--r--   0        0        0     1091 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/class_blank_parentheses.py
+-rw-r--r--   0        0        0     4318 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/class_methods_new_line.py
+-rw-r--r--   0        0        0     3294 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/collections.py
+-rw-r--r--   0        0        0      212 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/comment_after_escaped_newline.py
+-rw-r--r--   0        0        0     1909 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/comments.py
+-rw-r--r--   0        0        0     7749 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/comments2.py
+-rw-r--r--   0        0        0     1573 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/comments3.py
+-rw-r--r--   0        0        0     3536 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/comments4.py
+-rw-r--r--   0        0        0     1196 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/comments5.py
+-rw-r--r--   0        0        0     2567 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/comments6.py
+-rw-r--r--   0        0        0      300 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/comments8.py
+-rw-r--r--   0        0        0     5279 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/comments9.py
+-rw-r--r--   0        0        0      994 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/comments_non_breaking_space.py
+-rw-r--r--   0        0        0     5597 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/composition.py
+-rw-r--r--   0        0        0    11198 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/composition_no_trailing_comma.py
+-rw-r--r--   0        0        0     7699 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/docstring.py
+-rw-r--r--   0        0        0      140 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/docstring_no_extra_empty_line_before_eof.py
+-rw-r--r--   0        0        0     3513 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/docstring_preview.py
+-rw-r--r--   0        0        0     4596 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/empty_lines.py
+-rw-r--r--   0        0        0    15801 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/expression.diff
+-rw-r--r--   0        0        0    18624 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/expression.py
+-rw-r--r--   0        0        0     9681 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/fmtonoff.py
+-rw-r--r--   0        0        0      604 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/fmtonoff2.py
+-rw-r--r--   0        0        0      251 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/fmtonoff3.py
+-rw-r--r--   0        0        0      278 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/fmtonoff4.py
+-rw-r--r--   0        0        0     3627 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/fmtonoff5.py
+-rw-r--r--   0        0        0      277 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/fmtpass_imports.py
+-rw-r--r--   0        0        0       40 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/fmtskip.py
+-rw-r--r--   0        0        0      555 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/fmtskip2.py
+-rw-r--r--   0        0        0      362 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/fmtskip3.py
+-rw-r--r--   0        0        0       92 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/fmtskip4.py
+-rw-r--r--   0        0        0      301 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/fmtskip5.py
+-rw-r--r--   0        0        0      235 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/fmtskip6.py
+-rw-r--r--   0        0        0      356 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/fmtskip7.py
+-rw-r--r--   0        0        0     1705 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/fmtskip8.py
+-rw-r--r--   0        0        0      989 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/fstring.py
+-rw-r--r--   0        0        0     6482 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/function.py
+-rw-r--r--   0        0        0     2427 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/function2.py
+-rw-r--r--   0        0        0     3657 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/function_trailing_comma.py
+-rw-r--r--   0        0        0      505 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/ignore_pyi.py
+-rw-r--r--   0        0        0     2542 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/import_spacing.py
+-rw-r--r--   0        0        0      644 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/multiline_consecutive_open_parentheses_ignore.py
+-rw-r--r--   0        0        0      674 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/one_element_subscript.py
+-rw-r--r--   0        0        0      607 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/pep_604.py
+-rw-r--r--   0        0        0     3359 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/power_op_spacing.py
+-rw-r--r--   0        0        0     1106 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/prefer_rhs_split_reformatted.py
+-rw-r--r--   0        0        0     3205 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/remove_await_parens.py
+-rw-r--r--   0        0        0     2025 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/remove_except_parens.py
+-rw-r--r--   0        0        0     1460 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/remove_for_brackets.py
+-rw-r--r--   0        0        0     3351 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/remove_newline_after_code_block_open.py
+-rw-r--r--   0        0        0     3493 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/remove_parens.py
+-rw-r--r--   0        0        0     5141 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/return_annotation_brackets.py
+-rw-r--r--   0        0        0     1398 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/skip_magic_trailing_comma.py
+-rw-r--r--   0        0        0      787 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/slices.py
+-rw-r--r--   0        0        0      845 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/string_prefixes.py
+-rw-r--r--   0        0        0     2279 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/torture.py
+-rw-r--r--   0        0        0     1615 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/trailing_comma_optional_parens1.py
+-rw-r--r--   0        0        0      248 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/trailing_comma_optional_parens2.py
+-rw-r--r--   0        0        0      967 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/trailing_comma_optional_parens3.py
+-rw-r--r--   0        0        0     2123 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/trailing_commas_in_leading_parts.py
+-rw-r--r--   0        0        0       80 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/tricky_unicode_symbols.py
+-rw-r--r--   0        0        0      510 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/tupleassign.py
+-rw-r--r--   0        0        0       27 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/simple_cases/whitespace.py
+-rw-r--r--   0        0        0      101 2020-02-02 00:00:00.000000 cercis-0.2.0/tests/data/type_comments/type_comment_syntax_error.py
+-rw-r--r--   0        0        0      273 2020-02-02 00:00:00.000000 cercis-0.2.0/.gitignore
+-rw-r--r--   0        0        0     1061 2020-02-02 00:00:00.000000 cercis-0.2.0/LICENSE
+-rw-r--r--   0        0        0     1080 2020-02-02 00:00:00.000000 cercis-0.2.0/LICENSE_ORIGINAL
+-rw-r--r--   0        0        0     6972 2020-02-02 00:00:00.000000 cercis-0.2.0/pyproject.toml
+-rw-r--r--   0        0        0    29180 2020-02-02 00:00:00.000000 cercis-0.2.0/PKG-INFO
```

### Comparing `cercis-0.1.7/.pre-commit-config.yaml` & `cercis-0.2.0/.pre-commit-config.yaml`

 * *Files 11% similar despite different names*

```diff
@@ -4,43 +4,47 @@
 repos:
   - repo: https://github.com/pycqa/isort
     rev: 5.12.0
     hooks:
       - id: isort
 
   - repo: https://github.com/pycqa/flake8
-    rev: 4.0.1
+    rev: 6.0.0
     hooks:
       - id: flake8
         args: [--max-line-length=88]
         additional_dependencies:
           - flake8-bugbear
           - flake8-comprehensions
           - flake8-simplify
 
   - repo: https://github.com/pre-commit/mirrors-mypy
-    rev: v0.991
+    rev: v1.4.1
     hooks:
       - id: mypy
         exclude: ^docs/conf.py
         additional_dependencies:
-          - types-dataclasses >= 0.1.3
           - types-PyYAML
           - tomli >= 0.2.6, < 2.0.0
-          - types-typed-ast >= 1.4.1
-          - click >= 8.1.0
+          - click >= 8.1.0, != 8.1.4
           - packaging >= 22.0
           - platformdirs >= 2.1.0
           - pytest
           - hypothesis
 
   - repo: https://github.com/pre-commit/mirrors-prettier
-    rev: v2.7.1
+    rev: v3.0.0
     hooks:
       - id: prettier
         exclude: .*\.ya?ml
 
   - repo: https://github.com/pre-commit/pre-commit-hooks
-    rev: v4.3.0
+    rev: v4.4.0
     hooks:
       - id: end-of-file-fixer
       - id: trailing-whitespace
+
+  - repo: https://github.com/frnmst/md-toc
+    rev: 8.1.9
+    hooks:
+      - id: md-toc
+        args: [-p, '--skip-lines', '1', 'github', '-l', '4']
```

### Comparing `cercis-0.1.7/.pre-commit-hooks.yaml` & `cercis-0.2.0/.pre-commit-hooks.yaml`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/CHANGELOG.md` & `cercis-0.2.0/CHANGELOG.md`

 * *Files 10% similar despite different names*

```diff
@@ -1,9 +1,17 @@
 # Change Log
 
+## [0.2.0] - 2023-07-12
+
+- Changed
+  - Rebased `Cercis` to be head to head with `Black`
+    [version 23.7.0](https://github.com/psf/black/releases/tag/23.7.0)
+- Diff
+  - https://github.com/jsh9/cercis/compare/0.1.7...0.2.0
+
 ## [0.1.7] - 2023-06-19
 
 - Changed
   - Pulled in the latest changes from psf/black (code diff:
     https://github.com/jsh9/cercis/pull/27)
 
 ## [0.1.6] - 2023-05-23
```

### Comparing `cercis-0.1.7/CHANGES.md` & `cercis-0.2.0/CHANGES.md`

 * *Files 1% similar despite different names*

```diff
@@ -6,68 +6,122 @@
 
 <!-- Include any especially major or disruptive changes here -->
 
 ### Stable style
 
 <!-- Changes that affect Black's stable style -->
 
+### Preview style
+
+<!-- Changes that affect Black's preview style -->
+
+### Configuration
+
+<!-- Changes to how Black can be configured -->
+
+### Packaging
+
+<!-- Changes to how Black is packaged, such as dependency requirements -->
+
+### Parser
+
+<!-- Changes to the parser or to version autodetection -->
+
+### Performance
+
+<!-- Changes that improve Black's performance. -->
+
+### Output
+
+<!-- Changes to Black's terminal output and error messages -->
+
+### _Blackd_
+
+<!-- Changes to blackd -->
+
+### Integrations
+
+<!-- For example, Docker, GitHub Actions, pre-commit, editors -->
+
+### Documentation
+
+<!-- Major changes to documentation and policies. Small docs changes
+     don't need a changelog entry. -->
+
+## 23.7.0
+
+### Highlights
+
+- Runtime support for Python 3.7 has been removed. Formatting 3.7 code will still be
+  supported until further notice (#3765)
+
+### Stable style
+
 - Fix a bug where an illegal trailing comma was added to return type annotations using
   PEP 604 unions (#3735)
+- Fix several bugs and crashes where comments in stub files were removed or mishandled
+  under some circumstances (#3745)
+- Fix a crash with multi-line magic comments like `type: ignore` within parentheses
+  (#3740)
+- Fix error in AST validation when _Black_ removes trailing whitespace in a type comment
+  (#3773)
 
 ### Preview style
 
-<!-- Changes that affect Black's preview style -->
-
 - Implicitly concatenated strings used as function args are no longer wrapped inside
   parentheses (#3640)
 - Remove blank lines between a class definition and its docstring (#3692)
 
 ### Configuration
 
-<!-- Changes to how Black can be configured -->
-
+- The `--workers` argument to _Black_ can now be specified via the `BLACK_NUM_WORKERS`
+  environment variable (#3743)
 - `.pytest_cache`, `.ruff_cache` and `.vscode` are now excluded by default (#3691)
+- Fix _Black_ not honouring `pyproject.toml` settings when running `--stdin-filename`
+  and the `pyproject.toml` found isn't in the current working directory (#3719)
+- _Black_ will now error if `exclude` and `extend-exclude` have invalid data types in
+  `pyproject.toml`, instead of silently doing the wrong thing (#3764)
 
 ### Packaging
 
-<!-- Changes to how Black is packaged, such as dependency requirements -->
+- Upgrade mypyc from 0.991 to 1.3 (#3697)
+- Remove patching of Click that mitigated errors on Python 3.6 with `LANG=C` (#3768)
 
 ### Parser
 
-<!-- Changes to the parser or to version autodetection -->
-
 - Add support for the new PEP 695 syntax in Python 3.12 (#3703)
 
 ### Performance
 
-<!-- Changes that improve Black's performance. -->
+- Speed up _Black_ significantly when the cache is full (#3751)
+- Avoid importing `IPython` in a case where we wouldn't need it (#3748)
 
 ### Output
 
-<!-- Changes to Black's terminal output and error messages -->
-
 - Use aware UTC datetimes internally, avoids deprecation warning on Python 3.12 (#3728)
+- Change verbose logging to exactly mirror _Black_'s logic for source discovery (#3749)
 
 ### _Blackd_
 
-<!-- Changes to blackd -->
-
 - The `blackd` argument parser now shows the default values for options in their help
   text (#3712)
 
 ### Integrations
 
-<!-- For example, Docker, GitHub Actions, pre-commit, editors -->
-
+- Black is now tested with
+  [`PYTHONWARNDEFAULTENCODING = 1`](https://docs.python.org/3/library/io.html#io-encoding-warning)
+  (#3763)
 - Update GitHub Action to display black output in the job summary (#3688)
 
 ### Documentation
 
-<!-- Major changes to documentation and policies. Small docs changes
-     don't need a changelog entry. -->
+- Add a CITATION.cff file to the root of the repository, containing metadata on how to
+  cite this software (#3723)
+- Update the _classes_ and _exceptions_ documentation in Developer reference to match
+  the latest code base (#3755)
 
 ## 23.3.0
 
 ### Highlights
 
 This release fixes a longstanding confusing behavior in Black's GitHub action, where the
 version of the action did not determine the version of Black being run (issue #3382). In
```

### Comparing `cercis-0.1.7/Dockerfile` & `cercis-0.2.0/Dockerfile`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/README.md` & `cercis-0.2.0/README.md`

 * *Files 6% similar despite different names*

```diff
@@ -15,14 +15,49 @@
 _Cercis_ inherited Black's very comprehensive test cases, which means we are confident
 that our configurability addition does not introduce any undesirable side effects. We
 also thoroughly tested every configurable options that we added.
 
 In particular, via its configurable options, _Cercis_ can completely fall back to Black.
 See [Section 4.5](#45-how-to-fall-back-to-blacks-behavior) below for more details.
 
+**Table of Contents**
+
+<!--TOC-->
+
+- [1. Motivations](#1-motivations)
+- [2. Installation and usage](#2-installation-and-usage)
+  - [2.1. Installation](#21-installation)
+  - [2.2. Usage](#22-usage)
+    - [2.2.1. Command line usage](#221-command-line-usage)
+    - [2.2.2. As pre-commit hook](#222-as-pre-commit-hook)
+- [3. _Cercis_'s code style](#3-cerciss-code-style)
+  - [3.1. Line length](#31-line-length)
+  - [3.2. Single quote vs double quote](#32-single-quote-vs-double-quote)
+  - [3.3. Tabs vs spaces](#33-tabs-vs-spaces)
+  - [3.4. Base indentation spaces](#34-base-indentation-spaces)
+  - [3.5. Extra indentation at line continuations](#35-extra-indentation-at-line-continuations)
+    - [3.5.1. At function definition (`--function-definition-extra-indent`)](#351-at-function-definition---function-definition-extra-indent)
+    - [3.5.2. In other line continuations (`--other-line-continuation-extra-indent`)](#352-in-other-line-continuations---other-line-continuation-extra-indent)
+    - [3.5.3. At closing brackets (`--closing-bracket-extra-indent`)](#353-at-closing-brackets---closing-bracket-extra-indent)
+  - [3.6. "Simple" lines with long strings](#36-simple-lines-with-long-strings)
+  - [3.7. Collapse nested brackets](#37-collapse-nested-brackets)
+  - [3.8. Wrapping long lines ending with comments](#38-wrapping-long-lines-ending-with-comments)
+  - [3.9. Keep blank lines in brackets](#39-keep-blank-lines-in-brackets)
+- [4. How to configure _Cercis_](#4-how-to-configure-cercis)
+  - [4.1. Dynamically in the command line](#41-dynamically-in-the-command-line)
+  - [4.2. In your project's `pyproject.toml` file](#42-in-your-projects-pyprojecttoml-file)
+  - [4.3. In your project's `.pre-commit-config.yaml` file](#43-in-your-projects-pre-commit-configyaml-file)
+  - [4.4. Specify options in `tox.ini`](#44-specify-options-in-toxini)
+  - [4.5. How to fall back to Black's behavior](#45-how-to-fall-back-to-blacks-behavior)
+- [5. Maintainer resources](#5-maintainer-resources)
+  - [5.1. How to rebase on top of _Black_?](#51-how-to-rebase-on-top-of-black)
+  - [5.2. Change logs](#52-change-logs)
+
+<!--TOC-->
+
 ## 1. Motivations
 
 While we like the idea of auto-formatting and code readability, we take issue with some
 style choices and the lack of configurability of the Black formatter. Therefore,
 _Cercis_ aims at providing some configurability beyond Black's limited offering.
 
 ## 2. Installation and usage
@@ -83,29 +118,14 @@
 
 _Cercis_'s code style is largely consistent with the
 [style of of Black](https://black.readthedocs.io/en/stable/the_black_code_style/current_style.html).
 
 The main difference is that _Cercis_ provides several configurable options that Black
 doesn't. Configurability is our main motivation behind creating _Cercis_.
 
-_Cercis_ offers the following configurable options:
-
-1. [Line length](#31-line-length)
-2. [Single quote vs double quote](#32-single-quote-vs-double-quote)
-3. [Tabs vs spaces](#33-tabs-vs-spaces)
-4. [Base indentation spaces](#34-base-indentation-spaces)
-5. [Extra indentation at line continuation](#35-extra-indentation-at-line-continuation)
-   1. [At function definition](#351-at-function-definition---function-definition-extra-indent)
-   2. [In other line continuations](#352-in-other-line-continuations---other-line-continuation-extra-indent)
-   3. [At closing brackets](#353-at-closing-brackets---closing-bracket-extra-indent)
-6. ["Simple" lines with long strings](#36-simple-lines-with-long-strings)
-7. [Collapse nested brackets](#37-collapse-nested-brackets)
-8. [Wrap lines ending with comments](#38-wrapping-long-lines-ending-with-comments)
-9. [Keep blank lines in brackets](#39-keep-blank-lines-in-brackets)
-
 The next section ([How to configure _Cercis_](#4-how-to-configure-cercis)) contains
 detailed instructions of how to configure these options.
 
 ### 3.1. Line length
 
 _Cercis_ uses 79 characters as the line length limit, instead of 88 (Black's default).
 
@@ -707,7 +727,23 @@
 other-line-continuation-extra-indent = false
 closing-bracket-extra-indent = false
 wrap-line-with-long-string = true
 collapse-nested-brackets = false
 wrap-comments = true
 wrap-pragma-comments = true
 ```
+
+## 5. Maintainer resources
+
+Here are some resources and notes for maintainers of _Cercis_:
+
+### 5.1. How to rebase on top of _Black_?
+
+Please refer to the file [HOW_TO_REBASE.md](./HOW_TO_REBASE.md).
+
+### 5.2. Change logs
+
+There are 2 files in this repo: [CHANGELOG.md](./CHANGELOG.md) and
+[CHANGES.md](./CHANGES.md).
+
+The former tracks the changes of _Cercis_ (_Black_ does not have this file). The latter
+tracks the changes on _Black_ (it exists in the _Black_ repo as well).
```

### Comparing `cercis-0.1.7/action.yml` & `cercis-0.2.0/action.yml`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/mypy.ini` & `cercis-0.2.0/mypy.ini`

 * *Files 1% similar despite different names*

```diff
@@ -1,12 +1,12 @@
 [mypy]
 # Specify the target platform details in config, so your developers are
 # free to run mypy on Windows, Linux, or macOS and get consistent
 # results.
-python_version=3.7
+python_version=3.8
 
 mypy_path=src
 
 show_column_numbers=True
 show_error_codes=True
 
 # be strict
```

### Comparing `cercis-0.1.7/tox.ini` & `cercis-0.2.0/tox.ini`

 * *Files 7% similar despite different names*

```diff
@@ -1,13 +1,15 @@
 [tox]
 isolated_build = true
 envlist = {,ci-}py{37,38,39,310,311,py3},fuzz,run_self
 
 [testenv]
-setenv = PYTHONPATH = {toxinidir}/src
+setenv =
+    PYTHONPATH = {toxinidir}/src
+    PYTHONWARNDEFAULTENCODING = 1
 skip_install = True
 # We use `recreate=True` because otherwise, on the second run of `tox -e py`,
 # the `no_jupyter` tests would run with the jupyter extra dependencies installed.
 # See https://github.com/psf/black/issues/2367.
 recreate = True
 deps =
     -r{toxinidir}/test_requirements.txt
@@ -33,27 +35,23 @@
 deps =
     -r{toxinidir}/test_requirements.txt
 ; a separate worker is required in ci due to https://foss.heptapod.net/pypy/pypy/-/issues/3317
 ; this seems to cause tox to wait forever
 ; remove this when pypy releases the bugfix
 commands =
     pip install -e .[d]
-    coverage erase
     pytest tests \
         --run-optional no_jupyter \
         !ci: --numprocesses auto \
-        ci: --numprocesses 1 \
-        --cov {posargs}
+        ci: --numprocesses 1
     pip install -e .[jupyter]
     pytest tests --run-optional jupyter \
         -m jupyter \
         !ci: --numprocesses auto \
-        ci: --numprocesses 1 \
-        --cov --cov-append {posargs}
-    coverage report
+        ci: --numprocesses 1
 
 [testenv:{,ci-}311]
 setenv =
   PYTHONPATH = {toxinidir}/src
   AIOHTTP_NO_EXTENSIONS = 1
 skip_install = True
 recreate = True
```

### Comparing `cercis-0.1.7/.github/PULL_REQUEST_TEMPLATE.md` & `cercis-0.2.0/.github/PULL_REQUEST_TEMPLATE.md`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/.github/dependabot.yml` & `cercis-0.2.0/.github/dependabot.yml`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/.github/ISSUE_TEMPLATE/bug_report.md` & `cercis-0.2.0/.github/ISSUE_TEMPLATE/bug_report.md`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/.github/ISSUE_TEMPLATE/config.yml` & `cercis-0.2.0/.github/ISSUE_TEMPLATE/config.yml`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/.github/ISSUE_TEMPLATE/docs-issue.md` & `cercis-0.2.0/.github/ISSUE_TEMPLATE/docs-issue.md`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/.github/ISSUE_TEMPLATE/feature_request.md` & `cercis-0.2.0/.github/ISSUE_TEMPLATE/feature_request.md`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/.github/ISSUE_TEMPLATE/style_issue.md` & `cercis-0.2.0/.github/ISSUE_TEMPLATE/style_issue.md`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/.github/workflows/check-changelog.yml` & `cercis-0.2.0/.github/workflows/check-changelog.yml`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/.github/workflows/diff_shades_comment.yml` & `cercis-0.2.0/.github/workflows/diff_shades_comment.yml`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/.github/workflows/docker.yml` & `cercis-0.2.0/.github/workflows/docker.yml`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/.github/workflows/fuzz.yml` & `cercis-0.2.0/.github/workflows/fuzz.yml`

 * *Files 1% similar despite different names*

```diff
@@ -18,15 +18,15 @@
       github.event_name == 'push' || github.event.pull_request.head.repo.full_name !=
       github.repository
 
     runs-on: ubuntu-latest
     strategy:
       fail-fast: false
       matrix:
-        python-version: ["3.7", "3.8", "3.9", "3.10", "3.11"]
+        python-version: ["3.8", "3.9", "3.10", "3.11"]
 
     steps:
       - uses: actions/checkout@v3
 
       - name: Set up Python ${{ matrix.python-version }}
         uses: actions/setup-python@v4
         with:
```

### Comparing `cercis-0.1.7/.github/workflows/lint.yml` & `cercis-0.2.0/.github/workflows/lint.yml`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/.github/workflows/python-package.yml` & `cercis-0.2.0/.github/workflows/python-package.yml`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/.github/workflows/python-publish.yml` & `cercis-0.2.0/.github/workflows/python-publish.yml`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/.github/workflows/test.yml` & `cercis-0.2.0/.github/workflows/test.yml`

 * *Files 8% similar despite different names*

```diff
@@ -27,15 +27,15 @@
       github.event_name == 'push' || github.event.pull_request.head.repo.full_name !=
       github.repository
 
     runs-on: ${{ matrix.os }}
     strategy:
       fail-fast: false
       matrix:
-        python-version: ["3.7", "3.8", "3.9", "3.10", "3.11", "pypy-3.7", "pypy-3.8"]
+        python-version: ["3.8", "3.9", "3.10", "3.11", "pypy-3.8"]
         os: [ubuntu-latest, macOS-latest, windows-latest]
 
     steps:
       - uses: actions/checkout@v3
 
       - name: Set up Python ${{ matrix.python-version }}
         uses: actions/setup-python@v4
@@ -54,15 +54,17 @@
       - name: Unit tests (pypy)
         if: "startsWith(matrix.python-version, 'pypy')"
         run: tox -e ci-pypy3 -- -v --color=yes
 
       - name: Upload coverage to Coveralls
         # Upload coverage if we are on the main repository and
         # we're running on Linux (this action only supports Linux)
-        if: github.repository == 'psf/cercis' && matrix.os == 'ubuntu-latest'
+        if:
+          github.repository == 'psf/black' && matrix.os == 'ubuntu-latest' &&
+          !startsWith(matrix.python-version, 'pypy')
         uses: AndreMiras/coveralls-python-action@v20201129
         with:
           github-token: ${{ secrets.GITHUB_TOKEN }}
           parallel: true
           flag-name: py${{ matrix.python-version }}-${{ matrix.os }}
           debug: true
 
@@ -99,8 +101,8 @@
 
       - name: Install cercis with uvloop
         run: |
           python -m pip install pip --upgrade --disable-pip-version-check
           python -m pip install -e ".[uvloop]"
 
       - name: Format ourselves
-        run: python -m cercis --check src/
+        run: python -m cercis --check .
```

### Comparing `cercis-0.1.7/.github/workflows/upload_binary.yml` & `cercis-0.2.0/.github/workflows/upload_binary.yml`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/.github/workflows/version-check.yml` & `cercis-0.2.0/.github/workflows/version-check.yml`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/action/main.py` & `cercis-0.2.0/action/main.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/autoload/black.vim` & `cercis-0.2.0/autoload/black.vim`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/gallery/README.md` & `cercis-0.2.0/gallery/README.md`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/gallery/gallery.py` & `cercis-0.2.0/gallery/gallery.py`

 * *Files 2% similar despite different names*

```diff
@@ -99,31 +99,31 @@
     with get_archive_manager(local_file) as archive:
         archive.extractall(path=directory)
         result_dir = get_first_archive_member(archive)
     return directory / result_dir
 
 
 def get_package(
-    package: str, version: Optional[str], directory: Path
+        package: str, version: Optional[str], directory: Path
 ) -> Optional[Path]:
     try:
         return download_and_extract(package, version, directory)
     except Exception:
         print(f"Caught an exception while downloading {package}.")
         traceback.print_exc()
         return None
 
 
 DEFAULT_SLICE = slice(None)  # for flake8
 
 
 def download_and_extract_top_packages(
-    directory: Path,
-    workers: int = 8,
-    limit: slice = DEFAULT_SLICE,
+        directory: Path,
+        workers: int = 8,
+        limit: slice = DEFAULT_SLICE,
 ) -> Generator[Path, None, None]:
     with ThreadPoolExecutor(max_workers=workers) as executor:
         bound_downloader = partial(get_package, version=None, directory=directory)
         for package in executor.map(bound_downloader, get_top_packages()[limit]):
             if package is not None:
                 yield package
 
@@ -135,15 +135,15 @@
 
 def git_add_and_commit(msg: str, repo: Path) -> None:
     subprocess.run(["git", "add", "."], cwd=repo)
     subprocess.run(["git", "commit", "-m", msg, "--allow-empty"], cwd=repo)
 
 
 def git_switch_branch(
-    branch: str, repo: Path, new: bool = False, from_branch: Optional[str] = None
+        branch: str, repo: Path, new: bool = False, from_branch: Optional[str] = None
 ) -> None:
     args = ["git", "checkout"]
     if new:
         args.append("-b")
     args.append(branch)
     if from_branch:
         args.append(from_branch)
@@ -192,19 +192,19 @@
     subprocess.run([python, "-m", "pip", "install", "-e", black_repo])
 
     atexit.register(directory.cleanup)
     return python
 
 
 def format_repo_with_version(
-    repo: Path,
-    from_branch: Optional[str],
-    black_repo: Path,
-    black_version: BlackVersion,
-    input_directory: Path,
+        repo: Path,
+        from_branch: Optional[str],
+        black_repo: Path,
+        black_version: BlackVersion,
+        input_directory: Path,
 ) -> str:
     current_branch = f"cercis-{black_version.version}"
     git_switch_branch(black_version.version, repo=black_repo)
     git_switch_branch(current_branch, repo=repo, new=True, from_branch=from_branch)
 
     format_cmd: List[Union[Path, str]] = [
         black_runner(black_version.version, black_repo),
@@ -239,27 +239,27 @@
             )
         git_switch_branch("main", repo=repo)
 
     git_switch_branch("main", repo=options.black_repo)
 
 
 def main() -> None:
-    parser = ArgumentParser(
-        description="""Black Gallery is a script that
+    parser = ArgumentParser(description="""Black Gallery is a script that
     automates the process of applying different Black versions to a selected
-    PyPI package and seeing the results between versions."""
-    )
+    PyPI package and seeing the results between versions.""")
 
     group = parser.add_mutually_exclusive_group(required=True)
     group.add_argument("-p", "--pypi-package", help="PyPI package to download.")
     group.add_argument(
         "-t", "--top-packages", help="Top n PyPI packages to download.", type=int
     )
 
-    parser.add_argument("-b", "--cercis-repo", help="Black's Git repository.", type=Path)
+    parser.add_argument(
+        "-b", "--cercis-repo", help="Black's Git repository.", type=Path
+    )
     parser.add_argument(
         "-v",
         "--version",
         help=(
             "Version for given PyPI package. Will be discarded if used with -t option."
         ),
     )
```

### Comparing `cercis-0.1.7/plugin/black.vim` & `cercis-0.2.0/plugin/black.vim`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/scripts/check_version_and_changelog.py` & `cercis-0.2.0/scripts/check_version_and_changelog.py`

 * *Files 7% similar despite different names*

```diff
@@ -6,88 +6,88 @@
 
 try:
     from packaging.version import Version, parse
 except ImportError:
     from pip._vendor.packaging.version import Version, parse  # type:ignore
 
 
-PATTERN = re.compile(r'\[(.*?)\]')
-VER_PAT = re.compile(r'^\d\.\d\.\d$')
+PATTERN = re.compile(r"\[(.*?)\]")
+VER_PAT = re.compile(r"^\d\.\d\.\d$")
 
-URL_PATTERN = 'https://pypi.python.org/pypi/{package}/json'
+URL_PATTERN = "https://pypi.python.org/pypi/{package}/json"
 
 
 def get_latest_version_from_PyPI(
         package: str,
         url_pattern: str = URL_PATTERN,
 ) -> Version:
     """Return version of package on pypi.python.org using json."""
     req = requests.get(url_pattern.format(package=package))
-    version = parse('0')
+    version = parse("0")
     if req.status_code == requests.codes.ok:
         j = json.loads(req.text.encode(req.encoding))
-        releases = j.get('releases', [])
+        releases = j.get("releases", [])
         for release in releases:
             ver = parse(release)
             if not ver.is_prerelease:
                 version = max(version, ver)
 
     return version
 
 
 def should_fail_version_check(
         mode: str,
         local_latest_ver: Version,
         pypi_latest_ver: Version,
 ) -> bool:
-    if mode == 'branch':
+    if mode == "branch":
         return local_latest_ver < pypi_latest_ver
 
-    if mode == 'main':
+    if mode == "main":
         return local_latest_ver <= pypi_latest_ver
 
-    raise RuntimeError('Internal error; please contact the authors')
+    raise RuntimeError("Internal error; please contact the authors")
 
 
 def main() -> int:
-    mode = sys.argv[1] if len(sys.argv) > 1 else 'branch'
+    mode = sys.argv[1] if len(sys.argv) > 1 else "branch"
 
-    with open('CHANGELOG.md') as fp:
+    with open("CHANGELOG.md") as fp:
         lines = fp.readlines()
 
     if len(lines) == 0:
-        print('Empty CHANGELOG.md file')
+        print("Empty CHANGELOG.md file")
         return 1
 
-    print('Contents of CHANGELOG.md (up to the latest local version):\n')
-    if lines[0] != '# Change Log\n':
-        print(f'Unexpected first line in CHANGELOG.md: {lines[0]}')
+    print("Contents of CHANGELOG.md (up to the latest local version):\n")
+    if lines[0] != "# Change Log\n":
+        print(f"Unexpected first line in CHANGELOG.md: {lines[0]}")
         return 1
 
     for line in lines[1:]:
         print(line.rstrip())
-        if line.startswith('##'):
-            if line == '## [Unreleased]\n':
+        if line.startswith("##"):
+            if line == "## [Unreleased]\n":
                 continue
 
             match = PATTERN.search(line)
             version = match.group(1)  # type:ignore
             if not VER_PAT.match(version):
-                print(f'Invalid version: {version}')
+                print(f"Invalid version: {version}")
                 return 1
 
             break
 
-    latest_version_on_PyPI = get_latest_version_from_PyPI('cercis')
+    latest_version_on_PyPI = get_latest_version_from_PyPI("cercis")
 
     if should_fail_version_check(mode, parse(version), latest_version_on_PyPI):
         print(
-            f'Newest local version ({version}) must be higher than the'
-            f' latest version on PyPI ({latest_version_on_PyPI})'
+            f"Newest local version ({version}) must be higher than the"
+            f" latest version on PyPI ({latest_version_on_PyPI})"
         )
         return 1
 
     return 0
 
 
-if __name__ == '__main__':
+if __name__ == "__main__":
     raise SystemExit(main())
```

### Comparing `cercis-0.1.7/scripts/check_version_in_basics_example.py` & `cercis-0.2.0/scripts/check_version_in_basics_example.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/scripts/diff_shades_gha_helper.py` & `cercis-0.2.0/scripts/diff_shades_gha_helper.py`

 * *Files 3% similar despite different names*

```diff
@@ -48,15 +48,21 @@
 
 
 def set_output(name: str, value: str) -> None:
     if len(value) < 200:
         print(f"[INFO]: setting '{name}' to '{value}'")
     else:
         print(f"[INFO]: setting '{name}' to [{len(value)} chars]")
-    print(f"::set-output name={name}::{value}")
+
+    # Originally the `set-output` workflow command was used here, now replaced
+    # by setting variables through the `GITHUB_OUTPUT` environment variable
+    # to stay up to date with GitHub's update.
+    if "GITHUB_OUTPUT" in os.environ:
+        with open(os.environ["GITHUB_OUTPUT"], "a") as f:
+            print(f"{name}={value}", file=f)
 
 
 def http_get(url: str, *, is_json: bool = True, **kwargs: Any) -> Any:
     headers = kwargs.get("headers") or {}
     headers["User-Agent"] = USER_AGENT
     if "github" in url:
         if GH_API_TOKEN:
@@ -155,15 +161,15 @@
 @main.command("comment-body", help="Generate the body for a summary PR comment.")
 @click.argument("baseline", type=click.Path(exists=True, path_type=Path))
 @click.argument("target", type=click.Path(exists=True, path_type=Path))
 @click.argument("baseline-sha")
 @click.argument("target-sha")
 @click.argument("pr-num", type=int)
 def comment_body(
-    baseline: Path, target: Path, baseline_sha: str, target_sha: str, pr_num: int
+        baseline: Path, target: Path, baseline_sha: str, target_sha: str, pr_num: int
 ) -> None:
     # fmt: off
     cmd = [
         sys.executable, "-m", "diff_shades", "--no-color",
         "compare", str(baseline), str(target), "--quiet", "--check"
     ]
     # fmt: on
```

### Comparing `cercis-0.1.7/scripts/fuzz.py` & `cercis-0.2.0/scripts/fuzz.py`

 * *Files 0% similar despite different names*

```diff
@@ -35,15 +35,15 @@
         string_normalization=st.booleans(),
         preview=st.booleans(),
         is_pyi=st.booleans(),
         magic_trailing_comma=st.booleans(),
     ),
 )
 def test_idempotent_any_syntatically_valid_python(
-    src_contents: str, mode: cercis.FileMode
+        src_contents: str, mode: cercis.FileMode
 ) -> None:
     # Before starting, let's confirm that the input string is valid Python:
     compile(src_contents, "<string>", "exec")  # else the bug is in hypothesmith
 
     # Then format the code...
     try:
         dst_contents = cercis.format_str(src_contents, mode=mode)
```

### Comparing `cercis-0.1.7/scripts/make_width_table.py` & `cercis-0.2.0/scripts/make_width_table.py`

 * *Files 8% similar despite different names*

```diff
@@ -45,29 +45,21 @@
     if start_codepoint >= 0:
         yield (start_codepoint, end_codepoint, range_width)
 
 
 def main() -> None:
     table_path = join(dirname(__file__), "..", "src", "cercis", "_width_table.py")
     with open(table_path, "w") as f:
-        f.write(
-            f"""# Generated by {basename(__file__)}
+        f.write(f"""# Generated by {basename(__file__)}
 # wcwidth {wcwidth.__version__}
 # Unicode {wcwidth.list_versions()[-1]}
-import sys
-from typing import List, Tuple
-
-if sys.version_info < (3, 8):
-    from typing_extensions import Final
-else:
-    from typing import Final
+from typing import Final, List, Tuple
 
 WIDTH_TABLE: Final[List[Tuple[int, int, int]]] = [
-"""
-        )
+""")
         for triple in make_width_table():
             f.write(f"    {triple!r},\n")
         f.write("]\n")
 
 
 if __name__ == "__main__":
     main()
```

### Comparing `cercis-0.1.7/scripts/migrate-black.py` & `cercis-0.2.0/scripts/migrate-black.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/src/blackd/__init__.py` & `cercis-0.2.0/src/blackd/__init__.py`

 * *Files 1% similar despite different names*

```diff
@@ -222,13 +222,12 @@
                 raise InvalidVariantHeader("expected e.g. '3.7', 'py3.5'") from None
         return False, versions
 
 
 def patched_main() -> None:
     maybe_install_uvloop()
     freeze_support()
-    cercis.patch_click()
     main()
 
 
 if __name__ == "__main__":
     patched_main()
```

### Comparing `cercis-0.1.7/src/blackd/middlewares.py` & `cercis-0.2.0/src/blackd/middlewares.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/src/blib2to3/Grammar.txt` & `cercis-0.2.0/src/blib2to3/Grammar.txt`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/src/blib2to3/LICENSE` & `cercis-0.2.0/src/blib2to3/LICENSE`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/src/blib2to3/PatternGrammar.txt` & `cercis-0.2.0/src/blib2to3/PatternGrammar.txt`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/src/blib2to3/README` & `cercis-0.2.0/src/blib2to3/README`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/src/blib2to3/pygram.py` & `cercis-0.2.0/src/blib2to3/pygram.py`

 * *Files 1% similar despite different names*

```diff
@@ -5,27 +5,26 @@
 
 # Python imports
 import os
 
 from typing import Union
 
 # Local imports
-from .pgen2 import token
 from .pgen2 import driver
 
 from .pgen2.grammar import Grammar
 
 # Moved into initialize because mypyc can't handle __file__ (XXX bug)
 # # The grammar file
 # _GRAMMAR_FILE = os.path.join(os.path.dirname(__file__), "Grammar.txt")
 # _PATTERN_GRAMMAR_FILE = os.path.join(os.path.dirname(__file__),
 #                                      "PatternGrammar.txt")
 
 
-class Symbols(object):
+class Symbols:
     def __init__(self, grammar: Grammar) -> None:
         """Initializer.
 
         Creates an attribute for each grammar symbol (nonterminal),
         whose value is the symbol's type (an int >= 256).
         """
         for name, symbol in grammar.symbol2number.items():
```

### Comparing `cercis-0.1.7/src/blib2to3/pytree.py` & `cercis-0.2.0/src/blib2to3/pytree.py`

 * *Files 1% similar despite different names*

```diff
@@ -14,15 +14,14 @@
 
 from typing import (
     Any,
     Dict,
     Iterator,
     List,
     Optional,
-    Text,
     Tuple,
     TypeVar,
     Union,
     Set,
     Iterable,
 )
 from blib2to3.pgen2.grammar import Grammar
@@ -30,18 +29,18 @@
 __author__ = "Guido van Rossum <guido@python.org>"
 
 import sys
 from io import StringIO
 
 HUGE: int = 0x7FFFFFFF  # maximum repeat count, default max
 
-_type_reprs: Dict[int, Union[Text, int]] = {}
+_type_reprs: Dict[int, Union[str, int]] = {}
 
 
-def type_repr(type_num: int) -> Union[Text, int]:
+def type_repr(type_num: int) -> Union[str, int]:
     global _type_reprs
     if not _type_reprs:
         from .pygram import python_symbols
 
         # printing tokens is possible but not as useful
         # from .pgen2 import token // token.__dict__.items():
         for name in dir(python_symbols):
@@ -50,19 +49,19 @@
                 _type_reprs[val] = name
     return _type_reprs.setdefault(type_num, type_num)
 
 
 _P = TypeVar("_P", bound="Base")
 
 NL = Union["Node", "Leaf"]
-Context = Tuple[Text, Tuple[int, int]]
-RawNode = Tuple[int, Optional[Text], Optional[Context], Optional[List[NL]]]
+Context = Tuple[str, Tuple[int, int]]
+RawNode = Tuple[int, Optional[str], Optional[Context], Optional[List[NL]]]
 
 
-class Base(object):
+class Base:
 
     """
     Abstract base class for Node and Leaf.
 
     This provides some default functionality and boilerplate using the
     template pattern.
 
@@ -88,15 +87,15 @@
         This calls the method _eq().
         """
         if self.__class__ is not other.__class__:
             return NotImplemented
         return self._eq(other)
 
     @property
-    def prefix(self) -> Text:
+    def prefix(self) -> str:
         raise NotImplementedError
 
     def _eq(self: _P, other: _P) -> bool:
         """
         Compare two nodes for equality.
 
         This is called by __eq__ and __ne__.  It is only called if the two nodes
@@ -221,15 +220,15 @@
             yield from child.leaves()
 
     def depth(self) -> int:
         if self.parent is None:
             return 0
         return 1 + self.parent.depth()
 
-    def get_suffix(self) -> Text:
+    def get_suffix(self) -> str:
         """
         Return the string immediately following the invocant node. This is
         effectively equivalent to node.next_sibling.prefix
         """
         next_sib = self.next_sibling
         if next_sib is None:
             return ""
@@ -238,22 +237,22 @@
 
 
 class Node(Base):
 
     """Concrete implementation for interior nodes."""
 
     fixers_applied: Optional[List[Any]]
-    used_names: Optional[Set[Text]]
+    used_names: Optional[Set[str]]
 
     def __init__(
         self,
         type: int,
         children: List[NL],
         context: Optional[Any] = None,
-        prefix: Optional[Text] = None,
+        prefix: Optional[str] = None,
         fixers_applied: Optional[List[Any]] = None,
     ) -> None:
         """
         Initializer.
 
         Takes a type constant (a symbol number >= 256), a sequence of
         child nodes, and an optional context keyword argument.
@@ -270,24 +269,24 @@
         if prefix is not None:
             self.prefix = prefix
         if fixers_applied:
             self.fixers_applied = fixers_applied[:]
         else:
             self.fixers_applied = None
 
-    def __repr__(self) -> Text:
+    def __repr__(self) -> str:
         """Return a canonical string representation."""
         assert self.type is not None
-        return "%s(%s, %r)" % (
+        return "{}({}, {!r})".format(
             self.__class__.__name__,
             type_repr(self.type),
             self.children,
         )
 
-    def __str__(self) -> Text:
+    def __str__(self) -> str:
         """
         Return a pretty string representation.
 
         This reproduces the input source exactly.
         """
         return "".join(map(str, self.children))
 
@@ -313,24 +312,24 @@
     def pre_order(self) -> Iterator[NL]:
         """Return a pre-order iterator for the tree."""
         yield self
         for child in self.children:
             yield from child.pre_order()
 
     @property
-    def prefix(self) -> Text:
+    def prefix(self) -> str:
         """
         The whitespace and comments preceding this node in the input.
         """
         if not self.children:
             return ""
         return self.children[0].prefix
 
     @prefix.setter
-    def prefix(self, prefix: Text) -> None:
+    def prefix(self, prefix: str) -> None:
         if self.children:
             self.children[0].prefix = prefix
 
     def set_child(self, i: int, child: NL) -> None:
         """
         Equivalent to 'node.children[i] = child'. This method also sets the
         child's parent attribute appropriately.
@@ -379,34 +378,34 @@
 
 
 class Leaf(Base):
 
     """Concrete implementation for leaf nodes."""
 
     # Default values for instance variables
-    value: Text
+    value: str
     fixers_applied: List[Any]
     bracket_depth: int
     # Changed later in brackets.py
     opening_bracket: Optional["Leaf"] = None
-    used_names: Optional[Set[Text]]
+    used_names: Optional[Set[str]]
     _prefix = ""  # Whitespace and comments preceding this token in the input
     lineno: int = 0  # Line where this token starts in the input
     column: int = 0  # Column where this token starts in the input
     # If not None, this Leaf is created by converting a block of fmt off/skip
     # code, and `fmt_pass_converted_first_leaf` points to the first Leaf in the
     # converted code.
     fmt_pass_converted_first_leaf: Optional["Leaf"] = None
 
     def __init__(
         self,
         type: int,
-        value: Text,
+        value: str,
         context: Optional[Context] = None,
-        prefix: Optional[Text] = None,
+        prefix: Optional[str] = None,
         fixers_applied: List[Any] = [],
         opening_bracket: Optional["Leaf"] = None,
         fmt_pass_converted_first_leaf: Optional["Leaf"] = None,
     ) -> None:
         """
         Initializer.
 
@@ -427,21 +426,21 @@
         self.fmt_pass_converted_first_leaf = fmt_pass_converted_first_leaf
 
     def __repr__(self) -> str:
         """Return a canonical string representation."""
         from .pgen2.token import tok_name
 
         assert self.type is not None
-        return "%s(%s, %r)" % (
+        return "{}({}, {!r})".format(
             self.__class__.__name__,
             tok_name.get(self.type, self.type),
             self.value,
         )
 
-    def __str__(self) -> Text:
+    def __str__(self) -> str:
         """
         Return a pretty string representation.
 
         This reproduces the input source exactly.
         """
         return self._prefix + str(self.value)
 
@@ -467,22 +466,22 @@
         yield self
 
     def pre_order(self) -> Iterator["Leaf"]:
         """Return a pre-order iterator for the tree."""
         yield self
 
     @property
-    def prefix(self) -> Text:
+    def prefix(self) -> str:
         """
         The whitespace and comments preceding this token in the input.
         """
         return self._prefix
 
     @prefix.setter
-    def prefix(self, prefix: Text) -> None:
+    def prefix(self, prefix: str) -> None:
         self.changed()
         self._prefix = prefix
 
 
 def convert(gr: Grammar, raw_node: RawNode) -> NL:
     """
     Convert raw node information to a Node or Leaf instance.
@@ -499,18 +498,18 @@
         if len(children) == 1:
             return children[0]
         return Node(type, children, context=context)
     else:
         return Leaf(type, value or "", context=context)
 
 
-_Results = Dict[Text, NL]
+_Results = Dict[str, NL]
 
 
-class BasePattern(object):
+class BasePattern:
 
     """
     A pattern is a tree matching pattern.
 
     It looks for a specific node type (token or symbol), and
     optionally for a specific content.
 
@@ -522,27 +521,27 @@
     - WildcardPattern matches a sequence of nodes of variable length.
     """
 
     # Defaults for instance variables
     type: Optional[int]
     type = None  # Node type (token if < 256, symbol if >= 256)
     content: Any = None  # Optional content matching pattern
-    name: Optional[Text] = None  # Optional name used to store match in results dict
+    name: Optional[str] = None  # Optional name used to store match in results dict
 
     def __new__(cls, *args, **kwds):
         """Constructor that prevents BasePattern from being instantiated."""
         assert cls is not BasePattern, "Cannot instantiate BasePattern"
         return object.__new__(cls)
 
-    def __repr__(self) -> Text:
+    def __repr__(self) -> str:
         assert self.type is not None
         args = [type_repr(self.type), self.content, self.name]
         while args and args[-1] is None:
             del args[-1]
-        return "%s(%s)" % (self.__class__.__name__, ", ".join(map(repr, args)))
+        return "{}({})".format(self.__class__.__name__, ", ".join(map(repr, args)))
 
     def _submatch(self, node, results=None) -> bool:
         raise NotImplementedError
 
     def optimize(self) -> "BasePattern":
         """
         A subclass can define this as a hook for optimizations.
@@ -598,16 +597,16 @@
             yield 1, r
 
 
 class LeafPattern(BasePattern):
     def __init__(
         self,
         type: Optional[int] = None,
-        content: Optional[Text] = None,
-        name: Optional[Text] = None,
+        content: Optional[str] = None,
+        name: Optional[str] = None,
     ) -> None:
         """
         Initializer.  Takes optional type, content, and name.
 
         The type, if given must be a token type (< 256).  If not given,
         this matches any *leaf* node; the content may still be required.
 
@@ -649,16 +648,16 @@
 class NodePattern(BasePattern):
 
     wildcards: bool = False
 
     def __init__(
         self,
         type: Optional[int] = None,
-        content: Optional[Iterable[Text]] = None,
-        name: Optional[Text] = None,
+        content: Optional[Iterable[str]] = None,
+        name: Optional[str] = None,
     ) -> None:
         """
         Initializer.  Takes optional type, content, and name.
 
         The type, if given, must be a symbol type (>= 256).  If the
         type is None this matches *any* single node (leaf or not),
         except if content is not None, in which it only matches
@@ -730,18 +729,18 @@
     """
 
     min: int
     max: int
 
     def __init__(
         self,
-        content: Optional[Text] = None,
+        content: Optional[str] = None,
         min: int = 0,
         max: int = HUGE,
-        name: Optional[Text] = None,
+        name: Optional[str] = None,
     ) -> None:
         """
         Initializer.
 
         Args:
             content: optional sequence of subsequences of patterns;
                      if absent, matches one node;
```

### Comparing `cercis-0.1.7/src/blib2to3/pgen2/conv.py` & `cercis-0.2.0/src/blib2to3/pgen2/conv.py`

 * *Files 2% similar despite different names*

```diff
@@ -59,24 +59,24 @@
         nonterminals of the grammar as numbers.  We build two tables
         mapping the numbers to names and back.
 
         """
         try:
             f = open(filename)
         except OSError as err:
-            print("Can't open %s: %s" % (filename, err))
+            print(f"Can't open {filename}: {err}")
             return False
         self.symbol2number = {}
         self.number2symbol = {}
         lineno = 0
         for line in f:
             lineno += 1
             mo = re.match(r"^#define\s+(\w+)\s+(\d+)$", line)
             if not mo and line.strip():
-                print("%s(%s): can't parse %s" % (filename, lineno, line.strip()))
+                print(f"{filename}({lineno}): can't parse {line.strip()}")
             else:
                 symbol, number = mo.groups()
                 number = int(number)
                 assert symbol not in self.symbol2number
                 assert number not in self.number2symbol
                 self.symbol2number[symbol] = number
                 self.number2symbol[number] = symbol
@@ -109,15 +109,15 @@
                   ...
           };
 
         """
         try:
             f = open(filename)
         except OSError as err:
-            print("Can't open %s: %s" % (filename, err))
+            print(f"Can't open {filename}: {err}")
             return False
         # The code below essentially uses f's iterator-ness!
         lineno = 0
 
         # Expect the two #include lines
         lineno, line = lineno + 1, next(f)
         assert line == '#include "pgenheaders.h"\n', (lineno, line)
```

### Comparing `cercis-0.1.7/src/blib2to3/pgen2/driver.py` & `cercis-0.2.0/src/blib2to3/pgen2/driver.py`

 * *Files 3% similar despite different names*

```diff
@@ -24,19 +24,16 @@
 from typing import (
     Any,
     cast,
     IO,
     Iterable,
     List,
     Optional,
-    Text,
     Iterator,
     Tuple,
-    TypeVar,
-    Generic,
     Union,
 )
 from contextlib import contextmanager
 from dataclasses import dataclass, field
 
 # Pgen imports
 from . import grammar, parse, token, tokenize, pgen
@@ -112,15 +109,15 @@
             self.eat(to)
         except StopIteration:
             return False
         else:
             return True
 
 
-class Driver(object):
+class Driver:
     def __init__(self, grammar: Grammar, logger: Optional[Logger] = None) -> None:
         self.grammar = grammar
         if logger is None:
             logger = logging.getLogger(__name__)
         self.logger = logger
 
     def parse_tokens(self, tokens: Iterable[GoodTokenInfo], debug: bool = False) -> NL:
@@ -185,38 +182,38 @@
         else:
             # We never broke out -- EOF is too soon (how can this happen???)
             assert start is not None
             raise parse.ParseError("incomplete input", type, value, (prefix, start))
         assert p.rootnode is not None
         return p.rootnode
 
-    def parse_stream_raw(self, stream: IO[Text], debug: bool = False) -> NL:
+    def parse_stream_raw(self, stream: IO[str], debug: bool = False) -> NL:
         """Parse a stream and return the syntax tree."""
         tokens = tokenize.generate_tokens(stream.readline, grammar=self.grammar)
         return self.parse_tokens(tokens, debug)
 
-    def parse_stream(self, stream: IO[Text], debug: bool = False) -> NL:
+    def parse_stream(self, stream: IO[str], debug: bool = False) -> NL:
         """Parse a stream and return the syntax tree."""
         return self.parse_stream_raw(stream, debug)
 
     def parse_file(
-        self, filename: Path, encoding: Optional[Text] = None, debug: bool = False
+        self, filename: Path, encoding: Optional[str] = None, debug: bool = False
     ) -> NL:
         """Parse a file and return the syntax tree."""
-        with io.open(filename, "r", encoding=encoding) as stream:
+        with open(filename, encoding=encoding) as stream:
             return self.parse_stream(stream, debug)
 
-    def parse_string(self, text: Text, debug: bool = False) -> NL:
+    def parse_string(self, text: str, debug: bool = False) -> NL:
         """Parse a string and return the syntax tree."""
         tokens = tokenize.generate_tokens(
             io.StringIO(text).readline, grammar=self.grammar
         )
         return self.parse_tokens(tokens, debug)
 
-    def _partially_consume_prefix(self, prefix: Text, column: int) -> Tuple[Text, Text]:
+    def _partially_consume_prefix(self, prefix: str, column: int) -> Tuple[str, str]:
         lines: List[str] = []
         current_line = ""
         current_column = 0
         wait_for_nl = False
         for char in prefix:
             current_line += char
             if wait_for_nl:
@@ -236,28 +233,28 @@
                 current_column = 0
             else:
                 # indent is finished
                 wait_for_nl = True
         return "".join(lines), current_line
 
 
-def _generate_pickle_name(gt: Path, cache_dir: Optional[Path] = None) -> Text:
+def _generate_pickle_name(gt: Path, cache_dir: Optional[Path] = None) -> str:
     head, tail = os.path.splitext(gt)
     if tail == ".txt":
         tail = ""
     name = head + tail + ".".join(map(str, sys.version_info)) + ".pickle"
     if cache_dir:
         return os.path.join(cache_dir, os.path.basename(name))
     else:
         return name
 
 
 def load_grammar(
-    gt: Text = "Grammar.txt",
-    gp: Optional[Text] = None,
+    gt: str = "Grammar.txt",
+    gp: Optional[str] = None,
     save: bool = True,
     force: bool = False,
     logger: Optional[Logger] = None,
 ) -> Grammar:
     """Load the grammar (maybe from a pickle)."""
     if logger is None:
         logger = logging.getLogger(__name__)
@@ -272,25 +269,25 @@
                 pass
     else:
         g = grammar.Grammar()
         g.load(gp)
     return g
 
 
-def _newer(a: Text, b: Text) -> bool:
+def _newer(a: str, b: str) -> bool:
     """Inquire whether file a was written since file b."""
     if not os.path.exists(a):
         return False
     if not os.path.exists(b):
         return True
     return os.path.getmtime(a) >= os.path.getmtime(b)
 
 
 def load_packaged_grammar(
-    package: str, grammar_source: Text, cache_dir: Optional[Path] = None
+    package: str, grammar_source: str, cache_dir: Optional[Path] = None
 ) -> grammar.Grammar:
     """Normally, loads a pickled grammar by doing
         pkgutil.get_data(package, pickled_grammar)
     where *pickled_grammar* is computed from *grammar_source* by adding the
     Python version and using a ``.pickle`` extension.
 
     However, if *grammar_source* is an extant file, load_grammar(grammar_source)
@@ -305,15 +302,15 @@
     data = pkgutil.get_data(package, pickled_name)
     assert data is not None
     g = grammar.Grammar()
     g.loads(data)
     return g
 
 
-def main(*args: Text) -> bool:
+def main(*args: str) -> bool:
     """Main program, when run as a script: produce grammar pickle files.
 
     Calls load_grammar for each argument, a path to a grammar text file.
     """
     if not args:
         args = tuple(sys.argv[1:])
     logging.basicConfig(level=logging.INFO, stream=sys.stdout, format="%(message)s")
```

### Comparing `cercis-0.1.7/src/blib2to3/pgen2/grammar.py` & `cercis-0.2.0/src/blib2to3/pgen2/grammar.py`

 * *Files 1% similar despite different names*

```diff
@@ -12,27 +12,27 @@
 
 """
 
 # Python imports
 import os
 import pickle
 import tempfile
-from typing import Any, Dict, List, Optional, Text, Tuple, TypeVar, Union
+from typing import Any, Dict, List, Optional, Tuple, TypeVar, Union
 
 # Local imports
 from . import token
 
 _P = TypeVar("_P", bound="Grammar")
-Label = Tuple[int, Optional[Text]]
+Label = Tuple[int, Optional[str]]
 DFA = List[List[Tuple[int, int]]]
 DFAS = Tuple[DFA, Dict[int, int]]
 Path = Union[str, "os.PathLike[str]"]
 
 
-class Grammar(object):
+class Grammar:
     """Pgen parsing tables conversion class.
 
     Once initialized, this class supplies the grammar tables for the
     parsing engine implemented by parse.py.  The parsing engine
     accesses the instance variables directly.  The class here does not
     provide initialization of the tables; several subclasses exist to
     do this (see the conv and pgen modules).
```

### Comparing `cercis-0.1.7/src/blib2to3/pgen2/literals.py` & `cercis-0.2.0/src/blib2to3/pgen2/literals.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,32 +1,32 @@
 # Copyright 2004-2005 Elemental Security, Inc. All Rights Reserved.
 # Licensed to PSF under a Contributor Agreement.
 
 """Safely evaluate Python string literals without using eval()."""
 
 import re
 
-from typing import Dict, Match, Text
+from typing import Dict, Match
 
 
-simple_escapes: Dict[Text, Text] = {
+simple_escapes: Dict[str, str] = {
     "a": "\a",
     "b": "\b",
     "f": "\f",
     "n": "\n",
     "r": "\r",
     "t": "\t",
     "v": "\v",
     "'": "'",
     '"': '"',
     "\\": "\\",
 }
 
 
-def escape(m: Match[Text]) -> Text:
+def escape(m: Match[str]) -> str:
     all, tail = m.group(0, 1)
     assert all.startswith("\\")
     esc = simple_escapes.get(tail)
     if esc is not None:
         return esc
     if tail.startswith("x"):
         hexes = tail[1:]
@@ -40,15 +40,15 @@
         try:
             i = int(tail, 8)
         except ValueError:
             raise ValueError("invalid octal string escape ('\\%s')" % tail) from None
     return chr(i)
 
 
-def evalString(s: Text) -> Text:
+def evalString(s: str) -> str:
     assert s.startswith("'") or s.startswith('"'), repr(s[:1])
     q = s[0]
     if s[:3] == q * 3:
         q = q * 3
     assert s.endswith(q), repr(s[-len(q) :])
     assert len(s) >= 2 * len(q)
     s = s[len(q) : -len(q)]
```

### Comparing `cercis-0.1.7/src/blib2to3/pgen2/parse.py` & `cercis-0.2.0/src/blib2to3/pgen2/parse.py`

 * *Files 3% similar despite different names*

```diff
@@ -5,24 +5,22 @@
 
 The grammar table must be loaded first.
 
 See Parser/parser.c in the Python distribution for additional info on
 how this parsing engine works.
 
 """
-import copy
 from contextlib import contextmanager
 
 # Local imports
 from . import grammar, token, tokenize
 from typing import (
     cast,
     Any,
     Optional,
-    Text,
     Union,
     Tuple,
     Dict,
     List,
     Iterator,
     Callable,
     Set,
@@ -31,15 +29,15 @@
 from blib2to3.pgen2.grammar import Grammar
 from blib2to3.pytree import convert, NL, Context, RawNode, Leaf, Node
 
 if TYPE_CHECKING:
     from blib2to3.pgen2.driver import TokenProxy
 
 
-Results = Dict[Text, NL]
+Results = Dict[str, NL]
 Convert = Callable[[Grammar, RawNode], Union[Node, Leaf]]
 DFA = List[List[Tuple[int, int]]]
 DFAS = Tuple[DFA, Dict[int, int]]
 
 
 def lam_sub(grammar: Grammar, node: RawNode) -> NL:
     assert node[3] is not None
@@ -96,29 +94,29 @@
         is_backtracking = self.parser.is_backtracking
         try:
             self.parser.is_backtracking = True
             yield
         finally:
             self.parser.is_backtracking = is_backtracking
 
-    def add_token(self, tok_type: int, tok_val: Text, raw: bool = False) -> None:
+    def add_token(self, tok_type: int, tok_val: str, raw: bool = False) -> None:
         func: Callable[..., Any]
         if raw:
             func = self.parser._addtoken
         else:
             func = self.parser.addtoken
 
         for ilabel in self.ilabels:
             with self.switch_to(ilabel):
                 args = [tok_type, tok_val, self.context]
                 if raw:
                     args.insert(0, ilabel)
                 func(*args)
 
-    def determine_route(self, value: Optional[Text] = None, force: bool = False) -> Optional[int]:
+    def determine_route(self, value: Optional[str] = None, force: bool = False) -> Optional[int]:
         alive_ilabels = self.ilabels
         if len(alive_ilabels) == 0:
             *_, most_successful_ilabel = self._dead_ilabels
             raise ParseError("bad input", most_successful_ilabel, value, self.context)
 
         ilabel, *rest = alive_ilabels
         if force or not rest:
@@ -127,26 +125,26 @@
             return None
 
 
 class ParseError(Exception):
     """Exception to signal the parser is stuck."""
 
     def __init__(
-        self, msg: Text, type: Optional[int], value: Optional[Text], context: Context
+        self, msg: str, type: Optional[int], value: Optional[str], context: Context
     ) -> None:
         Exception.__init__(
-            self, "%s: type=%r, value=%r, context=%r" % (msg, type, value, context)
+            self, f"{msg}: type={type!r}, value={value!r}, context={context!r}"
         )
         self.msg = msg
         self.type = type
         self.value = value
         self.context = context
 
 
-class Parser(object):
+class Parser:
     """Parser engine.
 
     The proper usage sequence is:
 
     p = Parser(grammar, [converter])  # create instance
     p.setup([start])                  # prepare for parsing
     <for each input token>:
@@ -232,15 +230,15 @@
         newnode: RawNode = (start, None, None, [])
         stackentry = (self.grammar.dfas[start], 0, newnode)
         self.stack: List[Tuple[DFAS, int, RawNode]] = [stackentry]
         self.rootnode: Optional[NL] = None
         self.used_names: Set[str] = set()
         self.proxy = proxy
 
-    def addtoken(self, type: int, value: Text, context: Context) -> bool:
+    def addtoken(self, type: int, value: str, context: Context) -> bool:
         """Add a token; return True iff this is the end of the program."""
         # Map from token to label
         ilabels = self.classify(type, value, context)
         assert len(ilabels) >= 1
 
         # If we have only one state to advance, we'll directly
         # take it as is.
@@ -280,15 +278,15 @@
                 counter += 1
 
             ilabel = cast(int, recorder.determine_route(next_token_value, force=force))
             assert ilabel is not None
 
         return self._addtoken(ilabel, type, value, context)
 
-    def _addtoken(self, ilabel: int, type: int, value: Text, context: Context) -> bool:
+    def _addtoken(self, ilabel: int, type: int, value: str, context: Context) -> bool:
         # Loop until the token is shifted; may raise exceptions
         while True:
             dfa, state, node = self.stack[-1]
             states, first = dfa
             arcs = states[state]
             # Look for a state with this label
             for i, newstate in arcs:
@@ -325,15 +323,15 @@
                     if not self.stack:
                         # Done parsing, but another token is input
                         raise ParseError("too much input", type, value, context)
                 else:
                     # No success finding a transition
                     raise ParseError("bad input", type, value, context)
 
-    def classify(self, type: int, value: Text, context: Context) -> List[int]:
+    def classify(self, type: int, value: str, context: Context) -> List[int]:
         """Turn a token into a label.  (Internal)
 
         Depending on whether the value is a soft-keyword or not,
         this function may return multiple labels to choose from."""
         if type == token.NAME:
             # Keep a listing of all used names
             self.used_names.add(value)
@@ -348,15 +346,15 @@
                 ]
 
         ilabel = self.grammar.tokens.get(type)
         if ilabel is None:
             raise ParseError("bad token", type, value, context)
         return [ilabel]
 
-    def shift(self, type: int, value: Text, newstate: int, context: Context) -> None:
+    def shift(self, type: int, value: str, newstate: int, context: Context) -> None:
         """Shift a token.  (Internal)"""
         if self.is_backtracking:
             dfa, state, _ = self.stack[-1]
             self.stack[-1] = (dfa, newstate, DUMMY_NODE)
         else:
             dfa, state, node = self.stack[-1]
             rawnode: RawNode = (type, value, context, None)
```

### Comparing `cercis-0.1.7/src/blib2to3/pgen2/pgen.py` & `cercis-0.2.0/src/blib2to3/pgen2/pgen.py`

 * *Files 2% similar despite different names*

```diff
@@ -7,15 +7,14 @@
 from typing import (
     Any,
     Dict,
     IO,
     Iterator,
     List,
     Optional,
-    Text,
     Tuple,
     Union,
     Sequence,
     NoReturn,
 )
 from blib2to3.pgen2 import grammar
 from blib2to3.pgen2.tokenize import GoodTokenInfo
@@ -25,21 +24,21 @@
 Path = Union[str, "os.PathLike[str]"]
 
 
 class PgenGrammar(grammar.Grammar):
     pass
 
 
-class ParserGenerator(object):
+class ParserGenerator:
     filename: Path
-    stream: IO[Text]
+    stream: IO[str]
     generator: Iterator[GoodTokenInfo]
-    first: Dict[Text, Optional[Dict[Text, int]]]
+    first: Dict[str, Optional[Dict[str, int]]]
 
-    def __init__(self, filename: Path, stream: Optional[IO[Text]] = None) -> None:
+    def __init__(self, filename: Path, stream: Optional[IO[str]] = None) -> None:
         close_stream = None
         if stream is None:
             stream = open(filename, encoding="utf-8")
             close_stream = stream.close
         self.filename = filename
         self.stream = stream
         self.generator = tokenize.generate_tokens(stream.readline)
@@ -71,25 +70,25 @@
                     arcs.append((0, dfa.index(state)))
                 states.append(arcs)
             c.states.append(states)
             c.dfas[c.symbol2number[name]] = (states, self.make_first(c, name))
         c.start = c.symbol2number[self.startsymbol]
         return c
 
-    def make_first(self, c: PgenGrammar, name: Text) -> Dict[int, int]:
+    def make_first(self, c: PgenGrammar, name: str) -> Dict[int, int]:
         rawfirst = self.first[name]
         assert rawfirst is not None
         first = {}
         for label in sorted(rawfirst):
             ilabel = self.make_label(c, label)
             ##assert ilabel not in first # XXX failed on <> ... !=
             first[ilabel] = 1
         return first
 
-    def make_label(self, c: PgenGrammar, label: Text) -> int:
+    def make_label(self, c: PgenGrammar, label: str) -> int:
         # XXX Maybe this should be a method on a subclass of converter?
         ilabel = len(c.labels)
         if label[0].isalpha():
             # Either a symbol name or a named token
             if label in c.symbol2number:
                 # A symbol name (a non-terminal)
                 if label in c.symbol2label:
@@ -140,15 +139,15 @@
         names = list(self.dfas.keys())
         names.sort()
         for name in names:
             if name not in self.first:
                 self.calcfirst(name)
             # print name, self.first[name].keys()
 
-    def calcfirst(self, name: Text) -> None:
+    def calcfirst(self, name: str) -> None:
         dfa = self.dfas[name]
         self.first[name] = None  # dummy to detect left recursion
         state = dfa[0]
         totalset: Dict[str, int] = {}
         overlapcheck = {}
         for label, next in state.arcs.items():
             if label in self.dfas:
@@ -172,15 +171,15 @@
                     raise ValueError(
                         "rule %s is ambiguous; %s is in the first sets of %s as well"
                         " as %s" % (name, symbol, label, inverse[symbol])
                     )
                 inverse[symbol] = label
         self.first[name] = totalset
 
-    def parse(self) -> Tuple[Dict[Text, List["DFAState"]], Text]:
+    def parse(self) -> Tuple[Dict[str, List["DFAState"]], str]:
         dfas = {}
         startsymbol: Optional[str] = None
         # MSTART: (NEWLINE | RULE)* ENDMARKER
         while self.type != token.ENDMARKER:
             while self.type == token.NEWLINE:
                 self.gettoken()
             # RULE: NAME ':' RHS NEWLINE
@@ -236,15 +235,15 @@
                         break
                 else:
                     st = DFAState(nfaset, finish)
                     states.append(st)
                 state.addarc(st, label)
         return states  # List of DFAState instances; first one is start
 
-    def dump_nfa(self, name: Text, start: "NFAState", finish: "NFAState") -> None:
+    def dump_nfa(self, name: str, start: "NFAState", finish: "NFAState") -> None:
         print("Dump of NFA for", name)
         todo = [start]
         for i, state in enumerate(todo):
             print("  State", i, state is finish and "(final)" or "")
             for label, next in state.arcs:
                 if next in todo:
                     j = todo.index(next)
@@ -252,15 +251,15 @@
                     j = len(todo)
                     todo.append(next)
                 if label is None:
                     print("    -> %d" % j)
                 else:
                     print("    %s -> %d" % (label, j))
 
-    def dump_dfa(self, name: Text, dfa: Sequence["DFAState"]) -> None:
+    def dump_dfa(self, name: str, dfa: Sequence["DFAState"]) -> None:
         print("Dump of DFA for", name)
         for i, state in enumerate(dfa):
             print("  State", i, state.isfinal and "(final)" or "")
             for label, next in sorted(state.arcs.items()):
                 print("    %s -> %d" % (label, dfa.index(next)))
 
     def simplify_dfa(self, dfa: List["DFAState"]) -> None:
@@ -345,15 +344,15 @@
             return a, z
         else:
             self.raise_error(
                 "expected (...) or NAME or STRING, got %s/%s", self.type, self.value
             )
             assert False
 
-    def expect(self, type: int, value: Optional[Any] = None) -> Text:
+    def expect(self, type: int, value: Optional[Any] = None) -> str:
         if self.type != type or (value is not None and self.value != value):
             self.raise_error(
                 "expected %s/%s, got %s/%s", type, value, self.type, self.value
             )
         value = self.value
         self.gettoken()
         return value
@@ -370,40 +369,40 @@
             try:
                 msg = msg % args
             except:
                 msg = " ".join([msg] + list(map(str, args)))
         raise SyntaxError(msg, (self.filename, self.end[0], self.end[1], self.line))
 
 
-class NFAState(object):
-    arcs: List[Tuple[Optional[Text], "NFAState"]]
+class NFAState:
+    arcs: List[Tuple[Optional[str], "NFAState"]]
 
     def __init__(self) -> None:
         self.arcs = []  # list of (label, NFAState) pairs
 
-    def addarc(self, next: "NFAState", label: Optional[Text] = None) -> None:
+    def addarc(self, next: "NFAState", label: Optional[str] = None) -> None:
         assert label is None or isinstance(label, str)
         assert isinstance(next, NFAState)
         self.arcs.append((label, next))
 
 
-class DFAState(object):
+class DFAState:
     nfaset: Dict[NFAState, Any]
     isfinal: bool
-    arcs: Dict[Text, "DFAState"]
+    arcs: Dict[str, "DFAState"]
 
     def __init__(self, nfaset: Dict[NFAState, Any], final: NFAState) -> None:
         assert isinstance(nfaset, dict)
         assert isinstance(next(iter(nfaset)), NFAState)
         assert isinstance(final, NFAState)
         self.nfaset = nfaset
         self.isfinal = final in nfaset
         self.arcs = {}  # map from label to DFAState
 
-    def addarc(self, next: "DFAState", label: Text) -> None:
+    def addarc(self, next: "DFAState", label: str) -> None:
         assert isinstance(label, str)
         assert label not in self.arcs
         assert isinstance(next, DFAState)
         self.arcs[label] = next
 
     def unifystate(self, old: "DFAState", new: "DFAState") -> None:
         for label, next in self.arcs.items():
```

### Comparing `cercis-0.1.7/src/blib2to3/pgen2/token.py` & `cercis-0.2.0/src/blib2to3/pgen2/token.py`

 * *Files 7% similar despite different names*

```diff
@@ -1,16 +1,12 @@
 """Token constants (from "token.h")."""
 
-import sys
 from typing import Dict
 
-if sys.version_info < (3, 8):
-    from typing_extensions import Final
-else:
-    from typing import Final
+from typing import Final
 
 #  Taken from Python (r53757) and modified to include some tokens
 #   originally monkeypatched in by pgen2.tokenize
 
 # --start constants--
 ENDMARKER: Final = 0
 NAME: Final = 1
@@ -74,15 +70,15 @@
 COLONEQUAL: Final = 59
 N_TOKENS: Final = 60
 NT_OFFSET: Final = 256
 # --end constants--
 
 tok_name: Final[Dict[int, str]] = {}
 for _name, _value in list(globals().items()):
-    if type(_value) is type(0):
+    if type(_value) is int:
         tok_name[_value] = _name
 
 
 def ISTERMINAL(x: int) -> bool:
     return x < NT_OFFSET
```

### Comparing `cercis-0.1.7/src/blib2to3/pgen2/tokenize.py` & `cercis-0.2.0/src/blib2to3/pgen2/tokenize.py`

 * *Files 2% similar despite different names*

```diff
@@ -31,25 +31,21 @@
 from typing import (
     Callable,
     Iterable,
     Iterator,
     List,
     Optional,
     Set,
-    Text,
     Tuple,
     Pattern,
     Union,
     cast,
 )
 
-if sys.version_info >= (3, 8):
-    from typing import Final
-else:
-    from typing_extensions import Final
+from typing import Final
 
 from blib2to3.pgen2.token import *
 from blib2to3.pgen2.grammar import Grammar
 
 __author__ = "Ka-Ping Yee <ping@lfw.org>"
 __credits__ = "GvR, ESR, Tim Peters, Thomas Wouters, Fred Drake, Skip Montanaro"
 
@@ -76,15 +72,15 @@
 
 
 def maybe(*choices: str) -> str:
     return group(*choices) + "?"
 
 
 def _combinations(*l: str) -> Set[str]:
-    return set(x + y for x in l for y in l + ("",) if x.casefold() != y.casefold())
+    return {x + y for x in l for y in l + ("",) if x.casefold() != y.casefold()}
 
 
 Whitespace = r"[ \f\t]*"
 Comment = r"#[^\r\n]*"
 Ignore = Whitespace + any(r"\\\r?\n" + Whitespace) + maybe(Comment)
 Name = (  # this is invalid but it's fine because Name comes after Number in all groups
     r"[^\s#\(\)\[\]\{\}+\-*/!@$%^&=|;:'\",\.<>/?`~\\]+"
@@ -188,27 +184,27 @@
     pass
 
 
 Coord = Tuple[int, int]
 
 
 def printtoken(
-    type: int, token: Text, srow_col: Coord, erow_col: Coord, line: Text
+    type: int, token: str, srow_col: Coord, erow_col: Coord, line: str
 ) -> None:  # for testing
     (srow, scol) = srow_col
     (erow, ecol) = erow_col
     print(
         "%d,%d-%d,%d:\t%s\t%s" % (srow, scol, erow, ecol, tok_name[type], repr(token))
     )
 
 
-TokenEater = Callable[[int, Text, Coord, Coord, Text], None]
+TokenEater = Callable[[int, str, Coord, Coord, str], None]
 
 
-def tokenize(readline: Callable[[], Text], tokeneater: TokenEater = printtoken) -> None:
+def tokenize(readline: Callable[[], str], tokeneater: TokenEater = printtoken) -> None:
     """
     The tokenize() function accepts two parameters: one representing the
     input stream, and one providing an output mechanism for tokenize().
 
     The first parameter, readline, must be a callable object which provides
     the same interface as the readline() method of built-in file objects.
     Each call to the function should return one line of input as a string.
@@ -220,25 +216,25 @@
     try:
         tokenize_loop(readline, tokeneater)
     except StopTokenizing:
         pass
 
 
 # backwards compatible interface
-def tokenize_loop(readline: Callable[[], Text], tokeneater: TokenEater) -> None:
+def tokenize_loop(readline: Callable[[], str], tokeneater: TokenEater) -> None:
     for token_info in generate_tokens(readline):
         tokeneater(*token_info)
 
 
-GoodTokenInfo = Tuple[int, Text, Coord, Coord, Text]
+GoodTokenInfo = Tuple[int, str, Coord, Coord, str]
 TokenInfo = Union[Tuple[int, str], GoodTokenInfo]
 
 
 class Untokenizer:
-    tokens: List[Text]
+    tokens: List[str]
     prev_row: int
     prev_col: int
 
     def __init__(self) -> None:
         self.tokens = []
         self.prev_row = 1
         self.prev_col = 0
@@ -246,31 +242,31 @@
     def add_whitespace(self, start: Coord) -> None:
         row, col = start
         assert row <= self.prev_row
         col_offset = col - self.prev_col
         if col_offset:
             self.tokens.append(" " * col_offset)
 
-    def untokenize(self, iterable: Iterable[TokenInfo]) -> Text:
+    def untokenize(self, iterable: Iterable[TokenInfo]) -> str:
         for t in iterable:
             if len(t) == 2:
                 self.compat(cast(Tuple[int, str], t), iterable)
                 break
             tok_type, token, start, end, line = cast(
-                Tuple[int, Text, Coord, Coord, Text], t
+                Tuple[int, str, Coord, Coord, str], t
             )
             self.add_whitespace(start)
             self.tokens.append(token)
             self.prev_row, self.prev_col = end
             if tok_type in (NEWLINE, NL):
                 self.prev_row += 1
                 self.prev_col = 0
         return "".join(self.tokens)
 
-    def compat(self, token: Tuple[int, Text], iterable: Iterable[TokenInfo]) -> None:
+    def compat(self, token: Tuple[int, str], iterable: Iterable[TokenInfo]) -> None:
         startline = False
         indents = []
         toks_append = self.tokens.append
         toknum, tokval = token
         if toknum in (NAME, NUMBER):
             tokval += " "
         if toknum in (NEWLINE, NL):
@@ -334,15 +330,15 @@
     encoding = None
     default = "utf-8"
 
     def read_or_stop() -> bytes:
         try:
             return readline()
         except StopIteration:
-            return bytes()
+            return b''
 
     def find_cookie(line: bytes) -> Optional[str]:
         try:
             line_string = line.decode("ascii")
         except UnicodeDecodeError:
             return None
         match = cookie_re.match(line_string)
@@ -383,15 +379,15 @@
     encoding = find_cookie(second)
     if encoding:
         return encoding, [first, second]
 
     return default, [first, second]
 
 
-def untokenize(iterable: Iterable[TokenInfo]) -> Text:
+def untokenize(iterable: Iterable[TokenInfo]) -> str:
     """Transform tokens back into Python source code.
 
     Each element returned by the iterable must be a token sequence
     with at least two elements, a token number and token value.  If
     only two tokens are passed, the resulting output is poor.
 
     Round-trip invariant for full input:
@@ -406,15 +402,15 @@
         assert t1 == t2
     """
     ut = Untokenizer()
     return ut.untokenize(iterable)
 
 
 def generate_tokens(
-    readline: Callable[[], Text], grammar: Optional[Grammar] = None
+    readline: Callable[[], str], grammar: Optional[Grammar] = None
 ) -> Iterator[GoodTokenInfo]:
     """
     The generate_tokens() generator requires one argument, readline, which
     must be a callable object which provides the same interface as the
     readline() method of built-in file objects. Each call to the function
     should return one line of input as a string.  Alternately, readline
     can be a callable function terminating with StopIteration:
```

### Comparing `cercis-0.1.7/src/cercis/__init__.py` & `cercis-0.2.0/src/cercis/__init__.py`

 * *Files 3% similar despite different names*

```diff
@@ -135,15 +135,17 @@
 ) -> Optional[str]:
     """Inject Cercis configuration from "pyproject.toml" into defaults in `ctx`.
 
     Returns the path to a successfully found and read configuration file, None
     otherwise.
     """
     if not value:
-        value = find_pyproject_toml(ctx.params.get("src", ()))
+        value = find_pyproject_toml(
+            ctx.params.get("src", ()), ctx.params.get("stdin_filename", None)
+        )
         if value is None:
             return None
 
     try:
         config = parse_pyproject_toml(value)
     except (OSError, ValueError) as e:
         raise click.FileError(
@@ -163,14 +165,24 @@
 
     target_version = config.get("target_version")
     if target_version is not None and not isinstance(target_version, list):
         raise click.BadOptionUsage(
             "target-version", "Config key target-version must be a list"
         )
 
+    exclude = config.get("exclude")
+    if exclude is not None and not isinstance(exclude, str):
+        raise click.BadOptionUsage("exclude", "Config key exclude must be a string")
+
+    extend_exclude = config.get("extend_exclude")
+    if extend_exclude is not None and not isinstance(extend_exclude, str):
+        raise click.BadOptionUsage(
+            "extend-exclude", "Config key extend-exclude must be a string"
+        )
+
     default_map: Dict[str, Any] = {}
     if ctx.default_map:
         default_map.update(ctx.default_map)
     default_map.update(config)
 
     ctx.default_map = default_map
     return value
@@ -513,26 +525,30 @@
         "Like --exclude, but files and directories matching this regex will be "
         "excluded even when they are passed explicitly as arguments."
     ),
 )
 @click.option(
     "--stdin-filename",
     type=str,
+    is_eager=True,
     help=(
         "The name of the file when passing it through stdin. Useful to make "
         "sure Cercis will respect --force-exclude option on some "
         "editors that rely on using stdin."
     ),
 )
 @click.option(
     "-W",
     "--workers",
     type=click.IntRange(min=1),
     default=None,
-    help="Number of parallel workers [default: number of CPUs in the system]",
+    help=(
+        "Number of parallel workers [default: CERCIS_NUM_WORKERS environment variable "
+        "or number of CPUs in the system]"
+    ),
 )
 @click.option(
     "-q",
     "--quiet",
     is_flag=True,
     help=(
         "Don't emit non-error messages to stderr. Errors are still emitted; silence"
@@ -640,34 +656,14 @@
     if verbose:
         if root:
             out(
                 f"Identified `{root}` as project root containing a {method}.",
                 fg="blue",
             )
 
-            normalized = [
-                (
-                    (source, source)
-                    if source == "-"
-                    else (normalize_path_maybe_ignore(Path(source), root), source)
-                )
-                for source in src
-            ]
-            srcs_string = ", ".join(
-                [
-                    (
-                        f'"{_norm}"'
-                        if _norm
-                        else f'\033[31m"{source} (skipping - invalid)"\033[34m'
-                    )
-                    for _norm, source in normalized
-                ]
-            )
-            out(f"Sources to be formatted: {srcs_string}", fg="blue")
-
         if config:
             config_source = ctx.get_parameter_source("config")
             user_level_config = str(find_user_pyproject_toml())
             if config == user_level_config:
                 out(
                     "Using configuration from user-level config at "
                     f"'{user_level_config}'.",
@@ -827,17 +823,23 @@
             p = Path(stdin_filename)
             is_stdin = True
         else:
             p = Path(s)
             is_stdin = False
 
         if is_stdin or p.is_file():
-            normalized_path = normalize_path_maybe_ignore(p, ctx.obj["root"], report)
+            normalized_path: Optional[str] = normalize_path_maybe_ignore(
+                p, ctx.obj["root"], report
+            )
             if normalized_path is None:
+                if verbose:
+                    out(f'Skipping invalid source: "{normalized_path}"', fg="red")
                 continue
+            if verbose:
+                out(f'Found input source: "{normalized_path}"', fg="blue")
 
             normalized_path = "/" + normalized_path
             # Hard-exclude any files that matches the `--force-exclude` regex.
             if force_exclude:
                 force_exclude_match = force_exclude.search(normalized_path)
             else:
                 force_exclude_match = None
@@ -852,14 +854,17 @@
                 verbose=verbose, quiet=quiet
             ):
                 continue
 
             sources.add(p)
         elif p.is_dir():
             p = root / normalize_path_maybe_ignore(p, ctx.obj["root"], report)
+            if verbose:
+                out(f'Found input source directory: "{p}"', fg="blue")
+
             if using_default_exclude:
                 gitignore = {
                     root: root_gitignore,
                     p: get_gitignore(p),
                 }
             sources.update(
                 gen_python_files(
@@ -872,17 +877,20 @@
                     report,
                     gitignore,
                     verbose=verbose,
                     quiet=quiet,
                 )
             )
         elif s == "-":
+            if verbose:
+                out("Found input source stdin", fg="blue")
             sources.add(p)
         else:
             err(f"invalid path: {s}")
+
     return sources
 
 
 def path_empty(
         src: Sized, msg: str, quiet: bool, verbose: bool, ctx: click.Context
 ) -> None:
     """
@@ -1582,55 +1590,20 @@
     """Return an empty context manager.
 
     To be used like `nullcontext` in Python 3.7.
     """
     yield
 
 
-def patch_click() -> None:
-    """Make Click not crash on Python 3.6 with LANG=C.
-
-    On certain misconfigured environments, Python 3 selects the ASCII encoding as the
-    default which restricts paths that it can access during the lifetime of the
-    application.  Click refuses to work in this scenario by raising a RuntimeError.
-
-    In case of Cercis the likelihood that non-ASCII characters are going to be used in
-    file paths is minimal since it's Python source code.  Moreover, this crash was
-    spurious on Python 3.7 thanks to PEP 538 and PEP 540.
-    """
-    modules: List[Any] = []
-    try:
-        from click import core
-    except ImportError:
-        pass
-    else:
-        modules.append(core)
-    try:
-        # Removed in Click 8.1.0 and newer; we keep this around for users who have
-        # older versions installed.
-        from click import _unicodefun  # type: ignore
-    except ImportError:
-        pass
-    else:
-        modules.append(_unicodefun)
-
-    for module in modules:
-        if hasattr(module, "_verify_python3_env"):
-            module._verify_python3_env = lambda: None
-        if hasattr(module, "_verify_python_env"):
-            module._verify_python_env = lambda: None
-
-
 def patched_main() -> None:
     # PyInstaller patches multiprocessing to need freeze_support() even in non-Windows
     # environments so just assume we always need to call it if frozen.
     if getattr(sys, "frozen", False):
         from multiprocessing import freeze_support
 
         freeze_support()
 
-    patch_click()
     main()
 
 
 if __name__ == "__main__":
     patched_main()
```

### Comparing `cercis-0.1.7/src/cercis/_width_table.py` & `cercis-0.2.0/src/cercis/_width_table.py`

 * *Files 5% similar despite different names*

```diff
@@ -1,17 +1,11 @@
 # Generated by make_width_table.py
 # wcwidth 0.2.6
 # Unicode 15.0.0
-import sys
-from typing import List, Tuple
-
-if sys.version_info < (3, 8):
-    from typing_extensions import Final
-else:
-    from typing import Final
+from typing import Final, List, Tuple
 
 WIDTH_TABLE: Final[List[Tuple[int, int, int]]] = [
     (0, 0, 0),
     (1, 31, -1),
     (127, 159, -1),
     (768, 879, 0),
     (1155, 1161, 0),
```

### Comparing `cercis-0.1.7/src/cercis/brackets.py` & `cercis-0.2.0/src/cercis/brackets.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,17 +1,11 @@
 """Builds on top of nodes.py to track brackets."""
 
-import sys
 from dataclasses import dataclass, field
-from typing import Dict, Iterable, List, Optional, Sequence, Set, Tuple, Union
-
-if sys.version_info < (3, 8):
-    from typing_extensions import Final
-else:
-    from typing import Final
+from typing import Dict, Final, Iterable, List, Optional, Sequence, Set, Tuple, Union
 
 from blib2to3.pgen2 import token
 from blib2to3.pytree import Leaf, Node
 from cercis.nodes import (
     BRACKET,
     CLOSING_BRACKETS,
     COMPARATORS,
```

### Comparing `cercis-0.1.7/src/cercis/cache.py` & `cercis-0.2.0/src/cercis/cache.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/src/cercis/comments.py` & `cercis-0.2.0/src/cercis/comments.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,17 +1,11 @@
 import re
-import sys
 from dataclasses import dataclass
 from functools import lru_cache
-from typing import Iterator, List, Optional, Union
-
-if sys.version_info >= (3, 8):
-    from typing import Final
-else:
-    from typing_extensions import Final
+from typing import Final, Iterator, List, Optional, Union
 
 from blib2to3.pgen2 import token
 from blib2to3.pytree import Leaf, Node
 from cercis.nodes import (
     CLOSING_BRACKETS,
     STANDALONE_COMMENT,
     WHITESPACE,
```

### Comparing `cercis-0.1.7/src/cercis/concurrency.py` & `cercis-0.2.0/src/cercis/concurrency.py`

 * *Files 2% similar despite different names*

```diff
@@ -76,15 +76,16 @@
         workers: Optional[int],
 ) -> None:
     """Reformat multiple files using a ProcessPoolExecutor."""
     maybe_install_uvloop()
 
     executor: Executor
     if workers is None:
-        workers = os.cpu_count() or 1
+        workers = int(os.environ.get("CERCIS_NUM_WORKERS", 0))
+        workers = workers or os.cpu_count() or 1
     if sys.platform == "win32":
         # Work around https://bugs.python.org/issue26903
         workers = min(workers, 60)
     try:
         executor = ProcessPoolExecutor(max_workers=workers)
     except (ImportError, NotImplementedError, OSError):
         # we arrive here if the underlying system does not support multi-processing
```

### Comparing `cercis-0.1.7/src/cercis/const.py` & `cercis-0.2.0/src/cercis/const.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/src/cercis/debug.py` & `cercis-0.2.0/src/cercis/debug.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/src/cercis/files.py` & `cercis-0.2.0/src/cercis/files.py`

 * *Files 2% similar despite different names*

```diff
@@ -38,15 +38,15 @@
 from cercis.output import err
 from cercis.report import Report
 
 if TYPE_CHECKING:
     import colorama  # noqa: F401
 
 
-@lru_cache()
+@lru_cache
 def find_project_root(
         srcs: Sequence[str], stdin_filename: Optional[str] = None
 ) -> Tuple[Path, str]:
     """Return a directory containing .git, .hg, or pyproject.toml.
 
     That directory will be a common parent of all files and directories
     passed in `srcs`.
@@ -85,17 +85,19 @@
 
         if (directory / "pyproject.toml").is_file():
             return directory, "pyproject.toml"
 
     return directory, "file system root"
 
 
-def find_pyproject_toml(path_search_start: Tuple[str, ...]) -> Optional[str]:
+def find_pyproject_toml(
+        path_search_start: Tuple[str, ...], stdin_filename: Optional[str] = None
+) -> Optional[str]:
     """Find the absolute filepath to a pyproject.toml if it exists"""
-    path_project_root, _ = find_project_root(path_search_start)
+    path_project_root, _ = find_project_root(path_search_start, stdin_filename)
     path_pyproject_toml = path_project_root / "pyproject.toml"
     if path_pyproject_toml.is_file():
         return str(path_pyproject_toml)
 
     try:
         path_user_pyproject_toml = find_user_pyproject_toml()
         return (
@@ -206,15 +208,15 @@
             specifiers.append(s)
         else:
             specifiers.append(s)
 
     return SpecifierSet(",".join(str(s) for s in specifiers))
 
 
-@lru_cache()
+@lru_cache
 def find_user_pyproject_toml() -> Path:
     r"""Return the path to the top-level user configuration for cercis.
 
     This looks for ~\.cercis on Windows and ~/.config/cercis on Linux and other
     Unix systems.
 
     May raise:
@@ -226,15 +228,15 @@
         user_config_path = Path.home() / ".cercis"
     else:
         config_root = os.environ.get("XDG_CONFIG_HOME", "~/.config")
         user_config_path = Path(config_root).expanduser() / "cercis"
     return user_config_path.resolve()
 
 
-@lru_cache()
+@lru_cache
 def get_gitignore(root: Path) -> PathSpec:
     """Return a PathSpec matching gitignore content if present."""
     gitignore = root / ".gitignore"
     lines: List[str] = []
     if gitignore.is_file():
         with gitignore.open(encoding="utf-8") as gf:
             lines = gf.readlines()
@@ -270,23 +272,32 @@
         if report:
             report.path_ignored(path, f"cannot be read because {e}")
         return None
 
     return root_relative_path
 
 
-def path_is_ignored(
-        path: Path, gitignore_dict: Dict[Path, PathSpec], report: Report
+def _path_is_ignored(
+        root_relative_path: str,
+        root: Path,
+        gitignore_dict: Dict[Path, PathSpec],
+        report: Report,
 ) -> bool:
+    path = root / root_relative_path
+    # Note that this logic is sensitive to the ordering of gitignore_dict. Callers must
+    # ensure that gitignore_dict is ordered from least specific to most specific.
     for gitignore_path, pattern in gitignore_dict.items():
-        relative_path = normalize_path_maybe_ignore(path, gitignore_path, report)
-        if relative_path is None:
+        try:
+            relative_path = path.relative_to(gitignore_path).as_posix()
+        except ValueError:
             break
         if pattern.match_file(relative_path):
-            report.path_ignored(path, "matches a .gitignore file content")
+            report.path_ignored(
+                path.relative_to(root), "matches a .gitignore file content"
+            )
             return True
     return False
 
 
 def path_is_excluded(
         normalized_path: str,
         pattern: Optional[Pattern[str]],
@@ -320,15 +331,17 @@
     assert root.is_absolute(), f"INTERNAL ERROR: `root` must be absolute but is {root}"
     for child in paths:
         normalized_path = normalize_path_maybe_ignore(child, root, report)
         if normalized_path is None:
             continue
 
         # First ignore files matching .gitignore, if passed
-        if gitignore_dict and path_is_ignored(child, gitignore_dict, report):
+        if gitignore_dict and _path_is_ignored(
+            normalized_path, root, gitignore_dict, report
+        ):
             continue
 
         # Then ignore with `--exclude` `--extend-exclude` and `--force-exclude` options.
         normalized_path = "/" + normalized_path
         if child.is_dir():
             normalized_path += "/"
```

### Comparing `cercis-0.1.7/src/cercis/handle_ipynb_magics.py` & `cercis-0.2.0/src/cercis/handle_ipynb_magics.py`

 * *Files 1% similar despite different names*

```diff
@@ -51,19 +51,24 @@
 
 @dataclasses.dataclass(frozen=True)
 class Replacement:
     mask: str
     src: str
 
 
-@lru_cache()
+@lru_cache
 def jupyter_dependencies_are_installed(*, verbose: bool, quiet: bool) -> bool:
     try:
-        import IPython  # noqa:F401
+        # isort: off
+        # tokenize_rt is less commonly installed than IPython
+        # and IPython is expensive to import
         import tokenize_rt  # noqa:F401
+        import IPython  # noqa:F401
+
+        # isort: on
     except ModuleNotFoundError:
         if verbose or not quiet:
             msg = (
                 "Skipping .ipynb files as Jupyter dependencies are not installed.\n"
                 'You can fix this by running ``pip install "cercis[jupyter]"``'
             )
             out(msg)
@@ -326,15 +331,16 @@
 
     Note that the source of the abstract syntax tree
     will already have been processed by IPython's
     TransformerManager().transform_cell.
 
     For example,
 
-        %%time\nfoo()
+        %%time\n
+        foo()
 
     would have been transformed to
 
         get_ipython().run_cell_magic('time', '', 'foo()\\n')
 
     and we look for instances of the latter.
     """
```

### Comparing `cercis-0.1.7/src/cercis/indent.py` & `cercis-0.2.0/src/cercis/indent.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/src/cercis/linegen.py` & `cercis-0.2.0/src/cercis/linegen.py`

 * *Files 0% similar despite different names*

```diff
@@ -53,14 +53,15 @@
     is_name_token,
     is_one_sequence_between,
     is_one_tuple,
     is_rpar_token,
     is_stub_body,
     is_stub_suite,
     is_tuple_containing_walrus,
+    is_type_ignore_comment_string,
     is_vararg,
     is_walrus_assignment,
     is_yield,
     syms,
     wrap_in_parentheses,
 )
 from cercis.numerics import normalize_numeric_literal
@@ -1523,16 +1524,21 @@
             return False
 
     first = node.children[0]
     last = node.children[-1]
     if is_lpar_token(first) and is_rpar_token(last):
         middle = node.children[1]
         # make parentheses invisible
-        first.value = ""
-        last.value = ""
+        if (
+            # If the prefix of `middle` includes a type comment with
+            # ignore annotation, then we do not remove the parentheses
+            not is_type_ignore_comment_string(middle.prefix.strip())
+        ):
+            first.value = ""
+            last.value = ""
         maybe_make_parens_invisible_in_atom(
             middle,
             parent=parent,
             remove_brackets_around_comma=remove_brackets_around_comma,
         )
 
         if is_atom_with_invisible_parens(middle):
```

### Comparing `cercis-0.1.7/src/cercis/lines.py` & `cercis-0.2.0/src/cercis/lines.py`

 * *Files 0% similar despite different names*

```diff
@@ -28,14 +28,15 @@
     STANDALONE_COMMENT,
     TEST_DESCENDANTS,
     child_towards,
     is_import,
     is_multiline_string,
     is_one_sequence_between,
     is_type_comment,
+    is_type_ignore_comment,
     is_with_or_async_with_stmt,
     replace_child,
     syms,
     whitespace,
 )
 from cercis.strings import str_width
 
@@ -277,15 +278,15 @@
         # comments before it (since that could cause it to get hidden
         # behind a comment.
         comment_seen = False
         for leaf_id, comments in self.comments.items():
             for comment in comments:
                 if is_type_comment(comment):
                     if comment_seen or (
-                        not is_type_comment(comment, " ignore")
+                        not is_type_ignore_comment(comment)
                         and leaf_id not in ignored_ids
                     ):
                         return True
 
                 comment_seen = True
 
         return False
@@ -324,15 +325,15 @@
 
         if first_line == last_line:
             # We look at the last two leaves since a comma or an
             # invisible paren could have been added at the end of the
             # line.
             for node in self.leaves[-2:]:
                 for comment in self.comments.get(id(node), []):
-                    if is_type_comment(comment, " ignore"):
+                    if is_type_ignore_comment(comment):
                         return True
 
         return False
 
     def calc_comment_length(self) -> int:
         """
         This method is adapted from the wonderful implementation in Pyink:
```

### Comparing `cercis-0.1.7/src/cercis/mode.py` & `cercis-0.2.0/src/cercis/mode.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,26 +1,20 @@
 """Data structures configuring Black behavior.
 
 Mostly around Python language feature support per version and Black configuration
 chosen by the user.
 """
 
-import sys
 from dataclasses import dataclass, field
 from enum import Enum, auto
 from hashlib import sha256
 from operator import attrgetter
-from typing import Dict, Set
+from typing import Dict, Final, Set
 from warnings import warn
 
-if sys.version_info < (3, 8):
-    from typing_extensions import Final
-else:
-    from typing import Final
-
 from cercis.const import (
     DEFAULT_BASE_INDENTATION_SPACES,
     DEFAULT_CLOSING_BRACKET_EXTRA_INDENT,
     DEFAULT_COLLAPSE_NESTED_BRACKETS,
     DEFAULT_FUNCTION_DEFINITION_EXTRA_INDENT,
     DEFAULT_KEEP_BLANK_LINES_IN_BRACKETS,
     DEFAULT_LINE_LENGTH,
```

### Comparing `cercis-0.1.7/src/cercis/nodes.py` & `cercis-0.2.0/src/cercis/nodes.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,18 +1,14 @@
 """
 blib2to3 Node/Leaf transformation-related utility functions.
 """
 
 import sys
-from typing import Generic, Iterator, List, Optional, Set, Tuple, TypeVar, Union
+from typing import Final, Generic, Iterator, List, Optional, Set, Tuple, TypeVar, Union
 
-if sys.version_info >= (3, 8):
-    from typing import Final
-else:
-    from typing_extensions import Final
 if sys.version_info >= (3, 10):
     from typing import TypeGuard
 else:
     from typing_extensions import TypeGuard
 
 from mypy_extensions import mypyc_attr
 
@@ -714,36 +710,45 @@
 def is_multiline_string(leaf: Leaf) -> bool:
     """Return True if `leaf` is a multiline string that actually spans many lines."""
     return has_triple_quotes(leaf.value) and "\n" in leaf.value
 
 
 def is_stub_suite(node: Node) -> bool:
     """Return True if `node` is a suite with a stub body."""
+
+    # If there is a comment, we want to keep it.
+    if node.prefix.strip():
+        return False
+
     if (
         len(node.children) != 4
         or node.children[0].type != token.NEWLINE
         or node.children[1].type != token.INDENT
         or node.children[3].type != token.DEDENT
     ):
         return False
 
+    if node.children[3].prefix.strip():
+        return False
+
     return is_stub_body(node.children[2])
 
 
 def is_stub_body(node: LN) -> bool:
     """Return True if `node` is a simple statement containing an ellipsis."""
     if not isinstance(node, Node) or node.type != syms.simple_stmt:
         return False
 
     if len(node.children) != 2:
         return False
 
     child = node.children[0]
     return (
-        child.type == syms.atom
+        not child.prefix.strip()
+        and child.type == syms.atom
         and len(child.children) == 3
         and all(leaf == Leaf(token.DOT, ".") for leaf in child.children)
     )
 
 
 def is_atom_with_invisible_parens(node: LN) -> bool:
     """Given a `LN`, determines whether it's an atom `node` with invisible
@@ -812,20 +817,35 @@
     return bool(
         leaf.type == token.ASYNC
         and leaf.parent
         and leaf.parent.type in {syms.async_stmt, syms.async_funcdef}
     )
 
 
-def is_type_comment(leaf: Leaf, suffix: str = "") -> bool:
-    """Return True if the given leaf is a special comment.
-    Only returns true for type comments for now."""
+def is_type_comment(leaf: Leaf) -> bool:
+    """Return True if the given leaf is a type comment. This function should only
+    be used for general type comments (excluding ignore annotations, which should
+    use `is_type_ignore_comment`). Note that general type comments are no longer
+    used in modern version of Python, this function may be deprecated in the future."""
     t = leaf.type
     v = leaf.value
-    return t in {token.COMMENT, STANDALONE_COMMENT} and v.startswith("# type:" + suffix)
+    return t in {token.COMMENT, STANDALONE_COMMENT} and v.startswith("# type:")
+
+
+def is_type_ignore_comment(leaf: Leaf) -> bool:
+    """Return True if the given leaf is a type comment with ignore annotation."""
+    t = leaf.type
+    v = leaf.value
+    return t in {token.COMMENT, STANDALONE_COMMENT} and is_type_ignore_comment_string(v)
+
+
+def is_type_ignore_comment_string(value: str) -> bool:
+    """Return True if the given string match with type comment with
+    ignore annotation."""
+    return value.startswith("# type: ignore")
 
 
 def wrap_in_parentheses(parent: Node, child: LN, *, visible: bool = True) -> None:
     """Wrap `child` in parentheses.
 
     This replaces `child` with an atom holding the parentheses and the old
     child.  That requires moving the prefix.
```

### Comparing `cercis-0.1.7/src/cercis/numerics.py` & `cercis-0.2.0/src/cercis/numerics.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/src/cercis/output.py` & `cercis-0.2.0/src/cercis/output.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/src/cercis/parsing.py` & `cercis-0.2.0/src/cercis/parsing.py`

 * *Files 22% similar despite different names*

```diff
@@ -1,48 +1,23 @@
 """
 Parse Python code and perform AST validation.
 """
 import ast
-import platform
 import sys
-from typing import Any, Iterable, Iterator, List, Set, Tuple, Type, Union
-
-if sys.version_info < (3, 8):
-    from typing_extensions import Final
-else:
-    from typing import Final
+from typing import Final, Iterable, Iterator, List, Set, Tuple
 
 from blib2to3 import pygram
 from blib2to3.pgen2 import driver
 from blib2to3.pgen2.grammar import Grammar
 from blib2to3.pgen2.parse import ParseError
 from blib2to3.pgen2.tokenize import TokenError
 from blib2to3.pytree import Leaf, Node
 from cercis.mode import VERSION_TO_FEATURES, Feature, TargetVersion, supports_feature
 from cercis.nodes import syms
 
-ast3: Any
-
-_IS_PYPY = platform.python_implementation() == "PyPy"
-
-try:
-    from typed_ast import ast3
-except ImportError:
-    if sys.version_info < (3, 8) and not _IS_PYPY:
-        print(
-            "The typed_ast package is required but not installed.\n"
-            "You can upgrade to Python 3.8+ or install typed_ast with\n"
-            "`python3 -m pip install typed-ast`.",
-            file=sys.stderr,
-        )
-        sys.exit(1)
-    else:
-        ast3 = ast
-
-
 PY2_HINT: Final = "Python 2 support was removed in version 22.0."
 
 
 class InvalidInput(ValueError):
     """Raised when input source code fails all parse attempts."""
 
 
@@ -143,39 +118,22 @@
     """Given a lib2to3 node, return its string representation."""
     code = str(node)
     return code
 
 
 def parse_single_version(
         src: str, version: Tuple[int, int], *, type_comments: bool
-) -> Union[ast.AST, ast3.AST]:
+) -> ast.AST:
     filename = "<unknown>"
-    # typed-ast is needed because of feature version limitations in the builtin ast 3.8>
-    if sys.version_info >= (3, 8) and version >= (3,):
-        return ast.parse(
-            src, filename, feature_version=version, type_comments=type_comments
-        )
-
-    if _IS_PYPY:
-        # PyPy 3.7 doesn't support type comment tracking which is not ideal, but there's
-        # not much we can do as typed-ast won't work either.
-        if sys.version_info >= (3, 8):
-            return ast3.parse(src, filename, type_comments=type_comments)
-        else:
-            return ast3.parse(src, filename)
-    else:
-        if type_comments:
-            # Typed-ast is guaranteed to be used here and automatically tracks type
-            # comments separately.
-            return ast3.parse(src, filename, feature_version=version[1])
-        else:
-            return ast.parse(src, filename)
+    return ast.parse(
+        src, filename, feature_version=version, type_comments=type_comments
+    )
 
 
-def parse_ast(src: str) -> Union[ast.AST, ast3.AST]:
+def parse_ast(src: str) -> ast.AST:
     # TODO: support Python 4+ ;)
     versions = [(3, minor) for minor in range(3, sys.version_info[1] + 1)]
 
     first_error = ""
     for version in sorted(versions, reverse=True):
         try:
             return parse_single_version(src, version, type_comments=True)
@@ -189,99 +147,81 @@
             return parse_single_version(src, version, type_comments=False)
         except SyntaxError:
             pass
 
     raise SyntaxError(first_error)
 
 
-ast3_AST: Final[Type[ast3.AST]] = ast3.AST
-
-
 def _normalize(lineend: str, value: str) -> str:
     # To normalize, we strip any leading and trailing space from
     # each line...
     stripped: List[str] = [i.strip() for i in value.splitlines()]
     normalized = lineend.join(stripped)
     # ...and remove any blank lines at the beginning and end of
     # the whole string
     return normalized.strip()
 
 
-def stringify_ast(node: Union[ast.AST, ast3.AST], depth: int = 0) -> Iterator[str]:
+def stringify_ast(node: ast.AST, depth: int = 0) -> Iterator[str]:
     """Simple visitor generating strings to compare ASTs by content."""
 
-    node = fixup_ast_constants(node)
+    if (
+        isinstance(node, ast.Constant)
+        and isinstance(node.value, str)
+        and node.kind == "u"
+    ):
+        # It's a quirk of history that we strip the u prefix over here. We used to
+        # rewrite the AST nodes for Python version compatibility and we never copied
+        # over the kind
+        node.kind = None
 
     yield f"{'  ' * depth}{node.__class__.__name__}("
 
-    type_ignore_classes: Tuple[Type[Any], ...]
     for field in sorted(node._fields):  # noqa: F402
-        # TypeIgnore will not be present using pypy < 3.8, so need for this
-        if not (_IS_PYPY and sys.version_info < (3, 8)):
-            # TypeIgnore has only one field 'lineno' which breaks this comparison
-            type_ignore_classes = (ast3.TypeIgnore,)
-            if sys.version_info >= (3, 8):
-                type_ignore_classes += (ast.TypeIgnore,)
-            if isinstance(node, type_ignore_classes):
-                break
+        # TypeIgnore has only one field 'lineno' which breaks this comparison
+        if isinstance(node, ast.TypeIgnore):
+            break
 
         try:
             value: object = getattr(node, field)
         except AttributeError:
             continue
 
         yield f"{'  ' * (depth+1)}{field}="
 
         if isinstance(value, list):
             for item in value:
                 # Ignore nested tuples within del statements, because we may insert
                 # parentheses and they change the AST.
                 if (
                     field == "targets"
-                    and isinstance(node, (ast.Delete, ast3.Delete))
-                    and isinstance(item, (ast.Tuple, ast3.Tuple))
+                    and isinstance(node, ast.Delete)
+                    and isinstance(item, ast.Tuple)
                 ):
                     for elt in item.elts:
                         yield from stringify_ast(elt, depth + 2)
 
-                elif isinstance(item, (ast.AST, ast3.AST)):
+                elif isinstance(item, ast.AST):
                     yield from stringify_ast(item, depth + 2)
 
-        # Note that we are referencing the typed-ast ASTs via global variables and not
-        # direct module attribute accesses because that breaks mypyc. It's probably
-        # something to do with the ast3 variables being marked as Any leading
-        # mypy to think this branch is always taken, leaving the rest of the code
-        # unanalyzed. Tighting up the types for the typed-ast AST types avoids the
-        # mypyc crash.
-        elif isinstance(value, (ast.AST, ast3_AST)):
+        elif isinstance(value, ast.AST):
             yield from stringify_ast(value, depth + 2)
 
         else:
             normalized: object
-            # Constant strings may be indented across newlines, if they are
-            # docstrings; fold spaces after newlines when comparing. Similarly,
-            # trailing and leading space may be removed.
             if (
                 isinstance(node, ast.Constant)
                 and field == "value"
                 and isinstance(value, str)
             ):
+                # Constant strings may be indented across newlines, if they are
+                # docstrings; fold spaces after newlines when comparing. Similarly,
+                # trailing and leading space may be removed.
                 normalized = _normalize("\n", value)
+            elif field == "type_comment" and isinstance(value, str):
+                # Trailing whitespace in type comments is removed.
+                normalized = value.rstrip()
             else:
                 normalized = value
             yield f"{'  ' * (depth+2)}{normalized!r},  # {value.__class__.__name__}"
 
     yield f"{'  ' * depth})  # /{node.__class__.__name__}"
-
-
-def fixup_ast_constants(node: Union[ast.AST, ast3.AST]) -> Union[ast.AST, ast3.AST]:
-    """Map ast nodes deprecated in 3.8 to Constant."""
-    if isinstance(node, (ast.Str, ast3.Str, ast.Bytes, ast3.Bytes)):
-        return ast.Constant(value=node.s)
-
-    if isinstance(node, (ast.Num, ast3.Num)):
-        return ast.Constant(value=node.n)
-
-    if isinstance(node, (ast.NameConstant, ast3.NameConstant)):
-        return ast.Constant(value=node.value)
-
-    return node
```

### Comparing `cercis-0.1.7/src/cercis/report.py` & `cercis-0.2.0/src/cercis/report.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/src/cercis/rusty.py` & `cercis-0.2.0/src/cercis/rusty.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/src/cercis/strings.py` & `cercis-0.2.0/src/cercis/strings.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,23 +1,17 @@
 """
 Simple formatting on strings. Further string formatting code is in trans.py.
 """
 
 import re
 import sys
 from functools import lru_cache
-from typing import List, Match, Pattern
+from typing import Final, List, Match, Pattern
 
 from blib2to3.pytree import Leaf
-
-if sys.version_info < (3, 8):
-    from typing_extensions import Final
-else:
-    from typing import Final
-
 from cercis._width_table import WIDTH_TABLE
 
 STRING_PREFIX_CHARS: Final = "furbFURB"  # All possible string prefix characters.
 STRING_PREFIX_RE: Final = re.compile(
     r"^([" + STRING_PREFIX_CHARS + r"]*)(.*)$", re.DOTALL
 )
 FIRST_NON_WHITESPACE_RE: Final = re.compile(r"\s*\t+\s*(\S)")
```

### Comparing `cercis-0.1.7/src/cercis/trans.py` & `cercis-0.2.0/src/cercis/trans.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,44 +1,39 @@
 """
 String transformers that can split and merge strings.
 """
 import re
-import sys
 from abc import ABC, abstractmethod
 from collections import defaultdict
 from dataclasses import dataclass
 from typing import (
     Any,
     Callable,
     ClassVar,
     Collection,
     Dict,
+    Final,
     Iterable,
     Iterator,
     List,
+    Literal,
     Optional,
     Sequence,
     Set,
     Tuple,
     TypeVar,
     Union,
 )
 
-from cercis.indent import Indent
-
-if sys.version_info < (3, 8):
-    from typing_extensions import Final, Literal
-else:
-    from typing import Literal, Final
-
 from mypy_extensions import trait
 
 from blib2to3.pgen2 import token
 from blib2to3.pytree import Leaf, Node
 from cercis.comments import contains_pragma_comment
+from cercis.indent import Indent
 from cercis.lines import Line, append_leaves
 from cercis.mode import Feature, Mode
 from cercis.nodes import (
     CLOSING_BRACKETS,
     OPENING_BRACKETS,
     STANDALONE_COMMENT,
     is_empty_lpar,
@@ -209,35 +204,35 @@
         self.single_quote = single_quote
 
     @abstractmethod
     def do_match(self, line: Line) -> TMatchResult:
         """
         Returns:
             * Ok(string_indices) such that for each index, `line.leaves[index]`
-            is our target string if a match was able to be made. For
-            transformers that don't result in more lines (e.g. StringMerger,
-            StringParenStripper), multiple matches and transforms are done at
-            once to reduce the complexity.
-                OR
+              is our target string if a match was able to be made. For
+              transformers that don't result in more lines (e.g. StringMerger,
+              StringParenStripper), multiple matches and transforms are done at
+              once to reduce the complexity.
+              OR
             * Err(CannotTransform), if no match could be made.
         """
 
     @abstractmethod
     def do_transform(
             self, line: Line, string_indices: List[int]
     ) -> Iterator[TResult[Line]]:
         """
         Yields:
             * Ok(new_line) where new_line is the new transformed line.
-                OR
+              OR
             * Err(CannotTransform) if the transformation failed for some reason. The
-            `do_match(...)` template method should usually be used to reject
-            the form of the given Line, but in some cases it is difficult to
-            know whether or not a Line meets the StringTransformer's
-            requirements until the transformation is already midway.
+              `do_match(...)` template method should usually be used to reject
+              the form of the given Line, but in some cases it is difficult to
+              know whether or not a Line meets the StringTransformer's
+              requirements until the transformation is already midway.
 
         Side Effects:
             This method should NOT mutate @line directly, but it MAY mutate the
             Line's underlying Node structure. (WARNING: If the underlying Node
             structure IS altered, then this method should NOT be allowed to
             yield an CannotTransform after that point.)
         """
@@ -339,16 +334,16 @@
         self._CUSTOM_SPLIT_MAP[key] = tuple(custom_splits)
 
     def pop_custom_splits(self, string: str) -> List[CustomSplit]:
         """Custom Split Map Getter Method
 
         Returns:
             * A list of the custom splits that are mapped to @string, if any
-            exist.
-                OR
+              exist.
+              OR
             * [], otherwise.
 
         Side Effects:
             Deletes the mapping between @string and its associated custom
             splits (which are returned to the caller).
         """
         key = self._get_key(string)
@@ -369,22 +364,22 @@
 
 class StringMerger(StringTransformer, CustomSplitMapMixin):
     """StringTransformer that merges strings together.
 
     Requirements:
         (A) The line contains adjacent strings such that ALL of the validation checks
         listed in StringMerger._validate_msg(...)'s docstring pass.
-            OR
+        OR
         (B) The line contains a string which uses line continuation backslashes.
 
     Transformations:
         Depending on which of the two requirements above where met, either:
 
         (A) The string group associated with the target string is merged.
-            OR
+        OR
         (B) All line-continuation backslashes are removed from the target string.
 
     Collaborations:
         StringMerger provides custom split information to StringSplitter.
     """
 
     def do_match(self, line: Line) -> TMatchResult:
@@ -972,25 +967,28 @@
     """
     Abstract class for StringTransformers which transform a Line's strings by splitting
     them or placing them on their own lines where necessary to avoid going over
     the configured line length.
 
     Requirements:
         * The target string value is responsible for the line going over the
-        line length limit. It follows that after all of cercis's other line
-        split methods have been exhausted, this line (or one of the resulting
-        lines after all line splits are performed) would still be over the
-        line_length limit unless we split this string.
-            AND
+          line length limit. It follows that after all of Cercis's other line
+          split methods have been exhausted, this line (or one of the resulting
+          lines after all line splits are performed) would still be over the
+          line_length limit unless we split this string.
+          AND
+
         * The target string is NOT a "pointless" string (i.e. a string that has
-        no parent or siblings).
-            AND
+          no parent or siblings).
+          AND
+
         * The target string is not followed by an inline comment that appears
-        to be a pragma.
-            AND
+          to be a pragma.
+          AND
+
         * The target string is not a multiline (i.e. triple-quote) string.
     """
 
     STRING_OPERATORS: Final = [
         token.EQEQUAL,
         token.GREATER,
         token.GREATEREQUAL,
@@ -1034,15 +1032,15 @@
         """
         Checks that @line meets all of the requirements listed in this classes'
         docstring. Refer to `help(BaseStringSplitter)` for a detailed
         description of those requirements.
 
         Returns:
             * Ok(None), if ALL of the requirements are met.
-                OR
+              OR
             * Err(CannotTransform), if ANY of the requirements are NOT met.
         """
         LL = line.leaves
 
         string_leaf = LL[string_idx]
 
         max_string_length = self._get_max_string_length(line, string_idx)
@@ -1306,17 +1304,17 @@
 class StringSplitter(BaseStringSplitter, CustomSplitMapMixin):
     """
     StringTransformer that splits "atom" strings (i.e. strings which exist on
     lines by themselves).
 
     Requirements:
         * The line consists ONLY of a single string (possibly prefixed by a
-        string operator [e.g. '+' or '==']), MAYBE a string trailer, and MAYBE
-        a trailing comma.
-            AND
+          string operator [e.g. '+' or '==']), MAYBE a string trailer, and MAYBE
+          a trailing comma.
+          AND
         * All of the requirements listed in BaseStringSplitter's docstring.
 
     Transformations:
         The string mentioned in the 'Requirements' section is split into as
         many substrings as necessary to adhere to the configured line length.
 
         In the final set of substrings, no substring should be smaller than
@@ -1818,34 +1816,34 @@
     StringTransformer that wraps strings in parens and then splits at the LPAR.
 
     Requirements:
         All of the requirements listed in BaseStringSplitter's docstring in
         addition to the requirements listed below:
 
         * The line is a return/yield statement, which returns/yields a string.
-            OR
+          OR
         * The line is part of a ternary expression (e.g. `x = y if cond else
-        z`) such that the line starts with `else <string>`, where <string> is
-        some string.
-            OR
+          z`) such that the line starts with `else <string>`, where <string> is
+          some string.
+          OR
         * The line is an assert statement, which ends with a string.
-            OR
+          OR
         * The line is an assignment statement (e.g. `x = <string>` or `x +=
-        <string>`) such that the variable is being assigned the value of some
-        string.
-            OR
+          <string>`) such that the variable is being assigned the value of some
+          string.
+          OR
         * The line is a dictionary key assignment where some valid key is being
-        assigned the value of some string.
-            OR
+          assigned the value of some string.
+          OR
         * The line is an lambda expression and the value is a string.
-            OR
+          OR
         * The line starts with an "atom" string that prefers to be wrapped in
-        parens. It's preferred to be wrapped when it's is an immediate child of
-        a list/set/tuple literal, AND the string is surrounded by commas (or is
-        the first/last child).
+          parens. It's preferred to be wrapped when it's is an immediate child of
+          a list/set/tuple literal, AND the string is surrounded by commas (or is
+          the first/last child).
 
     Transformations:
         The chosen string is wrapped in parentheses and then split at the LPAR.
 
         We then have one line which ends with an LPAR and another line that
         starts with the chosen string. The latter line is then split again at
         the RPAR. This results in the RPAR (and possibly a trailing comma)
@@ -2285,33 +2283,33 @@
         """
         Pre-conditions:
             * @leaves[@string_idx].type == token.STRING
 
         Returns:
             The index directly after the last leaf which is apart of the string
             trailer, if a "trailer" exists.
-                OR
+            OR
             @string_idx + 1, if no string "trailer" exists.
         """
         assert leaves[string_idx].type == token.STRING
 
         idx = string_idx + 1
         while idx < len(leaves) and self._next_state(leaves[idx]):
             idx += 1
         return idx
 
     def _next_state(self, leaf: Leaf) -> bool:
         """
         Pre-conditions:
             * On the first call to this function, @leaf MUST be the leaf that
-            was directly after the string leaf in question (e.g. if our target
-            string is `line.leaves[i]` then the first call to this method must
-            be `line.leaves[i + 1]`).
+              was directly after the string leaf in question (e.g. if our target
+              string is `line.leaves[i]` then the first call to this method must
+              be `line.leaves[i + 1]`).
             * On the next call to this function, the leaf parameter passed in
-            MUST be the leaf directly following @leaf.
+              MUST be the leaf directly following @leaf.
 
         Returns:
             True iff @leaf is apart of the string's trailer.
         """
         # We ignore empty LPAR or RPAR leaves.
         if is_empty_par(leaf):
             return True
```

### Comparing `cercis-0.1.7/src/cercis/utils_line_wrapping.py` & `cercis-0.2.0/src/cercis/utils_line_wrapping.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/src/cercis/utils_linegen.py` & `cercis-0.2.0/src/cercis/utils_linegen.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/optional.py` & `cercis-0.2.0/tests/optional.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/test_black.py` & `cercis-0.2.0/tests/test_black.py`

 * *Files 2% similar despite different names*

```diff
@@ -152,6229 +152,6237 @@
 00000970: 6361 6c6c 696e 6720 6675 6e63 7469 6f6e  calling function
 00000980: 7320 7468 6174 206e 6565 6420 6974 2e22  s that need it."
 00000990: 2222 0a0a 2020 2020 6465 6620 5f5f 696e  ""..    def __in
 000009a0: 6974 5f5f 2873 656c 6629 202d 3e20 4e6f  it__(self) -> No
 000009b0: 6e65 3a0a 2020 2020 2020 2020 7365 6c66  ne:.        self
 000009c0: 2e64 6566 6175 6c74 5f6d 6170 3a20 4469  .default_map: Di
 000009d0: 6374 5b73 7472 2c20 416e 795d 203d 207b  ct[str, Any] = {
-000009e0: 7d0a 2020 2020 2020 2020 2320 4475 6d6d  }.        # Dumm
-000009f0: 7920 726f 6f74 2c20 7369 6e63 6520 6d6f  y root, since mo
-00000a00: 7374 206f 6620 7468 6520 7465 7374 7320  st of the tests 
-00000a10: 646f 6e27 7420 6361 7265 2061 626f 7574  don't care about
-00000a20: 2069 740a 2020 2020 2020 2020 7365 6c66   it.        self
-00000a30: 2e6f 626a 3a20 4469 6374 5b73 7472 2c20  .obj: Dict[str, 
-00000a40: 416e 795d 203d 207b 2272 6f6f 7422 3a20  Any] = {"root": 
-00000a50: 5052 4f4a 4543 545f 524f 4f54 7d0a 0a0a  PROJECT_ROOT}...
-00000a60: 636c 6173 7320 4661 6b65 5061 7261 6d65  class FakeParame
-00000a70: 7465 7228 636c 6963 6b2e 5061 7261 6d65  ter(click.Parame
-00000a80: 7465 7229 3a0a 2020 2020 2222 2241 2066  ter):.    """A f
-00000a90: 616b 6520 636c 6963 6b20 5061 7261 6d65  ake click Parame
-00000aa0: 7465 7220 666f 7220 7768 656e 2063 616c  ter for when cal
-00000ab0: 6c69 6e67 2066 756e 6374 696f 6e73 2074  ling functions t
-00000ac0: 6861 7420 6e65 6564 2069 742e 2222 220a  hat need it.""".
-00000ad0: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
-00000ae0: 5f28 7365 6c66 2920 2d3e 204e 6f6e 653a  _(self) -> None:
-00000af0: 0a20 2020 2020 2020 2070 6173 730a 0a0a  .        pass...
-00000b00: 636c 6173 7320 426c 6163 6b52 756e 6e65  class BlackRunne
-00000b10: 7228 436c 6952 756e 6e65 7229 3a0a 2020  r(CliRunner):.  
-00000b20: 2020 2222 224d 616b 6520 7375 7265 2053    """Make sure S
-00000b30: 5444 4f55 5420 616e 6420 5354 4445 5252  TDOUT and STDERR
-00000b40: 2061 7265 206b 6570 7420 7365 7061 7261   are kept separa
-00000b50: 7465 2077 6865 6e20 7465 7374 696e 6720  te when testing 
-00000b60: 426c 6163 6b20 7669 6120 6974 7320 434c  Black via its CL
-00000b70: 492e 2222 220a 0a20 2020 2064 6566 205f  I."""..    def _
-00000b80: 5f69 6e69 745f 5f28 7365 6c66 2920 2d3e  _init__(self) ->
-00000b90: 204e 6f6e 653a 0a20 2020 2020 2020 2073   None:.        s
-00000ba0: 7570 6572 2829 2e5f 5f69 6e69 745f 5f28  uper().__init__(
-00000bb0: 6d69 785f 7374 6465 7272 3d46 616c 7365  mix_stderr=False
-00000bc0: 290a 0a0a 6465 6620 696e 766f 6b65 426c  )...def invokeBl
-00000bd0: 6163 6b28 0a20 2020 2020 2020 2061 7267  ack(.        arg
-00000be0: 733a 204c 6973 745b 7374 725d 2c20 6578  s: List[str], ex
-00000bf0: 6974 5f63 6f64 653a 2069 6e74 203d 2030  it_code: int = 0
-00000c00: 2c20 6967 6e6f 7265 5f63 6f6e 6669 673a  , ignore_config:
-00000c10: 2062 6f6f 6c20 3d20 5472 7565 0a29 202d   bool = True.) -
-00000c20: 3e20 4e6f 6e65 3a0a 2020 2020 7275 6e6e  > None:.    runn
-00000c30: 6572 203d 2042 6c61 636b 5275 6e6e 6572  er = BlackRunner
-00000c40: 2829 0a20 2020 2069 6620 6967 6e6f 7265  ().    if ignore
-00000c50: 5f63 6f6e 6669 673a 0a20 2020 2020 2020  _config:.       
-00000c60: 2061 7267 7320 3d20 5b22 2d2d 7665 7262   args = ["--verb
-00000c70: 6f73 6522 2c20 222d 2d63 6f6e 6669 6722  ose", "--config"
-00000c80: 2c20 7374 7228 5448 4953 5f44 4952 202f  , str(THIS_DIR /
-00000c90: 2022 656d 7074 792e 746f 6d6c 2229 2c20   "empty.toml"), 
-00000ca0: 2a61 7267 735d 0a20 2020 2072 6573 756c  *args].    resul
-00000cb0: 7420 3d20 7275 6e6e 6572 2e69 6e76 6f6b  t = runner.invok
-00000cc0: 6528 6365 7263 6973 2e6d 6169 6e2c 2061  e(cercis.main, a
-00000cd0: 7267 732c 2063 6174 6368 5f65 7863 6570  rgs, catch_excep
-00000ce0: 7469 6f6e 733d 4661 6c73 6529 0a20 2020  tions=False).   
-00000cf0: 2061 7373 6572 7420 7265 7375 6c74 2e73   assert result.s
-00000d00: 7464 6f75 745f 6279 7465 7320 6973 206e  tdout_bytes is n
-00000d10: 6f74 204e 6f6e 650a 2020 2020 6173 7365  ot None.    asse
-00000d20: 7274 2072 6573 756c 742e 7374 6465 7272  rt result.stderr
-00000d30: 5f62 7974 6573 2069 7320 6e6f 7420 4e6f  _bytes is not No
-00000d40: 6e65 0a20 2020 206d 7367 203d 2028 0a20  ne.    msg = (. 
-00000d50: 2020 2020 2020 2066 2246 6169 6c65 6420         f"Failed 
-00000d60: 7769 7468 2061 7267 733a 207b 6172 6773  with args: {args
-00000d70: 7d5c 6e22 0a20 2020 2020 2020 2066 2273  }\n".        f"s
-00000d80: 7464 6f75 743a 207b 7265 7375 6c74 2e73  tdout: {result.s
-00000d90: 7464 6f75 745f 6279 7465 732e 6465 636f  tdout_bytes.deco
-00000da0: 6465 2829 2172 7d5c 6e22 0a20 2020 2020  de()!r}\n".     
-00000db0: 2020 2066 2273 7464 6572 723a 207b 7265     f"stderr: {re
-00000dc0: 7375 6c74 2e73 7464 6572 725f 6279 7465  sult.stderr_byte
-00000dd0: 732e 6465 636f 6465 2829 2172 7d5c 6e22  s.decode()!r}\n"
-00000de0: 0a20 2020 2020 2020 2066 2265 7863 6570  .        f"excep
-00000df0: 7469 6f6e 3a20 7b72 6573 756c 742e 6578  tion: {result.ex
-00000e00: 6365 7074 696f 6e7d 220a 2020 2020 290a  ception}".    ).
-00000e10: 2020 2020 6173 7365 7274 2072 6573 756c      assert resul
-00000e20: 742e 6578 6974 5f63 6f64 6520 3d3d 2065  t.exit_code == e
-00000e30: 7869 745f 636f 6465 2c20 6d73 670a 0a0a  xit_code, msg...
-00000e40: 636c 6173 7320 426c 6163 6b54 6573 7443  class BlackTestC
-00000e50: 6173 6528 426c 6163 6b42 6173 6554 6573  ase(BlackBaseTes
-00000e60: 7443 6173 6529 3a0a 2020 2020 696e 766f  tCase):.    invo
-00000e70: 6b65 426c 6163 6b20 3d20 7374 6174 6963  keBlack = static
-00000e80: 6d65 7468 6f64 2869 6e76 6f6b 6542 6c61  method(invokeBla
-00000e90: 636b 290a 0a20 2020 2064 6566 2074 6573  ck)..    def tes
-00000ea0: 745f 656d 7074 795f 6666 2873 656c 6629  t_empty_ff(self)
-00000eb0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-00000ec0: 2020 6578 7065 6374 6564 203d 2022 220a    expected = "".
-00000ed0: 2020 2020 2020 2020 746d 705f 6669 6c65          tmp_file
-00000ee0: 203d 2050 6174 6828 6365 7263 6973 2e64   = Path(cercis.d
-00000ef0: 756d 705f 746f 5f66 696c 6528 2929 0a20  ump_to_file()). 
-00000f00: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-00000f10: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00000f20: 6572 7446 616c 7365 2866 6628 746d 705f  ertFalse(ff(tmp_
-00000f30: 6669 6c65 2c20 7772 6974 655f 6261 636b  file, write_back
-00000f40: 3d63 6572 6369 732e 5772 6974 6542 6163  =cercis.WriteBac
-00000f50: 6b2e 5945 5329 290a 2020 2020 2020 2020  k.YES)).        
-00000f60: 2020 2020 7769 7468 206f 7065 6e28 746d      with open(tm
-00000f70: 705f 6669 6c65 2c20 656e 636f 6469 6e67  p_file, encoding
-00000f80: 3d22 7574 6638 2229 2061 7320 663a 0a20  ="utf8") as f:. 
-00000f90: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00000fa0: 6374 7561 6c20 3d20 662e 7265 6164 2829  ctual = f.read()
-00000fb0: 0a20 2020 2020 2020 2066 696e 616c 6c79  .        finally
-00000fc0: 3a0a 2020 2020 2020 2020 2020 2020 6f73  :.            os
-00000fd0: 2e75 6e6c 696e 6b28 746d 705f 6669 6c65  .unlink(tmp_file
-00000fe0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00000ff0: 7373 6572 7446 6f72 6d61 7445 7175 616c  ssertFormatEqual
-00001000: 2865 7870 6563 7465 642c 2061 6374 7561  (expected, actua
-00001010: 6c29 0a0a 2020 2020 4070 6174 6368 2822  l)..    @patch("
-00001020: 6365 7263 6973 2e64 756d 705f 746f 5f66  cercis.dump_to_f
-00001030: 696c 6522 2c20 6475 6d70 5f74 6f5f 7374  ile", dump_to_st
-00001040: 6465 7272 290a 2020 2020 6465 6620 7465  derr).    def te
-00001050: 7374 5f6f 6e65 5f65 6d70 7479 5f6c 696e  st_one_empty_lin
-00001060: 6528 7365 6c66 2920 2d3e 204e 6f6e 653a  e(self) -> None:
-00001070: 0a20 2020 2020 2020 206d 6f64 6520 3d20  .        mode = 
-00001080: 6365 7263 6973 2e4d 6f64 6528 7072 6576  cercis.Mode(prev
-00001090: 6965 773d 5472 7565 290a 2020 2020 2020  iew=True).      
-000010a0: 2020 666f 7220 6e6c 2069 6e20 5b22 5c6e    for nl in ["\n
-000010b0: 222c 2022 5c72 5c6e 225d 3a0a 2020 2020  ", "\r\n"]:.    
-000010c0: 2020 2020 2020 2020 736f 7572 6365 203d          source =
-000010d0: 2065 7870 6563 7465 6420 3d20 6e6c 0a20   expected = nl. 
-000010e0: 2020 2020 2020 2020 2020 2061 7373 6572             asser
-000010f0: 745f 666f 726d 6174 2873 6f75 7263 652c  t_format(source,
-00001100: 2065 7870 6563 7465 642c 206d 6f64 653d   expected, mode=
-00001110: 6d6f 6465 290a 0a20 2020 2064 6566 2074  mode)..    def t
-00001120: 6573 745f 6f6e 655f 656d 7074 795f 6c69  est_one_empty_li
-00001130: 6e65 5f66 6628 7365 6c66 2920 2d3e 204e  ne_ff(self) -> N
-00001140: 6f6e 653a 0a20 2020 2020 2020 206d 6f64  one:.        mod
-00001150: 6520 3d20 6365 7263 6973 2e4d 6f64 6528  e = cercis.Mode(
-00001160: 7072 6576 6965 773d 5472 7565 290a 2020  preview=True).  
-00001170: 2020 2020 2020 666f 7220 6e6c 2069 6e20        for nl in 
-00001180: 5b22 5c6e 222c 2022 5c72 5c6e 225d 3a0a  ["\n", "\r\n"]:.
-00001190: 2020 2020 2020 2020 2020 2020 6578 7065              expe
-000011a0: 6374 6564 203d 206e 6c0a 2020 2020 2020  cted = nl.      
-000011b0: 2020 2020 2020 746d 705f 6669 6c65 203d        tmp_file =
-000011c0: 2050 6174 6828 6365 7263 6973 2e64 756d   Path(cercis.dum
-000011d0: 705f 746f 5f66 696c 6528 6e6c 2929 0a20  p_to_file(nl)). 
-000011e0: 2020 2020 2020 2020 2020 2069 6620 7379             if sy
-000011f0: 7374 656d 2829 203d 3d20 2257 696e 646f  stem() == "Windo
-00001200: 7773 223a 0a20 2020 2020 2020 2020 2020  ws":.           
-00001210: 2020 2020 2023 2057 7269 7469 6e67 2066       # Writing f
-00001220: 696c 6573 2069 6e20 7465 7874 206d 6f64  iles in text mod
-00001230: 6520 6175 746f 6d61 7469 6361 6c6c 7920  e automatically 
-00001240: 7573 6573 2074 6865 2073 7973 7465 6d20  uses the system 
-00001250: 6e65 776c 696e 652c 0a20 2020 2020 2020  newline,.       
-00001260: 2020 2020 2020 2020 2023 2062 7574 2069           # but i
-00001270: 6e20 7468 6973 2063 6173 6520 7765 2064  n this case we d
-00001280: 6f6e 2774 2077 616e 7420 7468 6973 2066  on't want this f
-00001290: 6f72 2074 6573 7469 6e67 2072 6561 736f  or testing reaso
-000012a0: 6e73 2e20 5365 653a 0a20 2020 2020 2020  ns. See:.       
-000012b0: 2020 2020 2020 2020 2023 2068 7474 7073           # https
-000012c0: 3a2f 2f67 6974 6875 622e 636f 6d2f 7073  ://github.com/ps
-000012d0: 662f 626c 6163 6b2f 7075 6c6c 2f33 3334  f/black/pull/334
-000012e0: 380a 2020 2020 2020 2020 2020 2020 2020  8.              
-000012f0: 2020 7769 7468 206f 7065 6e28 746d 705f    with open(tmp_
-00001300: 6669 6c65 2c20 2277 6222 2920 6173 2066  file, "wb") as f
-00001310: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00001320: 2020 2020 2020 662e 7772 6974 6528 6e6c        f.write(nl
-00001330: 2e65 6e63 6f64 6528 2275 7466 2d38 2229  .encode("utf-8")
-00001340: 290a 2020 2020 2020 2020 2020 2020 7472  ).            tr
-00001350: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
-00001360: 2020 2073 656c 662e 6173 7365 7274 4661     self.assertFa
-00001370: 6c73 6528 0a20 2020 2020 2020 2020 2020  lse(.           
-00001380: 2020 2020 2020 2020 2066 6628 746d 705f           ff(tmp_
-00001390: 6669 6c65 2c20 6d6f 6465 3d6d 6f64 652c  file, mode=mode,
-000013a0: 2077 7269 7465 5f62 6163 6b3d 6365 7263   write_back=cerc
-000013b0: 6973 2e57 7269 7465 4261 636b 2e59 4553  is.WriteBack.YES
-000013c0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000013d0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-000013e0: 2020 2020 7769 7468 206f 7065 6e28 746d      with open(tm
-000013f0: 705f 6669 6c65 2c20 2272 6222 2920 6173  p_file, "rb") as
-00001400: 2066 3a0a 2020 2020 2020 2020 2020 2020   f:.            
-00001410: 2020 2020 2020 2020 6163 7475 616c 203d          actual =
-00001420: 2066 2e72 6561 6428 292e 6465 636f 6465   f.read().decode
-00001430: 2822 7574 6638 2229 0a20 2020 2020 2020  ("utf8").       
-00001440: 2020 2020 2066 696e 616c 6c79 3a0a 2020       finally:.  
-00001450: 2020 2020 2020 2020 2020 2020 2020 6f73                os
-00001460: 2e75 6e6c 696e 6b28 746d 705f 6669 6c65  .unlink(tmp_file
-00001470: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-00001480: 6c66 2e61 7373 6572 7446 6f72 6d61 7445  lf.assertFormatE
-00001490: 7175 616c 2865 7870 6563 7465 642c 2061  qual(expected, a
-000014a0: 6374 7561 6c29 0a0a 2020 2020 6465 6620  ctual)..    def 
-000014b0: 7465 7374 5f65 7870 6572 696d 656e 7461  test_experimenta
-000014c0: 6c5f 7374 7269 6e67 5f70 726f 6365 7373  l_string_process
-000014d0: 696e 675f 7761 726e 7328 7365 6c66 2920  ing_warns(self) 
-000014e0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-000014f0: 2073 656c 662e 6173 7365 7274 5761 726e   self.assertWarn
-00001500: 7328 0a20 2020 2020 2020 2020 2020 2063  s(.            c
-00001510: 6572 6369 732e 6d6f 6465 2e44 6570 7265  ercis.mode.Depre
-00001520: 6361 7465 642c 2063 6572 6369 732e 4d6f  cated, cercis.Mo
-00001530: 6465 2c20 6578 7065 7269 6d65 6e74 616c  de, experimental
-00001540: 5f73 7472 696e 675f 7072 6f63 6573 7369  _string_processi
-00001550: 6e67 3d54 7275 650a 2020 2020 2020 2020  ng=True.        
-00001560: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
-00001570: 7069 7069 6e67 2873 656c 6629 202d 3e20  piping(self) -> 
-00001580: 4e6f 6e65 3a0a 2020 2020 2020 2020 736f  None:.        so
-00001590: 7572 6365 2c20 6578 7065 6374 6564 203d  urce, expected =
-000015a0: 2072 6561 645f 6461 7461 5f66 726f 6d5f   read_data_from_
-000015b0: 6669 6c65 2850 524f 4a45 4354 5f52 4f4f  file(PROJECT_ROO
-000015c0: 5420 2f20 2273 7263 2f63 6572 6369 732f  T / "src/cercis/
-000015d0: 5f5f 696e 6974 5f5f 2e70 7922 290a 2020  __init__.py").  
-000015e0: 2020 2020 2020 7265 7375 6c74 203d 2042        result = B
-000015f0: 6c61 636b 5275 6e6e 6572 2829 2e69 6e76  lackRunner().inv
-00001600: 6f6b 6528 0a20 2020 2020 2020 2020 2020  oke(.           
-00001610: 2063 6572 6369 732e 6d61 696e 2c0a 2020   cercis.main,.  
-00001620: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
-00001630: 2020 2020 2020 2020 2020 2020 222d 222c              "-",
-00001640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001650: 2022 2d2d 6661 7374 222c 0a20 2020 2020   "--fast",.     
-00001660: 2020 2020 2020 2020 2020 2022 2d2d 6c69             "--li
-00001670: 6e65 2d6c 656e 6774 683d 3838 222c 0a20  ne-length=88",. 
-00001680: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00001690: 222d 2d63 6f6e 6669 673d 7b45 4d50 5459  "--config={EMPTY
-000016a0: 5f43 4f4e 4649 477d 222c 0a20 2020 2020  _CONFIG}",.     
-000016b0: 2020 2020 2020 2020 2020 2022 2d2d 7369             "--si
-000016c0: 6e67 6c65 2d71 756f 7465 3d46 616c 7365  ngle-quote=False
-000016d0: 222c 0a20 2020 2020 2020 2020 2020 205d  ",.            ]
-000016e0: 2c0a 2020 2020 2020 2020 2020 2020 696e  ,.            in
-000016f0: 7075 743d 4279 7465 7349 4f28 736f 7572  put=BytesIO(sour
-00001700: 6365 2e65 6e63 6f64 6528 2275 7466 3822  ce.encode("utf8"
-00001710: 2929 2c0a 2020 2020 2020 2020 290a 2020  )),.        ).  
-00001720: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00001730: 7445 7175 616c 2872 6573 756c 742e 6578  tEqual(result.ex
-00001740: 6974 5f63 6f64 652c 2030 290a 2020 2020  it_code, 0).    
-00001750: 2020 2020 7365 6c66 2e61 7373 6572 7446      self.assertF
-00001760: 6f72 6d61 7445 7175 616c 2865 7870 6563  ormatEqual(expec
-00001770: 7465 642c 2072 6573 756c 742e 6f75 7470  ted, result.outp
-00001780: 7574 290a 2020 2020 2020 2020 6966 2073  ut).        if s
-00001790: 6f75 7263 6520 213d 2072 6573 756c 742e  ource != result.
-000017a0: 6f75 7470 7574 3a0a 2020 2020 2020 2020  output:.        
-000017b0: 2020 2020 6365 7263 6973 2e61 7373 6572      cercis.asser
-000017c0: 745f 6571 7569 7661 6c65 6e74 2873 6f75  t_equivalent(sou
-000017d0: 7263 652c 2072 6573 756c 742e 6f75 7470  rce, result.outp
-000017e0: 7574 290a 2020 2020 2020 2020 2020 2020  ut).            
-000017f0: 6365 7263 6973 2e61 7373 6572 745f 7374  cercis.assert_st
-00001800: 6162 6c65 2873 6f75 7263 652c 2072 6573  able(source, res
-00001810: 756c 742e 6f75 7470 7574 2c20 4445 4641  ult.output, DEFA
-00001820: 554c 545f 4d4f 4445 290a 0a20 2020 2064  ULT_MODE)..    d
-00001830: 6566 2074 6573 745f 7069 7069 6e67 5f64  ef test_piping_d
-00001840: 6966 6628 7365 6c66 2920 2d3e 204e 6f6e  iff(self) -> Non
-00001850: 653a 0a20 2020 2020 2020 2064 6966 665f  e:.        diff_
-00001860: 6865 6164 6572 203d 2072 652e 636f 6d70  header = re.comp
-00001870: 696c 6528 0a20 2020 2020 2020 2020 2020  ile(.           
-00001880: 2072 2228 5354 4449 4e7c 5354 444f 5554   r"(STDIN|STDOUT
-00001890: 295c 745c 645c 645c 645c 642d 5c64 5c64  )\t\d\d\d\d-\d\d
-000018a0: 2d5c 645c 6420 5c64 5c64 3a5c 645c 643a  -\d\d \d\d:\d\d:
-000018b0: 5c64 5c64 5c2e 5c64 5c64 5c64 5c64 5c64  \d\d\.\d\d\d\d\d
-000018c0: 5c64 220a 2020 2020 2020 2020 2020 2020  \d".            
-000018d0: 7222 5c2b 5c64 5c64 3a5c 645c 6422 0a20  r"\+\d\d:\d\d". 
-000018e0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000018f0: 2073 6f75 7263 652c 205f 203d 2072 6561   source, _ = rea
-00001900: 645f 6461 7461 2822 7369 6d70 6c65 5f63  d_data("simple_c
-00001910: 6173 6573 222c 2022 6578 7072 6573 7369  ases", "expressi
-00001920: 6f6e 2e70 7922 290a 2020 2020 2020 2020  on.py").        
-00001930: 6578 7065 6374 6564 2c20 5f20 3d20 7265  expected, _ = re
-00001940: 6164 5f64 6174 6128 2273 696d 706c 655f  ad_data("simple_
-00001950: 6361 7365 7322 2c20 2265 7870 7265 7373  cases", "express
-00001960: 696f 6e2e 6469 6666 2229 0a20 2020 2020  ion.diff").     
-00001970: 2020 2061 7267 7320 3d20 5b0a 2020 2020     args = [.    
-00001980: 2020 2020 2020 2020 222d 222c 0a20 2020          "-",.   
-00001990: 2020 2020 2020 2020 2022 2d2d 6661 7374           "--fast
-000019a0: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
-000019b0: 2d2d 6c69 6e65 2d6c 656e 6774 683d 3838  --line-length=88
-000019c0: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
-000019d0: 2d2d 6469 6666 222c 0a20 2020 2020 2020  --diff",.       
-000019e0: 2020 2020 2066 222d 2d63 6f6e 6669 673d       f"--config=
-000019f0: 7b45 4d50 5459 5f43 4f4e 4649 477d 222c  {EMPTY_CONFIG}",
-00001a00: 0a20 2020 2020 2020 205d 0a20 2020 2020  .        ].     
-00001a10: 2020 2072 6573 756c 7420 3d20 426c 6163     result = Blac
-00001a20: 6b52 756e 6e65 7228 292e 696e 766f 6b65  kRunner().invoke
-00001a30: 280a 2020 2020 2020 2020 2020 2020 6365  (.            ce
-00001a40: 7263 6973 2e6d 6169 6e2c 2061 7267 732c  rcis.main, args,
-00001a50: 2069 6e70 7574 3d42 7974 6573 494f 2873   input=BytesIO(s
-00001a60: 6f75 7263 652e 656e 636f 6465 2822 7574  ource.encode("ut
-00001a70: 6638 2229 290a 2020 2020 2020 2020 290a  f8")).        ).
-00001a80: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00001a90: 6572 7445 7175 616c 2872 6573 756c 742e  ertEqual(result.
-00001aa0: 6578 6974 5f63 6f64 652c 2030 290a 2020  exit_code, 0).  
-00001ab0: 2020 2020 2020 6163 7475 616c 203d 2064        actual = d
-00001ac0: 6966 665f 6865 6164 6572 2e73 7562 2844  iff_header.sub(D
-00001ad0: 4554 4552 4d49 4e49 5354 4943 5f48 4541  ETERMINISTIC_HEA
-00001ae0: 4445 522c 2072 6573 756c 742e 6f75 7470  DER, result.outp
-00001af0: 7574 290a 2020 2020 2020 2020 6163 7475  ut).        actu
-00001b00: 616c 203d 2061 6374 7561 6c2e 7273 7472  al = actual.rstr
-00001b10: 6970 2829 202b 2022 5c6e 2220 2023 2074  ip() + "\n"  # t
-00001b20: 6865 2064 6966 6620 6f75 7470 7574 2068  he diff output h
-00001b30: 6173 2061 2074 7261 696c 696e 6720 7370  as a trailing sp
-00001b40: 6163 650a 2020 2020 2020 2020 7365 6c66  ace.        self
-00001b50: 2e61 7373 6572 7445 7175 616c 2865 7870  .assertEqual(exp
-00001b60: 6563 7465 642c 2061 6374 7561 6c29 0a0a  ected, actual)..
-00001b70: 2020 2020 6465 6620 7465 7374 5f70 6970      def test_pip
-00001b80: 696e 675f 6469 6666 5f77 6974 685f 636f  ing_diff_with_co
-00001b90: 6c6f 7228 7365 6c66 2920 2d3e 204e 6f6e  lor(self) -> Non
-00001ba0: 653a 0a20 2020 2020 2020 2073 6f75 7263  e:.        sourc
-00001bb0: 652c 205f 203d 2072 6561 645f 6461 7461  e, _ = read_data
-00001bc0: 2822 7369 6d70 6c65 5f63 6173 6573 222c  ("simple_cases",
-00001bd0: 2022 6578 7072 6573 7369 6f6e 2e70 7922   "expression.py"
-00001be0: 290a 2020 2020 2020 2020 6172 6773 203d  ).        args =
-00001bf0: 205b 0a20 2020 2020 2020 2020 2020 2022   [.            "
-00001c00: 2d22 2c0a 2020 2020 2020 2020 2020 2020  -",.            
-00001c10: 222d 2d66 6173 7422 2c0a 2020 2020 2020  "--fast",.      
-00001c20: 2020 2020 2020 222d 2d6c 696e 652d 6c65        "--line-le
-00001c30: 6e67 7468 3d38 3822 2c0a 2020 2020 2020  ngth=88",.      
-00001c40: 2020 2020 2020 222d 2d64 6966 6622 2c0a        "--diff",.
-00001c50: 2020 2020 2020 2020 2020 2020 222d 2d63              "--c
-00001c60: 6f6c 6f72 222c 0a20 2020 2020 2020 2020  olor",.         
-00001c70: 2020 2066 222d 2d63 6f6e 6669 673d 7b45     f"--config={E
-00001c80: 4d50 5459 5f43 4f4e 4649 477d 222c 0a20  MPTY_CONFIG}",. 
-00001c90: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
-00001ca0: 2072 6573 756c 7420 3d20 426c 6163 6b52   result = BlackR
-00001cb0: 756e 6e65 7228 292e 696e 766f 6b65 280a  unner().invoke(.
-00001cc0: 2020 2020 2020 2020 2020 2020 6365 7263              cerc
-00001cd0: 6973 2e6d 6169 6e2c 2061 7267 732c 2069  is.main, args, i
-00001ce0: 6e70 7574 3d42 7974 6573 494f 2873 6f75  nput=BytesIO(sou
-00001cf0: 7263 652e 656e 636f 6465 2822 7574 6638  rce.encode("utf8
-00001d00: 2229 290a 2020 2020 2020 2020 290a 2020  ")).        ).  
-00001d10: 2020 2020 2020 6163 7475 616c 203d 2072        actual = r
-00001d20: 6573 756c 742e 6f75 7470 7574 0a20 2020  esult.output.   
-00001d30: 2020 2020 2023 2041 6761 696e 2c20 7468       # Again, th
-00001d40: 6520 636f 6e74 656e 7473 2061 7265 2063  e contents are c
-00001d50: 6865 636b 6564 2069 6e20 6120 6469 6666  hecked in a diff
-00001d60: 6572 656e 7420 7465 7374 2c20 736f 206f  erent test, so o
-00001d70: 6e6c 7920 6c6f 6f6b 2066 6f72 2063 6f6c  nly look for col
-00001d80: 6f72 732e 0a20 2020 2020 2020 2073 656c  ors..        sel
-00001d90: 662e 6173 7365 7274 496e 2822 5c30 3333  f.assertIn("\033
-00001da0: 5b31 6d22 2c20 6163 7475 616c 290a 2020  [1m", actual).  
-00001db0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-00001dc0: 7449 6e28 225c 3033 335b 3336 6d22 2c20  tIn("\033[36m", 
-00001dd0: 6163 7475 616c 290a 2020 2020 2020 2020  actual).        
-00001de0: 7365 6c66 2e61 7373 6572 7449 6e28 225c  self.assertIn("\
-00001df0: 3033 335b 3332 6d22 2c20 6163 7475 616c  033[32m", actual
-00001e00: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00001e10: 7373 6572 7449 6e28 225c 3033 335b 3331  ssertIn("\033[31
-00001e20: 6d22 2c20 6163 7475 616c 290a 2020 2020  m", actual).    
-00001e30: 2020 2020 7365 6c66 2e61 7373 6572 7449      self.assertI
-00001e40: 6e28 225c 3033 335b 306d 222c 2061 6374  n("\033[0m", act
-00001e50: 7561 6c29 0a0a 2020 2020 4070 6174 6368  ual)..    @patch
-00001e60: 2822 6365 7263 6973 2e64 756d 705f 746f  ("cercis.dump_to
-00001e70: 5f66 696c 6522 2c20 6475 6d70 5f74 6f5f  _file", dump_to_
-00001e80: 7374 6465 7272 290a 2020 2020 6465 6620  stderr).    def 
-00001e90: 5f74 6573 745f 7769 7028 7365 6c66 2920  _test_wip(self) 
-00001ea0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00001eb0: 2073 6f75 7263 652c 2065 7870 6563 7465   source, expecte
-00001ec0: 6420 3d20 7265 6164 5f64 6174 6128 226d  d = read_data("m
-00001ed0: 6973 6365 6c6c 616e 656f 7573 222c 2022  iscellaneous", "
-00001ee0: 7769 7022 290a 2020 2020 2020 2020 7379  wip").        sy
-00001ef0: 732e 7365 7474 7261 6365 2874 7261 6365  s.settrace(trace
-00001f00: 6675 6e63 290a 2020 2020 2020 2020 6d6f  func).        mo
-00001f10: 6465 203d 2072 6570 6c61 6365 280a 2020  de = replace(.  
-00001f20: 2020 2020 2020 2020 2020 4445 4641 554c            DEFAUL
-00001f30: 545f 4d4f 4445 2c0a 2020 2020 2020 2020  T_MODE,.        
-00001f40: 2020 2020 6578 7065 7269 6d65 6e74 616c      experimental
-00001f50: 5f73 7472 696e 675f 7072 6f63 6573 7369  _string_processi
-00001f60: 6e67 3d46 616c 7365 2c0a 2020 2020 2020  ng=False,.      
-00001f70: 2020 2020 2020 7461 7267 6574 5f76 6572        target_ver
-00001f80: 7369 6f6e 733d 7b63 6572 6369 732e 5461  sions={cercis.Ta
-00001f90: 7267 6574 5665 7273 696f 6e2e 5059 3338  rgetVersion.PY38
-00001fa0: 7d2c 0a20 2020 2020 2020 2029 0a20 2020  },.        ).   
-00001fb0: 2020 2020 2061 6374 7561 6c20 3d20 6673       actual = fs
-00001fc0: 2873 6f75 7263 652c 206d 6f64 653d 6d6f  (source, mode=mo
-00001fd0: 6465 290a 2020 2020 2020 2020 7379 732e  de).        sys.
-00001fe0: 7365 7474 7261 6365 284e 6f6e 6529 0a20  settrace(None). 
-00001ff0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00002000: 7274 466f 726d 6174 4571 7561 6c28 6578  rtFormatEqual(ex
-00002010: 7065 6374 6564 2c20 6163 7475 616c 290a  pected, actual).
-00002020: 2020 2020 2020 2020 6365 7263 6973 2e61          cercis.a
-00002030: 7373 6572 745f 6571 7569 7661 6c65 6e74  ssert_equivalent
-00002040: 2873 6f75 7263 652c 2061 6374 7561 6c29  (source, actual)
-00002050: 0a20 2020 2020 2020 2063 6572 6369 732e  .        cercis.
-00002060: 6173 7365 7274 5f73 7461 626c 6528 736f  assert_stable(so
-00002070: 7572 6365 2c20 6163 7475 616c 2c20 6365  urce, actual, ce
-00002080: 7263 6973 2e46 696c 654d 6f64 6528 2929  rcis.FileMode())
-00002090: 0a0a 2020 2020 6465 6620 7465 7374 5f70  ..    def test_p
-000020a0: 6570 5f35 3732 5f76 6572 7369 6f6e 5f64  ep_572_version_d
-000020b0: 6574 6563 7469 6f6e 2873 656c 6629 202d  etection(self) -
-000020c0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-000020d0: 736f 7572 6365 2c20 5f20 3d20 7265 6164  source, _ = read
-000020e0: 5f64 6174 6128 2270 795f 3338 222c 2022  _data("py_38", "
-000020f0: 7065 705f 3537 3222 290a 2020 2020 2020  pep_572").      
-00002100: 2020 726f 6f74 203d 2063 6572 6369 732e    root = cercis.
-00002110: 6c69 6232 746f 335f 7061 7273 6528 736f  lib2to3_parse(so
-00002120: 7572 6365 290a 2020 2020 2020 2020 6665  urce).        fe
-00002130: 6174 7572 6573 203d 2063 6572 6369 732e  atures = cercis.
-00002140: 6765 745f 6665 6174 7572 6573 5f75 7365  get_features_use
-00002150: 6428 726f 6f74 290a 2020 2020 2020 2020  d(root).        
-00002160: 7365 6c66 2e61 7373 6572 7449 6e28 6365  self.assertIn(ce
-00002170: 7263 6973 2e46 6561 7475 7265 2e41 5353  rcis.Feature.ASS
-00002180: 4947 4e4d 454e 545f 4558 5052 4553 5349  IGNMENT_EXPRESSI
-00002190: 4f4e 532c 2066 6561 7475 7265 7329 0a20  ONS, features). 
-000021a0: 2020 2020 2020 2076 6572 7369 6f6e 7320         versions 
-000021b0: 3d20 6365 7263 6973 2e64 6574 6563 745f  = cercis.detect_
-000021c0: 7461 7267 6574 5f76 6572 7369 6f6e 7328  target_versions(
-000021d0: 726f 6f74 290a 2020 2020 2020 2020 7365  root).        se
-000021e0: 6c66 2e61 7373 6572 7449 6e28 6365 7263  lf.assertIn(cerc
-000021f0: 6973 2e54 6172 6765 7456 6572 7369 6f6e  is.TargetVersion
-00002200: 2e50 5933 382c 2076 6572 7369 6f6e 7329  .PY38, versions)
-00002210: 0a0a 2020 2020 6465 6620 7465 7374 5f70  ..    def test_p
-00002220: 6570 5f36 3935 5f76 6572 7369 6f6e 5f64  ep_695_version_d
-00002230: 6574 6563 7469 6f6e 2873 656c 6629 202d  etection(self) -
-00002240: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00002250: 666f 7220 6669 6c65 2069 6e20 2822 7479  for file in ("ty
-00002260: 7065 5f61 6c69 6173 6573 222c 2022 7479  pe_aliases", "ty
-00002270: 7065 5f70 6172 616d 7322 293a 0a20 2020  pe_params"):.   
-00002280: 2020 2020 2020 2020 2073 6f75 7263 652c           source,
-00002290: 205f 203d 2072 6561 645f 6461 7461 2822   _ = read_data("
-000022a0: 7079 5f33 3132 222c 2066 696c 6529 0a20  py_312", file). 
-000022b0: 2020 2020 2020 2020 2020 2072 6f6f 7420             root 
-000022c0: 3d20 6365 7263 6973 2e6c 6962 3274 6f33  = cercis.lib2to3
-000022d0: 5f70 6172 7365 2873 6f75 7263 6529 0a20  _parse(source). 
-000022e0: 2020 2020 2020 2020 2020 2066 6561 7475             featu
-000022f0: 7265 7320 3d20 6365 7263 6973 2e67 6574  res = cercis.get
-00002300: 5f66 6561 7475 7265 735f 7573 6564 2872  _features_used(r
-00002310: 6f6f 7429 0a20 2020 2020 2020 2020 2020  oot).           
-00002320: 2073 656c 662e 6173 7365 7274 496e 2863   self.assertIn(c
-00002330: 6572 6369 732e 4665 6174 7572 652e 5459  ercis.Feature.TY
-00002340: 5045 5f50 4152 414d 532c 2066 6561 7475  PE_PARAMS, featu
-00002350: 7265 7329 0a20 2020 2020 2020 2020 2020  res).           
-00002360: 2076 6572 7369 6f6e 7320 3d20 6365 7263   versions = cerc
-00002370: 6973 2e64 6574 6563 745f 7461 7267 6574  is.detect_target
-00002380: 5f76 6572 7369 6f6e 7328 726f 6f74 290a  _versions(root).
-00002390: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000023a0: 2e61 7373 6572 7449 6e28 6365 7263 6973  .assertIn(cercis
-000023b0: 2e54 6172 6765 7456 6572 7369 6f6e 2e50  .TargetVersion.P
-000023c0: 5933 3132 2c20 7665 7273 696f 6e73 290a  Y312, versions).
-000023d0: 0a20 2020 2064 6566 2074 6573 745f 6578  .    def test_ex
-000023e0: 7072 6573 7369 6f6e 5f66 6628 7365 6c66  pression_ff(self
-000023f0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-00002400: 2020 2073 6f75 7263 652c 2065 7870 6563     source, expec
-00002410: 7465 6420 3d20 7265 6164 5f64 6174 6128  ted = read_data(
-00002420: 2273 696d 706c 655f 6361 7365 7322 2c20  "simple_cases", 
-00002430: 2265 7870 7265 7373 696f 6e2e 7079 2229  "expression.py")
-00002440: 0a20 2020 2020 2020 2074 6d70 5f66 696c  .        tmp_fil
-00002450: 6520 3d20 5061 7468 2863 6572 6369 732e  e = Path(cercis.
-00002460: 6475 6d70 5f74 6f5f 6669 6c65 2873 6f75  dump_to_file(sou
-00002470: 7263 6529 290a 2020 2020 2020 2020 6d6f  rce)).        mo
-00002480: 6465 203d 2072 6570 6c61 6365 2844 4546  de = replace(DEF
-00002490: 4155 4c54 5f4d 4f44 452c 206c 696e 655f  AULT_MODE, line_
-000024a0: 6c65 6e67 7468 3d38 3829 0a20 2020 2020  length=88).     
-000024b0: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-000024c0: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
-000024d0: 7275 6528 6666 2874 6d70 5f66 696c 652c  rue(ff(tmp_file,
-000024e0: 2077 7269 7465 5f62 6163 6b3d 6365 7263   write_back=cerc
-000024f0: 6973 2e57 7269 7465 4261 636b 2e59 4553  is.WriteBack.YES
-00002500: 2c20 6d6f 6465 3d6d 6f64 6529 290a 2020  , mode=mode)).  
-00002510: 2020 2020 2020 2020 2020 7769 7468 206f            with o
-00002520: 7065 6e28 746d 705f 6669 6c65 2c20 656e  pen(tmp_file, en
-00002530: 636f 6469 6e67 3d22 7574 6638 2229 2061  coding="utf8") a
-00002540: 7320 663a 0a20 2020 2020 2020 2020 2020  s f:.           
-00002550: 2020 2020 2061 6374 7561 6c20 3d20 662e       actual = f.
-00002560: 7265 6164 2829 0a20 2020 2020 2020 2066  read().        f
-00002570: 696e 616c 6c79 3a0a 2020 2020 2020 2020  inally:.        
-00002580: 2020 2020 6f73 2e75 6e6c 696e 6b28 746d      os.unlink(tm
-00002590: 705f 6669 6c65 290a 2020 2020 2020 2020  p_file).        
-000025a0: 7365 6c66 2e61 7373 6572 7446 6f72 6d61  self.assertForma
-000025b0: 7445 7175 616c 2865 7870 6563 7465 642c  tEqual(expected,
-000025c0: 2061 6374 7561 6c29 0a20 2020 2020 2020   actual).       
-000025d0: 2077 6974 6820 7061 7463 6828 2263 6572   with patch("cer
-000025e0: 6369 732e 6475 6d70 5f74 6f5f 6669 6c65  cis.dump_to_file
-000025f0: 222c 2064 756d 705f 746f 5f73 7464 6572  ", dump_to_stder
-00002600: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
-00002610: 6365 7263 6973 2e61 7373 6572 745f 6571  cercis.assert_eq
-00002620: 7569 7661 6c65 6e74 2873 6f75 7263 652c  uivalent(source,
-00002630: 2061 6374 7561 6c29 0a20 2020 2020 2020   actual).       
-00002640: 2020 2020 2063 6572 6369 732e 6173 7365       cercis.asse
-00002650: 7274 5f73 7461 626c 6528 736f 7572 6365  rt_stable(source
-00002660: 2c20 6163 7475 616c 2c20 6d6f 6465 290a  , actual, mode).
-00002670: 0a20 2020 2064 6566 2074 6573 745f 6578  .    def test_ex
-00002680: 7072 6573 7369 6f6e 5f64 6966 6628 7365  pression_diff(se
-00002690: 6c66 2920 2d3e 204e 6f6e 653a 0a20 2020  lf) -> None:.   
-000026a0: 2020 2020 2073 6f75 7263 652c 205f 203d       source, _ =
-000026b0: 2072 6561 645f 6461 7461 2822 7369 6d70   read_data("simp
-000026c0: 6c65 5f63 6173 6573 222c 2022 6578 7072  le_cases", "expr
-000026d0: 6573 7369 6f6e 2e70 7922 290a 2020 2020  ession.py").    
-000026e0: 2020 2020 6578 7065 6374 6564 2c20 5f20      expected, _ 
-000026f0: 3d20 7265 6164 5f64 6174 6128 2273 696d  = read_data("sim
-00002700: 706c 655f 6361 7365 7322 2c20 2265 7870  ple_cases", "exp
-00002710: 7265 7373 696f 6e2e 6469 6666 2229 0a20  ression.diff"). 
-00002720: 2020 2020 2020 2074 6d70 5f66 696c 6520         tmp_file 
-00002730: 3d20 5061 7468 2863 6572 6369 732e 6475  = Path(cercis.du
-00002740: 6d70 5f74 6f5f 6669 6c65 2873 6f75 7263  mp_to_file(sourc
-00002750: 6529 290a 2020 2020 2020 2020 6469 6666  e)).        diff
-00002760: 5f68 6561 6465 7220 3d20 7265 2e63 6f6d  _header = re.com
-00002770: 7069 6c65 280a 2020 2020 2020 2020 2020  pile(.          
-00002780: 2020 7266 227b 7265 2e65 7363 6170 6528    rf"{re.escape(
-00002790: 7374 7228 746d 705f 6669 6c65 2929 7d5c  str(tmp_file))}\
-000027a0: 745c 645c 645c 645c 642d 5c64 5c64 2d5c  t\d\d\d\d-\d\d-\
-000027b0: 645c 6420 220a 2020 2020 2020 2020 2020  d\d ".          
-000027c0: 2020 7222 5c64 5c64 3a5c 645c 643a 5c64    r"\d\d:\d\d:\d
-000027d0: 5c64 5c2e 5c64 5c64 5c64 5c64 5c64 5c64  \d\.\d\d\d\d\d\d
-000027e0: 5c2b 5c64 5c64 3a5c 645c 6422 0a20 2020  \+\d\d:\d\d".   
-000027f0: 2020 2020 2029 0a20 2020 2020 2020 2074       ).        t
-00002800: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-00002810: 7265 7375 6c74 203d 2042 6c61 636b 5275  result = BlackRu
-00002820: 6e6e 6572 2829 2e69 6e76 6f6b 6528 0a20  nner().invoke(. 
-00002830: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00002840: 6572 6369 732e 6d61 696e 2c0a 2020 2020  ercis.main,.    
-00002850: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
+000009e0: 7d0a 2020 2020 2020 2020 7365 6c66 2e70  }.        self.p
+000009f0: 6172 616d 733a 2044 6963 745b 7374 722c  arams: Dict[str,
+00000a00: 2041 6e79 5d20 3d20 7b7d 0a20 2020 2020   Any] = {}.     
+00000a10: 2020 2023 2044 756d 6d79 2072 6f6f 742c     # Dummy root,
+00000a20: 2073 696e 6365 206d 6f73 7420 6f66 2074   since most of t
+00000a30: 6865 2074 6573 7473 2064 6f6e 2774 2063  he tests don't c
+00000a40: 6172 6520 6162 6f75 7420 6974 0a20 2020  are about it.   
+00000a50: 2020 2020 2073 656c 662e 6f62 6a3a 2044       self.obj: D
+00000a60: 6963 745b 7374 722c 2041 6e79 5d20 3d20  ict[str, Any] = 
+00000a70: 7b22 726f 6f74 223a 2050 524f 4a45 4354  {"root": PROJECT
+00000a80: 5f52 4f4f 547d 0a0a 0a63 6c61 7373 2046  _ROOT}...class F
+00000a90: 616b 6550 6172 616d 6574 6572 2863 6c69  akeParameter(cli
+00000aa0: 636b 2e50 6172 616d 6574 6572 293a 0a20  ck.Parameter):. 
+00000ab0: 2020 2022 2222 4120 6661 6b65 2063 6c69     """A fake cli
+00000ac0: 636b 2050 6172 616d 6574 6572 2066 6f72  ck Parameter for
+00000ad0: 2077 6865 6e20 6361 6c6c 696e 6720 6675   when calling fu
+00000ae0: 6e63 7469 6f6e 7320 7468 6174 206e 6565  nctions that nee
+00000af0: 6420 6974 2e22 2222 0a0a 2020 2020 6465  d it."""..    de
+00000b00: 6620 5f5f 696e 6974 5f5f 2873 656c 6629  f __init__(self)
+00000b10: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00000b20: 2020 7061 7373 0a0a 0a63 6c61 7373 2042    pass...class B
+00000b30: 6c61 636b 5275 6e6e 6572 2843 6c69 5275  lackRunner(CliRu
+00000b40: 6e6e 6572 293a 0a20 2020 2022 2222 4d61  nner):.    """Ma
+00000b50: 6b65 2073 7572 6520 5354 444f 5554 2061  ke sure STDOUT a
+00000b60: 6e64 2053 5444 4552 5220 6172 6520 6b65  nd STDERR are ke
+00000b70: 7074 2073 6570 6172 6174 6520 7768 656e  pt separate when
+00000b80: 2074 6573 7469 6e67 2042 6c61 636b 2076   testing Black v
+00000b90: 6961 2069 7473 2043 4c49 2e22 2222 0a0a  ia its CLI."""..
+00000ba0: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
+00000bb0: 2873 656c 6629 202d 3e20 4e6f 6e65 3a0a  (self) -> None:.
+00000bc0: 2020 2020 2020 2020 7375 7065 7228 292e          super().
+00000bd0: 5f5f 696e 6974 5f5f 286d 6978 5f73 7464  __init__(mix_std
+00000be0: 6572 723d 4661 6c73 6529 0a0a 0a64 6566  err=False)...def
+00000bf0: 2069 6e76 6f6b 6542 6c61 636b 280a 2020   invokeBlack(.  
+00000c00: 2020 2020 2020 6172 6773 3a20 4c69 7374        args: List
+00000c10: 5b73 7472 5d2c 2065 7869 745f 636f 6465  [str], exit_code
+00000c20: 3a20 696e 7420 3d20 302c 2069 676e 6f72  : int = 0, ignor
+00000c30: 655f 636f 6e66 6967 3a20 626f 6f6c 203d  e_config: bool =
+00000c40: 2054 7275 650a 2920 2d3e 204e 6f6e 653a   True.) -> None:
+00000c50: 0a20 2020 2072 756e 6e65 7220 3d20 426c  .    runner = Bl
+00000c60: 6163 6b52 756e 6e65 7228 290a 2020 2020  ackRunner().    
+00000c70: 6966 2069 676e 6f72 655f 636f 6e66 6967  if ignore_config
+00000c80: 3a0a 2020 2020 2020 2020 6172 6773 203d  :.        args =
+00000c90: 205b 222d 2d76 6572 626f 7365 222c 2022   ["--verbose", "
+00000ca0: 2d2d 636f 6e66 6967 222c 2073 7472 2854  --config", str(T
+00000cb0: 4849 535f 4449 5220 2f20 2265 6d70 7479  HIS_DIR / "empty
+00000cc0: 2e74 6f6d 6c22 292c 202a 6172 6773 5d0a  .toml"), *args].
+00000cd0: 2020 2020 7265 7375 6c74 203d 2072 756e      result = run
+00000ce0: 6e65 722e 696e 766f 6b65 2863 6572 6369  ner.invoke(cerci
+00000cf0: 732e 6d61 696e 2c20 6172 6773 2c20 6361  s.main, args, ca
+00000d00: 7463 685f 6578 6365 7074 696f 6e73 3d46  tch_exceptions=F
+00000d10: 616c 7365 290a 2020 2020 6173 7365 7274  alse).    assert
+00000d20: 2072 6573 756c 742e 7374 646f 7574 5f62   result.stdout_b
+00000d30: 7974 6573 2069 7320 6e6f 7420 4e6f 6e65  ytes is not None
+00000d40: 0a20 2020 2061 7373 6572 7420 7265 7375  .    assert resu
+00000d50: 6c74 2e73 7464 6572 725f 6279 7465 7320  lt.stderr_bytes 
+00000d60: 6973 206e 6f74 204e 6f6e 650a 2020 2020  is not None.    
+00000d70: 6d73 6720 3d20 280a 2020 2020 2020 2020  msg = (.        
+00000d80: 6622 4661 696c 6564 2077 6974 6820 6172  f"Failed with ar
+00000d90: 6773 3a20 7b61 7267 737d 5c6e 220a 2020  gs: {args}\n".  
+00000da0: 2020 2020 2020 6622 7374 646f 7574 3a20        f"stdout: 
+00000db0: 7b72 6573 756c 742e 7374 646f 7574 5f62  {result.stdout_b
+00000dc0: 7974 6573 2e64 6563 6f64 6528 2921 727d  ytes.decode()!r}
+00000dd0: 5c6e 220a 2020 2020 2020 2020 6622 7374  \n".        f"st
+00000de0: 6465 7272 3a20 7b72 6573 756c 742e 7374  derr: {result.st
+00000df0: 6465 7272 5f62 7974 6573 2e64 6563 6f64  derr_bytes.decod
+00000e00: 6528 2921 727d 5c6e 220a 2020 2020 2020  e()!r}\n".      
+00000e10: 2020 6622 6578 6365 7074 696f 6e3a 207b    f"exception: {
+00000e20: 7265 7375 6c74 2e65 7863 6570 7469 6f6e  result.exception
+00000e30: 7d22 0a20 2020 2029 0a20 2020 2061 7373  }".    ).    ass
+00000e40: 6572 7420 7265 7375 6c74 2e65 7869 745f  ert result.exit_
+00000e50: 636f 6465 203d 3d20 6578 6974 5f63 6f64  code == exit_cod
+00000e60: 652c 206d 7367 0a0a 0a63 6c61 7373 2042  e, msg...class B
+00000e70: 6c61 636b 5465 7374 4361 7365 2842 6c61  lackTestCase(Bla
+00000e80: 636b 4261 7365 5465 7374 4361 7365 293a  ckBaseTestCase):
+00000e90: 0a20 2020 2069 6e76 6f6b 6542 6c61 636b  .    invokeBlack
+00000ea0: 203d 2073 7461 7469 636d 6574 686f 6428   = staticmethod(
+00000eb0: 696e 766f 6b65 426c 6163 6b29 0a0a 2020  invokeBlack)..  
+00000ec0: 2020 6465 6620 7465 7374 5f65 6d70 7479    def test_empty
+00000ed0: 5f66 6628 7365 6c66 2920 2d3e 204e 6f6e  _ff(self) -> Non
+00000ee0: 653a 0a20 2020 2020 2020 2065 7870 6563  e:.        expec
+00000ef0: 7465 6420 3d20 2222 0a20 2020 2020 2020  ted = "".       
+00000f00: 2074 6d70 5f66 696c 6520 3d20 5061 7468   tmp_file = Path
+00000f10: 2863 6572 6369 732e 6475 6d70 5f74 6f5f  (cercis.dump_to_
+00000f20: 6669 6c65 2829 290a 2020 2020 2020 2020  file()).        
+00000f30: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
+00000f40: 2073 656c 662e 6173 7365 7274 4661 6c73   self.assertFals
+00000f50: 6528 6666 2874 6d70 5f66 696c 652c 2077  e(ff(tmp_file, w
+00000f60: 7269 7465 5f62 6163 6b3d 6365 7263 6973  rite_back=cercis
+00000f70: 2e57 7269 7465 4261 636b 2e59 4553 2929  .WriteBack.YES))
+00000f80: 0a20 2020 2020 2020 2020 2020 2061 6374  .            act
+00000f90: 7561 6c20 3d20 746d 705f 6669 6c65 2e72  ual = tmp_file.r
+00000fa0: 6561 645f 7465 7874 2865 6e63 6f64 696e  ead_text(encodin
+00000fb0: 673d 2275 7466 2d38 2229 0a20 2020 2020  g="utf-8").     
+00000fc0: 2020 2066 696e 616c 6c79 3a0a 2020 2020     finally:.    
+00000fd0: 2020 2020 2020 2020 6f73 2e75 6e6c 696e          os.unlin
+00000fe0: 6b28 746d 705f 6669 6c65 290a 2020 2020  k(tmp_file).    
+00000ff0: 2020 2020 7365 6c66 2e61 7373 6572 7446      self.assertF
+00001000: 6f72 6d61 7445 7175 616c 2865 7870 6563  ormatEqual(expec
+00001010: 7465 642c 2061 6374 7561 6c29 0a0a 2020  ted, actual)..  
+00001020: 2020 4070 6174 6368 2822 6365 7263 6973    @patch("cercis
+00001030: 2e64 756d 705f 746f 5f66 696c 6522 2c20  .dump_to_file", 
+00001040: 6475 6d70 5f74 6f5f 7374 6465 7272 290a  dump_to_stderr).
+00001050: 2020 2020 6465 6620 7465 7374 5f6f 6e65      def test_one
+00001060: 5f65 6d70 7479 5f6c 696e 6528 7365 6c66  _empty_line(self
+00001070: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00001080: 2020 206d 6f64 6520 3d20 6365 7263 6973     mode = cercis
+00001090: 2e4d 6f64 6528 7072 6576 6965 773d 5472  .Mode(preview=Tr
+000010a0: 7565 290a 2020 2020 2020 2020 666f 7220  ue).        for 
+000010b0: 6e6c 2069 6e20 5b22 5c6e 222c 2022 5c72  nl in ["\n", "\r
+000010c0: 5c6e 225d 3a0a 2020 2020 2020 2020 2020  \n"]:.          
+000010d0: 2020 736f 7572 6365 203d 2065 7870 6563    source = expec
+000010e0: 7465 6420 3d20 6e6c 0a20 2020 2020 2020  ted = nl.       
+000010f0: 2020 2020 2061 7373 6572 745f 666f 726d       assert_form
+00001100: 6174 2873 6f75 7263 652c 2065 7870 6563  at(source, expec
+00001110: 7465 642c 206d 6f64 653d 6d6f 6465 290a  ted, mode=mode).
+00001120: 0a20 2020 2064 6566 2074 6573 745f 6f6e  .    def test_on
+00001130: 655f 656d 7074 795f 6c69 6e65 5f66 6628  e_empty_line_ff(
+00001140: 7365 6c66 2920 2d3e 204e 6f6e 653a 0a20  self) -> None:. 
+00001150: 2020 2020 2020 206d 6f64 6520 3d20 6365         mode = ce
+00001160: 7263 6973 2e4d 6f64 6528 7072 6576 6965  rcis.Mode(previe
+00001170: 773d 5472 7565 290a 2020 2020 2020 2020  w=True).        
+00001180: 666f 7220 6e6c 2069 6e20 5b22 5c6e 222c  for nl in ["\n",
+00001190: 2022 5c72 5c6e 225d 3a0a 2020 2020 2020   "\r\n"]:.      
+000011a0: 2020 2020 2020 6578 7065 6374 6564 203d        expected =
+000011b0: 206e 6c0a 2020 2020 2020 2020 2020 2020   nl.            
+000011c0: 746d 705f 6669 6c65 203d 2050 6174 6828  tmp_file = Path(
+000011d0: 6365 7263 6973 2e64 756d 705f 746f 5f66  cercis.dump_to_f
+000011e0: 696c 6528 6e6c 2929 0a20 2020 2020 2020  ile(nl)).       
+000011f0: 2020 2020 2069 6620 7379 7374 656d 2829       if system()
+00001200: 203d 3d20 2257 696e 646f 7773 223a 0a20   == "Windows":. 
+00001210: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00001220: 2057 7269 7469 6e67 2066 696c 6573 2069   Writing files i
+00001230: 6e20 7465 7874 206d 6f64 6520 6175 746f  n text mode auto
+00001240: 6d61 7469 6361 6c6c 7920 7573 6573 2074  matically uses t
+00001250: 6865 2073 7973 7465 6d20 6e65 776c 696e  he system newlin
+00001260: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00001270: 2020 2023 2062 7574 2069 6e20 7468 6973     # but in this
+00001280: 2063 6173 6520 7765 2064 6f6e 2774 2077   case we don't w
+00001290: 616e 7420 7468 6973 2066 6f72 2074 6573  ant this for tes
+000012a0: 7469 6e67 2072 6561 736f 6e73 2e20 5365  ting reasons. Se
+000012b0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+000012c0: 2020 2023 2068 7474 7073 3a2f 2f67 6974     # https://git
+000012d0: 6875 622e 636f 6d2f 7073 662f 626c 6163  hub.com/psf/blac
+000012e0: 6b2f 7075 6c6c 2f33 3334 380a 2020 2020  k/pull/3348.    
+000012f0: 2020 2020 2020 2020 2020 2020 7769 7468              with
+00001300: 206f 7065 6e28 746d 705f 6669 6c65 2c20   open(tmp_file, 
+00001310: 2277 6222 2920 6173 2066 3a0a 2020 2020  "wb") as f:.    
+00001320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001330: 662e 7772 6974 6528 6e6c 2e65 6e63 6f64  f.write(nl.encod
+00001340: 6528 2275 7466 2d38 2229 290a 2020 2020  e("utf-8")).    
+00001350: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+00001360: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00001370: 662e 6173 7365 7274 4661 6c73 6528 0a20  f.assertFalse(. 
+00001380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001390: 2020 2066 6628 746d 705f 6669 6c65 2c20     ff(tmp_file, 
+000013a0: 6d6f 6465 3d6d 6f64 652c 2077 7269 7465  mode=mode, write
+000013b0: 5f62 6163 6b3d 6365 7263 6973 2e57 7269  _back=cercis.Wri
+000013c0: 7465 4261 636b 2e59 4553 290a 2020 2020  teBack.YES).    
+000013d0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+000013e0: 2020 2020 2020 2020 2020 2020 2020 7769                wi
+000013f0: 7468 206f 7065 6e28 746d 705f 6669 6c65  th open(tmp_file
+00001400: 2c20 2272 6222 2920 6173 2066 3a0a 2020  , "rb") as f:.  
+00001410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001420: 2020 6163 7475 616c 203d 2066 2e72 6561    actual = f.rea
+00001430: 6428 292e 6465 636f 6465 2822 7574 662d  d().decode("utf-
+00001440: 3822 290a 2020 2020 2020 2020 2020 2020  8").            
+00001450: 6669 6e61 6c6c 793a 0a20 2020 2020 2020  finally:.       
+00001460: 2020 2020 2020 2020 206f 732e 756e 6c69           os.unli
+00001470: 6e6b 2874 6d70 5f66 696c 6529 0a20 2020  nk(tmp_file).   
+00001480: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00001490: 7365 7274 466f 726d 6174 4571 7561 6c28  sertFormatEqual(
+000014a0: 6578 7065 6374 6564 2c20 6163 7475 616c  expected, actual
+000014b0: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
+000014c0: 6578 7065 7269 6d65 6e74 616c 5f73 7472  experimental_str
+000014d0: 696e 675f 7072 6f63 6573 7369 6e67 5f77  ing_processing_w
+000014e0: 6172 6e73 2873 656c 6629 202d 3e20 4e6f  arns(self) -> No
+000014f0: 6e65 3a0a 2020 2020 2020 2020 7365 6c66  ne:.        self
+00001500: 2e61 7373 6572 7457 6172 6e73 280a 2020  .assertWarns(.  
+00001510: 2020 2020 2020 2020 2020 6365 7263 6973            cercis
+00001520: 2e6d 6f64 652e 4465 7072 6563 6174 6564  .mode.Deprecated
+00001530: 2c20 6365 7263 6973 2e4d 6f64 652c 2065  , cercis.Mode, e
+00001540: 7870 6572 696d 656e 7461 6c5f 7374 7269  xperimental_stri
+00001550: 6e67 5f70 726f 6365 7373 696e 673d 5472  ng_processing=Tr
+00001560: 7565 0a20 2020 2020 2020 2029 0a0a 2020  ue.        )..  
+00001570: 2020 6465 6620 7465 7374 5f70 6970 696e    def test_pipin
+00001580: 6728 7365 6c66 2920 2d3e 204e 6f6e 653a  g(self) -> None:
+00001590: 0a20 2020 2020 2020 2073 6f75 7263 652c  .        source,
+000015a0: 2065 7870 6563 7465 6420 3d20 7265 6164   expected = read
+000015b0: 5f64 6174 615f 6672 6f6d 5f66 696c 6528  _data_from_file(
+000015c0: 5052 4f4a 4543 545f 524f 4f54 202f 2022  PROJECT_ROOT / "
+000015d0: 7372 632f 6365 7263 6973 2f5f 5f69 6e69  src/cercis/__ini
+000015e0: 745f 5f2e 7079 2229 0a20 2020 2020 2020  t__.py").       
+000015f0: 2072 6573 756c 7420 3d20 426c 6163 6b52   result = BlackR
+00001600: 756e 6e65 7228 292e 696e 766f 6b65 280a  unner().invoke(.
+00001610: 2020 2020 2020 2020 2020 2020 6365 7263              cerc
+00001620: 6973 2e6d 6169 6e2c 0a20 2020 2020 2020  is.main,.       
+00001630: 2020 2020 205b 0a20 2020 2020 2020 2020       [.         
+00001640: 2020 2020 2020 2022 2d22 2c0a 2020 2020         "-",.    
+00001650: 2020 2020 2020 2020 2020 2020 222d 2d66              "--f
+00001660: 6173 7422 2c0a 2020 2020 2020 2020 2020  ast",.          
+00001670: 2020 2020 2020 222d 2d6c 696e 652d 6c65        "--line-le
+00001680: 6e67 7468 3d38 3822 2c0a 2020 2020 2020  ngth=88",.      
+00001690: 2020 2020 2020 2020 2020 6622 2d2d 636f            f"--co
+000016a0: 6e66 6967 3d7b 454d 5054 595f 434f 4e46  nfig={EMPTY_CONF
+000016b0: 4947 7d22 2c0a 2020 2020 2020 2020 2020  IG}",.          
+000016c0: 2020 2020 2020 222d 2d73 696e 676c 652d        "--single-
+000016d0: 7175 6f74 653d 4661 6c73 6522 2c0a 2020  quote=False",.  
+000016e0: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
+000016f0: 2020 2020 2020 2020 2069 6e70 7574 3d42           input=B
+00001700: 7974 6573 494f 2873 6f75 7263 652e 656e  ytesIO(source.en
+00001710: 636f 6465 2822 7574 662d 3822 2929 2c0a  code("utf-8")),.
+00001720: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00001730: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00001740: 616c 2872 6573 756c 742e 6578 6974 5f63  al(result.exit_c
+00001750: 6f64 652c 2030 290a 2020 2020 2020 2020  ode, 0).        
+00001760: 7365 6c66 2e61 7373 6572 7446 6f72 6d61  self.assertForma
+00001770: 7445 7175 616c 2865 7870 6563 7465 642c  tEqual(expected,
+00001780: 2072 6573 756c 742e 6f75 7470 7574 290a   result.output).
+00001790: 2020 2020 2020 2020 6966 2073 6f75 7263          if sourc
+000017a0: 6520 213d 2072 6573 756c 742e 6f75 7470  e != result.outp
+000017b0: 7574 3a0a 2020 2020 2020 2020 2020 2020  ut:.            
+000017c0: 6365 7263 6973 2e61 7373 6572 745f 6571  cercis.assert_eq
+000017d0: 7569 7661 6c65 6e74 2873 6f75 7263 652c  uivalent(source,
+000017e0: 2072 6573 756c 742e 6f75 7470 7574 290a   result.output).
+000017f0: 2020 2020 2020 2020 2020 2020 6365 7263              cerc
+00001800: 6973 2e61 7373 6572 745f 7374 6162 6c65  is.assert_stable
+00001810: 2873 6f75 7263 652c 2072 6573 756c 742e  (source, result.
+00001820: 6f75 7470 7574 2c20 4445 4641 554c 545f  output, DEFAULT_
+00001830: 4d4f 4445 290a 0a20 2020 2064 6566 2074  MODE)..    def t
+00001840: 6573 745f 7069 7069 6e67 5f64 6966 6628  est_piping_diff(
+00001850: 7365 6c66 2920 2d3e 204e 6f6e 653a 0a20  self) -> None:. 
+00001860: 2020 2020 2020 2064 6966 665f 6865 6164         diff_head
+00001870: 6572 203d 2072 652e 636f 6d70 696c 6528  er = re.compile(
+00001880: 0a20 2020 2020 2020 2020 2020 2072 2228  .            r"(
+00001890: 5354 4449 4e7c 5354 444f 5554 295c 745c  STDIN|STDOUT)\t\
+000018a0: 645c 645c 645c 642d 5c64 5c64 2d5c 645c  d\d\d\d-\d\d-\d\
+000018b0: 6420 5c64 5c64 3a5c 645c 643a 5c64 5c64  d \d\d:\d\d:\d\d
+000018c0: 5c2e 5c64 5c64 5c64 5c64 5c64 5c64 220a  \.\d\d\d\d\d\d".
+000018d0: 2020 2020 2020 2020 2020 2020 7222 5c2b              r"\+
+000018e0: 5c64 5c64 3a5c 645c 6422 0a20 2020 2020  \d\d:\d\d".     
+000018f0: 2020 2029 0a20 2020 2020 2020 2073 6f75     ).        sou
+00001900: 7263 652c 205f 203d 2072 6561 645f 6461  rce, _ = read_da
+00001910: 7461 2822 7369 6d70 6c65 5f63 6173 6573  ta("simple_cases
+00001920: 222c 2022 6578 7072 6573 7369 6f6e 2e70  ", "expression.p
+00001930: 7922 290a 2020 2020 2020 2020 6578 7065  y").        expe
+00001940: 6374 6564 2c20 5f20 3d20 7265 6164 5f64  cted, _ = read_d
+00001950: 6174 6128 2273 696d 706c 655f 6361 7365  ata("simple_case
+00001960: 7322 2c20 2265 7870 7265 7373 696f 6e2e  s", "expression.
+00001970: 6469 6666 2229 0a20 2020 2020 2020 2061  diff").        a
+00001980: 7267 7320 3d20 5b0a 2020 2020 2020 2020  rgs = [.        
+00001990: 2020 2020 222d 222c 0a20 2020 2020 2020      "-",.       
+000019a0: 2020 2020 2022 2d2d 6661 7374 222c 0a20       "--fast",. 
+000019b0: 2020 2020 2020 2020 2020 2022 2d2d 6c69             "--li
+000019c0: 6e65 2d6c 656e 6774 683d 3838 222c 0a20  ne-length=88",. 
+000019d0: 2020 2020 2020 2020 2020 2022 2d2d 6469             "--di
+000019e0: 6666 222c 0a20 2020 2020 2020 2020 2020  ff",.           
+000019f0: 2066 222d 2d63 6f6e 6669 673d 7b45 4d50   f"--config={EMP
+00001a00: 5459 5f43 4f4e 4649 477d 222c 0a20 2020  TY_CONFIG}",.   
+00001a10: 2020 2020 205d 0a20 2020 2020 2020 2072       ].        r
+00001a20: 6573 756c 7420 3d20 426c 6163 6b52 756e  esult = BlackRun
+00001a30: 6e65 7228 292e 696e 766f 6b65 280a 2020  ner().invoke(.  
+00001a40: 2020 2020 2020 2020 2020 6365 7263 6973            cercis
+00001a50: 2e6d 6169 6e2c 2061 7267 732c 2069 6e70  .main, args, inp
+00001a60: 7574 3d42 7974 6573 494f 2873 6f75 7263  ut=BytesIO(sourc
+00001a70: 652e 656e 636f 6465 2822 7574 662d 3822  e.encode("utf-8"
+00001a80: 2929 0a20 2020 2020 2020 2029 0a20 2020  )).        ).   
+00001a90: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00001aa0: 4571 7561 6c28 7265 7375 6c74 2e65 7869  Equal(result.exi
+00001ab0: 745f 636f 6465 2c20 3029 0a20 2020 2020  t_code, 0).     
+00001ac0: 2020 2061 6374 7561 6c20 3d20 6469 6666     actual = diff
+00001ad0: 5f68 6561 6465 722e 7375 6228 4445 5445  _header.sub(DETE
+00001ae0: 524d 494e 4953 5449 435f 4845 4144 4552  RMINISTIC_HEADER
+00001af0: 2c20 7265 7375 6c74 2e6f 7574 7075 7429  , result.output)
+00001b00: 0a20 2020 2020 2020 2061 6374 7561 6c20  .        actual 
+00001b10: 3d20 6163 7475 616c 2e72 7374 7269 7028  = actual.rstrip(
+00001b20: 2920 2b20 225c 6e22 2020 2320 7468 6520  ) + "\n"  # the 
+00001b30: 6469 6666 206f 7574 7075 7420 6861 7320  diff output has 
+00001b40: 6120 7472 6169 6c69 6e67 2073 7061 6365  a trailing space
+00001b50: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00001b60: 7365 7274 4571 7561 6c28 6578 7065 6374  sertEqual(expect
+00001b70: 6564 2c20 6163 7475 616c 290a 0a20 2020  ed, actual)..   
+00001b80: 2064 6566 2074 6573 745f 7069 7069 6e67   def test_piping
+00001b90: 5f64 6966 665f 7769 7468 5f63 6f6c 6f72  _diff_with_color
+00001ba0: 2873 656c 6629 202d 3e20 4e6f 6e65 3a0a  (self) -> None:.
+00001bb0: 2020 2020 2020 2020 736f 7572 6365 2c20          source, 
+00001bc0: 5f20 3d20 7265 6164 5f64 6174 6128 2273  _ = read_data("s
+00001bd0: 696d 706c 655f 6361 7365 7322 2c20 2265  imple_cases", "e
+00001be0: 7870 7265 7373 696f 6e2e 7079 2229 0a20  xpression.py"). 
+00001bf0: 2020 2020 2020 2061 7267 7320 3d20 5b0a         args = [.
+00001c00: 2020 2020 2020 2020 2020 2020 222d 222c              "-",
+00001c10: 0a20 2020 2020 2020 2020 2020 2022 2d2d  .            "--
+00001c20: 6661 7374 222c 0a20 2020 2020 2020 2020  fast",.         
+00001c30: 2020 2022 2d2d 6c69 6e65 2d6c 656e 6774     "--line-lengt
+00001c40: 683d 3838 222c 0a20 2020 2020 2020 2020  h=88",.         
+00001c50: 2020 2022 2d2d 6469 6666 222c 0a20 2020     "--diff",.   
+00001c60: 2020 2020 2020 2020 2022 2d2d 636f 6c6f           "--colo
+00001c70: 7222 2c0a 2020 2020 2020 2020 2020 2020  r",.            
+00001c80: 6622 2d2d 636f 6e66 6967 3d7b 454d 5054  f"--config={EMPT
+00001c90: 595f 434f 4e46 4947 7d22 2c0a 2020 2020  Y_CONFIG}",.    
+00001ca0: 2020 2020 5d0a 2020 2020 2020 2020 7265      ].        re
+00001cb0: 7375 6c74 203d 2042 6c61 636b 5275 6e6e  sult = BlackRunn
+00001cc0: 6572 2829 2e69 6e76 6f6b 6528 0a20 2020  er().invoke(.   
+00001cd0: 2020 2020 2020 2020 2063 6572 6369 732e           cercis.
+00001ce0: 6d61 696e 2c20 6172 6773 2c20 696e 7075  main, args, inpu
+00001cf0: 743d 4279 7465 7349 4f28 736f 7572 6365  t=BytesIO(source
+00001d00: 2e65 6e63 6f64 6528 2275 7466 2d38 2229  .encode("utf-8")
+00001d10: 290a 2020 2020 2020 2020 290a 2020 2020  ).        ).    
+00001d20: 2020 2020 6163 7475 616c 203d 2072 6573      actual = res
+00001d30: 756c 742e 6f75 7470 7574 0a20 2020 2020  ult.output.     
+00001d40: 2020 2023 2041 6761 696e 2c20 7468 6520     # Again, the 
+00001d50: 636f 6e74 656e 7473 2061 7265 2063 6865  contents are che
+00001d60: 636b 6564 2069 6e20 6120 6469 6666 6572  cked in a differ
+00001d70: 656e 7420 7465 7374 2c20 736f 206f 6e6c  ent test, so onl
+00001d80: 7920 6c6f 6f6b 2066 6f72 2063 6f6c 6f72  y look for color
+00001d90: 732e 0a20 2020 2020 2020 2073 656c 662e  s..        self.
+00001da0: 6173 7365 7274 496e 2822 5c30 3333 5b31  assertIn("\033[1
+00001db0: 6d22 2c20 6163 7475 616c 290a 2020 2020  m", actual).    
+00001dc0: 2020 2020 7365 6c66 2e61 7373 6572 7449      self.assertI
+00001dd0: 6e28 225c 3033 335b 3336 6d22 2c20 6163  n("\033[36m", ac
+00001de0: 7475 616c 290a 2020 2020 2020 2020 7365  tual).        se
+00001df0: 6c66 2e61 7373 6572 7449 6e28 225c 3033  lf.assertIn("\03
+00001e00: 335b 3332 6d22 2c20 6163 7475 616c 290a  3[32m", actual).
+00001e10: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00001e20: 6572 7449 6e28 225c 3033 335b 3331 6d22  ertIn("\033[31m"
+00001e30: 2c20 6163 7475 616c 290a 2020 2020 2020  , actual).      
+00001e40: 2020 7365 6c66 2e61 7373 6572 7449 6e28    self.assertIn(
+00001e50: 225c 3033 335b 306d 222c 2061 6374 7561  "\033[0m", actua
+00001e60: 6c29 0a0a 2020 2020 4070 6174 6368 2822  l)..    @patch("
+00001e70: 6365 7263 6973 2e64 756d 705f 746f 5f66  cercis.dump_to_f
+00001e80: 696c 6522 2c20 6475 6d70 5f74 6f5f 7374  ile", dump_to_st
+00001e90: 6465 7272 290a 2020 2020 6465 6620 5f74  derr).    def _t
+00001ea0: 6573 745f 7769 7028 7365 6c66 2920 2d3e  est_wip(self) ->
+00001eb0: 204e 6f6e 653a 0a20 2020 2020 2020 2073   None:.        s
+00001ec0: 6f75 7263 652c 2065 7870 6563 7465 6420  ource, expected 
+00001ed0: 3d20 7265 6164 5f64 6174 6128 226d 6973  = read_data("mis
+00001ee0: 6365 6c6c 616e 656f 7573 222c 2022 7769  cellaneous", "wi
+00001ef0: 7022 290a 2020 2020 2020 2020 7379 732e  p").        sys.
+00001f00: 7365 7474 7261 6365 2874 7261 6365 6675  settrace(tracefu
+00001f10: 6e63 290a 2020 2020 2020 2020 6d6f 6465  nc).        mode
+00001f20: 203d 2072 6570 6c61 6365 280a 2020 2020   = replace(.    
+00001f30: 2020 2020 2020 2020 4445 4641 554c 545f          DEFAULT_
+00001f40: 4d4f 4445 2c0a 2020 2020 2020 2020 2020  MODE,.          
+00001f50: 2020 6578 7065 7269 6d65 6e74 616c 5f73    experimental_s
+00001f60: 7472 696e 675f 7072 6f63 6573 7369 6e67  tring_processing
+00001f70: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+00001f80: 2020 2020 7461 7267 6574 5f76 6572 7369      target_versi
+00001f90: 6f6e 733d 7b63 6572 6369 732e 5461 7267  ons={cercis.Targ
+00001fa0: 6574 5665 7273 696f 6e2e 5059 3338 7d2c  etVersion.PY38},
+00001fb0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00001fc0: 2020 2061 6374 7561 6c20 3d20 6673 2873     actual = fs(s
+00001fd0: 6f75 7263 652c 206d 6f64 653d 6d6f 6465  ource, mode=mode
+00001fe0: 290a 2020 2020 2020 2020 7379 732e 7365  ).        sys.se
+00001ff0: 7474 7261 6365 284e 6f6e 6529 0a20 2020  ttrace(None).   
+00002000: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00002010: 466f 726d 6174 4571 7561 6c28 6578 7065  FormatEqual(expe
+00002020: 6374 6564 2c20 6163 7475 616c 290a 2020  cted, actual).  
+00002030: 2020 2020 2020 6365 7263 6973 2e61 7373        cercis.ass
+00002040: 6572 745f 6571 7569 7661 6c65 6e74 2873  ert_equivalent(s
+00002050: 6f75 7263 652c 2061 6374 7561 6c29 0a20  ource, actual). 
+00002060: 2020 2020 2020 2063 6572 6369 732e 6173         cercis.as
+00002070: 7365 7274 5f73 7461 626c 6528 736f 7572  sert_stable(sour
+00002080: 6365 2c20 6163 7475 616c 2c20 6365 7263  ce, actual, cerc
+00002090: 6973 2e46 696c 654d 6f64 6528 2929 0a0a  is.FileMode())..
+000020a0: 2020 2020 6465 6620 7465 7374 5f70 6570      def test_pep
+000020b0: 5f35 3732 5f76 6572 7369 6f6e 5f64 6574  _572_version_det
+000020c0: 6563 7469 6f6e 2873 656c 6629 202d 3e20  ection(self) -> 
+000020d0: 4e6f 6e65 3a0a 2020 2020 2020 2020 736f  None:.        so
+000020e0: 7572 6365 2c20 5f20 3d20 7265 6164 5f64  urce, _ = read_d
+000020f0: 6174 6128 2270 795f 3338 222c 2022 7065  ata("py_38", "pe
+00002100: 705f 3537 3222 290a 2020 2020 2020 2020  p_572").        
+00002110: 726f 6f74 203d 2063 6572 6369 732e 6c69  root = cercis.li
+00002120: 6232 746f 335f 7061 7273 6528 736f 7572  b2to3_parse(sour
+00002130: 6365 290a 2020 2020 2020 2020 6665 6174  ce).        feat
+00002140: 7572 6573 203d 2063 6572 6369 732e 6765  ures = cercis.ge
+00002150: 745f 6665 6174 7572 6573 5f75 7365 6428  t_features_used(
+00002160: 726f 6f74 290a 2020 2020 2020 2020 7365  root).        se
+00002170: 6c66 2e61 7373 6572 7449 6e28 6365 7263  lf.assertIn(cerc
+00002180: 6973 2e46 6561 7475 7265 2e41 5353 4947  is.Feature.ASSIG
+00002190: 4e4d 454e 545f 4558 5052 4553 5349 4f4e  NMENT_EXPRESSION
+000021a0: 532c 2066 6561 7475 7265 7329 0a20 2020  S, features).   
+000021b0: 2020 2020 2076 6572 7369 6f6e 7320 3d20       versions = 
+000021c0: 6365 7263 6973 2e64 6574 6563 745f 7461  cercis.detect_ta
+000021d0: 7267 6574 5f76 6572 7369 6f6e 7328 726f  rget_versions(ro
+000021e0: 6f74 290a 2020 2020 2020 2020 7365 6c66  ot).        self
+000021f0: 2e61 7373 6572 7449 6e28 6365 7263 6973  .assertIn(cercis
+00002200: 2e54 6172 6765 7456 6572 7369 6f6e 2e50  .TargetVersion.P
+00002210: 5933 382c 2076 6572 7369 6f6e 7329 0a0a  Y38, versions)..
+00002220: 2020 2020 6465 6620 7465 7374 5f70 6570      def test_pep
+00002230: 5f36 3935 5f76 6572 7369 6f6e 5f64 6574  _695_version_det
+00002240: 6563 7469 6f6e 2873 656c 6629 202d 3e20  ection(self) -> 
+00002250: 4e6f 6e65 3a0a 2020 2020 2020 2020 666f  None:.        fo
+00002260: 7220 6669 6c65 2069 6e20 2822 7479 7065  r file in ("type
+00002270: 5f61 6c69 6173 6573 222c 2022 7479 7065  _aliases", "type
+00002280: 5f70 6172 616d 7322 293a 0a20 2020 2020  _params"):.     
+00002290: 2020 2020 2020 2073 6f75 7263 652c 205f         source, _
+000022a0: 203d 2072 6561 645f 6461 7461 2822 7079   = read_data("py
+000022b0: 5f33 3132 222c 2066 696c 6529 0a20 2020  _312", file).   
+000022c0: 2020 2020 2020 2020 2072 6f6f 7420 3d20           root = 
+000022d0: 6365 7263 6973 2e6c 6962 3274 6f33 5f70  cercis.lib2to3_p
+000022e0: 6172 7365 2873 6f75 7263 6529 0a20 2020  arse(source).   
+000022f0: 2020 2020 2020 2020 2066 6561 7475 7265           feature
+00002300: 7320 3d20 6365 7263 6973 2e67 6574 5f66  s = cercis.get_f
+00002310: 6561 7475 7265 735f 7573 6564 2872 6f6f  eatures_used(roo
+00002320: 7429 0a20 2020 2020 2020 2020 2020 2073  t).            s
+00002330: 656c 662e 6173 7365 7274 496e 2863 6572  elf.assertIn(cer
+00002340: 6369 732e 4665 6174 7572 652e 5459 5045  cis.Feature.TYPE
+00002350: 5f50 4152 414d 532c 2066 6561 7475 7265  _PARAMS, feature
+00002360: 7329 0a20 2020 2020 2020 2020 2020 2076  s).            v
+00002370: 6572 7369 6f6e 7320 3d20 6365 7263 6973  ersions = cercis
+00002380: 2e64 6574 6563 745f 7461 7267 6574 5f76  .detect_target_v
+00002390: 6572 7369 6f6e 7328 726f 6f74 290a 2020  ersions(root).  
+000023a0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+000023b0: 7373 6572 7449 6e28 6365 7263 6973 2e54  ssertIn(cercis.T
+000023c0: 6172 6765 7456 6572 7369 6f6e 2e50 5933  argetVersion.PY3
+000023d0: 3132 2c20 7665 7273 696f 6e73 290a 0a20  12, versions).. 
+000023e0: 2020 2064 6566 2074 6573 745f 6578 7072     def test_expr
+000023f0: 6573 7369 6f6e 5f66 6628 7365 6c66 2920  ession_ff(self) 
+00002400: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00002410: 2073 6f75 7263 652c 2065 7870 6563 7465   source, expecte
+00002420: 6420 3d20 7265 6164 5f64 6174 6128 2273  d = read_data("s
+00002430: 696d 706c 655f 6361 7365 7322 2c20 2265  imple_cases", "e
+00002440: 7870 7265 7373 696f 6e2e 7079 2229 0a20  xpression.py"). 
+00002450: 2020 2020 2020 2074 6d70 5f66 696c 6520         tmp_file 
+00002460: 3d20 5061 7468 2863 6572 6369 732e 6475  = Path(cercis.du
+00002470: 6d70 5f74 6f5f 6669 6c65 2873 6f75 7263  mp_to_file(sourc
+00002480: 6529 290a 2020 2020 2020 2020 6d6f 6465  e)).        mode
+00002490: 203d 2072 6570 6c61 6365 2844 4546 4155   = replace(DEFAU
+000024a0: 4c54 5f4d 4f44 452c 206c 696e 655f 6c65  LT_MODE, line_le
+000024b0: 6e67 7468 3d38 3829 0a20 2020 2020 2020  ngth=88).       
+000024c0: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+000024d0: 2020 7365 6c66 2e61 7373 6572 7454 7275    self.assertTru
+000024e0: 6528 6666 2874 6d70 5f66 696c 652c 2077  e(ff(tmp_file, w
+000024f0: 7269 7465 5f62 6163 6b3d 6365 7263 6973  rite_back=cercis
+00002500: 2e57 7269 7465 4261 636b 2e59 4553 2929  .WriteBack.YES))
+00002510: 0a20 2020 2020 2020 2020 2020 2061 6374  .            act
+00002520: 7561 6c20 3d20 746d 705f 6669 6c65 2e72  ual = tmp_file.r
+00002530: 6561 645f 7465 7874 2865 6e63 6f64 696e  ead_text(encodin
+00002540: 673d 2275 7466 2d38 2229 0a20 2020 2020  g="utf-8").     
+00002550: 2020 2066 696e 616c 6c79 3a0a 2020 2020     finally:.    
+00002560: 2020 2020 2020 2020 6f73 2e75 6e6c 696e          os.unlin
+00002570: 6b28 746d 705f 6669 6c65 290a 2020 2020  k(tmp_file).    
+00002580: 2020 2020 7365 6c66 2e61 7373 6572 7446      self.assertF
+00002590: 6f72 6d61 7445 7175 616c 2865 7870 6563  ormatEqual(expec
+000025a0: 7465 642c 2061 6374 7561 6c29 0a20 2020  ted, actual).   
+000025b0: 2020 2020 2077 6974 6820 7061 7463 6828       with patch(
+000025c0: 2263 6572 6369 732e 6475 6d70 5f74 6f5f  "cercis.dump_to_
+000025d0: 6669 6c65 222c 2064 756d 705f 746f 5f73  file", dump_to_s
+000025e0: 7464 6572 7229 3a0a 2020 2020 2020 2020  tderr):.        
+000025f0: 2020 2020 6365 7263 6973 2e61 7373 6572      cercis.asser
+00002600: 745f 6571 7569 7661 6c65 6e74 2873 6f75  t_equivalent(sou
+00002610: 7263 652c 2061 6374 7561 6c29 0a20 2020  rce, actual).   
+00002620: 2020 2020 2020 2020 2063 6572 6369 732e           cercis.
+00002630: 6173 7365 7274 5f73 7461 626c 6528 736f  assert_stable(so
+00002640: 7572 6365 2c20 6163 7475 616c 2c20 6d6f  urce, actual, mo
+00002650: 6465 290a 0a20 2020 2064 6566 2074 6573  de)..    def tes
+00002660: 745f 6578 7072 6573 7369 6f6e 5f64 6966  t_expression_dif
+00002670: 6628 7365 6c66 2920 2d3e 204e 6f6e 653a  f(self) -> None:
+00002680: 0a20 2020 2020 2020 2073 6f75 7263 652c  .        source,
+00002690: 205f 203d 2072 6561 645f 6461 7461 2822   _ = read_data("
+000026a0: 7369 6d70 6c65 5f63 6173 6573 222c 2022  simple_cases", "
+000026b0: 6578 7072 6573 7369 6f6e 2e70 7922 290a  expression.py").
+000026c0: 2020 2020 2020 2020 6578 7065 6374 6564          expected
+000026d0: 2c20 5f20 3d20 7265 6164 5f64 6174 6128  , _ = read_data(
+000026e0: 2273 696d 706c 655f 6361 7365 7322 2c20  "simple_cases", 
+000026f0: 2265 7870 7265 7373 696f 6e2e 6469 6666  "expression.diff
+00002700: 2229 0a20 2020 2020 2020 2074 6d70 5f66  ").        tmp_f
+00002710: 696c 6520 3d20 5061 7468 2863 6572 6369  ile = Path(cerci
+00002720: 732e 6475 6d70 5f74 6f5f 6669 6c65 2873  s.dump_to_file(s
+00002730: 6f75 7263 6529 290a 2020 2020 2020 2020  ource)).        
+00002740: 6469 6666 5f68 6561 6465 7220 3d20 7265  diff_header = re
+00002750: 2e63 6f6d 7069 6c65 280a 2020 2020 2020  .compile(.      
+00002760: 2020 2020 2020 7266 227b 7265 2e65 7363        rf"{re.esc
+00002770: 6170 6528 7374 7228 746d 705f 6669 6c65  ape(str(tmp_file
+00002780: 2929 7d5c 745c 645c 645c 645c 642d 5c64  ))}\t\d\d\d\d-\d
+00002790: 5c64 2d5c 645c 6420 220a 2020 2020 2020  \d-\d\d ".      
+000027a0: 2020 2020 2020 7222 5c64 5c64 3a5c 645c        r"\d\d:\d\
+000027b0: 643a 5c64 5c64 5c2e 5c64 5c64 5c64 5c64  d:\d\d\.\d\d\d\d
+000027c0: 5c64 5c64 5c2b 5c64 5c64 3a5c 645c 6422  \d\d\+\d\d:\d\d"
+000027d0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+000027e0: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+000027f0: 2020 2020 7265 7375 6c74 203d 2042 6c61      result = Bla
+00002800: 636b 5275 6e6e 6572 2829 2e69 6e76 6f6b  ckRunner().invok
+00002810: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+00002820: 2020 2063 6572 6369 732e 6d61 696e 2c0a     cercis.main,.
+00002830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002840: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00002850: 2020 2020 2020 222d 2d64 6966 6622 2c0a        "--diff",.
 00002860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002870: 2020 222d 2d64 6966 6622 2c0a 2020 2020    "--diff",.    
-00002880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002890: 7374 7228 746d 705f 6669 6c65 292c 0a20  str(tmp_file),. 
-000028a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000028b0: 2020 2066 222d 2d63 6f6e 6669 673d 7b45     f"--config={E
-000028c0: 4d50 5459 5f43 4f4e 4649 477d 222c 0a20  MPTY_CONFIG}",. 
-000028d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000028e0: 2020 2022 2d2d 6c69 6e65 2d6c 656e 6774     "--line-lengt
-000028f0: 683d 3838 222c 0a20 2020 2020 2020 2020  h=88",.         
-00002900: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
-00002910: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00002920: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00002930: 7175 616c 2872 6573 756c 742e 6578 6974  qual(result.exit
-00002940: 5f63 6f64 652c 2030 290a 2020 2020 2020  _code, 0).      
-00002950: 2020 6669 6e61 6c6c 793a 0a20 2020 2020    finally:.     
-00002960: 2020 2020 2020 206f 732e 756e 6c69 6e6b         os.unlink
-00002970: 2874 6d70 5f66 696c 6529 0a20 2020 2020  (tmp_file).     
-00002980: 2020 2061 6374 7561 6c20 3d20 7265 7375     actual = resu
-00002990: 6c74 2e6f 7574 7075 740a 2020 2020 2020  lt.output.      
-000029a0: 2020 6163 7475 616c 203d 2064 6966 665f    actual = diff_
-000029b0: 6865 6164 6572 2e73 7562 2844 4554 4552  header.sub(DETER
-000029c0: 4d49 4e49 5354 4943 5f48 4541 4445 522c  MINISTIC_HEADER,
-000029d0: 2061 6374 7561 6c29 0a20 2020 2020 2020   actual).       
-000029e0: 2069 6620 6578 7065 6374 6564 2021 3d20   if expected != 
-000029f0: 6163 7475 616c 3a0a 2020 2020 2020 2020  actual:.        
-00002a00: 2020 2020 6475 6d70 203d 2063 6572 6369      dump = cerci
-00002a10: 732e 6475 6d70 5f74 6f5f 6669 6c65 2861  s.dump_to_file(a
-00002a20: 6374 7561 6c29 0a20 2020 2020 2020 2020  ctual).         
-00002a30: 2020 206d 7367 203d 2028 0a20 2020 2020     msg = (.     
-00002a40: 2020 2020 2020 2020 2020 2022 4578 7065             "Expe
-00002a50: 6374 6564 2064 6966 6620 6973 6e27 7420  cted diff isn't 
-00002a60: 6571 7561 6c20 746f 2074 6865 2061 6374  equal to the act
-00002a70: 7561 6c2e 2049 6620 796f 7520 6d61 6465  ual. If you made
-00002a80: 2063 6861 6e67 6573 2074 6f22 0a20 2020   changes to".   
-00002a90: 2020 2020 2020 2020 2020 2020 2022 2065               " e
-00002aa0: 7870 7265 7373 696f 6e2e 7079 2061 6e64  xpression.py and
-00002ab0: 2074 6869 7320 6973 2061 6e20 616e 7469   this is an anti
-00002ac0: 6369 7061 7465 6420 6469 6666 6572 656e  cipated differen
-00002ad0: 6365 2c20 6f76 6572 7772 6974 6522 0a20  ce, overwrite". 
-00002ae0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00002af0: 2220 7465 7374 732f 6461 7461 2f65 7870  " tests/data/exp
-00002b00: 7265 7373 696f 6e2e 6469 6666 2077 6974  ression.diff wit
-00002b10: 6820 7b64 756d 707d 220a 2020 2020 2020  h {dump}".      
-00002b20: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00002b30: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00002b40: 7175 616c 2865 7870 6563 7465 642c 2061  qual(expected, a
-00002b50: 6374 7561 6c2c 206d 7367 290a 0a20 2020  ctual, msg)..   
-00002b60: 2064 6566 2074 6573 745f 6578 7072 6573   def test_expres
-00002b70: 7369 6f6e 5f64 6966 665f 7769 7468 5f63  sion_diff_with_c
-00002b80: 6f6c 6f72 2873 656c 6629 202d 3e20 4e6f  olor(self) -> No
-00002b90: 6e65 3a0a 2020 2020 2020 2020 736f 7572  ne:.        sour
-00002ba0: 6365 2c20 5f20 3d20 7265 6164 5f64 6174  ce, _ = read_dat
-00002bb0: 6128 2273 696d 706c 655f 6361 7365 7322  a("simple_cases"
-00002bc0: 2c20 2265 7870 7265 7373 696f 6e2e 7079  , "expression.py
-00002bd0: 2229 0a20 2020 2020 2020 2065 7870 6563  ").        expec
-00002be0: 7465 642c 205f 203d 2072 6561 645f 6461  ted, _ = read_da
-00002bf0: 7461 2822 7369 6d70 6c65 5f63 6173 6573  ta("simple_cases
-00002c00: 222c 2022 6578 7072 6573 7369 6f6e 2e64  ", "expression.d
-00002c10: 6966 6622 290a 2020 2020 2020 2020 746d  iff").        tm
-00002c20: 705f 6669 6c65 203d 2050 6174 6828 6365  p_file = Path(ce
-00002c30: 7263 6973 2e64 756d 705f 746f 5f66 696c  rcis.dump_to_fil
-00002c40: 6528 736f 7572 6365 2929 0a20 2020 2020  e(source)).     
-00002c50: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-00002c60: 2020 2020 7265 7375 6c74 203d 2042 6c61      result = Bla
-00002c70: 636b 5275 6e6e 6572 2829 2e69 6e76 6f6b  ckRunner().invok
-00002c80: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
-00002c90: 2020 2063 6572 6369 732e 6d61 696e 2c0a     cercis.main,.
-00002ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002cb0: 5b22 2d2d 6469 6666 222c 2022 2d2d 636f  ["--diff", "--co
-00002cc0: 6c6f 7222 2c20 7374 7228 746d 705f 6669  lor", str(tmp_fi
-00002cd0: 6c65 292c 2066 222d 2d63 6f6e 6669 673d  le), f"--config=
-00002ce0: 7b45 4d50 5459 5f43 4f4e 4649 477d 225d  {EMPTY_CONFIG}"]
-00002cf0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-00002d00: 2020 2020 2020 2020 6669 6e61 6c6c 793a          finally:
-00002d10: 0a20 2020 2020 2020 2020 2020 206f 732e  .            os.
-00002d20: 756e 6c69 6e6b 2874 6d70 5f66 696c 6529  unlink(tmp_file)
-00002d30: 0a20 2020 2020 2020 2061 6374 7561 6c20  .        actual 
-00002d40: 3d20 7265 7375 6c74 2e6f 7574 7075 740a  = result.output.
-00002d50: 2020 2020 2020 2020 2320 5765 2063 6865          # We che
-00002d60: 636b 2074 6865 2063 6f6e 7465 6e74 7320  ck the contents 
-00002d70: 6f66 2074 6865 2064 6966 6620 696e 2060  of the diff in `
-00002d80: 7465 7374 5f65 7870 7265 7373 696f 6e5f  test_expression_
-00002d90: 6469 6666 602e 2041 6c6c 0a20 2020 2020  diff`. All.     
-00002da0: 2020 2023 2077 6520 6e65 6564 2074 6f20     # we need to 
-00002db0: 6368 6563 6b20 6865 7265 2069 7320 7468  check here is th
-00002dc0: 6174 2063 6f6c 6f72 2063 6f64 6573 2065  at color codes e
-00002dd0: 7869 7374 2069 6e20 7468 6520 7265 7375  xist in the resu
-00002de0: 6c74 2e0a 2020 2020 2020 2020 7365 6c66  lt..        self
-00002df0: 2e61 7373 6572 7449 6e28 225c 3033 335b  .assertIn("\033[
-00002e00: 316d 222c 2061 6374 7561 6c29 0a20 2020  1m", actual).   
-00002e10: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00002e20: 496e 2822 5c30 3333 5b33 366d 222c 2061  In("\033[36m", a
-00002e30: 6374 7561 6c29 0a20 2020 2020 2020 2073  ctual).        s
-00002e40: 656c 662e 6173 7365 7274 496e 2822 5c30  elf.assertIn("\0
-00002e50: 3333 5b33 326d 222c 2061 6374 7561 6c29  33[32m", actual)
-00002e60: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00002e70: 7365 7274 496e 2822 5c30 3333 5b33 316d  sertIn("\033[31m
-00002e80: 222c 2061 6374 7561 6c29 0a20 2020 2020  ", actual).     
-00002e90: 2020 2073 656c 662e 6173 7365 7274 496e     self.assertIn
-00002ea0: 2822 5c30 3333 5b30 6d22 2c20 6163 7475  ("\033[0m", actu
-00002eb0: 616c 290a 0a20 2020 2064 6566 2074 6573  al)..    def tes
-00002ec0: 745f 6465 7465 6374 5f70 6f73 5f6f 6e6c  t_detect_pos_onl
-00002ed0: 795f 6172 6775 6d65 6e74 7328 7365 6c66  y_arguments(self
-00002ee0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-00002ef0: 2020 2073 6f75 7263 652c 205f 203d 2072     source, _ = r
-00002f00: 6561 645f 6461 7461 2822 7079 5f33 3822  ead_data("py_38"
-00002f10: 2c20 2270 6570 5f35 3730 2229 0a20 2020  , "pep_570").   
-00002f20: 2020 2020 2072 6f6f 7420 3d20 6365 7263       root = cerc
-00002f30: 6973 2e6c 6962 3274 6f33 5f70 6172 7365  is.lib2to3_parse
-00002f40: 2873 6f75 7263 6529 0a20 2020 2020 2020  (source).       
-00002f50: 2066 6561 7475 7265 7320 3d20 6365 7263   features = cerc
-00002f60: 6973 2e67 6574 5f66 6561 7475 7265 735f  is.get_features_
-00002f70: 7573 6564 2872 6f6f 7429 0a20 2020 2020  used(root).     
-00002f80: 2020 2073 656c 662e 6173 7365 7274 496e     self.assertIn
-00002f90: 2863 6572 6369 732e 4665 6174 7572 652e  (cercis.Feature.
-00002fa0: 504f 535f 4f4e 4c59 5f41 5247 554d 454e  POS_ONLY_ARGUMEN
-00002fb0: 5453 2c20 6665 6174 7572 6573 290a 2020  TS, features).  
-00002fc0: 2020 2020 2020 7665 7273 696f 6e73 203d        versions =
-00002fd0: 2063 6572 6369 732e 6465 7465 6374 5f74   cercis.detect_t
-00002fe0: 6172 6765 745f 7665 7273 696f 6e73 2872  arget_versions(r
-00002ff0: 6f6f 7429 0a20 2020 2020 2020 2073 656c  oot).        sel
-00003000: 662e 6173 7365 7274 496e 2863 6572 6369  f.assertIn(cerci
-00003010: 732e 5461 7267 6574 5665 7273 696f 6e2e  s.TargetVersion.
-00003020: 5059 3338 2c20 7665 7273 696f 6e73 290a  PY38, versions).
-00003030: 0a20 2020 2064 6566 2074 6573 745f 6465  .    def test_de
-00003040: 7465 6374 5f64 6562 7567 5f66 5f73 7472  tect_debug_f_str
-00003050: 696e 6773 2873 656c 6629 202d 3e20 4e6f  ings(self) -> No
-00003060: 6e65 3a0a 2020 2020 2020 2020 726f 6f74  ne:.        root
-00003070: 203d 2063 6572 6369 732e 6c69 6232 746f   = cercis.lib2to
-00003080: 335f 7061 7273 6528 2222 2266 227b 783d  3_parse("""f"{x=
-00003090: 7d22 2022 2222 290a 2020 2020 2020 2020  }" """).        
-000030a0: 6665 6174 7572 6573 203d 2063 6572 6369  features = cerci
-000030b0: 732e 6765 745f 6665 6174 7572 6573 5f75  s.get_features_u
-000030c0: 7365 6428 726f 6f74 290a 2020 2020 2020  sed(root).      
-000030d0: 2020 7365 6c66 2e61 7373 6572 7449 6e28    self.assertIn(
-000030e0: 6365 7263 6973 2e46 6561 7475 7265 2e44  cercis.Feature.D
-000030f0: 4542 5547 5f46 5f53 5452 494e 4753 2c20  EBUG_F_STRINGS, 
-00003100: 6665 6174 7572 6573 290a 2020 2020 2020  features).      
-00003110: 2020 7665 7273 696f 6e73 203d 2063 6572    versions = cer
-00003120: 6369 732e 6465 7465 6374 5f74 6172 6765  cis.detect_targe
-00003130: 745f 7665 7273 696f 6e73 2872 6f6f 7429  t_versions(root)
-00003140: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00003150: 7365 7274 496e 2863 6572 6369 732e 5461  sertIn(cercis.Ta
-00003160: 7267 6574 5665 7273 696f 6e2e 5059 3338  rgetVersion.PY38
-00003170: 2c20 7665 7273 696f 6e73 290a 0a20 2020  , versions)..   
-00003180: 2020 2020 2072 6f6f 7420 3d20 6365 7263       root = cerc
-00003190: 6973 2e6c 6962 3274 6f33 5f70 6172 7365  is.lib2to3_parse
-000031a0: 280a 2020 2020 2020 2020 2020 2020 2222  (.            ""
-000031b0: 2266 227b 787d 225c 6e66 277b 223d 227d  "f"{x}"\nf'{"="}
-000031c0: 275c 6e66 277b 2878 3a3d 3529 7d27 5c6e  '\nf'{(x:=5)}'\n
-000031d0: 6627 7b66 2861 3d22 333d 2229 7d27 5c6e  f'{f(a="3=")}'\n
-000031e0: 6627 7b78 3a3d 3130 7d27 5c6e 2222 220a  f'{x:=10}'\n""".
-000031f0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00003200: 2020 6665 6174 7572 6573 203d 2063 6572    features = cer
-00003210: 6369 732e 6765 745f 6665 6174 7572 6573  cis.get_features
-00003220: 5f75 7365 6428 726f 6f74 290a 2020 2020  _used(root).    
-00003230: 2020 2020 7365 6c66 2e61 7373 6572 744e      self.assertN
-00003240: 6f74 496e 2863 6572 6369 732e 4665 6174  otIn(cercis.Feat
-00003250: 7572 652e 4445 4255 475f 465f 5354 5249  ure.DEBUG_F_STRI
-00003260: 4e47 532c 2066 6561 7475 7265 7329 0a0a  NGS, features)..
-00003270: 2020 2020 2020 2020 2320 5765 2064 6f6e          # We don
-00003280: 2774 2079 6574 2073 7570 706f 7274 2066  't yet support f
-00003290: 6561 7475 7265 2076 6572 7369 6f6e 2064  eature version d
-000032a0: 6574 6563 7469 6f6e 2069 6e20 6e65 7374  etection in nest
-000032b0: 6564 2066 2d73 7472 696e 6773 0a20 2020  ed f-strings.   
-000032c0: 2020 2020 2072 6f6f 7420 3d20 6365 7263       root = cerc
-000032d0: 6973 2e6c 6962 3274 6f33 5f70 6172 7365  is.lib2to3_parse
-000032e0: 280a 2020 2020 2020 2020 2020 2020 2222  (.            ""
-000032f0: 2266 2268 6561 7264 2061 2072 756d 6f75  "f"heard a rumou
-00003300: 7220 7468 6174 207b 2066 277b 312b 313d  r that { f'{1+1=
-00003310: 7d27 207d 202e 2e2e 2073 6565 6d73 206c  }' } ... seems l
-00003320: 696b 6520 6974 2063 6f75 6c64 2062 6520  ike it could be 
-00003330: 7472 7565 2220 2222 220a 2020 2020 2020  true" """.      
-00003340: 2020 290a 2020 2020 2020 2020 6665 6174    ).        feat
-00003350: 7572 6573 203d 2063 6572 6369 732e 6765  ures = cercis.ge
-00003360: 745f 6665 6174 7572 6573 5f75 7365 6428  t_features_used(
-00003370: 726f 6f74 290a 2020 2020 2020 2020 7365  root).        se
-00003380: 6c66 2e61 7373 6572 744e 6f74 496e 2863  lf.assertNotIn(c
-00003390: 6572 6369 732e 4665 6174 7572 652e 4445  ercis.Feature.DE
-000033a0: 4255 475f 465f 5354 5249 4e47 532c 2066  BUG_F_STRINGS, f
-000033b0: 6561 7475 7265 7329 0a0a 2020 2020 4070  eatures)..    @p
-000033c0: 6174 6368 2822 6365 7263 6973 2e64 756d  atch("cercis.dum
-000033d0: 705f 746f 5f66 696c 6522 2c20 6475 6d70  p_to_file", dump
-000033e0: 5f74 6f5f 7374 6465 7272 290a 2020 2020  _to_stderr).    
-000033f0: 6465 6620 7465 7374 5f73 7472 696e 675f  def test_string_
-00003400: 7175 6f74 6573 2873 656c 6629 202d 3e20  quotes(self) -> 
-00003410: 4e6f 6e65 3a0a 2020 2020 2020 2020 736f  None:.        so
-00003420: 7572 6365 2c20 6578 7065 6374 6564 203d  urce, expected =
-00003430: 2072 6561 645f 6461 7461 2822 6d69 7363   read_data("misc
-00003440: 656c 6c61 6e65 6f75 7322 2c20 2273 7472  ellaneous", "str
-00003450: 696e 675f 7175 6f74 6573 2229 0a20 2020  ing_quotes").   
-00003460: 2020 2020 206d 6f64 6520 3d20 6365 7263       mode = cerc
-00003470: 6973 2e4d 6f64 6528 7072 6576 6965 773d  is.Mode(preview=
-00003480: 5472 7565 2c20 7369 6e67 6c65 5f71 756f  True, single_quo
-00003490: 7465 3d46 616c 7365 290a 2020 2020 2020  te=False).      
-000034a0: 2020 6173 7365 7274 5f66 6f72 6d61 7428    assert_format(
-000034b0: 736f 7572 6365 2c20 6578 7065 6374 6564  source, expected
-000034c0: 2c20 6d6f 6465 290a 2020 2020 2020 2020  , mode).        
-000034d0: 6d6f 6465 203d 2072 6570 6c61 6365 286d  mode = replace(m
-000034e0: 6f64 652c 2073 7472 696e 675f 6e6f 726d  ode, string_norm
-000034f0: 616c 697a 6174 696f 6e3d 4661 6c73 6529  alization=False)
-00003500: 0a20 2020 2020 2020 206e 6f74 5f6e 6f72  .        not_nor
-00003510: 6d61 6c69 7a65 6420 3d20 6673 2873 6f75  malized = fs(sou
-00003520: 7263 652c 206d 6f64 653d 6d6f 6465 290a  rce, mode=mode).
-00003530: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00003540: 6572 7446 6f72 6d61 7445 7175 616c 2873  ertFormatEqual(s
-00003550: 6f75 7263 652e 7265 706c 6163 6528 225c  ource.replace("\
-00003560: 5c5c 6e22 2c20 2222 292c 206e 6f74 5f6e  \\n", ""), not_n
-00003570: 6f72 6d61 6c69 7a65 6429 0a20 2020 2020  ormalized).     
-00003580: 2020 2063 6572 6369 732e 6173 7365 7274     cercis.assert
-00003590: 5f65 7175 6976 616c 656e 7428 736f 7572  _equivalent(sour
-000035a0: 6365 2c20 6e6f 745f 6e6f 726d 616c 697a  ce, not_normaliz
-000035b0: 6564 290a 2020 2020 2020 2020 6365 7263  ed).        cerc
-000035c0: 6973 2e61 7373 6572 745f 7374 6162 6c65  is.assert_stable
-000035d0: 2873 6f75 7263 652c 206e 6f74 5f6e 6f72  (source, not_nor
-000035e0: 6d61 6c69 7a65 642c 206d 6f64 653d 6d6f  malized, mode=mo
-000035f0: 6465 290a 0a20 2020 2064 6566 2074 6573  de)..    def tes
-00003600: 745f 736b 6970 5f73 6f75 7263 655f 6669  t_skip_source_fi
-00003610: 7273 745f 6c69 6e65 2873 656c 6629 202d  rst_line(self) -
-00003620: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00003630: 736f 7572 6365 2c20 5f20 3d20 7265 6164  source, _ = read
-00003640: 5f64 6174 6128 226d 6973 6365 6c6c 616e  _data("miscellan
-00003650: 656f 7573 222c 2022 696e 7661 6c69 645f  eous", "invalid_
-00003660: 6865 6164 6572 2229 0a20 2020 2020 2020  header").       
-00003670: 2074 6d70 5f66 696c 6520 3d20 5061 7468   tmp_file = Path
-00003680: 2863 6572 6369 732e 6475 6d70 5f74 6f5f  (cercis.dump_to_
-00003690: 6669 6c65 2873 6f75 7263 6529 290a 2020  file(source)).  
-000036a0: 2020 2020 2020 2320 4675 6c6c 2073 6f75        # Full sou
-000036b0: 7263 6520 7368 6f75 6c64 2066 6169 6c20  rce should fail 
-000036c0: 2869 6e76 616c 6964 2073 796e 7461 7820  (invalid syntax 
-000036d0: 6174 2068 6561 6465 7229 0a20 2020 2020  at header).     
-000036e0: 2020 2073 656c 662e 696e 766f 6b65 426c     self.invokeBl
-000036f0: 6163 6b28 5b73 7472 2874 6d70 5f66 696c  ack([str(tmp_fil
-00003700: 6529 2c20 222d 2d64 6966 6622 2c20 222d  e), "--diff", "-
-00003710: 2d63 6865 636b 225d 2c20 6578 6974 5f63  -check"], exit_c
-00003720: 6f64 653d 3132 3329 0a20 2020 2020 2020  ode=123).       
-00003730: 2023 2053 6f2c 2073 6b69 7070 696e 6720   # So, skipping 
-00003740: 7468 6520 6669 7273 7420 6c69 6e65 2073  the first line s
-00003750: 686f 756c 6420 776f 726b 0a20 2020 2020  hould work.     
-00003760: 2020 2072 6573 756c 7420 3d20 426c 6163     result = Blac
-00003770: 6b52 756e 6e65 7228 292e 696e 766f 6b65  kRunner().invoke
-00003780: 280a 2020 2020 2020 2020 2020 2020 6365  (.            ce
-00003790: 7263 6973 2e6d 6169 6e2c 205b 7374 7228  rcis.main, [str(
-000037a0: 746d 705f 6669 6c65 292c 2022 2d78 222c  tmp_file), "-x",
-000037b0: 2066 222d 2d63 6f6e 6669 673d 7b45 4d50   f"--config={EMP
-000037c0: 5459 5f43 4f4e 4649 477d 225d 0a20 2020  TY_CONFIG}"].   
-000037d0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-000037e0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-000037f0: 7265 7375 6c74 2e65 7869 745f 636f 6465  result.exit_code
-00003800: 2c20 3029 0a20 2020 2020 2020 2077 6974  , 0).        wit
-00003810: 6820 6f70 656e 2874 6d70 5f66 696c 652c  h open(tmp_file,
-00003820: 2065 6e63 6f64 696e 673d 2275 7466 3822   encoding="utf8"
-00003830: 2920 6173 2066 3a0a 2020 2020 2020 2020  ) as f:.        
-00003840: 2020 2020 6163 7475 616c 203d 2066 2e72      actual = f.r
-00003850: 6561 6428 290a 2020 2020 2020 2020 7365  ead().        se
-00003860: 6c66 2e61 7373 6572 7446 6f72 6d61 7445  lf.assertFormatE
-00003870: 7175 616c 2873 6f75 7263 652c 2061 6374  qual(source, act
-00003880: 7561 6c29 0a0a 2020 2020 6465 6620 7465  ual)..    def te
-00003890: 7374 5f73 6b69 705f 736f 7572 6365 5f66  st_skip_source_f
-000038a0: 6972 7374 5f6c 696e 655f 7768 656e 5f6d  irst_line_when_m
-000038b0: 6978 696e 675f 6e65 776c 696e 6573 2873  ixing_newlines(s
-000038c0: 656c 6629 202d 3e20 4e6f 6e65 3a0a 2020  elf) -> None:.  
-000038d0: 2020 2020 2020 636f 6465 5f6d 6978 696e        code_mixin
-000038e0: 675f 6e65 776c 696e 6573 203d 2062 2248  g_newlines = b"H
-000038f0: 6561 6465 7220 7769 6c6c 2062 6520 736b  eader will be sk
-00003900: 6970 7065 645c 725c 6e69 203d 205b 312c  ipped\r\ni = [1,
-00003910: 322c 335d 5c6e 6a20 3d20 5b31 2c32 2c33  2,3]\nj = [1,2,3
-00003920: 5d5c 6e22 0a20 2020 2020 2020 2065 7870  ]\n".        exp
-00003930: 6563 7465 6420 3d20 6222 4865 6164 6572  ected = b"Header
-00003940: 2077 696c 6c20 6265 2073 6b69 7070 6564   will be skipped
-00003950: 5c72 5c6e 6920 3d20 5b31 2c20 322c 2033  \r\ni = [1, 2, 3
-00003960: 5d5c 6e6a 203d 205b 312c 2032 2c20 335d  ]\nj = [1, 2, 3]
-00003970: 5c6e 220a 2020 2020 2020 2020 7769 7468  \n".        with
-00003980: 2054 656d 706f 7261 7279 4469 7265 6374   TemporaryDirect
-00003990: 6f72 7928 2920 6173 2077 6f72 6b73 7061  ory() as workspa
-000039a0: 6365 3a0a 2020 2020 2020 2020 2020 2020  ce:.            
-000039b0: 7465 7374 5f66 696c 6520 3d20 5061 7468  test_file = Path
-000039c0: 2877 6f72 6b73 7061 6365 2920 2f20 2273  (workspace) / "s
-000039d0: 6b69 705f 6865 6164 6572 2e70 7922 0a20  kip_header.py". 
-000039e0: 2020 2020 2020 2020 2020 2074 6573 745f             test_
-000039f0: 6669 6c65 2e77 7269 7465 5f62 7974 6573  file.write_bytes
-00003a00: 2863 6f64 655f 6d69 7869 6e67 5f6e 6577  (code_mixing_new
-00003a10: 6c69 6e65 7329 0a20 2020 2020 2020 2020  lines).         
-00003a20: 2020 206d 6f64 6520 3d20 7265 706c 6163     mode = replac
-00003a30: 6528 4445 4641 554c 545f 4d4f 4445 2c20  e(DEFAULT_MODE, 
-00003a40: 736b 6970 5f73 6f75 7263 655f 6669 7273  skip_source_firs
-00003a50: 745f 6c69 6e65 3d54 7275 6529 0a20 2020  t_line=True).   
-00003a60: 2020 2020 2020 2020 2066 6628 7465 7374           ff(test
-00003a70: 5f66 696c 652c 206d 6f64 653d 6d6f 6465  _file, mode=mode
-00003a80: 2c20 7772 6974 655f 6261 636b 3d63 6572  , write_back=cer
-00003a90: 6369 732e 5772 6974 6542 6163 6b2e 5945  cis.WriteBack.YE
-00003aa0: 5329 0a20 2020 2020 2020 2020 2020 2073  S).            s
-00003ab0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00003ac0: 7465 7374 5f66 696c 652e 7265 6164 5f62  test_file.read_b
-00003ad0: 7974 6573 2829 2c20 6578 7065 6374 6564  ytes(), expected
-00003ae0: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
-00003af0: 736b 6970 5f6d 6167 6963 5f74 7261 696c  skip_magic_trail
-00003b00: 696e 675f 636f 6d6d 6128 7365 6c66 2920  ing_comma(self) 
-00003b10: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00003b20: 2073 6f75 7263 652c 205f 203d 2072 6561   source, _ = rea
-00003b30: 645f 6461 7461 2822 7369 6d70 6c65 5f63  d_data("simple_c
-00003b40: 6173 6573 222c 2022 6578 7072 6573 7369  ases", "expressi
-00003b50: 6f6e 2229 0a20 2020 2020 2020 2065 7870  on").        exp
-00003b60: 6563 7465 642c 205f 203d 2072 6561 645f  ected, _ = read_
-00003b70: 6461 7461 280a 2020 2020 2020 2020 2020  data(.          
-00003b80: 2020 226d 6973 6365 6c6c 616e 656f 7573    "miscellaneous
-00003b90: 222c 2022 6578 7072 6573 7369 6f6e 5f73  ", "expression_s
-00003ba0: 6b69 705f 6d61 6769 635f 7472 6169 6c69  kip_magic_traili
-00003bb0: 6e67 5f63 6f6d 6d61 2e64 6966 6622 0a20  ng_comma.diff". 
-00003bc0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00003bd0: 2074 6d70 5f66 696c 6520 3d20 5061 7468   tmp_file = Path
-00003be0: 2863 6572 6369 732e 6475 6d70 5f74 6f5f  (cercis.dump_to_
-00003bf0: 6669 6c65 2873 6f75 7263 6529 290a 2020  file(source)).  
-00003c00: 2020 2020 2020 6469 6666 5f68 6561 6465        diff_heade
-00003c10: 7220 3d20 7265 2e63 6f6d 7069 6c65 280a  r = re.compile(.
-00003c20: 2020 2020 2020 2020 2020 2020 7266 227b              rf"{
-00003c30: 7265 2e65 7363 6170 6528 7374 7228 746d  re.escape(str(tm
-00003c40: 705f 6669 6c65 2929 7d5c 745c 645c 645c  p_file))}\t\d\d\
-00003c50: 645c 642d 5c64 5c64 2d5c 645c 6420 220a  d\d-\d\d-\d\d ".
-00003c60: 2020 2020 2020 2020 2020 2020 7222 5c64              r"\d
-00003c70: 5c64 3a5c 645c 643a 5c64 5c64 5c2e 5c64  \d:\d\d:\d\d\.\d
-00003c80: 5c64 5c64 5c64 5c64 5c64 5c2b 5c64 5c64  \d\d\d\d\d\+\d\d
-00003c90: 3a5c 645c 6422 0a20 2020 2020 2020 2029  :\d\d".        )
-00003ca0: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
-00003cb0: 2020 2020 2020 2020 2020 7265 7375 6c74            result
-00003cc0: 203d 2042 6c61 636b 5275 6e6e 6572 2829   = BlackRunner()
-00003cd0: 2e69 6e76 6f6b 6528 0a20 2020 2020 2020  .invoke(.       
-00003ce0: 2020 2020 2020 2020 2063 6572 6369 732e           cercis.
-00003cf0: 6d61 696e 2c0a 2020 2020 2020 2020 2020  main,.          
-00003d00: 2020 2020 2020 5b0a 2020 2020 2020 2020        [.        
-00003d10: 2020 2020 2020 2020 2020 2020 222d 4322              "-C"
-00003d20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00003d30: 2020 2020 2020 222d 2d64 6966 6622 2c0a        "--diff",.
-00003d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003d50: 2020 2020 7374 7228 746d 705f 6669 6c65      str(tmp_file
-00003d60: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00003d70: 2020 2020 2020 2066 222d 2d63 6f6e 6669         f"--confi
-00003d80: 673d 7b45 4d50 5459 5f43 4f4e 4649 477d  g={EMPTY_CONFIG}
-00003d90: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00003da0: 2020 2020 2020 2022 2d2d 6c69 6e65 2d6c         "--line-l
-00003db0: 656e 6774 683d 3838 222c 0a20 2020 2020  ength=88",.     
-00003dc0: 2020 2020 2020 2020 2020 205d 2c0a 2020             ],.  
-00003dd0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00003de0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00003df0: 6572 7445 7175 616c 2872 6573 756c 742e  ertEqual(result.
-00003e00: 6578 6974 5f63 6f64 652c 2030 290a 2020  exit_code, 0).  
-00003e10: 2020 2020 2020 6669 6e61 6c6c 793a 0a20        finally:. 
-00003e20: 2020 2020 2020 2020 2020 206f 732e 756e             os.un
-00003e30: 6c69 6e6b 2874 6d70 5f66 696c 6529 0a20  link(tmp_file). 
-00003e40: 2020 2020 2020 2061 6374 7561 6c20 3d20         actual = 
-00003e50: 7265 7375 6c74 2e6f 7574 7075 740a 2020  result.output.  
-00003e60: 2020 2020 2020 6163 7475 616c 203d 2064        actual = d
-00003e70: 6966 665f 6865 6164 6572 2e73 7562 2844  iff_header.sub(D
-00003e80: 4554 4552 4d49 4e49 5354 4943 5f48 4541  ETERMINISTIC_HEA
-00003e90: 4445 522c 2061 6374 7561 6c29 0a20 2020  DER, actual).   
-00003ea0: 2020 2020 2061 6374 7561 6c20 3d20 6163       actual = ac
-00003eb0: 7475 616c 2e72 7374 7269 7028 2920 2b20  tual.rstrip() + 
-00003ec0: 225c 6e22 2020 2320 7468 6520 6469 6666  "\n"  # the diff
-00003ed0: 206f 7574 7075 7420 6861 7320 6120 7472   output has a tr
-00003ee0: 6169 6c69 6e67 2073 7061 6365 0a20 2020  ailing space.   
-00003ef0: 2020 2020 2069 6620 6578 7065 6374 6564       if expected
-00003f00: 2021 3d20 6163 7475 616c 3a0a 2020 2020   != actual:.    
-00003f10: 2020 2020 2020 2020 6475 6d70 203d 2063          dump = c
-00003f20: 6572 6369 732e 6475 6d70 5f74 6f5f 6669  ercis.dump_to_fi
-00003f30: 6c65 2861 6374 7561 6c29 0a20 2020 2020  le(actual).     
-00003f40: 2020 2020 2020 206d 7367 203d 2028 0a20         msg = (. 
-00003f50: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00003f60: 4578 7065 6374 6564 2064 6966 6620 6973  Expected diff is
-00003f70: 6e27 7420 6571 7561 6c20 746f 2074 6865  n't equal to the
-00003f80: 2061 6374 7561 6c2e 2049 6620 796f 7520   actual. If you 
-00003f90: 6d61 6465 2063 6861 6e67 6573 2074 6f22  made changes to"
-00003fa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003fb0: 2022 2065 7870 7265 7373 696f 6e2e 7079   " expression.py
-00003fc0: 2061 6e64 2074 6869 7320 6973 2061 6e20   and this is an 
-00003fd0: 616e 7469 6369 7061 7465 6420 6469 6666  anticipated diff
-00003fe0: 6572 656e 6365 2c20 6f76 6572 7772 6974  erence, overwrit
-00003ff0: 6522 0a20 2020 2020 2020 2020 2020 2020  e".             
-00004000: 2020 2022 2074 6573 7473 2f64 6174 612f     " tests/data/
-00004010: 6d69 7363 656c 6c61 6e65 6f75 732f 6578  miscellaneous/ex
-00004020: 7072 6573 7369 6f6e 5f73 6b69 705f 6d61  pression_skip_ma
-00004030: 6769 635f 7472 6169 6c69 6e67 5f63 6f6d  gic_trailing_com
-00004040: 6d61 2e64 6966 6622 0a20 2020 2020 2020  ma.diff".       
-00004050: 2020 2020 2020 2020 2066 2220 7769 7468           f" with
-00004060: 207b 6475 6d70 7d22 0a20 2020 2020 2020   {dump}".       
-00004070: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00004080: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00004090: 7561 6c28 6578 7065 6374 6564 2c20 6163  ual(expected, ac
-000040a0: 7475 616c 2c20 6d73 6729 0a0a 2020 2020  tual, msg)..    
-000040b0: 4070 6174 6368 2822 6365 7263 6973 2e64  @patch("cercis.d
-000040c0: 756d 705f 746f 5f66 696c 6522 2c20 6475  ump_to_file", du
-000040d0: 6d70 5f74 6f5f 7374 6465 7272 290a 2020  mp_to_stderr).  
-000040e0: 2020 6465 6620 7465 7374 5f61 7379 6e63    def test_async
-000040f0: 5f61 735f 6964 656e 7469 6669 6572 2873  _as_identifier(s
-00004100: 656c 6629 202d 3e20 4e6f 6e65 3a0a 2020  elf) -> None:.  
-00004110: 2020 2020 2020 736f 7572 6365 5f70 6174        source_pat
-00004120: 6820 3d20 6765 745f 6361 7365 5f70 6174  h = get_case_pat
-00004130: 6828 226d 6973 6365 6c6c 616e 656f 7573  h("miscellaneous
-00004140: 222c 2022 6173 796e 635f 6173 5f69 6465  ", "async_as_ide
-00004150: 6e74 6966 6965 7222 290a 2020 2020 2020  ntifier").      
-00004160: 2020 736f 7572 6365 2c20 6578 7065 6374    source, expect
-00004170: 6564 203d 2072 6561 645f 6461 7461 5f66  ed = read_data_f
-00004180: 726f 6d5f 6669 6c65 2873 6f75 7263 655f  rom_file(source_
-00004190: 7061 7468 290a 2020 2020 2020 2020 6163  path).        ac
-000041a0: 7475 616c 203d 2066 7328 736f 7572 6365  tual = fs(source
-000041b0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-000041c0: 7373 6572 7446 6f72 6d61 7445 7175 616c  ssertFormatEqual
-000041d0: 2865 7870 6563 7465 642c 2061 6374 7561  (expected, actua
-000041e0: 6c29 0a20 2020 2020 2020 206d 616a 6f72  l).        major
-000041f0: 2c20 6d69 6e6f 7220 3d20 7379 732e 7665  , minor = sys.ve
-00004200: 7273 696f 6e5f 696e 666f 5b3a 325d 0a20  rsion_info[:2]. 
-00004210: 2020 2020 2020 2069 6620 6d61 6a6f 7220         if major 
-00004220: 3c20 3320 6f72 2028 6d61 6a6f 7220 3c3d  < 3 or (major <=
-00004230: 2033 2061 6e64 206d 696e 6f72 203c 2037   3 and minor < 7
-00004240: 293a 0a20 2020 2020 2020 2020 2020 2063  ):.            c
-00004250: 6572 6369 732e 6173 7365 7274 5f65 7175  ercis.assert_equ
-00004260: 6976 616c 656e 7428 736f 7572 6365 2c20  ivalent(source, 
-00004270: 6163 7475 616c 290a 2020 2020 2020 2020  actual).        
-00004280: 6365 7263 6973 2e61 7373 6572 745f 7374  cercis.assert_st
-00004290: 6162 6c65 2873 6f75 7263 652c 2061 6374  able(source, act
-000042a0: 7561 6c2c 2044 4546 4155 4c54 5f4d 4f44  ual, DEFAULT_MOD
-000042b0: 4529 0a20 2020 2020 2020 2023 2065 6e73  E).        # ens
-000042c0: 7572 6520 6365 7263 6973 2063 616e 2070  ure cercis can p
-000042d0: 6172 7365 2074 6869 7320 7768 656e 2074  arse this when t
-000042e0: 6865 2074 6172 6765 7420 6973 2033 2e36  he target is 3.6
-000042f0: 0a20 2020 2020 2020 2073 656c 662e 696e  .        self.in
-00004300: 766f 6b65 426c 6163 6b28 5b73 7472 2873  vokeBlack([str(s
-00004310: 6f75 7263 655f 7061 7468 292c 2022 2d2d  ource_path), "--
-00004320: 7461 7267 6574 2d76 6572 7369 6f6e 222c  target-version",
-00004330: 2022 7079 3336 225d 290a 2020 2020 2020   "py36"]).      
-00004340: 2020 2320 6275 7420 6e6f 7420 6f6e 2033    # but not on 3
-00004350: 2e37 2c20 6265 6361 7573 6520 6173 796e  .7, because asyn
-00004360: 632f 6177 6169 7420 6973 206e 6f20 6c6f  c/await is no lo
-00004370: 6e67 6572 2061 6e20 6964 656e 7469 6669  nger an identifi
-00004380: 6572 0a20 2020 2020 2020 2073 656c 662e  er.        self.
-00004390: 696e 766f 6b65 426c 6163 6b28 5b73 7472  invokeBlack([str
-000043a0: 2873 6f75 7263 655f 7061 7468 292c 2022  (source_path), "
-000043b0: 2d2d 7461 7267 6574 2d76 6572 7369 6f6e  --target-version
-000043c0: 222c 2022 7079 3337 225d 2c20 6578 6974  ", "py37"], exit
-000043d0: 5f63 6f64 653d 3132 3329 0a0a 2020 2020  _code=123)..    
-000043e0: 4070 6174 6368 2822 6365 7263 6973 2e64  @patch("cercis.d
-000043f0: 756d 705f 746f 5f66 696c 6522 2c20 6475  ump_to_file", du
-00004400: 6d70 5f74 6f5f 7374 6465 7272 290a 2020  mp_to_stderr).  
-00004410: 2020 6465 6620 7465 7374 5f70 7974 686f    def test_pytho
-00004420: 6e33 3728 7365 6c66 2920 2d3e 204e 6f6e  n37(self) -> Non
-00004430: 653a 0a20 2020 2020 2020 2073 6f75 7263  e:.        sourc
-00004440: 655f 7061 7468 203d 2067 6574 5f63 6173  e_path = get_cas
-00004450: 655f 7061 7468 2822 7079 5f33 3722 2c20  e_path("py_37", 
-00004460: 2270 7974 686f 6e33 3722 290a 2020 2020  "python37").    
-00004470: 2020 2020 736f 7572 6365 2c20 6578 7065      source, expe
-00004480: 6374 6564 203d 2072 6561 645f 6461 7461  cted = read_data
-00004490: 5f66 726f 6d5f 6669 6c65 2873 6f75 7263  _from_file(sourc
-000044a0: 655f 7061 7468 290a 2020 2020 2020 2020  e_path).        
-000044b0: 6163 7475 616c 203d 2066 7328 736f 7572  actual = fs(sour
-000044c0: 6365 290a 2020 2020 2020 2020 7365 6c66  ce).        self
-000044d0: 2e61 7373 6572 7446 6f72 6d61 7445 7175  .assertFormatEqu
-000044e0: 616c 2865 7870 6563 7465 642c 2061 6374  al(expected, act
-000044f0: 7561 6c29 0a20 2020 2020 2020 206d 616a  ual).        maj
-00004500: 6f72 2c20 6d69 6e6f 7220 3d20 7379 732e  or, minor = sys.
-00004510: 7665 7273 696f 6e5f 696e 666f 5b3a 325d  version_info[:2]
-00004520: 0a20 2020 2020 2020 2069 6620 6d61 6a6f  .        if majo
-00004530: 7220 3e20 3320 6f72 2028 6d61 6a6f 7220  r > 3 or (major 
-00004540: 3d3d 2033 2061 6e64 206d 696e 6f72 203e  == 3 and minor >
-00004550: 3d20 3729 3a0a 2020 2020 2020 2020 2020  = 7):.          
-00004560: 2020 6365 7263 6973 2e61 7373 6572 745f    cercis.assert_
-00004570: 6571 7569 7661 6c65 6e74 2873 6f75 7263  equivalent(sourc
-00004580: 652c 2061 6374 7561 6c29 0a20 2020 2020  e, actual).     
-00004590: 2020 2063 6572 6369 732e 6173 7365 7274     cercis.assert
-000045a0: 5f73 7461 626c 6528 736f 7572 6365 2c20  _stable(source, 
-000045b0: 6163 7475 616c 2c20 4445 4641 554c 545f  actual, DEFAULT_
-000045c0: 4d4f 4445 290a 2020 2020 2020 2020 2320  MODE).        # 
-000045d0: 656e 7375 7265 2063 6572 6369 7320 6361  ensure cercis ca
-000045e0: 6e20 7061 7273 6520 7468 6973 2077 6865  n parse this whe
-000045f0: 6e20 7468 6520 7461 7267 6574 2069 7320  n the target is 
-00004600: 332e 370a 2020 2020 2020 2020 7365 6c66  3.7.        self
-00004610: 2e69 6e76 6f6b 6542 6c61 636b 285b 7374  .invokeBlack([st
-00004620: 7228 736f 7572 6365 5f70 6174 6829 2c20  r(source_path), 
-00004630: 222d 2d74 6172 6765 742d 7665 7273 696f  "--target-versio
-00004640: 6e22 2c20 2270 7933 3722 5d29 0a20 2020  n", "py37"]).   
-00004650: 2020 2020 2023 2062 7574 206e 6f74 206f       # but not o
-00004660: 6e20 332e 362c 2062 6563 6175 7365 2077  n 3.6, because w
-00004670: 6520 7573 6520 6173 796e 6320 6173 2061  e use async as a
-00004680: 2072 6573 6572 7665 6420 6b65 7977 6f72   reserved keywor
-00004690: 640a 2020 2020 2020 2020 7365 6c66 2e69  d.        self.i
-000046a0: 6e76 6f6b 6542 6c61 636b 285b 7374 7228  nvokeBlack([str(
-000046b0: 736f 7572 6365 5f70 6174 6829 2c20 222d  source_path), "-
-000046c0: 2d74 6172 6765 742d 7665 7273 696f 6e22  -target-version"
-000046d0: 2c20 2270 7933 3622 5d2c 2065 7869 745f  , "py36"], exit_
-000046e0: 636f 6465 3d31 3233 290a 0a20 2020 2064  code=123)..    d
-000046f0: 6566 2074 6573 745f 7461 625f 636f 6d6d  ef test_tab_comm
-00004700: 656e 745f 696e 6465 6e74 6174 696f 6e28  ent_indentation(
-00004710: 7365 6c66 2920 2d3e 204e 6f6e 653a 0a20  self) -> None:. 
-00004720: 2020 2020 2020 2063 6f6e 7465 6e74 735f         contents_
-00004730: 7461 6220 3d20 2269 6620 313a 5c6e 5c74  tab = "if 1:\n\t
-00004740: 6966 2032 3a5c 6e5c 745c 7470 6173 735c  if 2:\n\t\tpass\
-00004750: 6e5c 7423 2063 6f6d 6d65 6e74 5c6e 5c74  n\t# comment\n\t
-00004760: 7061 7373 5c6e 220a 2020 2020 2020 2020  pass\n".        
-00004770: 636f 6e74 656e 7473 5f73 7063 203d 2022  contents_spc = "
-00004780: 6966 2031 3a5c 6e20 2020 2069 6620 323a  if 1:\n    if 2:
-00004790: 5c6e 2020 2020 2020 2020 7061 7373 5c6e  \n        pass\n
-000047a0: 2020 2020 2320 636f 6d6d 656e 745c 6e20      # comment\n 
-000047b0: 2020 2070 6173 735c 6e22 0a20 2020 2020     pass\n".     
-000047c0: 2020 2073 656c 662e 6173 7365 7274 466f     self.assertFo
-000047d0: 726d 6174 4571 7561 6c28 636f 6e74 656e  rmatEqual(conten
-000047e0: 7473 5f73 7063 2c20 6673 2863 6f6e 7465  ts_spc, fs(conte
-000047f0: 6e74 735f 7370 6329 290a 2020 2020 2020  nts_spc)).      
-00004800: 2020 7365 6c66 2e61 7373 6572 7446 6f72    self.assertFor
-00004810: 6d61 7445 7175 616c 2863 6f6e 7465 6e74  matEqual(content
-00004820: 735f 7370 632c 2066 7328 636f 6e74 656e  s_spc, fs(conten
-00004830: 7473 5f74 6162 2929 0a0a 2020 2020 2020  ts_tab))..      
-00004840: 2020 636f 6e74 656e 7473 5f74 6162 203d    contents_tab =
-00004850: 2022 6966 2031 3a5c 6e5c 7469 6620 323a   "if 1:\n\tif 2:
-00004860: 5c6e 5c74 5c74 7061 7373 5c6e 5c74 5c74  \n\t\tpass\n\t\t
-00004870: 2320 636f 6d6d 656e 745c 6e5c 7470 6173  # comment\n\tpas
-00004880: 735c 6e22 0a20 2020 2020 2020 2063 6f6e  s\n".        con
-00004890: 7465 6e74 735f 7370 6320 3d20 2269 6620  tents_spc = "if 
-000048a0: 313a 5c6e 2020 2020 6966 2032 3a5c 6e20  1:\n    if 2:\n 
-000048b0: 2020 2020 2020 2070 6173 735c 6e20 2020         pass\n   
-000048c0: 2020 2020 2023 2063 6f6d 6d65 6e74 5c6e       # comment\n
-000048d0: 2020 2020 7061 7373 5c6e 220a 2020 2020      pass\n".    
-000048e0: 2020 2020 7365 6c66 2e61 7373 6572 7446      self.assertF
-000048f0: 6f72 6d61 7445 7175 616c 2863 6f6e 7465  ormatEqual(conte
-00004900: 6e74 735f 7370 632c 2066 7328 636f 6e74  nts_spc, fs(cont
-00004910: 656e 7473 5f73 7063 2929 0a20 2020 2020  ents_spc)).     
-00004920: 2020 2073 656c 662e 6173 7365 7274 466f     self.assertFo
-00004930: 726d 6174 4571 7561 6c28 636f 6e74 656e  rmatEqual(conten
-00004940: 7473 5f73 7063 2c20 6673 2863 6f6e 7465  ts_spc, fs(conte
-00004950: 6e74 735f 7461 6229 290a 0a20 2020 2020  nts_tab))..     
-00004960: 2020 2023 206d 6978 6564 2074 6162 7320     # mixed tabs 
-00004970: 616e 6420 7370 6163 6573 2028 7661 6c69  and spaces (vali
-00004980: 6420 5079 7468 6f6e 2032 2063 6f64 6529  d Python 2 code)
-00004990: 0a20 2020 2020 2020 2063 6f6e 7465 6e74  .        content
-000049a0: 735f 7461 6220 3d20 2269 6620 313a 5c6e  s_tab = "if 1:\n
-000049b0: 2020 2020 2020 2020 6966 2032 3a5c 6e5c          if 2:\n\
-000049c0: 745c 7470 6173 735c 6e5c 7423 2063 6f6d  t\tpass\n\t# com
-000049d0: 6d65 6e74 5c6e 2020 2020 2020 2020 7061  ment\n        pa
-000049e0: 7373 5c6e 220a 2020 2020 2020 2020 636f  ss\n".        co
-000049f0: 6e74 656e 7473 5f73 7063 203d 2022 6966  ntents_spc = "if
-00004a00: 2031 3a5c 6e20 2020 2069 6620 323a 5c6e   1:\n    if 2:\n
-00004a10: 2020 2020 2020 2020 7061 7373 5c6e 2020          pass\n  
-00004a20: 2020 2320 636f 6d6d 656e 745c 6e20 2020    # comment\n   
-00004a30: 2070 6173 735c 6e22 0a20 2020 2020 2020   pass\n".       
-00004a40: 2073 656c 662e 6173 7365 7274 466f 726d   self.assertForm
-00004a50: 6174 4571 7561 6c28 636f 6e74 656e 7473  atEqual(contents
-00004a60: 5f73 7063 2c20 6673 2863 6f6e 7465 6e74  _spc, fs(content
-00004a70: 735f 7370 6329 290a 2020 2020 2020 2020  s_spc)).        
-00004a80: 7365 6c66 2e61 7373 6572 7446 6f72 6d61  self.assertForma
-00004a90: 7445 7175 616c 2863 6f6e 7465 6e74 735f  tEqual(contents_
-00004aa0: 7370 632c 2066 7328 636f 6e74 656e 7473  spc, fs(contents
-00004ab0: 5f74 6162 2929 0a0a 2020 2020 2020 2020  _tab))..        
-00004ac0: 636f 6e74 656e 7473 5f74 6162 203d 2022  contents_tab = "
-00004ad0: 6966 2031 3a5c 6e20 2020 2020 2020 2069  if 1:\n        i
-00004ae0: 6620 323a 5c6e 5c74 5c74 7061 7373 5c6e  f 2:\n\t\tpass\n
-00004af0: 5c74 5c74 2320 636f 6d6d 656e 745c 6e20  \t\t# comment\n 
-00004b00: 2020 2020 2020 2070 6173 735c 6e22 0a20         pass\n". 
-00004b10: 2020 2020 2020 2063 6f6e 7465 6e74 735f         contents_
-00004b20: 7370 6320 3d20 2269 6620 313a 5c6e 2020  spc = "if 1:\n  
-00004b30: 2020 6966 2032 3a5c 6e20 2020 2020 2020    if 2:\n       
-00004b40: 2070 6173 735c 6e20 2020 2020 2020 2023   pass\n        #
-00004b50: 2063 6f6d 6d65 6e74 5c6e 2020 2020 7061   comment\n    pa
-00004b60: 7373 5c6e 220a 2020 2020 2020 2020 7365  ss\n".        se
-00004b70: 6c66 2e61 7373 6572 7446 6f72 6d61 7445  lf.assertFormatE
-00004b80: 7175 616c 2863 6f6e 7465 6e74 735f 7370  qual(contents_sp
-00004b90: 632c 2066 7328 636f 6e74 656e 7473 5f73  c, fs(contents_s
-00004ba0: 7063 2929 0a20 2020 2020 2020 2073 656c  pc)).        sel
-00004bb0: 662e 6173 7365 7274 466f 726d 6174 4571  f.assertFormatEq
-00004bc0: 7561 6c28 636f 6e74 656e 7473 5f73 7063  ual(contents_spc
-00004bd0: 2c20 6673 2863 6f6e 7465 6e74 735f 7461  , fs(contents_ta
-00004be0: 6229 290a 0a20 2020 2064 6566 2074 6573  b))..    def tes
-00004bf0: 745f 6661 6c73 655f 706f 7369 7469 7665  t_false_positive
-00004c00: 5f73 796d 6c69 6e6b 5f6f 7574 7075 745f  _symlink_output_
-00004c10: 6973 7375 655f 3333 3834 2873 656c 6629  issue_3384(self)
-00004c20: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-00004c30: 2020 2320 456d 756c 6174 6520 7468 6520    # Emulate the 
-00004c40: 6265 6861 7669 6f72 2077 6865 6e20 7573  behavior when us
-00004c50: 696e 6720 7468 6520 434c 4920 2860 6365  ing the CLI (`ce
-00004c60: 7263 6973 202e 2f63 6869 6c64 2020 2d2d  rcis ./child  --
-00004c70: 7665 7262 6f73 6560 292c 2077 6869 6368  verbose`), which
-00004c80: 0a20 2020 2020 2020 2023 2069 6e76 6f6c  .        # invol
-00004c90: 7665 7320 7061 7463 6869 6e67 2073 6f6d  ves patching som
-00004ca0: 6520 6070 6174 686c 6962 2e50 6174 6860  e `pathlib.Path`
-00004cb0: 206d 6574 686f 6473 2e20 496e 2070 6172   methods. In par
-00004cc0: 7469 6375 6c61 722c 2060 6973 5f64 6972  ticular, `is_dir
-00004cd0: 6020 6973 0a20 2020 2020 2020 2023 2070  ` is.        # p
-00004ce0: 6174 6368 6564 206f 6e6c 7920 6f6e 2069  atched only on i
-00004cf0: 7473 2066 6972 7374 2063 616c 6c3a 2077  ts first call: w
-00004d00: 6865 6e20 6368 6563 6b69 6e67 2069 6620  hen checking if 
-00004d10: 222e 2f63 6869 6c64 2220 6973 2061 2064  "./child" is a d
-00004d20: 6972 6563 746f 7279 2069 740a 2020 2020  irectory it.    
-00004d30: 2020 2020 2320 7368 6f75 6c64 2072 6574      # should ret
-00004d40: 7572 6e20 5472 7565 2e20 5468 6520 222e  urn True. The ".
-00004d50: 2f63 6869 6c64 2220 666f 6c64 6572 2065  /child" folder e
-00004d60: 7869 7374 7320 7265 6c61 7469 7665 2074  xists relative t
-00004d70: 6f20 7468 6520 6377 6420 7768 656e 0a20  o the cwd when. 
-00004d80: 2020 2020 2020 2023 2072 756e 6e69 6e67         # running
-00004d90: 2066 726f 6d20 434c 492c 2062 7574 2066   from CLI, but f
-00004da0: 6169 6c73 2077 6865 6e20 7275 6e6e 696e  ails when runnin
-00004db0: 6720 7468 6520 7465 7374 7320 6265 6361  g the tests beca
-00004dc0: 7573 6520 6377 6420 6973 2064 6966 6665  use cwd is diffe
-00004dd0: 7265 6e74 0a20 2020 2020 2020 2070 726f  rent.        pro
-00004de0: 6a65 6374 5f72 6f6f 7420 3d20 5061 7468  ject_root = Path
-00004df0: 2854 4849 535f 4449 5220 2f20 2264 6174  (THIS_DIR / "dat
-00004e00: 6122 202f 2022 6e65 7374 6564 5f67 6974  a" / "nested_git
-00004e10: 6967 6e6f 7265 5f74 6573 7473 2229 0a20  ignore_tests"). 
-00004e20: 2020 2020 2020 2077 6f72 6b69 6e67 5f64         working_d
-00004e30: 6972 6563 746f 7279 203d 2070 726f 6a65  irectory = proje
-00004e40: 6374 5f72 6f6f 7420 2f20 2272 6f6f 7422  ct_root / "root"
-00004e50: 0a20 2020 2020 2020 2074 6172 6765 745f  .        target_
-00004e60: 6162 7370 6174 6820 3d20 776f 726b 696e  abspath = workin
-00004e70: 675f 6469 7265 6374 6f72 7920 2f20 2263  g_directory / "c
-00004e80: 6869 6c64 220a 2020 2020 2020 2020 7461  hild".        ta
-00004e90: 7267 6574 5f63 6f6e 7465 6e74 7320 3d20  rget_contents = 
-00004ea0: 280a 2020 2020 2020 2020 2020 2020 7372  (.            sr
-00004eb0: 632e 7265 6c61 7469 7665 5f74 6f28 776f  c.relative_to(wo
-00004ec0: 726b 696e 675f 6469 7265 6374 6f72 7929  rking_directory)
-00004ed0: 2066 6f72 2073 7263 2069 6e20 7461 7267   for src in targ
-00004ee0: 6574 5f61 6273 7061 7468 2e69 7465 7264  et_abspath.iterd
-00004ef0: 6972 2829 0a20 2020 2020 2020 2029 0a0a  ir().        )..
-00004f00: 2020 2020 2020 2020 6465 6620 6d6f 636b          def mock
-00004f10: 5f6e 5f63 616c 6c73 2872 6573 706f 6e73  _n_calls(respons
-00004f20: 6573 3a20 4c69 7374 5b62 6f6f 6c5d 2920  es: List[bool]) 
-00004f30: 2d3e 2043 616c 6c61 626c 655b 5b5d 2c20  -> Callable[[], 
-00004f40: 626f 6f6c 5d3a 0a20 2020 2020 2020 2020  bool]:.         
-00004f50: 2020 2064 6566 205f 6d6f 636b 6564 5f63     def _mocked_c
-00004f60: 616c 6c73 2829 202d 3e20 626f 6f6c 3a0a  alls() -> bool:.
-00004f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004f80: 6966 2072 6573 706f 6e73 6573 3a0a 2020  if responses:.  
-00004f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004fa0: 2020 7265 7475 726e 2072 6573 706f 6e73    return respons
-00004fb0: 6573 2e70 6f70 2830 290a 2020 2020 2020  es.pop(0).      
-00004fc0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00004fd0: 2046 616c 7365 0a0a 2020 2020 2020 2020   False..        
-00004fe0: 2020 2020 7265 7475 726e 205f 6d6f 636b      return _mock
-00004ff0: 6564 5f63 616c 6c73 0a0a 2020 2020 2020  ed_calls..      
-00005000: 2020 7769 7468 2070 6174 6368 2822 7061    with patch("pa
-00005010: 7468 6c69 622e 5061 7468 2e69 7465 7264  thlib.Path.iterd
-00005020: 6972 222c 2072 6574 7572 6e5f 7661 6c75  ir", return_valu
-00005030: 653d 7461 7267 6574 5f63 6f6e 7465 6e74  e=target_content
-00005040: 7329 2c20 7061 7463 6828 0a20 2020 2020  s), patch(.     
-00005050: 2020 2020 2020 2022 7061 7468 6c69 622e         "pathlib.
-00005060: 5061 7468 2e63 7764 222c 2072 6574 7572  Path.cwd", retur
-00005070: 6e5f 7661 6c75 653d 776f 726b 696e 675f  n_value=working_
-00005080: 6469 7265 6374 6f72 790a 2020 2020 2020  directory.      
-00005090: 2020 292c 2070 6174 6368 2822 7061 7468    ), patch("path
-000050a0: 6c69 622e 5061 7468 2e69 735f 6469 7222  lib.Path.is_dir"
-000050b0: 2c20 7369 6465 5f65 6666 6563 743d 6d6f  , side_effect=mo
-000050c0: 636b 5f6e 5f63 616c 6c73 285b 5472 7565  ck_n_calls([True
-000050d0: 5d29 293a 0a20 2020 2020 2020 2020 2020  ])):.           
-000050e0: 2063 7478 203d 2046 616b 6543 6f6e 7465   ctx = FakeConte
-000050f0: 7874 2829 0a20 2020 2020 2020 2020 2020  xt().           
-00005100: 2063 7478 2e6f 626a 5b22 726f 6f74 225d   ctx.obj["root"]
-00005110: 203d 2070 726f 6a65 6374 5f72 6f6f 740a   = project_root.
-00005120: 2020 2020 2020 2020 2020 2020 7265 706f              repo
-00005130: 7274 203d 204d 6167 6963 4d6f 636b 2876  rt = MagicMock(v
-00005140: 6572 626f 7365 3d54 7275 6529 0a20 2020  erbose=True).   
-00005150: 2020 2020 2020 2020 2063 6572 6369 732e           cercis.
-00005160: 6765 745f 736f 7572 6365 7328 0a20 2020  get_sources(.   
-00005170: 2020 2020 2020 2020 2020 2020 2063 7478               ctx
-00005180: 3d63 7478 2c0a 2020 2020 2020 2020 2020  =ctx,.          
-00005190: 2020 2020 2020 7372 633d 2822 2e2f 6368        src=("./ch
-000051a0: 696c 6422 2c29 2c0a 2020 2020 2020 2020  ild",),.        
-000051b0: 2020 2020 2020 2020 7175 6965 743d 4661          quiet=Fa
-000051c0: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-000051d0: 2020 2020 2076 6572 626f 7365 3d54 7275       verbose=Tru
-000051e0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-000051f0: 2020 2069 6e63 6c75 6465 3d44 4546 4155     include=DEFAU
-00005200: 4c54 5f49 4e43 4c55 4445 2c0a 2020 2020  LT_INCLUDE,.    
-00005210: 2020 2020 2020 2020 2020 2020 6578 636c              excl
-00005220: 7564 653d 4e6f 6e65 2c0a 2020 2020 2020  ude=None,.      
-00005230: 2020 2020 2020 2020 2020 7265 706f 7274            report
-00005240: 3d72 6570 6f72 742c 0a20 2020 2020 2020  =report,.       
-00005250: 2020 2020 2020 2020 2065 7874 656e 645f           extend_
+00002870: 2020 2020 7374 7228 746d 705f 6669 6c65      str(tmp_file
+00002880: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00002890: 2020 2020 2020 2066 222d 2d63 6f6e 6669         f"--confi
+000028a0: 673d 7b45 4d50 5459 5f43 4f4e 4649 477d  g={EMPTY_CONFIG}
+000028b0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+000028c0: 2020 2020 2020 2022 2d2d 6c69 6e65 2d6c         "--line-l
+000028d0: 656e 6774 683d 3838 222c 0a20 2020 2020  ength=88",.     
+000028e0: 2020 2020 2020 2020 2020 205d 2c0a 2020             ],.  
+000028f0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00002900: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00002910: 6572 7445 7175 616c 2872 6573 756c 742e  ertEqual(result.
+00002920: 6578 6974 5f63 6f64 652c 2030 290a 2020  exit_code, 0).  
+00002930: 2020 2020 2020 6669 6e61 6c6c 793a 0a20        finally:. 
+00002940: 2020 2020 2020 2020 2020 206f 732e 756e             os.un
+00002950: 6c69 6e6b 2874 6d70 5f66 696c 6529 0a20  link(tmp_file). 
+00002960: 2020 2020 2020 2061 6374 7561 6c20 3d20         actual = 
+00002970: 7265 7375 6c74 2e6f 7574 7075 740a 2020  result.output.  
+00002980: 2020 2020 2020 6163 7475 616c 203d 2064        actual = d
+00002990: 6966 665f 6865 6164 6572 2e73 7562 2844  iff_header.sub(D
+000029a0: 4554 4552 4d49 4e49 5354 4943 5f48 4541  ETERMINISTIC_HEA
+000029b0: 4445 522c 2061 6374 7561 6c29 0a20 2020  DER, actual).   
+000029c0: 2020 2020 2069 6620 6578 7065 6374 6564       if expected
+000029d0: 2021 3d20 6163 7475 616c 3a0a 2020 2020   != actual:.    
+000029e0: 2020 2020 2020 2020 6475 6d70 203d 2063          dump = c
+000029f0: 6572 6369 732e 6475 6d70 5f74 6f5f 6669  ercis.dump_to_fi
+00002a00: 6c65 2861 6374 7561 6c29 0a20 2020 2020  le(actual).     
+00002a10: 2020 2020 2020 206d 7367 203d 2028 0a20         msg = (. 
+00002a20: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00002a30: 4578 7065 6374 6564 2064 6966 6620 6973  Expected diff is
+00002a40: 6e27 7420 6571 7561 6c20 746f 2074 6865  n't equal to the
+00002a50: 2061 6374 7561 6c2e 2049 6620 796f 7520   actual. If you 
+00002a60: 6d61 6465 2063 6861 6e67 6573 2074 6f22  made changes to"
+00002a70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002a80: 2022 2065 7870 7265 7373 696f 6e2e 7079   " expression.py
+00002a90: 2061 6e64 2074 6869 7320 6973 2061 6e20   and this is an 
+00002aa0: 616e 7469 6369 7061 7465 6420 6469 6666  anticipated diff
+00002ab0: 6572 656e 6365 2c20 6f76 6572 7772 6974  erence, overwrit
+00002ac0: 6522 0a20 2020 2020 2020 2020 2020 2020  e".             
+00002ad0: 2020 2066 2220 7465 7374 732f 6461 7461     f" tests/data
+00002ae0: 2f65 7870 7265 7373 696f 6e2e 6469 6666  /expression.diff
+00002af0: 2077 6974 6820 7b64 756d 707d 220a 2020   with {dump}".  
+00002b00: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00002b10: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00002b20: 6572 7445 7175 616c 2865 7870 6563 7465  ertEqual(expecte
+00002b30: 642c 2061 6374 7561 6c2c 206d 7367 290a  d, actual, msg).
+00002b40: 0a20 2020 2064 6566 2074 6573 745f 6578  .    def test_ex
+00002b50: 7072 6573 7369 6f6e 5f64 6966 665f 7769  pression_diff_wi
+00002b60: 7468 5f63 6f6c 6f72 2873 656c 6629 202d  th_color(self) -
+00002b70: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00002b80: 736f 7572 6365 2c20 5f20 3d20 7265 6164  source, _ = read
+00002b90: 5f64 6174 6128 2273 696d 706c 655f 6361  _data("simple_ca
+00002ba0: 7365 7322 2c20 2265 7870 7265 7373 696f  ses", "expressio
+00002bb0: 6e2e 7079 2229 0a20 2020 2020 2020 2065  n.py").        e
+00002bc0: 7870 6563 7465 642c 205f 203d 2072 6561  xpected, _ = rea
+00002bd0: 645f 6461 7461 2822 7369 6d70 6c65 5f63  d_data("simple_c
+00002be0: 6173 6573 222c 2022 6578 7072 6573 7369  ases", "expressi
+00002bf0: 6f6e 2e64 6966 6622 290a 2020 2020 2020  on.diff").      
+00002c00: 2020 746d 705f 6669 6c65 203d 2050 6174    tmp_file = Pat
+00002c10: 6828 6365 7263 6973 2e64 756d 705f 746f  h(cercis.dump_to
+00002c20: 5f66 696c 6528 736f 7572 6365 2929 0a20  _file(source)). 
+00002c30: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+00002c40: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
+00002c50: 2042 6c61 636b 5275 6e6e 6572 2829 2e69   BlackRunner().i
+00002c60: 6e76 6f6b 6528 0a20 2020 2020 2020 2020  nvoke(.         
+00002c70: 2020 2020 2020 2063 6572 6369 732e 6d61         cercis.ma
+00002c80: 696e 2c0a 2020 2020 2020 2020 2020 2020  in,.            
+00002c90: 2020 2020 5b22 2d2d 6469 6666 222c 2022      ["--diff", "
+00002ca0: 2d2d 636f 6c6f 7222 2c20 7374 7228 746d  --color", str(tm
+00002cb0: 705f 6669 6c65 292c 2066 222d 2d63 6f6e  p_file), f"--con
+00002cc0: 6669 673d 7b45 4d50 5459 5f43 4f4e 4649  fig={EMPTY_CONFI
+00002cd0: 477d 225d 2c0a 2020 2020 2020 2020 2020  G}"],.          
+00002ce0: 2020 290a 2020 2020 2020 2020 6669 6e61    ).        fina
+00002cf0: 6c6c 793a 0a20 2020 2020 2020 2020 2020  lly:.           
+00002d00: 206f 732e 756e 6c69 6e6b 2874 6d70 5f66   os.unlink(tmp_f
+00002d10: 696c 6529 0a20 2020 2020 2020 2061 6374  ile).        act
+00002d20: 7561 6c20 3d20 7265 7375 6c74 2e6f 7574  ual = result.out
+00002d30: 7075 740a 2020 2020 2020 2020 2320 5765  put.        # We
+00002d40: 2063 6865 636b 2074 6865 2063 6f6e 7465   check the conte
+00002d50: 6e74 7320 6f66 2074 6865 2064 6966 6620  nts of the diff 
+00002d60: 696e 2060 7465 7374 5f65 7870 7265 7373  in `test_express
+00002d70: 696f 6e5f 6469 6666 602e 2041 6c6c 0a20  ion_diff`. All. 
+00002d80: 2020 2020 2020 2023 2077 6520 6e65 6564         # we need
+00002d90: 2074 6f20 6368 6563 6b20 6865 7265 2069   to check here i
+00002da0: 7320 7468 6174 2063 6f6c 6f72 2063 6f64  s that color cod
+00002db0: 6573 2065 7869 7374 2069 6e20 7468 6520  es exist in the 
+00002dc0: 7265 7375 6c74 2e0a 2020 2020 2020 2020  result..        
+00002dd0: 7365 6c66 2e61 7373 6572 7449 6e28 225c  self.assertIn("\
+00002de0: 3033 335b 316d 222c 2061 6374 7561 6c29  033[1m", actual)
+00002df0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00002e00: 7365 7274 496e 2822 5c30 3333 5b33 366d  sertIn("\033[36m
+00002e10: 222c 2061 6374 7561 6c29 0a20 2020 2020  ", actual).     
+00002e20: 2020 2073 656c 662e 6173 7365 7274 496e     self.assertIn
+00002e30: 2822 5c30 3333 5b33 326d 222c 2061 6374  ("\033[32m", act
+00002e40: 7561 6c29 0a20 2020 2020 2020 2073 656c  ual).        sel
+00002e50: 662e 6173 7365 7274 496e 2822 5c30 3333  f.assertIn("\033
+00002e60: 5b33 316d 222c 2061 6374 7561 6c29 0a20  [31m", actual). 
+00002e70: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00002e80: 7274 496e 2822 5c30 3333 5b30 6d22 2c20  rtIn("\033[0m", 
+00002e90: 6163 7475 616c 290a 0a20 2020 2064 6566  actual)..    def
+00002ea0: 2074 6573 745f 6465 7465 6374 5f70 6f73   test_detect_pos
+00002eb0: 5f6f 6e6c 795f 6172 6775 6d65 6e74 7328  _only_arguments(
+00002ec0: 7365 6c66 2920 2d3e 204e 6f6e 653a 0a20  self) -> None:. 
+00002ed0: 2020 2020 2020 2073 6f75 7263 652c 205f         source, _
+00002ee0: 203d 2072 6561 645f 6461 7461 2822 7079   = read_data("py
+00002ef0: 5f33 3822 2c20 2270 6570 5f35 3730 2229  _38", "pep_570")
+00002f00: 0a20 2020 2020 2020 2072 6f6f 7420 3d20  .        root = 
+00002f10: 6365 7263 6973 2e6c 6962 3274 6f33 5f70  cercis.lib2to3_p
+00002f20: 6172 7365 2873 6f75 7263 6529 0a20 2020  arse(source).   
+00002f30: 2020 2020 2066 6561 7475 7265 7320 3d20       features = 
+00002f40: 6365 7263 6973 2e67 6574 5f66 6561 7475  cercis.get_featu
+00002f50: 7265 735f 7573 6564 2872 6f6f 7429 0a20  res_used(root). 
+00002f60: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00002f70: 7274 496e 2863 6572 6369 732e 4665 6174  rtIn(cercis.Feat
+00002f80: 7572 652e 504f 535f 4f4e 4c59 5f41 5247  ure.POS_ONLY_ARG
+00002f90: 554d 454e 5453 2c20 6665 6174 7572 6573  UMENTS, features
+00002fa0: 290a 2020 2020 2020 2020 7665 7273 696f  ).        versio
+00002fb0: 6e73 203d 2063 6572 6369 732e 6465 7465  ns = cercis.dete
+00002fc0: 6374 5f74 6172 6765 745f 7665 7273 696f  ct_target_versio
+00002fd0: 6e73 2872 6f6f 7429 0a20 2020 2020 2020  ns(root).       
+00002fe0: 2073 656c 662e 6173 7365 7274 496e 2863   self.assertIn(c
+00002ff0: 6572 6369 732e 5461 7267 6574 5665 7273  ercis.TargetVers
+00003000: 696f 6e2e 5059 3338 2c20 7665 7273 696f  ion.PY38, versio
+00003010: 6e73 290a 0a20 2020 2064 6566 2074 6573  ns)..    def tes
+00003020: 745f 6465 7465 6374 5f64 6562 7567 5f66  t_detect_debug_f
+00003030: 5f73 7472 696e 6773 2873 656c 6629 202d  _strings(self) -
+00003040: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00003050: 726f 6f74 203d 2063 6572 6369 732e 6c69  root = cercis.li
+00003060: 6232 746f 335f 7061 7273 6528 2222 2266  b2to3_parse("""f
+00003070: 227b 783d 7d22 2022 2222 290a 2020 2020  "{x=}" """).    
+00003080: 2020 2020 6665 6174 7572 6573 203d 2063      features = c
+00003090: 6572 6369 732e 6765 745f 6665 6174 7572  ercis.get_featur
+000030a0: 6573 5f75 7365 6428 726f 6f74 290a 2020  es_used(root).  
+000030b0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+000030c0: 7449 6e28 6365 7263 6973 2e46 6561 7475  tIn(cercis.Featu
+000030d0: 7265 2e44 4542 5547 5f46 5f53 5452 494e  re.DEBUG_F_STRIN
+000030e0: 4753 2c20 6665 6174 7572 6573 290a 2020  GS, features).  
+000030f0: 2020 2020 2020 7665 7273 696f 6e73 203d        versions =
+00003100: 2063 6572 6369 732e 6465 7465 6374 5f74   cercis.detect_t
+00003110: 6172 6765 745f 7665 7273 696f 6e73 2872  arget_versions(r
+00003120: 6f6f 7429 0a20 2020 2020 2020 2073 656c  oot).        sel
+00003130: 662e 6173 7365 7274 496e 2863 6572 6369  f.assertIn(cerci
+00003140: 732e 5461 7267 6574 5665 7273 696f 6e2e  s.TargetVersion.
+00003150: 5059 3338 2c20 7665 7273 696f 6e73 290a  PY38, versions).
+00003160: 0a20 2020 2020 2020 2072 6f6f 7420 3d20  .        root = 
+00003170: 6365 7263 6973 2e6c 6962 3274 6f33 5f70  cercis.lib2to3_p
+00003180: 6172 7365 280a 2020 2020 2020 2020 2020  arse(.          
+00003190: 2020 2222 2266 227b 787d 225c 6e66 277b    """f"{x}"\nf'{
+000031a0: 223d 227d 275c 6e66 277b 2878 3a3d 3529  "="}'\nf'{(x:=5)
+000031b0: 7d27 5c6e 6627 7b66 2861 3d22 333d 2229  }'\nf'{f(a="3=")
+000031c0: 7d27 5c6e 6627 7b78 3a3d 3130 7d27 5c6e  }'\nf'{x:=10}'\n
+000031d0: 2222 220a 2020 2020 2020 2020 290a 2020  """.        ).  
+000031e0: 2020 2020 2020 6665 6174 7572 6573 203d        features =
+000031f0: 2063 6572 6369 732e 6765 745f 6665 6174   cercis.get_feat
+00003200: 7572 6573 5f75 7365 6428 726f 6f74 290a  ures_used(root).
+00003210: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00003220: 6572 744e 6f74 496e 2863 6572 6369 732e  ertNotIn(cercis.
+00003230: 4665 6174 7572 652e 4445 4255 475f 465f  Feature.DEBUG_F_
+00003240: 5354 5249 4e47 532c 2066 6561 7475 7265  STRINGS, feature
+00003250: 7329 0a0a 2020 2020 2020 2020 2320 5765  s)..        # We
+00003260: 2064 6f6e 2774 2079 6574 2073 7570 706f   don't yet suppo
+00003270: 7274 2066 6561 7475 7265 2076 6572 7369  rt feature versi
+00003280: 6f6e 2064 6574 6563 7469 6f6e 2069 6e20  on detection in 
+00003290: 6e65 7374 6564 2066 2d73 7472 696e 6773  nested f-strings
+000032a0: 0a20 2020 2020 2020 2072 6f6f 7420 3d20  .        root = 
+000032b0: 6365 7263 6973 2e6c 6962 3274 6f33 5f70  cercis.lib2to3_p
+000032c0: 6172 7365 280a 2020 2020 2020 2020 2020  arse(.          
+000032d0: 2020 2222 2266 2268 6561 7264 2061 2072    """f"heard a r
+000032e0: 756d 6f75 7220 7468 6174 207b 2066 277b  umour that { f'{
+000032f0: 312b 313d 7d27 207d 202e 2e2e 2073 6565  1+1=}' } ... see
+00003300: 6d73 206c 696b 6520 6974 2063 6f75 6c64  ms like it could
+00003310: 2062 6520 7472 7565 2220 2222 220a 2020   be true" """.  
+00003320: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00003330: 6665 6174 7572 6573 203d 2063 6572 6369  features = cerci
+00003340: 732e 6765 745f 6665 6174 7572 6573 5f75  s.get_features_u
+00003350: 7365 6428 726f 6f74 290a 2020 2020 2020  sed(root).      
+00003360: 2020 7365 6c66 2e61 7373 6572 744e 6f74    self.assertNot
+00003370: 496e 2863 6572 6369 732e 4665 6174 7572  In(cercis.Featur
+00003380: 652e 4445 4255 475f 465f 5354 5249 4e47  e.DEBUG_F_STRING
+00003390: 532c 2066 6561 7475 7265 7329 0a0a 2020  S, features)..  
+000033a0: 2020 4070 6174 6368 2822 6365 7263 6973    @patch("cercis
+000033b0: 2e64 756d 705f 746f 5f66 696c 6522 2c20  .dump_to_file", 
+000033c0: 6475 6d70 5f74 6f5f 7374 6465 7272 290a  dump_to_stderr).
+000033d0: 2020 2020 6465 6620 7465 7374 5f73 7472      def test_str
+000033e0: 696e 675f 7175 6f74 6573 2873 656c 6629  ing_quotes(self)
+000033f0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00003400: 2020 736f 7572 6365 2c20 6578 7065 6374    source, expect
+00003410: 6564 203d 2072 6561 645f 6461 7461 2822  ed = read_data("
+00003420: 6d69 7363 656c 6c61 6e65 6f75 7322 2c20  miscellaneous", 
+00003430: 2273 7472 696e 675f 7175 6f74 6573 2229  "string_quotes")
+00003440: 0a20 2020 2020 2020 206d 6f64 6520 3d20  .        mode = 
+00003450: 6365 7263 6973 2e4d 6f64 6528 7072 6576  cercis.Mode(prev
+00003460: 6965 773d 5472 7565 2c20 7369 6e67 6c65  iew=True, single
+00003470: 5f71 756f 7465 3d46 616c 7365 290a 2020  _quote=False).  
+00003480: 2020 2020 2020 6173 7365 7274 5f66 6f72        assert_for
+00003490: 6d61 7428 736f 7572 6365 2c20 6578 7065  mat(source, expe
+000034a0: 6374 6564 2c20 6d6f 6465 290a 2020 2020  cted, mode).    
+000034b0: 2020 2020 6d6f 6465 203d 2072 6570 6c61      mode = repla
+000034c0: 6365 286d 6f64 652c 2073 7472 696e 675f  ce(mode, string_
+000034d0: 6e6f 726d 616c 697a 6174 696f 6e3d 4661  normalization=Fa
+000034e0: 6c73 6529 0a20 2020 2020 2020 206e 6f74  lse).        not
+000034f0: 5f6e 6f72 6d61 6c69 7a65 6420 3d20 6673  _normalized = fs
+00003500: 2873 6f75 7263 652c 206d 6f64 653d 6d6f  (source, mode=mo
+00003510: 6465 290a 2020 2020 2020 2020 7365 6c66  de).        self
+00003520: 2e61 7373 6572 7446 6f72 6d61 7445 7175  .assertFormatEqu
+00003530: 616c 2873 6f75 7263 652e 7265 706c 6163  al(source.replac
+00003540: 6528 225c 5c5c 6e22 2c20 2222 292c 206e  e("\\\n", ""), n
+00003550: 6f74 5f6e 6f72 6d61 6c69 7a65 6429 0a20  ot_normalized). 
+00003560: 2020 2020 2020 2063 6572 6369 732e 6173         cercis.as
+00003570: 7365 7274 5f65 7175 6976 616c 656e 7428  sert_equivalent(
+00003580: 736f 7572 6365 2c20 6e6f 745f 6e6f 726d  source, not_norm
+00003590: 616c 697a 6564 290a 2020 2020 2020 2020  alized).        
+000035a0: 6365 7263 6973 2e61 7373 6572 745f 7374  cercis.assert_st
+000035b0: 6162 6c65 2873 6f75 7263 652c 206e 6f74  able(source, not
+000035c0: 5f6e 6f72 6d61 6c69 7a65 642c 206d 6f64  _normalized, mod
+000035d0: 653d 6d6f 6465 290a 0a20 2020 2064 6566  e=mode)..    def
+000035e0: 2074 6573 745f 736b 6970 5f73 6f75 7263   test_skip_sourc
+000035f0: 655f 6669 7273 745f 6c69 6e65 2873 656c  e_first_line(sel
+00003600: 6629 202d 3e20 4e6f 6e65 3a0a 2020 2020  f) -> None:.    
+00003610: 2020 2020 736f 7572 6365 2c20 5f20 3d20      source, _ = 
+00003620: 7265 6164 5f64 6174 6128 226d 6973 6365  read_data("misce
+00003630: 6c6c 616e 656f 7573 222c 2022 696e 7661  llaneous", "inva
+00003640: 6c69 645f 6865 6164 6572 2229 0a20 2020  lid_header").   
+00003650: 2020 2020 2074 6d70 5f66 696c 6520 3d20       tmp_file = 
+00003660: 5061 7468 2863 6572 6369 732e 6475 6d70  Path(cercis.dump
+00003670: 5f74 6f5f 6669 6c65 2873 6f75 7263 6529  _to_file(source)
+00003680: 290a 2020 2020 2020 2020 2320 4675 6c6c  ).        # Full
+00003690: 2073 6f75 7263 6520 7368 6f75 6c64 2066   source should f
+000036a0: 6169 6c20 2869 6e76 616c 6964 2073 796e  ail (invalid syn
+000036b0: 7461 7820 6174 2068 6561 6465 7229 0a20  tax at header). 
+000036c0: 2020 2020 2020 2073 656c 662e 696e 766f         self.invo
+000036d0: 6b65 426c 6163 6b28 5b73 7472 2874 6d70  keBlack([str(tmp
+000036e0: 5f66 696c 6529 2c20 222d 2d64 6966 6622  _file), "--diff"
+000036f0: 2c20 222d 2d63 6865 636b 225d 2c20 6578  , "--check"], ex
+00003700: 6974 5f63 6f64 653d 3132 3329 0a20 2020  it_code=123).   
+00003710: 2020 2020 2023 2053 6f2c 2073 6b69 7070       # So, skipp
+00003720: 696e 6720 7468 6520 6669 7273 7420 6c69  ing the first li
+00003730: 6e65 2073 686f 756c 6420 776f 726b 0a20  ne should work. 
+00003740: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+00003750: 426c 6163 6b52 756e 6e65 7228 292e 696e  BlackRunner().in
+00003760: 766f 6b65 280a 2020 2020 2020 2020 2020  voke(.          
+00003770: 2020 6365 7263 6973 2e6d 6169 6e2c 205b    cercis.main, [
+00003780: 7374 7228 746d 705f 6669 6c65 292c 2022  str(tmp_file), "
+00003790: 2d78 222c 2066 222d 2d63 6f6e 6669 673d  -x", f"--config=
+000037a0: 7b45 4d50 5459 5f43 4f4e 4649 477d 225d  {EMPTY_CONFIG}"]
+000037b0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+000037c0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+000037d0: 7561 6c28 7265 7375 6c74 2e65 7869 745f  ual(result.exit_
+000037e0: 636f 6465 2c20 3029 0a20 2020 2020 2020  code, 0).       
+000037f0: 2061 6374 7561 6c20 3d20 746d 705f 6669   actual = tmp_fi
+00003800: 6c65 2e72 6561 645f 7465 7874 2865 6e63  le.read_text(enc
+00003810: 6f64 696e 673d 2275 7466 2d38 2229 0a20  oding="utf-8"). 
+00003820: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00003830: 7274 466f 726d 6174 4571 7561 6c28 736f  rtFormatEqual(so
+00003840: 7572 6365 2c20 6163 7475 616c 290a 0a20  urce, actual).. 
+00003850: 2020 2064 6566 2074 6573 745f 736b 6970     def test_skip
+00003860: 5f73 6f75 7263 655f 6669 7273 745f 6c69  _source_first_li
+00003870: 6e65 5f77 6865 6e5f 6d69 7869 6e67 5f6e  ne_when_mixing_n
+00003880: 6577 6c69 6e65 7328 7365 6c66 2920 2d3e  ewlines(self) ->
+00003890: 204e 6f6e 653a 0a20 2020 2020 2020 2063   None:.        c
+000038a0: 6f64 655f 6d69 7869 6e67 5f6e 6577 6c69  ode_mixing_newli
+000038b0: 6e65 7320 3d20 6222 4865 6164 6572 2077  nes = b"Header w
+000038c0: 696c 6c20 6265 2073 6b69 7070 6564 5c72  ill be skipped\r
+000038d0: 5c6e 6920 3d20 5b31 2c32 2c33 5d5c 6e6a  \ni = [1,2,3]\nj
+000038e0: 203d 205b 312c 322c 335d 5c6e 220a 2020   = [1,2,3]\n".  
+000038f0: 2020 2020 2020 6578 7065 6374 6564 203d        expected =
+00003900: 2062 2248 6561 6465 7220 7769 6c6c 2062   b"Header will b
+00003910: 6520 736b 6970 7065 645c 725c 6e69 203d  e skipped\r\ni =
+00003920: 205b 312c 2032 2c20 335d 5c6e 6a20 3d20   [1, 2, 3]\nj = 
+00003930: 5b31 2c20 322c 2033 5d5c 6e22 0a20 2020  [1, 2, 3]\n".   
+00003940: 2020 2020 2077 6974 6820 5465 6d70 6f72       with Tempor
+00003950: 6172 7944 6972 6563 746f 7279 2829 2061  aryDirectory() a
+00003960: 7320 776f 726b 7370 6163 653a 0a20 2020  s workspace:.   
+00003970: 2020 2020 2020 2020 2074 6573 745f 6669           test_fi
+00003980: 6c65 203d 2050 6174 6828 776f 726b 7370  le = Path(worksp
+00003990: 6163 6529 202f 2022 736b 6970 5f68 6561  ace) / "skip_hea
+000039a0: 6465 722e 7079 220a 2020 2020 2020 2020  der.py".        
+000039b0: 2020 2020 7465 7374 5f66 696c 652e 7772      test_file.wr
+000039c0: 6974 655f 6279 7465 7328 636f 6465 5f6d  ite_bytes(code_m
+000039d0: 6978 696e 675f 6e65 776c 696e 6573 290a  ixing_newlines).
+000039e0: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+000039f0: 203d 2072 6570 6c61 6365 2844 4546 4155   = replace(DEFAU
+00003a00: 4c54 5f4d 4f44 452c 2073 6b69 705f 736f  LT_MODE, skip_so
+00003a10: 7572 6365 5f66 6972 7374 5f6c 696e 653d  urce_first_line=
+00003a20: 5472 7565 290a 2020 2020 2020 2020 2020  True).          
+00003a30: 2020 6666 2874 6573 745f 6669 6c65 2c20    ff(test_file, 
+00003a40: 6d6f 6465 3d6d 6f64 652c 2077 7269 7465  mode=mode, write
+00003a50: 5f62 6163 6b3d 6365 7263 6973 2e57 7269  _back=cercis.Wri
+00003a60: 7465 4261 636b 2e59 4553 290a 2020 2020  teBack.YES).    
+00003a70: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00003a80: 6572 7445 7175 616c 2874 6573 745f 6669  ertEqual(test_fi
+00003a90: 6c65 2e72 6561 645f 6279 7465 7328 292c  le.read_bytes(),
+00003aa0: 2065 7870 6563 7465 6429 0a0a 2020 2020   expected)..    
+00003ab0: 6465 6620 7465 7374 5f73 6b69 705f 6d61  def test_skip_ma
+00003ac0: 6769 635f 7472 6169 6c69 6e67 5f63 6f6d  gic_trailing_com
+00003ad0: 6d61 2873 656c 6629 202d 3e20 4e6f 6e65  ma(self) -> None
+00003ae0: 3a0a 2020 2020 2020 2020 736f 7572 6365  :.        source
+00003af0: 2c20 5f20 3d20 7265 6164 5f64 6174 6128  , _ = read_data(
+00003b00: 2273 696d 706c 655f 6361 7365 7322 2c20  "simple_cases", 
+00003b10: 2265 7870 7265 7373 696f 6e22 290a 2020  "expression").  
+00003b20: 2020 2020 2020 6578 7065 6374 6564 2c20        expected, 
+00003b30: 5f20 3d20 7265 6164 5f64 6174 6128 0a20  _ = read_data(. 
+00003b40: 2020 2020 2020 2020 2020 2022 6d69 7363             "misc
+00003b50: 656c 6c61 6e65 6f75 7322 2c20 2265 7870  ellaneous", "exp
+00003b60: 7265 7373 696f 6e5f 736b 6970 5f6d 6167  ression_skip_mag
+00003b70: 6963 5f74 7261 696c 696e 675f 636f 6d6d  ic_trailing_comm
+00003b80: 612e 6469 6666 220a 2020 2020 2020 2020  a.diff".        
+00003b90: 290a 2020 2020 2020 2020 746d 705f 6669  ).        tmp_fi
+00003ba0: 6c65 203d 2050 6174 6828 6365 7263 6973  le = Path(cercis
+00003bb0: 2e64 756d 705f 746f 5f66 696c 6528 736f  .dump_to_file(so
+00003bc0: 7572 6365 2929 0a20 2020 2020 2020 2064  urce)).        d
+00003bd0: 6966 665f 6865 6164 6572 203d 2072 652e  iff_header = re.
+00003be0: 636f 6d70 696c 6528 0a20 2020 2020 2020  compile(.       
+00003bf0: 2020 2020 2072 6622 7b72 652e 6573 6361       rf"{re.esca
+00003c00: 7065 2873 7472 2874 6d70 5f66 696c 6529  pe(str(tmp_file)
+00003c10: 297d 5c74 5c64 5c64 5c64 5c64 2d5c 645c  )}\t\d\d\d\d-\d\
+00003c20: 642d 5c64 5c64 2022 0a20 2020 2020 2020  d-\d\d ".       
+00003c30: 2020 2020 2072 225c 645c 643a 5c64 5c64       r"\d\d:\d\d
+00003c40: 3a5c 645c 645c 2e5c 645c 645c 645c 645c  :\d\d\.\d\d\d\d\
+00003c50: 645c 645c 2b5c 645c 643a 5c64 5c64 220a  d\d\+\d\d:\d\d".
+00003c60: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00003c70: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+00003c80: 2020 2072 6573 756c 7420 3d20 426c 6163     result = Blac
+00003c90: 6b52 756e 6e65 7228 292e 696e 766f 6b65  kRunner().invoke
+00003ca0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00003cb0: 2020 6365 7263 6973 2e6d 6169 6e2c 0a20    cercis.main,. 
+00003cc0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+00003cd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003ce0: 2020 2020 2022 2d43 222c 0a20 2020 2020       "-C",.     
+00003cf0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00003d00: 2d2d 6469 6666 222c 0a20 2020 2020 2020  --diff",.       
+00003d10: 2020 2020 2020 2020 2020 2020 2073 7472               str
+00003d20: 2874 6d70 5f66 696c 6529 2c0a 2020 2020  (tmp_file),.    
+00003d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003d40: 6622 2d2d 636f 6e66 6967 3d7b 454d 5054  f"--config={EMPT
+00003d50: 595f 434f 4e46 4947 7d22 2c0a 2020 2020  Y_CONFIG}",.    
+00003d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003d70: 222d 2d6c 696e 652d 6c65 6e67 7468 3d38  "--line-length=8
+00003d80: 3822 2c0a 2020 2020 2020 2020 2020 2020  8",.            
+00003d90: 2020 2020 5d2c 0a20 2020 2020 2020 2020      ],.         
+00003da0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00003db0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00003dc0: 6c28 7265 7375 6c74 2e65 7869 745f 636f  l(result.exit_co
+00003dd0: 6465 2c20 3029 0a20 2020 2020 2020 2066  de, 0).        f
+00003de0: 696e 616c 6c79 3a0a 2020 2020 2020 2020  inally:.        
+00003df0: 2020 2020 6f73 2e75 6e6c 696e 6b28 746d      os.unlink(tm
+00003e00: 705f 6669 6c65 290a 2020 2020 2020 2020  p_file).        
+00003e10: 6163 7475 616c 203d 2072 6573 756c 742e  actual = result.
+00003e20: 6f75 7470 7574 0a20 2020 2020 2020 2061  output.        a
+00003e30: 6374 7561 6c20 3d20 6469 6666 5f68 6561  ctual = diff_hea
+00003e40: 6465 722e 7375 6228 4445 5445 524d 494e  der.sub(DETERMIN
+00003e50: 4953 5449 435f 4845 4144 4552 2c20 6163  ISTIC_HEADER, ac
+00003e60: 7475 616c 290a 2020 2020 2020 2020 6163  tual).        ac
+00003e70: 7475 616c 203d 2061 6374 7561 6c2e 7273  tual = actual.rs
+00003e80: 7472 6970 2829 202b 2022 5c6e 2220 2023  trip() + "\n"  #
+00003e90: 2074 6865 2064 6966 6620 6f75 7470 7574   the diff output
+00003ea0: 2068 6173 2061 2074 7261 696c 696e 6720   has a trailing 
+00003eb0: 7370 6163 650a 2020 2020 2020 2020 6966  space.        if
+00003ec0: 2065 7870 6563 7465 6420 213d 2061 6374   expected != act
+00003ed0: 7561 6c3a 0a20 2020 2020 2020 2020 2020  ual:.           
+00003ee0: 2064 756d 7020 3d20 6365 7263 6973 2e64   dump = cercis.d
+00003ef0: 756d 705f 746f 5f66 696c 6528 6163 7475  ump_to_file(actu
+00003f00: 616c 290a 2020 2020 2020 2020 2020 2020  al).            
+00003f10: 6d73 6720 3d20 280a 2020 2020 2020 2020  msg = (.        
+00003f20: 2020 2020 2020 2020 2245 7870 6563 7465          "Expecte
+00003f30: 6420 6469 6666 2069 736e 2774 2065 7175  d diff isn't equ
+00003f40: 616c 2074 6f20 7468 6520 6163 7475 616c  al to the actual
+00003f50: 2e20 4966 2079 6f75 206d 6164 6520 6368  . If you made ch
+00003f60: 616e 6765 7320 746f 220a 2020 2020 2020  anges to".      
+00003f70: 2020 2020 2020 2020 2020 2220 6578 7072            " expr
+00003f80: 6573 7369 6f6e 2e70 7920 616e 6420 7468  ession.py and th
+00003f90: 6973 2069 7320 616e 2061 6e74 6963 6970  is is an anticip
+00003fa0: 6174 6564 2064 6966 6665 7265 6e63 652c  ated difference,
+00003fb0: 206f 7665 7277 7269 7465 220a 2020 2020   overwrite".    
+00003fc0: 2020 2020 2020 2020 2020 2020 2220 7465              " te
+00003fd0: 7374 732f 6461 7461 2f6d 6973 6365 6c6c  sts/data/miscell
+00003fe0: 616e 656f 7573 2f65 7870 7265 7373 696f  aneous/expressio
+00003ff0: 6e5f 736b 6970 5f6d 6167 6963 5f74 7261  n_skip_magic_tra
+00004000: 696c 696e 675f 636f 6d6d 612e 6469 6666  iling_comma.diff
+00004010: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00004020: 2020 6622 2077 6974 6820 7b64 756d 707d    f" with {dump}
+00004030: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
+00004040: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00004050: 2e61 7373 6572 7445 7175 616c 2865 7870  .assertEqual(exp
+00004060: 6563 7465 642c 2061 6374 7561 6c2c 206d  ected, actual, m
+00004070: 7367 290a 0a20 2020 2040 7061 7463 6828  sg)..    @patch(
+00004080: 2263 6572 6369 732e 6475 6d70 5f74 6f5f  "cercis.dump_to_
+00004090: 6669 6c65 222c 2064 756d 705f 746f 5f73  file", dump_to_s
+000040a0: 7464 6572 7229 0a20 2020 2064 6566 2074  tderr).    def t
+000040b0: 6573 745f 6173 796e 635f 6173 5f69 6465  est_async_as_ide
+000040c0: 6e74 6966 6965 7228 7365 6c66 2920 2d3e  ntifier(self) ->
+000040d0: 204e 6f6e 653a 0a20 2020 2020 2020 2073   None:.        s
+000040e0: 6f75 7263 655f 7061 7468 203d 2067 6574  ource_path = get
+000040f0: 5f63 6173 655f 7061 7468 2822 6d69 7363  _case_path("misc
+00004100: 656c 6c61 6e65 6f75 7322 2c20 2261 7379  ellaneous", "asy
+00004110: 6e63 5f61 735f 6964 656e 7469 6669 6572  nc_as_identifier
+00004120: 2229 0a20 2020 2020 2020 2073 6f75 7263  ").        sourc
+00004130: 652c 2065 7870 6563 7465 6420 3d20 7265  e, expected = re
+00004140: 6164 5f64 6174 615f 6672 6f6d 5f66 696c  ad_data_from_fil
+00004150: 6528 736f 7572 6365 5f70 6174 6829 0a20  e(source_path). 
+00004160: 2020 2020 2020 2061 6374 7561 6c20 3d20         actual = 
+00004170: 6673 2873 6f75 7263 6529 0a20 2020 2020  fs(source).     
+00004180: 2020 2073 656c 662e 6173 7365 7274 466f     self.assertFo
+00004190: 726d 6174 4571 7561 6c28 6578 7065 6374  rmatEqual(expect
+000041a0: 6564 2c20 6163 7475 616c 290a 2020 2020  ed, actual).    
+000041b0: 2020 2020 6d61 6a6f 722c 206d 696e 6f72      major, minor
+000041c0: 203d 2073 7973 2e76 6572 7369 6f6e 5f69   = sys.version_i
+000041d0: 6e66 6f5b 3a32 5d0a 2020 2020 2020 2020  nfo[:2].        
+000041e0: 6966 206d 616a 6f72 203c 2033 206f 7220  if major < 3 or 
+000041f0: 286d 616a 6f72 203c 3d20 3320 616e 6420  (major <= 3 and 
+00004200: 6d69 6e6f 7220 3c20 3729 3a0a 2020 2020  minor < 7):.    
+00004210: 2020 2020 2020 2020 6365 7263 6973 2e61          cercis.a
+00004220: 7373 6572 745f 6571 7569 7661 6c65 6e74  ssert_equivalent
+00004230: 2873 6f75 7263 652c 2061 6374 7561 6c29  (source, actual)
+00004240: 0a20 2020 2020 2020 2063 6572 6369 732e  .        cercis.
+00004250: 6173 7365 7274 5f73 7461 626c 6528 736f  assert_stable(so
+00004260: 7572 6365 2c20 6163 7475 616c 2c20 4445  urce, actual, DE
+00004270: 4641 554c 545f 4d4f 4445 290a 2020 2020  FAULT_MODE).    
+00004280: 2020 2020 2320 656e 7375 7265 2063 6572      # ensure cer
+00004290: 6369 7320 6361 6e20 7061 7273 6520 7468  cis can parse th
+000042a0: 6973 2077 6865 6e20 7468 6520 7461 7267  is when the targ
+000042b0: 6574 2069 7320 332e 360a 2020 2020 2020  et is 3.6.      
+000042c0: 2020 7365 6c66 2e69 6e76 6f6b 6542 6c61    self.invokeBla
+000042d0: 636b 285b 7374 7228 736f 7572 6365 5f70  ck([str(source_p
+000042e0: 6174 6829 2c20 222d 2d74 6172 6765 742d  ath), "--target-
+000042f0: 7665 7273 696f 6e22 2c20 2270 7933 3622  version", "py36"
+00004300: 5d29 0a20 2020 2020 2020 2023 2062 7574  ]).        # but
+00004310: 206e 6f74 206f 6e20 332e 372c 2062 6563   not on 3.7, bec
+00004320: 6175 7365 2061 7379 6e63 2f61 7761 6974  ause async/await
+00004330: 2069 7320 6e6f 206c 6f6e 6765 7220 616e   is no longer an
+00004340: 2069 6465 6e74 6966 6965 720a 2020 2020   identifier.    
+00004350: 2020 2020 7365 6c66 2e69 6e76 6f6b 6542      self.invokeB
+00004360: 6c61 636b 285b 7374 7228 736f 7572 6365  lack([str(source
+00004370: 5f70 6174 6829 2c20 222d 2d74 6172 6765  _path), "--targe
+00004380: 742d 7665 7273 696f 6e22 2c20 2270 7933  t-version", "py3
+00004390: 3722 5d2c 2065 7869 745f 636f 6465 3d31  7"], exit_code=1
+000043a0: 3233 290a 0a20 2020 2040 7061 7463 6828  23)..    @patch(
+000043b0: 2263 6572 6369 732e 6475 6d70 5f74 6f5f  "cercis.dump_to_
+000043c0: 6669 6c65 222c 2064 756d 705f 746f 5f73  file", dump_to_s
+000043d0: 7464 6572 7229 0a20 2020 2064 6566 2074  tderr).    def t
+000043e0: 6573 745f 7079 7468 6f6e 3337 2873 656c  est_python37(sel
+000043f0: 6629 202d 3e20 4e6f 6e65 3a0a 2020 2020  f) -> None:.    
+00004400: 2020 2020 736f 7572 6365 5f70 6174 6820      source_path 
+00004410: 3d20 6765 745f 6361 7365 5f70 6174 6828  = get_case_path(
+00004420: 2270 795f 3337 222c 2022 7079 7468 6f6e  "py_37", "python
+00004430: 3337 2229 0a20 2020 2020 2020 2073 6f75  37").        sou
+00004440: 7263 652c 2065 7870 6563 7465 6420 3d20  rce, expected = 
+00004450: 7265 6164 5f64 6174 615f 6672 6f6d 5f66  read_data_from_f
+00004460: 696c 6528 736f 7572 6365 5f70 6174 6829  ile(source_path)
+00004470: 0a20 2020 2020 2020 2061 6374 7561 6c20  .        actual 
+00004480: 3d20 6673 2873 6f75 7263 6529 0a20 2020  = fs(source).   
+00004490: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+000044a0: 466f 726d 6174 4571 7561 6c28 6578 7065  FormatEqual(expe
+000044b0: 6374 6564 2c20 6163 7475 616c 290a 2020  cted, actual).  
+000044c0: 2020 2020 2020 6d61 6a6f 722c 206d 696e        major, min
+000044d0: 6f72 203d 2073 7973 2e76 6572 7369 6f6e  or = sys.version
+000044e0: 5f69 6e66 6f5b 3a32 5d0a 2020 2020 2020  _info[:2].      
+000044f0: 2020 6966 206d 616a 6f72 203e 2033 206f    if major > 3 o
+00004500: 7220 286d 616a 6f72 203d 3d20 3320 616e  r (major == 3 an
+00004510: 6420 6d69 6e6f 7220 3e3d 2037 293a 0a20  d minor >= 7):. 
+00004520: 2020 2020 2020 2020 2020 2063 6572 6369             cerci
+00004530: 732e 6173 7365 7274 5f65 7175 6976 616c  s.assert_equival
+00004540: 656e 7428 736f 7572 6365 2c20 6163 7475  ent(source, actu
+00004550: 616c 290a 2020 2020 2020 2020 6365 7263  al).        cerc
+00004560: 6973 2e61 7373 6572 745f 7374 6162 6c65  is.assert_stable
+00004570: 2873 6f75 7263 652c 2061 6374 7561 6c2c  (source, actual,
+00004580: 2044 4546 4155 4c54 5f4d 4f44 4529 0a20   DEFAULT_MODE). 
+00004590: 2020 2020 2020 2023 2065 6e73 7572 6520         # ensure 
+000045a0: 6365 7263 6973 2063 616e 2070 6172 7365  cercis can parse
+000045b0: 2074 6869 7320 7768 656e 2074 6865 2074   this when the t
+000045c0: 6172 6765 7420 6973 2033 2e37 0a20 2020  arget is 3.7.   
+000045d0: 2020 2020 2073 656c 662e 696e 766f 6b65       self.invoke
+000045e0: 426c 6163 6b28 5b73 7472 2873 6f75 7263  Black([str(sourc
+000045f0: 655f 7061 7468 292c 2022 2d2d 7461 7267  e_path), "--targ
+00004600: 6574 2d76 6572 7369 6f6e 222c 2022 7079  et-version", "py
+00004610: 3337 225d 290a 2020 2020 2020 2020 2320  37"]).        # 
+00004620: 6275 7420 6e6f 7420 6f6e 2033 2e36 2c20  but not on 3.6, 
+00004630: 6265 6361 7573 6520 7765 2075 7365 2061  because we use a
+00004640: 7379 6e63 2061 7320 6120 7265 7365 7276  sync as a reserv
+00004650: 6564 206b 6579 776f 7264 0a20 2020 2020  ed keyword.     
+00004660: 2020 2073 656c 662e 696e 766f 6b65 426c     self.invokeBl
+00004670: 6163 6b28 5b73 7472 2873 6f75 7263 655f  ack([str(source_
+00004680: 7061 7468 292c 2022 2d2d 7461 7267 6574  path), "--target
+00004690: 2d76 6572 7369 6f6e 222c 2022 7079 3336  -version", "py36
+000046a0: 225d 2c20 6578 6974 5f63 6f64 653d 3132  "], exit_code=12
+000046b0: 3329 0a0a 2020 2020 6465 6620 7465 7374  3)..    def test
+000046c0: 5f74 6162 5f63 6f6d 6d65 6e74 5f69 6e64  _tab_comment_ind
+000046d0: 656e 7461 7469 6f6e 2873 656c 6629 202d  entation(self) -
+000046e0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+000046f0: 636f 6e74 656e 7473 5f74 6162 203d 2022  contents_tab = "
+00004700: 6966 2031 3a5c 6e5c 7469 6620 323a 5c6e  if 1:\n\tif 2:\n
+00004710: 5c74 5c74 7061 7373 5c6e 5c74 2320 636f  \t\tpass\n\t# co
+00004720: 6d6d 656e 745c 6e5c 7470 6173 735c 6e22  mment\n\tpass\n"
+00004730: 0a20 2020 2020 2020 2063 6f6e 7465 6e74  .        content
+00004740: 735f 7370 6320 3d20 2269 6620 313a 5c6e  s_spc = "if 1:\n
+00004750: 2020 2020 6966 2032 3a5c 6e20 2020 2020      if 2:\n     
+00004760: 2020 2070 6173 735c 6e20 2020 2023 2063     pass\n    # c
+00004770: 6f6d 6d65 6e74 5c6e 2020 2020 7061 7373  omment\n    pass
+00004780: 5c6e 220a 2020 2020 2020 2020 7365 6c66  \n".        self
+00004790: 2e61 7373 6572 7446 6f72 6d61 7445 7175  .assertFormatEqu
+000047a0: 616c 2863 6f6e 7465 6e74 735f 7370 632c  al(contents_spc,
+000047b0: 2066 7328 636f 6e74 656e 7473 5f73 7063   fs(contents_spc
+000047c0: 2929 0a20 2020 2020 2020 2073 656c 662e  )).        self.
+000047d0: 6173 7365 7274 466f 726d 6174 4571 7561  assertFormatEqua
+000047e0: 6c28 636f 6e74 656e 7473 5f73 7063 2c20  l(contents_spc, 
+000047f0: 6673 2863 6f6e 7465 6e74 735f 7461 6229  fs(contents_tab)
+00004800: 290a 0a20 2020 2020 2020 2063 6f6e 7465  )..        conte
+00004810: 6e74 735f 7461 6220 3d20 2269 6620 313a  nts_tab = "if 1:
+00004820: 5c6e 5c74 6966 2032 3a5c 6e5c 745c 7470  \n\tif 2:\n\t\tp
+00004830: 6173 735c 6e5c 745c 7423 2063 6f6d 6d65  ass\n\t\t# comme
+00004840: 6e74 5c6e 5c74 7061 7373 5c6e 220a 2020  nt\n\tpass\n".  
+00004850: 2020 2020 2020 636f 6e74 656e 7473 5f73        contents_s
+00004860: 7063 203d 2022 6966 2031 3a5c 6e20 2020  pc = "if 1:\n   
+00004870: 2069 6620 323a 5c6e 2020 2020 2020 2020   if 2:\n        
+00004880: 7061 7373 5c6e 2020 2020 2020 2020 2320  pass\n        # 
+00004890: 636f 6d6d 656e 745c 6e20 2020 2070 6173  comment\n    pas
+000048a0: 735c 6e22 0a20 2020 2020 2020 2073 656c  s\n".        sel
+000048b0: 662e 6173 7365 7274 466f 726d 6174 4571  f.assertFormatEq
+000048c0: 7561 6c28 636f 6e74 656e 7473 5f73 7063  ual(contents_spc
+000048d0: 2c20 6673 2863 6f6e 7465 6e74 735f 7370  , fs(contents_sp
+000048e0: 6329 290a 2020 2020 2020 2020 7365 6c66  c)).        self
+000048f0: 2e61 7373 6572 7446 6f72 6d61 7445 7175  .assertFormatEqu
+00004900: 616c 2863 6f6e 7465 6e74 735f 7370 632c  al(contents_spc,
+00004910: 2066 7328 636f 6e74 656e 7473 5f74 6162   fs(contents_tab
+00004920: 2929 0a0a 2020 2020 2020 2020 2320 6d69  ))..        # mi
+00004930: 7865 6420 7461 6273 2061 6e64 2073 7061  xed tabs and spa
+00004940: 6365 7320 2876 616c 6964 2050 7974 686f  ces (valid Pytho
+00004950: 6e20 3220 636f 6465 290a 2020 2020 2020  n 2 code).      
+00004960: 2020 636f 6e74 656e 7473 5f74 6162 203d    contents_tab =
+00004970: 2022 6966 2031 3a5c 6e20 2020 2020 2020   "if 1:\n       
+00004980: 2069 6620 323a 5c6e 5c74 5c74 7061 7373   if 2:\n\t\tpass
+00004990: 5c6e 5c74 2320 636f 6d6d 656e 745c 6e20  \n\t# comment\n 
+000049a0: 2020 2020 2020 2070 6173 735c 6e22 0a20         pass\n". 
+000049b0: 2020 2020 2020 2063 6f6e 7465 6e74 735f         contents_
+000049c0: 7370 6320 3d20 2269 6620 313a 5c6e 2020  spc = "if 1:\n  
+000049d0: 2020 6966 2032 3a5c 6e20 2020 2020 2020    if 2:\n       
+000049e0: 2070 6173 735c 6e20 2020 2023 2063 6f6d   pass\n    # com
+000049f0: 6d65 6e74 5c6e 2020 2020 7061 7373 5c6e  ment\n    pass\n
+00004a00: 220a 2020 2020 2020 2020 7365 6c66 2e61  ".        self.a
+00004a10: 7373 6572 7446 6f72 6d61 7445 7175 616c  ssertFormatEqual
+00004a20: 2863 6f6e 7465 6e74 735f 7370 632c 2066  (contents_spc, f
+00004a30: 7328 636f 6e74 656e 7473 5f73 7063 2929  s(contents_spc))
+00004a40: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00004a50: 7365 7274 466f 726d 6174 4571 7561 6c28  sertFormatEqual(
+00004a60: 636f 6e74 656e 7473 5f73 7063 2c20 6673  contents_spc, fs
+00004a70: 2863 6f6e 7465 6e74 735f 7461 6229 290a  (contents_tab)).
+00004a80: 0a20 2020 2020 2020 2063 6f6e 7465 6e74  .        content
+00004a90: 735f 7461 6220 3d20 2269 6620 313a 5c6e  s_tab = "if 1:\n
+00004aa0: 2020 2020 2020 2020 6966 2032 3a5c 6e5c          if 2:\n\
+00004ab0: 745c 7470 6173 735c 6e5c 745c 7423 2063  t\tpass\n\t\t# c
+00004ac0: 6f6d 6d65 6e74 5c6e 2020 2020 2020 2020  omment\n        
+00004ad0: 7061 7373 5c6e 220a 2020 2020 2020 2020  pass\n".        
+00004ae0: 636f 6e74 656e 7473 5f73 7063 203d 2022  contents_spc = "
+00004af0: 6966 2031 3a5c 6e20 2020 2069 6620 323a  if 1:\n    if 2:
+00004b00: 5c6e 2020 2020 2020 2020 7061 7373 5c6e  \n        pass\n
+00004b10: 2020 2020 2020 2020 2320 636f 6d6d 656e          # commen
+00004b20: 745c 6e20 2020 2070 6173 735c 6e22 0a20  t\n    pass\n". 
+00004b30: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00004b40: 7274 466f 726d 6174 4571 7561 6c28 636f  rtFormatEqual(co
+00004b50: 6e74 656e 7473 5f73 7063 2c20 6673 2863  ntents_spc, fs(c
+00004b60: 6f6e 7465 6e74 735f 7370 6329 290a 2020  ontents_spc)).  
+00004b70: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00004b80: 7446 6f72 6d61 7445 7175 616c 2863 6f6e  tFormatEqual(con
+00004b90: 7465 6e74 735f 7370 632c 2066 7328 636f  tents_spc, fs(co
+00004ba0: 6e74 656e 7473 5f74 6162 2929 0a0a 2020  ntents_tab))..  
+00004bb0: 2020 6465 6620 7465 7374 5f66 616c 7365    def test_false
+00004bc0: 5f70 6f73 6974 6976 655f 7379 6d6c 696e  _positive_symlin
+00004bd0: 6b5f 6f75 7470 7574 5f69 7373 7565 5f33  k_output_issue_3
+00004be0: 3338 3428 7365 6c66 2920 2d3e 204e 6f6e  384(self) -> Non
+00004bf0: 653a 0a20 2020 2020 2020 2023 2045 6d75  e:.        # Emu
+00004c00: 6c61 7465 2074 6865 2062 6568 6176 696f  late the behavio
+00004c10: 7220 7768 656e 2075 7369 6e67 2074 6865  r when using the
+00004c20: 2043 4c49 2028 6063 6572 6369 7320 2e2f   CLI (`cercis ./
+00004c30: 6368 696c 6420 202d 2d76 6572 626f 7365  child  --verbose
+00004c40: 6029 2c20 7768 6963 680a 2020 2020 2020  `), which.      
+00004c50: 2020 2320 696e 766f 6c76 6573 2070 6174    # involves pat
+00004c60: 6368 696e 6720 736f 6d65 2060 7061 7468  ching some `path
+00004c70: 6c69 622e 5061 7468 6020 6d65 7468 6f64  lib.Path` method
+00004c80: 732e 2049 6e20 7061 7274 6963 756c 6172  s. In particular
+00004c90: 2c20 6069 735f 6469 7260 2069 730a 2020  , `is_dir` is.  
+00004ca0: 2020 2020 2020 2320 7061 7463 6865 6420        # patched 
+00004cb0: 6f6e 6c79 206f 6e20 6974 7320 6669 7273  only on its firs
+00004cc0: 7420 6361 6c6c 3a20 7768 656e 2063 6865  t call: when che
+00004cd0: 636b 696e 6720 6966 2022 2e2f 6368 696c  cking if "./chil
+00004ce0: 6422 2069 7320 6120 6469 7265 6374 6f72  d" is a director
+00004cf0: 7920 6974 0a20 2020 2020 2020 2023 2073  y it.        # s
+00004d00: 686f 756c 6420 7265 7475 726e 2054 7275  hould return Tru
+00004d10: 652e 2054 6865 2022 2e2f 6368 696c 6422  e. The "./child"
+00004d20: 2066 6f6c 6465 7220 6578 6973 7473 2072   folder exists r
+00004d30: 656c 6174 6976 6520 746f 2074 6865 2063  elative to the c
+00004d40: 7764 2077 6865 6e0a 2020 2020 2020 2020  wd when.        
+00004d50: 2320 7275 6e6e 696e 6720 6672 6f6d 2043  # running from C
+00004d60: 4c49 2c20 6275 7420 6661 696c 7320 7768  LI, but fails wh
+00004d70: 656e 2072 756e 6e69 6e67 2074 6865 2074  en running the t
+00004d80: 6573 7473 2062 6563 6175 7365 2063 7764  ests because cwd
+00004d90: 2069 7320 6469 6666 6572 656e 740a 2020   is different.  
+00004da0: 2020 2020 2020 7072 6f6a 6563 745f 726f        project_ro
+00004db0: 6f74 203d 2050 6174 6828 5448 4953 5f44  ot = Path(THIS_D
+00004dc0: 4952 202f 2022 6461 7461 2220 2f20 226e  IR / "data" / "n
+00004dd0: 6573 7465 645f 6769 7469 676e 6f72 655f  ested_gitignore_
+00004de0: 7465 7374 7322 290a 2020 2020 2020 2020  tests").        
+00004df0: 776f 726b 696e 675f 6469 7265 6374 6f72  working_director
+00004e00: 7920 3d20 7072 6f6a 6563 745f 726f 6f74  y = project_root
+00004e10: 202f 2022 726f 6f74 220a 2020 2020 2020   / "root".      
+00004e20: 2020 7461 7267 6574 5f61 6273 7061 7468    target_abspath
+00004e30: 203d 2077 6f72 6b69 6e67 5f64 6972 6563   = working_direc
+00004e40: 746f 7279 202f 2022 6368 696c 6422 0a20  tory / "child". 
+00004e50: 2020 2020 2020 2074 6172 6765 745f 636f         target_co
+00004e60: 6e74 656e 7473 203d 2028 0a20 2020 2020  ntents = (.     
+00004e70: 2020 2020 2020 2073 7263 2e72 656c 6174         src.relat
+00004e80: 6976 655f 746f 2877 6f72 6b69 6e67 5f64  ive_to(working_d
+00004e90: 6972 6563 746f 7279 2920 666f 7220 7372  irectory) for sr
+00004ea0: 6320 696e 2074 6172 6765 745f 6162 7370  c in target_absp
+00004eb0: 6174 682e 6974 6572 6469 7228 290a 2020  ath.iterdir().  
+00004ec0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00004ed0: 2064 6566 206d 6f63 6b5f 6e5f 6361 6c6c   def mock_n_call
+00004ee0: 7328 7265 7370 6f6e 7365 733a 204c 6973  s(responses: Lis
+00004ef0: 745b 626f 6f6c 5d29 202d 3e20 4361 6c6c  t[bool]) -> Call
+00004f00: 6162 6c65 5b5b 5d2c 2062 6f6f 6c5d 3a0a  able[[], bool]:.
+00004f10: 2020 2020 2020 2020 2020 2020 6465 6620              def 
+00004f20: 5f6d 6f63 6b65 645f 6361 6c6c 7328 2920  _mocked_calls() 
+00004f30: 2d3e 2062 6f6f 6c3a 0a20 2020 2020 2020  -> bool:.       
+00004f40: 2020 2020 2020 2020 2069 6620 7265 7370           if resp
+00004f50: 6f6e 7365 733a 0a20 2020 2020 2020 2020  onses:.         
+00004f60: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00004f70: 6e20 7265 7370 6f6e 7365 732e 706f 7028  n responses.pop(
+00004f80: 3029 0a20 2020 2020 2020 2020 2020 2020  0).             
+00004f90: 2020 2072 6574 7572 6e20 4661 6c73 650a     return False.
+00004fa0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00004fb0: 7572 6e20 5f6d 6f63 6b65 645f 6361 6c6c  urn _mocked_call
+00004fc0: 730a 0a20 2020 2020 2020 2077 6974 6820  s..        with 
+00004fd0: 7061 7463 6828 2270 6174 686c 6962 2e50  patch("pathlib.P
+00004fe0: 6174 682e 6974 6572 6469 7222 2c20 7265  ath.iterdir", re
+00004ff0: 7475 726e 5f76 616c 7565 3d74 6172 6765  turn_value=targe
+00005000: 745f 636f 6e74 656e 7473 292c 2070 6174  t_contents), pat
+00005010: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
+00005020: 2270 6174 686c 6962 2e50 6174 682e 6377  "pathlib.Path.cw
+00005030: 6422 2c20 7265 7475 726e 5f76 616c 7565  d", return_value
+00005040: 3d77 6f72 6b69 6e67 5f64 6972 6563 746f  =working_directo
+00005050: 7279 0a20 2020 2020 2020 2029 2c20 7061  ry.        ), pa
+00005060: 7463 6828 2270 6174 686c 6962 2e50 6174  tch("pathlib.Pat
+00005070: 682e 6973 5f64 6972 222c 2073 6964 655f  h.is_dir", side_
+00005080: 6566 6665 6374 3d6d 6f63 6b5f 6e5f 6361  effect=mock_n_ca
+00005090: 6c6c 7328 5b54 7275 655d 2929 3a0a 2020  lls([True])):.  
+000050a0: 2020 2020 2020 2020 2020 6374 7820 3d20            ctx = 
+000050b0: 4661 6b65 436f 6e74 6578 7428 290a 2020  FakeContext().  
+000050c0: 2020 2020 2020 2020 2020 2320 4e6f 7465            # Note
+000050d0: 2074 6861 7420 7468 6520 726f 6f74 2066   that the root f
+000050e0: 6f6c 6465 7220 2870 726f 6a65 6374 5f72  older (project_r
+000050f0: 6f6f 7429 2069 736e 2774 2074 6865 2066  oot) isn't the f
+00005100: 6f6c 6465 720a 2020 2020 2020 2020 2020  older.          
+00005110: 2020 2320 6e61 6d65 6420 2272 6f6f 7422    # named "root"
+00005120: 2028 616b 6120 776f 726b 696e 675f 6469   (aka working_di
+00005130: 7265 6374 6f72 7929 0a20 2020 2020 2020  rectory).       
+00005140: 2020 2020 2063 7478 2e6f 626a 5b22 726f       ctx.obj["ro
+00005150: 6f74 225d 203d 2070 726f 6a65 6374 5f72  ot"] = project_r
+00005160: 6f6f 740a 2020 2020 2020 2020 2020 2020  oot.            
+00005170: 7265 706f 7274 203d 204d 6167 6963 4d6f  report = MagicMo
+00005180: 636b 2876 6572 626f 7365 3d54 7275 6529  ck(verbose=True)
+00005190: 0a20 2020 2020 2020 2020 2020 2063 6572  .            cer
+000051a0: 6369 732e 6765 745f 736f 7572 6365 7328  cis.get_sources(
+000051b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000051c0: 2063 7478 3d63 7478 2c0a 2020 2020 2020   ctx=ctx,.      
+000051d0: 2020 2020 2020 2020 2020 7372 633d 2822            src=("
+000051e0: 2e2f 6368 696c 6422 2c29 2c0a 2020 2020  ./child",),.    
+000051f0: 2020 2020 2020 2020 2020 2020 7175 6965              quie
+00005200: 743d 4661 6c73 652c 0a20 2020 2020 2020  t=False,.       
+00005210: 2020 2020 2020 2020 2076 6572 626f 7365           verbose
+00005220: 3d54 7275 652c 0a20 2020 2020 2020 2020  =True,.         
+00005230: 2020 2020 2020 2069 6e63 6c75 6465 3d44         include=D
+00005240: 4546 4155 4c54 5f49 4e43 4c55 4445 2c0a  EFAULT_INCLUDE,.
+00005250: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00005260: 6578 636c 7564 653d 4e6f 6e65 2c0a 2020  exclude=None,.  
-00005270: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00005280: 7263 655f 6578 636c 7564 653d 4e6f 6e65  rce_exclude=None
-00005290: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000052a0: 2020 7374 6469 6e5f 6669 6c65 6e61 6d65    stdin_filename
-000052b0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2020  =None,.         
-000052c0: 2020 2029 0a20 2020 2020 2020 2061 7373     ).        ass
-000052d0: 6572 7420 6e6f 7420 616e 7928 0a20 2020  ert not any(.   
-000052e0: 2020 2020 2020 2020 206d 6f63 6b5f 6172           mock_ar
-000052f0: 6773 5b31 5d2e 7374 6172 7473 7769 7468  gs[1].startswith
-00005300: 2822 6973 2061 2073 796d 626f 6c69 6320  ("is a symbolic 
-00005310: 6c69 6e6b 2074 6861 7420 706f 696e 7473  link that points
-00005320: 206f 7574 7369 6465 2229 0a20 2020 2020   outside").     
-00005330: 2020 2020 2020 2066 6f72 205f 2c20 6d6f         for _, mo
-00005340: 636b 5f61 7267 732c 205f 2069 6e20 7265  ck_args, _ in re
-00005350: 706f 7274 2e70 6174 685f 6967 6e6f 7265  port.path_ignore
-00005360: 642e 6d6f 636b 5f63 616c 6c73 0a20 2020  d.mock_calls.   
-00005370: 2020 2020 2029 2c20 2241 2073 796d 626f       ), "A symbo
-00005380: 6c69 6320 6c69 6e6b 2077 6173 2072 6570  lic link was rep
-00005390: 6f72 7465 642e 220a 2020 2020 2020 2020  orted.".        
-000053a0: 7265 706f 7274 2e70 6174 685f 6967 6e6f  report.path_igno
-000053b0: 7265 642e 6173 7365 7274 5f63 616c 6c65  red.assert_calle
-000053c0: 645f 6f6e 6365 5f77 6974 6828 0a20 2020  d_once_with(.   
-000053d0: 2020 2020 2020 2020 2050 6174 6828 2263           Path("c
-000053e0: 6869 6c64 222c 2022 622e 7079 2229 2c20  hild", "b.py"), 
-000053f0: 226d 6174 6368 6573 2061 202e 6769 7469  "matches a .giti
-00005400: 676e 6f72 6520 6669 6c65 2063 6f6e 7465  gnore file conte
-00005410: 6e74 220a 2020 2020 2020 2020 290a 0a20  nt".        ).. 
-00005420: 2020 2064 6566 2074 6573 745f 7265 706f     def test_repo
-00005430: 7274 5f76 6572 626f 7365 2873 656c 6629  rt_verbose(self)
-00005440: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-00005450: 2020 7265 706f 7274 203d 2052 6570 6f72    report = Repor
-00005460: 7428 7665 7262 6f73 653d 5472 7565 290a  t(verbose=True).
-00005470: 2020 2020 2020 2020 6f75 745f 6c69 6e65          out_line
-00005480: 7320 3d20 5b5d 0a20 2020 2020 2020 2065  s = [].        e
-00005490: 7272 5f6c 696e 6573 203d 205b 5d0a 0a20  rr_lines = [].. 
-000054a0: 2020 2020 2020 2064 6566 206f 7574 286d         def out(m
-000054b0: 7367 3a20 7374 722c 202a 2a6b 7761 7267  sg: str, **kwarg
-000054c0: 733a 2041 6e79 2920 2d3e 204e 6f6e 653a  s: Any) -> None:
-000054d0: 0a20 2020 2020 2020 2020 2020 206f 7574  .            out
-000054e0: 5f6c 696e 6573 2e61 7070 656e 6428 6d73  _lines.append(ms
-000054f0: 6729 0a0a 2020 2020 2020 2020 6465 6620  g)..        def 
-00005500: 6572 7228 6d73 673a 2073 7472 2c20 2a2a  err(msg: str, **
-00005510: 6b77 6172 6773 3a20 416e 7929 202d 3e20  kwargs: Any) -> 
-00005520: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00005530: 2020 6572 725f 6c69 6e65 732e 6170 7065    err_lines.appe
-00005540: 6e64 286d 7367 290a 0a20 2020 2020 2020  nd(msg)..       
-00005550: 2077 6974 6820 7061 7463 6828 2263 6572   with patch("cer
-00005560: 6369 732e 6f75 7470 7574 2e5f 6f75 7422  cis.output._out"
-00005570: 2c20 6f75 7429 2c20 7061 7463 6828 2263  , out), patch("c
-00005580: 6572 6369 732e 6f75 7470 7574 2e5f 6572  ercis.output._er
-00005590: 7222 2c20 6572 7229 3a0a 2020 2020 2020  r", err):.      
-000055a0: 2020 2020 2020 7265 706f 7274 2e64 6f6e        report.don
-000055b0: 6528 5061 7468 2822 6631 2229 2c20 6365  e(Path("f1"), ce
-000055c0: 7263 6973 2e43 6861 6e67 6564 2e4e 4f29  rcis.Changed.NO)
-000055d0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000055e0: 662e 6173 7365 7274 4571 7561 6c28 6c65  f.assertEqual(le
-000055f0: 6e28 6f75 745f 6c69 6e65 7329 2c20 3129  n(out_lines), 1)
-00005600: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00005610: 662e 6173 7365 7274 4571 7561 6c28 6c65  f.assertEqual(le
-00005620: 6e28 6572 725f 6c69 6e65 7329 2c20 3029  n(err_lines), 0)
-00005630: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00005640: 662e 6173 7365 7274 4571 7561 6c28 6f75  f.assertEqual(ou
-00005650: 745f 6c69 6e65 735b 2d31 5d2c 2022 6631  t_lines[-1], "f1
-00005660: 2061 6c72 6561 6479 2077 656c 6c20 666f   already well fo
-00005670: 726d 6174 7465 642c 2067 6f6f 6420 6a6f  rmatted, good jo
-00005680: 622e 2229 0a20 2020 2020 2020 2020 2020  b.").           
-00005690: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-000056a0: 6c28 756e 7374 796c 6528 7374 7228 7265  l(unstyle(str(re
-000056b0: 706f 7274 2929 2c20 2231 2066 696c 6520  port)), "1 file 
-000056c0: 6c65 6674 2075 6e63 6861 6e67 6564 2e22  left unchanged."
-000056d0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-000056e0: 6c66 2e61 7373 6572 7445 7175 616c 2872  lf.assertEqual(r
-000056f0: 6570 6f72 742e 7265 7475 726e 5f63 6f64  eport.return_cod
-00005700: 652c 2030 290a 2020 2020 2020 2020 2020  e, 0).          
-00005710: 2020 7265 706f 7274 2e64 6f6e 6528 5061    report.done(Pa
-00005720: 7468 2822 6632 2229 2c20 6365 7263 6973  th("f2"), cercis
-00005730: 2e43 6861 6e67 6564 2e59 4553 290a 2020  .Changed.YES).  
-00005740: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00005750: 7373 6572 7445 7175 616c 286c 656e 286f  ssertEqual(len(o
-00005760: 7574 5f6c 696e 6573 292c 2032 290a 2020  ut_lines), 2).  
-00005770: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00005780: 7373 6572 7445 7175 616c 286c 656e 2865  ssertEqual(len(e
-00005790: 7272 5f6c 696e 6573 292c 2030 290a 2020  rr_lines), 0).  
-000057a0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-000057b0: 7373 6572 7445 7175 616c 286f 7574 5f6c  ssertEqual(out_l
-000057c0: 696e 6573 5b2d 315d 2c20 2272 6566 6f72  ines[-1], "refor
-000057d0: 6d61 7474 6564 2066 3222 290a 2020 2020  matted f2").    
-000057e0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000057f0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-00005800: 2020 2020 2020 2020 2020 756e 7374 796c            unstyl
-00005810: 6528 7374 7228 7265 706f 7274 2929 2c20  e(str(report)), 
-00005820: 2231 2066 696c 6520 7265 666f 726d 6174  "1 file reformat
-00005830: 7465 642c 2031 2066 696c 6520 6c65 6674  ted, 1 file left
-00005840: 2075 6e63 6861 6e67 6564 2e22 0a20 2020   unchanged.".   
-00005850: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00005860: 2020 2020 2020 2072 6570 6f72 742e 646f         report.do
-00005870: 6e65 2850 6174 6828 2266 3322 292c 2063  ne(Path("f3"), c
-00005880: 6572 6369 732e 4368 616e 6765 642e 4341  ercis.Changed.CA
-00005890: 4348 4544 290a 2020 2020 2020 2020 2020  CHED).          
-000058a0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-000058b0: 616c 286c 656e 286f 7574 5f6c 696e 6573  al(len(out_lines
-000058c0: 292c 2033 290a 2020 2020 2020 2020 2020  ), 3).          
-000058d0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-000058e0: 616c 286c 656e 2865 7272 5f6c 696e 6573  al(len(err_lines
-000058f0: 292c 2030 290a 2020 2020 2020 2020 2020  ), 0).          
-00005900: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00005910: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
-00005920: 2020 2020 6f75 745f 6c69 6e65 735b 2d31      out_lines[-1
-00005930: 5d2c 2022 6633 2077 6173 6e27 7420 6d6f  ], "f3 wasn't mo
-00005940: 6469 6669 6564 206f 6e20 6469 736b 2073  dified on disk s
-00005950: 696e 6365 206c 6173 7420 7275 6e2e 220a  ince last run.".
-00005960: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00005970: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00005980: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-00005990: 2020 2020 2020 2020 2020 2020 756e 7374              unst
-000059a0: 796c 6528 7374 7228 7265 706f 7274 2929  yle(str(report))
-000059b0: 2c20 2231 2066 696c 6520 7265 666f 726d  , "1 file reform
-000059c0: 6174 7465 642c 2032 2066 696c 6573 206c  atted, 2 files l
-000059d0: 6566 7420 756e 6368 616e 6765 642e 220a  eft unchanged.".
-000059e0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-000059f0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00005a00: 7373 6572 7445 7175 616c 2872 6570 6f72  ssertEqual(repor
-00005a10: 742e 7265 7475 726e 5f63 6f64 652c 2030  t.return_code, 0
-00005a20: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00005a30: 706f 7274 2e63 6865 636b 203d 2054 7275  port.check = Tru
-00005a40: 650a 2020 2020 2020 2020 2020 2020 7365  e.            se
-00005a50: 6c66 2e61 7373 6572 7445 7175 616c 2872  lf.assertEqual(r
-00005a60: 6570 6f72 742e 7265 7475 726e 5f63 6f64  eport.return_cod
-00005a70: 652c 2031 290a 2020 2020 2020 2020 2020  e, 1).          
-00005a80: 2020 7265 706f 7274 2e63 6865 636b 203d    report.check =
-00005a90: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
-00005aa0: 2020 2072 6570 6f72 742e 6661 696c 6564     report.failed
-00005ab0: 2850 6174 6828 2265 3122 292c 2022 626f  (Path("e1"), "bo
-00005ac0: 6f6d 2229 0a20 2020 2020 2020 2020 2020  om").           
-00005ad0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00005ae0: 6c28 6c65 6e28 6f75 745f 6c69 6e65 7329  l(len(out_lines)
-00005af0: 2c20 3329 0a20 2020 2020 2020 2020 2020  , 3).           
-00005b00: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00005b10: 6c28 6c65 6e28 6572 725f 6c69 6e65 7329  l(len(err_lines)
-00005b20: 2c20 3129 0a20 2020 2020 2020 2020 2020  , 1).           
-00005b30: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00005b40: 6c28 6572 725f 6c69 6e65 735b 2d31 5d2c  l(err_lines[-1],
-00005b50: 2022 6572 726f 723a 2063 616e 6e6f 7420   "error: cannot 
-00005b60: 666f 726d 6174 2065 313a 2062 6f6f 6d22  format e1: boom"
-00005b70: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-00005b80: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-00005b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005ba0: 756e 7374 796c 6528 7374 7228 7265 706f  unstyle(str(repo
-00005bb0: 7274 2929 2c0a 2020 2020 2020 2020 2020  rt)),.          
-00005bc0: 2020 2020 2020 2231 2066 696c 6520 7265        "1 file re
-00005bd0: 666f 726d 6174 7465 642c 2032 2066 696c  formatted, 2 fil
-00005be0: 6573 206c 6566 7420 756e 6368 616e 6765  es left unchange
-00005bf0: 642c 2031 2066 696c 6520 6661 696c 6564  d, 1 file failed
-00005c00: 2074 6f22 0a20 2020 2020 2020 2020 2020   to".           
-00005c10: 2020 2020 2022 2072 6566 6f72 6d61 742e       " reformat.
-00005c20: 222c 0a20 2020 2020 2020 2020 2020 2029  ",.            )
-00005c30: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00005c40: 662e 6173 7365 7274 4571 7561 6c28 7265  f.assertEqual(re
-00005c50: 706f 7274 2e72 6574 7572 6e5f 636f 6465  port.return_code
-00005c60: 2c20 3132 3329 0a20 2020 2020 2020 2020  , 123).         
-00005c70: 2020 2072 6570 6f72 742e 646f 6e65 2850     report.done(P
-00005c80: 6174 6828 2266 3322 292c 2063 6572 6369  ath("f3"), cerci
-00005c90: 732e 4368 616e 6765 642e 5945 5329 0a20  s.Changed.YES). 
-00005ca0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00005cb0: 6173 7365 7274 4571 7561 6c28 6c65 6e28  assertEqual(len(
-00005cc0: 6f75 745f 6c69 6e65 7329 2c20 3429 0a20  out_lines), 4). 
-00005cd0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00005ce0: 6173 7365 7274 4571 7561 6c28 6c65 6e28  assertEqual(len(
-00005cf0: 6572 725f 6c69 6e65 7329 2c20 3129 0a20  err_lines), 1). 
-00005d00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00005d10: 6173 7365 7274 4571 7561 6c28 6f75 745f  assertEqual(out_
-00005d20: 6c69 6e65 735b 2d31 5d2c 2022 7265 666f  lines[-1], "refo
-00005d30: 726d 6174 7465 6420 6633 2229 0a20 2020  rmatted f3").   
-00005d40: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00005d50: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-00005d60: 2020 2020 2020 2020 2020 2075 6e73 7479             unsty
-00005d70: 6c65 2873 7472 2872 6570 6f72 7429 292c  le(str(report)),
-00005d80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005d90: 2022 3220 6669 6c65 7320 7265 666f 726d   "2 files reform
-00005da0: 6174 7465 642c 2032 2066 696c 6573 206c  atted, 2 files l
-00005db0: 6566 7420 756e 6368 616e 6765 642c 2031  eft unchanged, 1
-00005dc0: 2066 696c 6520 6661 696c 6564 2074 6f22   file failed to"
-00005dd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005de0: 2022 2072 6566 6f72 6d61 742e 222c 0a20   " reformat.",. 
-00005df0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00005e00: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00005e10: 7365 7274 4571 7561 6c28 7265 706f 7274  sertEqual(report
-00005e20: 2e72 6574 7572 6e5f 636f 6465 2c20 3132  .return_code, 12
-00005e30: 3329 0a20 2020 2020 2020 2020 2020 2072  3).            r
-00005e40: 6570 6f72 742e 6661 696c 6564 2850 6174  eport.failed(Pat
-00005e50: 6828 2265 3222 292c 2022 626f 6f6d 2229  h("e2"), "boom")
-00005e60: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00005e70: 662e 6173 7365 7274 4571 7561 6c28 6c65  f.assertEqual(le
-00005e80: 6e28 6f75 745f 6c69 6e65 7329 2c20 3429  n(out_lines), 4)
-00005e90: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00005ea0: 662e 6173 7365 7274 4571 7561 6c28 6c65  f.assertEqual(le
-00005eb0: 6e28 6572 725f 6c69 6e65 7329 2c20 3229  n(err_lines), 2)
-00005ec0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00005ed0: 662e 6173 7365 7274 4571 7561 6c28 6572  f.assertEqual(er
-00005ee0: 725f 6c69 6e65 735b 2d31 5d2c 2022 6572  r_lines[-1], "er
-00005ef0: 726f 723a 2063 616e 6e6f 7420 666f 726d  ror: cannot form
-00005f00: 6174 2065 323a 2062 6f6f 6d22 290a 2020  at e2: boom").  
-00005f10: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00005f20: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-00005f30: 2020 2020 2020 2020 2020 2020 756e 7374              unst
-00005f40: 796c 6528 7374 7228 7265 706f 7274 2929  yle(str(report))
-00005f50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00005f60: 2020 2232 2066 696c 6573 2072 6566 6f72    "2 files refor
-00005f70: 6d61 7474 6564 2c20 3220 6669 6c65 7320  matted, 2 files 
-00005f80: 6c65 6674 2075 6e63 6861 6e67 6564 2c20  left unchanged, 
-00005f90: 3220 6669 6c65 7320 6661 696c 6564 2074  2 files failed t
-00005fa0: 6f22 0a20 2020 2020 2020 2020 2020 2020  o".             
-00005fb0: 2020 2022 2072 6566 6f72 6d61 742e 222c     " reformat.",
-00005fc0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00005fd0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00005fe0: 6173 7365 7274 4571 7561 6c28 7265 706f  assertEqual(repo
-00005ff0: 7274 2e72 6574 7572 6e5f 636f 6465 2c20  rt.return_code, 
-00006000: 3132 3329 0a20 2020 2020 2020 2020 2020  123).           
-00006010: 2072 6570 6f72 742e 7061 7468 5f69 676e   report.path_ign
-00006020: 6f72 6564 2850 6174 6828 2277 6174 2229  ored(Path("wat")
-00006030: 2c20 226e 6f20 6d61 7463 6822 290a 2020  , "no match").  
-00006040: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00006050: 7373 6572 7445 7175 616c 286c 656e 286f  ssertEqual(len(o
-00006060: 7574 5f6c 696e 6573 292c 2035 290a 2020  ut_lines), 5).  
-00006070: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00006080: 7373 6572 7445 7175 616c 286c 656e 2865  ssertEqual(len(e
-00006090: 7272 5f6c 696e 6573 292c 2032 290a 2020  rr_lines), 2).  
-000060a0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-000060b0: 7373 6572 7445 7175 616c 286f 7574 5f6c  ssertEqual(out_l
-000060c0: 696e 6573 5b2d 315d 2c20 2277 6174 2069  ines[-1], "wat i
-000060d0: 676e 6f72 6564 3a20 6e6f 206d 6174 6368  gnored: no match
-000060e0: 2229 0a20 2020 2020 2020 2020 2020 2073  ").            s
-000060f0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00006100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006110: 2075 6e73 7479 6c65 2873 7472 2872 6570   unstyle(str(rep
-00006120: 6f72 7429 292c 0a20 2020 2020 2020 2020  ort)),.         
-00006130: 2020 2020 2020 2022 3220 6669 6c65 7320         "2 files 
-00006140: 7265 666f 726d 6174 7465 642c 2032 2066  reformatted, 2 f
-00006150: 696c 6573 206c 6566 7420 756e 6368 616e  iles left unchan
-00006160: 6765 642c 2032 2066 696c 6573 2066 6169  ged, 2 files fai
-00006170: 6c65 6420 746f 220a 2020 2020 2020 2020  led to".        
-00006180: 2020 2020 2020 2020 2220 7265 666f 726d          " reform
-00006190: 6174 2e22 2c0a 2020 2020 2020 2020 2020  at.",.          
-000061a0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-000061b0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-000061c0: 2872 6570 6f72 742e 7265 7475 726e 5f63  (report.return_c
-000061d0: 6f64 652c 2031 3233 290a 2020 2020 2020  ode, 123).      
-000061e0: 2020 2020 2020 7265 706f 7274 2e64 6f6e        report.don
-000061f0: 6528 5061 7468 2822 6634 2229 2c20 6365  e(Path("f4"), ce
-00006200: 7263 6973 2e43 6861 6e67 6564 2e4e 4f29  rcis.Changed.NO)
-00006210: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00006220: 662e 6173 7365 7274 4571 7561 6c28 6c65  f.assertEqual(le
-00006230: 6e28 6f75 745f 6c69 6e65 7329 2c20 3629  n(out_lines), 6)
-00006240: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00006250: 662e 6173 7365 7274 4571 7561 6c28 6c65  f.assertEqual(le
-00006260: 6e28 6572 725f 6c69 6e65 7329 2c20 3229  n(err_lines), 2)
-00006270: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00006280: 662e 6173 7365 7274 4571 7561 6c28 6f75  f.assertEqual(ou
-00006290: 745f 6c69 6e65 735b 2d31 5d2c 2022 6634  t_lines[-1], "f4
-000062a0: 2061 6c72 6561 6479 2077 656c 6c20 666f   already well fo
-000062b0: 726d 6174 7465 642c 2067 6f6f 6420 6a6f  rmatted, good jo
-000062c0: 622e 2229 0a20 2020 2020 2020 2020 2020  b.").           
-000062d0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-000062e0: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
-000062f0: 2020 2075 6e73 7479 6c65 2873 7472 2872     unstyle(str(r
-00006300: 6570 6f72 7429 292c 0a20 2020 2020 2020  eport)),.       
-00006310: 2020 2020 2020 2020 2022 3220 6669 6c65           "2 file
-00006320: 7320 7265 666f 726d 6174 7465 642c 2033  s reformatted, 3
-00006330: 2066 696c 6573 206c 6566 7420 756e 6368   files left unch
-00006340: 616e 6765 642c 2032 2066 696c 6573 2066  anged, 2 files f
-00006350: 6169 6c65 6420 746f 220a 2020 2020 2020  ailed to".      
-00006360: 2020 2020 2020 2020 2020 2220 7265 666f            " refo
-00006370: 726d 6174 2e22 2c0a 2020 2020 2020 2020  rmat.",.        
-00006380: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00006390: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-000063a0: 616c 2872 6570 6f72 742e 7265 7475 726e  al(report.return
-000063b0: 5f63 6f64 652c 2031 3233 290a 2020 2020  _code, 123).    
-000063c0: 2020 2020 2020 2020 7265 706f 7274 2e63          report.c
-000063d0: 6865 636b 203d 2054 7275 650a 2020 2020  heck = True.    
-000063e0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000063f0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-00006400: 2020 2020 2020 2020 2020 756e 7374 796c            unstyl
-00006410: 6528 7374 7228 7265 706f 7274 2929 2c0a  e(str(report)),.
-00006420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006430: 2232 2066 696c 6573 2077 6f75 6c64 2062  "2 files would b
-00006440: 6520 7265 666f 726d 6174 7465 642c 2033  e reformatted, 3
-00006450: 2066 696c 6573 2077 6f75 6c64 2062 6520   files would be 
-00006460: 6c65 6674 2075 6e63 6861 6e67 6564 2c20  left unchanged, 
-00006470: 3222 0a20 2020 2020 2020 2020 2020 2020  2".             
-00006480: 2020 2022 2066 696c 6573 2077 6f75 6c64     " files would
-00006490: 2066 6169 6c20 746f 2072 6566 6f72 6d61   fail to reforma
-000064a0: 742e 222c 0a20 2020 2020 2020 2020 2020  t.",.           
-000064b0: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
-000064c0: 6570 6f72 742e 6368 6563 6b20 3d20 4661  eport.check = Fa
-000064d0: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-000064e0: 7265 706f 7274 2e64 6966 6620 3d20 5472  report.diff = Tr
-000064f0: 7565 0a20 2020 2020 2020 2020 2020 2073  ue.            s
-00006500: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00006510: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006520: 2075 6e73 7479 6c65 2873 7472 2872 6570   unstyle(str(rep
-00006530: 6f72 7429 292c 0a20 2020 2020 2020 2020  ort)),.         
-00006540: 2020 2020 2020 2022 3220 6669 6c65 7320         "2 files 
-00006550: 776f 756c 6420 6265 2072 6566 6f72 6d61  would be reforma
-00006560: 7474 6564 2c20 3320 6669 6c65 7320 776f  tted, 3 files wo
-00006570: 756c 6420 6265 206c 6566 7420 756e 6368  uld be left unch
-00006580: 616e 6765 642c 2032 220a 2020 2020 2020  anged, 2".      
-00006590: 2020 2020 2020 2020 2020 2220 6669 6c65            " file
-000065a0: 7320 776f 756c 6420 6661 696c 2074 6f20  s would fail to 
-000065b0: 7265 666f 726d 6174 2e22 2c0a 2020 2020  reformat.",.    
-000065c0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-000065d0: 6566 2074 6573 745f 7265 706f 7274 5f71  ef test_report_q
-000065e0: 7569 6574 2873 656c 6629 202d 3e20 4e6f  uiet(self) -> No
-000065f0: 6e65 3a0a 2020 2020 2020 2020 7265 706f  ne:.        repo
-00006600: 7274 203d 2052 6570 6f72 7428 7175 6965  rt = Report(quie
-00006610: 743d 5472 7565 290a 2020 2020 2020 2020  t=True).        
-00006620: 6f75 745f 6c69 6e65 7320 3d20 5b5d 0a20  out_lines = []. 
-00006630: 2020 2020 2020 2065 7272 5f6c 696e 6573         err_lines
-00006640: 203d 205b 5d0a 0a20 2020 2020 2020 2064   = []..        d
-00006650: 6566 206f 7574 286d 7367 3a20 7374 722c  ef out(msg: str,
-00006660: 202a 2a6b 7761 7267 733a 2041 6e79 2920   **kwargs: Any) 
-00006670: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00006680: 2020 2020 206f 7574 5f6c 696e 6573 2e61       out_lines.a
-00006690: 7070 656e 6428 6d73 6729 0a0a 2020 2020  ppend(msg)..    
-000066a0: 2020 2020 6465 6620 6572 7228 6d73 673a      def err(msg:
-000066b0: 2073 7472 2c20 2a2a 6b77 6172 6773 3a20   str, **kwargs: 
-000066c0: 416e 7929 202d 3e20 4e6f 6e65 3a0a 2020  Any) -> None:.  
-000066d0: 2020 2020 2020 2020 2020 6572 725f 6c69            err_li
-000066e0: 6e65 732e 6170 7065 6e64 286d 7367 290a  nes.append(msg).
-000066f0: 0a20 2020 2020 2020 2077 6974 6820 7061  .        with pa
-00006700: 7463 6828 2263 6572 6369 732e 6f75 7470  tch("cercis.outp
-00006710: 7574 2e5f 6f75 7422 2c20 6f75 7429 2c20  ut._out", out), 
-00006720: 7061 7463 6828 2263 6572 6369 732e 6f75  patch("cercis.ou
-00006730: 7470 7574 2e5f 6572 7222 2c20 6572 7229  tput._err", err)
-00006740: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00006750: 706f 7274 2e64 6f6e 6528 5061 7468 2822  port.done(Path("
-00006760: 6631 2229 2c20 6365 7263 6973 2e43 6861  f1"), cercis.Cha
-00006770: 6e67 6564 2e4e 4f29 0a20 2020 2020 2020  nged.NO).       
-00006780: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00006790: 4571 7561 6c28 6c65 6e28 6f75 745f 6c69  Equal(len(out_li
-000067a0: 6e65 7329 2c20 3029 0a20 2020 2020 2020  nes), 0).       
-000067b0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-000067c0: 4571 7561 6c28 6c65 6e28 6572 725f 6c69  Equal(len(err_li
-000067d0: 6e65 7329 2c20 3029 0a20 2020 2020 2020  nes), 0).       
-000067e0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-000067f0: 4571 7561 6c28 756e 7374 796c 6528 7374  Equal(unstyle(st
-00006800: 7228 7265 706f 7274 2929 2c20 2231 2066  r(report)), "1 f
-00006810: 696c 6520 6c65 6674 2075 6e63 6861 6e67  ile left unchang
-00006820: 6564 2e22 290a 2020 2020 2020 2020 2020  ed.").          
-00006830: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00006840: 616c 2872 6570 6f72 742e 7265 7475 726e  al(report.return
-00006850: 5f63 6f64 652c 2030 290a 2020 2020 2020  _code, 0).      
-00006860: 2020 2020 2020 7265 706f 7274 2e64 6f6e        report.don
-00006870: 6528 5061 7468 2822 6632 2229 2c20 6365  e(Path("f2"), ce
-00006880: 7263 6973 2e43 6861 6e67 6564 2e59 4553  rcis.Changed.YES
-00006890: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-000068a0: 6c66 2e61 7373 6572 7445 7175 616c 286c  lf.assertEqual(l
-000068b0: 656e 286f 7574 5f6c 696e 6573 292c 2030  en(out_lines), 0
-000068c0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-000068d0: 6c66 2e61 7373 6572 7445 7175 616c 286c  lf.assertEqual(l
-000068e0: 656e 2865 7272 5f6c 696e 6573 292c 2030  en(err_lines), 0
-000068f0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-00006900: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-00006910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006920: 756e 7374 796c 6528 7374 7228 7265 706f  unstyle(str(repo
-00006930: 7274 2929 2c20 2231 2066 696c 6520 7265  rt)), "1 file re
-00006940: 666f 726d 6174 7465 642c 2031 2066 696c  formatted, 1 fil
-00006950: 6520 6c65 6674 2075 6e63 6861 6e67 6564  e left unchanged
-00006960: 2e22 0a20 2020 2020 2020 2020 2020 2029  .".            )
-00006970: 0a20 2020 2020 2020 2020 2020 2072 6570  .            rep
-00006980: 6f72 742e 646f 6e65 2850 6174 6828 2266  ort.done(Path("f
-00006990: 3322 292c 2063 6572 6369 732e 4368 616e  3"), cercis.Chan
-000069a0: 6765 642e 4341 4348 4544 290a 2020 2020  ged.CACHED).    
-000069b0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000069c0: 6572 7445 7175 616c 286c 656e 286f 7574  ertEqual(len(out
-000069d0: 5f6c 696e 6573 292c 2030 290a 2020 2020  _lines), 0).    
-000069e0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000069f0: 6572 7445 7175 616c 286c 656e 2865 7272  ertEqual(len(err
-00006a00: 5f6c 696e 6573 292c 2030 290a 2020 2020  _lines), 0).    
-00006a10: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00006a20: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-00006a30: 2020 2020 2020 2020 2020 756e 7374 796c            unstyl
-00006a40: 6528 7374 7228 7265 706f 7274 2929 2c20  e(str(report)), 
-00006a50: 2231 2066 696c 6520 7265 666f 726d 6174  "1 file reformat
-00006a60: 7465 642c 2032 2066 696c 6573 206c 6566  ted, 2 files lef
-00006a70: 7420 756e 6368 616e 6765 642e 220a 2020  t unchanged.".  
-00006a80: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00006a90: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00006aa0: 6572 7445 7175 616c 2872 6570 6f72 742e  ertEqual(report.
-00006ab0: 7265 7475 726e 5f63 6f64 652c 2030 290a  return_code, 0).
-00006ac0: 2020 2020 2020 2020 2020 2020 7265 706f              repo
-00006ad0: 7274 2e63 6865 636b 203d 2054 7275 650a  rt.check = True.
-00006ae0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00006af0: 2e61 7373 6572 7445 7175 616c 2872 6570  .assertEqual(rep
-00006b00: 6f72 742e 7265 7475 726e 5f63 6f64 652c  ort.return_code,
-00006b10: 2031 290a 2020 2020 2020 2020 2020 2020   1).            
-00006b20: 7265 706f 7274 2e63 6865 636b 203d 2046  report.check = F
-00006b30: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-00006b40: 2072 6570 6f72 742e 6661 696c 6564 2850   report.failed(P
-00006b50: 6174 6828 2265 3122 292c 2022 626f 6f6d  ath("e1"), "boom
-00006b60: 2229 0a20 2020 2020 2020 2020 2020 2073  ").            s
-00006b70: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00006b80: 6c65 6e28 6f75 745f 6c69 6e65 7329 2c20  len(out_lines), 
-00006b90: 3029 0a20 2020 2020 2020 2020 2020 2073  0).            s
-00006ba0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00006bb0: 6c65 6e28 6572 725f 6c69 6e65 7329 2c20  len(err_lines), 
-00006bc0: 3129 0a20 2020 2020 2020 2020 2020 2073  1).            s
-00006bd0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00006be0: 6572 725f 6c69 6e65 735b 2d31 5d2c 2022  err_lines[-1], "
-00006bf0: 6572 726f 723a 2063 616e 6e6f 7420 666f  error: cannot fo
-00006c00: 726d 6174 2065 313a 2062 6f6f 6d22 290a  rmat e1: boom").
-00006c10: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00006c20: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
-00006c30: 2020 2020 2020 2020 2020 2020 2020 756e                un
-00006c40: 7374 796c 6528 7374 7228 7265 706f 7274  style(str(report
-00006c50: 2929 2c0a 2020 2020 2020 2020 2020 2020  )),.            
-00006c60: 2020 2020 2231 2066 696c 6520 7265 666f      "1 file refo
-00006c70: 726d 6174 7465 642c 2032 2066 696c 6573  rmatted, 2 files
-00006c80: 206c 6566 7420 756e 6368 616e 6765 642c   left unchanged,
-00006c90: 2031 2066 696c 6520 6661 696c 6564 2074   1 file failed t
-00006ca0: 6f22 0a20 2020 2020 2020 2020 2020 2020  o".             
-00006cb0: 2020 2022 2072 6566 6f72 6d61 742e 222c     " reformat.",
-00006cc0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00006cd0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00006ce0: 6173 7365 7274 4571 7561 6c28 7265 706f  assertEqual(repo
-00006cf0: 7274 2e72 6574 7572 6e5f 636f 6465 2c20  rt.return_code, 
-00006d00: 3132 3329 0a20 2020 2020 2020 2020 2020  123).           
-00006d10: 2072 6570 6f72 742e 646f 6e65 2850 6174   report.done(Pat
-00006d20: 6828 2266 3322 292c 2063 6572 6369 732e  h("f3"), cercis.
-00006d30: 4368 616e 6765 642e 5945 5329 0a20 2020  Changed.YES).   
-00006d40: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00006d50: 7365 7274 4571 7561 6c28 6c65 6e28 6f75  sertEqual(len(ou
-00006d60: 745f 6c69 6e65 7329 2c20 3029 0a20 2020  t_lines), 0).   
-00006d70: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00006d80: 7365 7274 4571 7561 6c28 6c65 6e28 6572  sertEqual(len(er
-00006d90: 725f 6c69 6e65 7329 2c20 3129 0a20 2020  r_lines), 1).   
-00006da0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00006db0: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-00006dc0: 2020 2020 2020 2020 2020 2075 6e73 7479             unsty
-00006dd0: 6c65 2873 7472 2872 6570 6f72 7429 292c  le(str(report)),
-00006de0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006df0: 2022 3220 6669 6c65 7320 7265 666f 726d   "2 files reform
-00006e00: 6174 7465 642c 2032 2066 696c 6573 206c  atted, 2 files l
-00006e10: 6566 7420 756e 6368 616e 6765 642c 2031  eft unchanged, 1
-00006e20: 2066 696c 6520 6661 696c 6564 2074 6f22   file failed to"
-00006e30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006e40: 2022 2072 6566 6f72 6d61 742e 222c 0a20   " reformat.",. 
-00006e50: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00006e60: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00006e70: 7365 7274 4571 7561 6c28 7265 706f 7274  sertEqual(report
-00006e80: 2e72 6574 7572 6e5f 636f 6465 2c20 3132  .return_code, 12
-00006e90: 3329 0a20 2020 2020 2020 2020 2020 2072  3).            r
-00006ea0: 6570 6f72 742e 6661 696c 6564 2850 6174  eport.failed(Pat
-00006eb0: 6828 2265 3222 292c 2022 626f 6f6d 2229  h("e2"), "boom")
-00006ec0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00006ed0: 662e 6173 7365 7274 4571 7561 6c28 6c65  f.assertEqual(le
-00006ee0: 6e28 6f75 745f 6c69 6e65 7329 2c20 3029  n(out_lines), 0)
-00006ef0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00006f00: 662e 6173 7365 7274 4571 7561 6c28 6c65  f.assertEqual(le
-00006f10: 6e28 6572 725f 6c69 6e65 7329 2c20 3229  n(err_lines), 2)
-00006f20: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00006f30: 662e 6173 7365 7274 4571 7561 6c28 6572  f.assertEqual(er
-00006f40: 725f 6c69 6e65 735b 2d31 5d2c 2022 6572  r_lines[-1], "er
-00006f50: 726f 723a 2063 616e 6e6f 7420 666f 726d  ror: cannot form
-00006f60: 6174 2065 323a 2062 6f6f 6d22 290a 2020  at e2: boom").  
-00006f70: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00006f80: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-00006f90: 2020 2020 2020 2020 2020 2020 756e 7374              unst
-00006fa0: 796c 6528 7374 7228 7265 706f 7274 2929  yle(str(report))
-00006fb0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00006fc0: 2020 2232 2066 696c 6573 2072 6566 6f72    "2 files refor
-00006fd0: 6d61 7474 6564 2c20 3220 6669 6c65 7320  matted, 2 files 
-00006fe0: 6c65 6674 2075 6e63 6861 6e67 6564 2c20  left unchanged, 
-00006ff0: 3220 6669 6c65 7320 6661 696c 6564 2074  2 files failed t
-00007000: 6f22 0a20 2020 2020 2020 2020 2020 2020  o".             
-00007010: 2020 2022 2072 6566 6f72 6d61 742e 222c     " reformat.",
-00007020: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00007030: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00007040: 6173 7365 7274 4571 7561 6c28 7265 706f  assertEqual(repo
-00007050: 7274 2e72 6574 7572 6e5f 636f 6465 2c20  rt.return_code, 
-00007060: 3132 3329 0a20 2020 2020 2020 2020 2020  123).           
-00007070: 2072 6570 6f72 742e 7061 7468 5f69 676e   report.path_ign
-00007080: 6f72 6564 2850 6174 6828 2277 6174 2229  ored(Path("wat")
-00007090: 2c20 226e 6f20 6d61 7463 6822 290a 2020  , "no match").  
-000070a0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-000070b0: 7373 6572 7445 7175 616c 286c 656e 286f  ssertEqual(len(o
-000070c0: 7574 5f6c 696e 6573 292c 2030 290a 2020  ut_lines), 0).  
-000070d0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-000070e0: 7373 6572 7445 7175 616c 286c 656e 2865  ssertEqual(len(e
-000070f0: 7272 5f6c 696e 6573 292c 2032 290a 2020  rr_lines), 2).  
-00007100: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00007110: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-00007120: 2020 2020 2020 2020 2020 2020 756e 7374              unst
-00007130: 796c 6528 7374 7228 7265 706f 7274 2929  yle(str(report))
-00007140: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00007150: 2020 2232 2066 696c 6573 2072 6566 6f72    "2 files refor
-00007160: 6d61 7474 6564 2c20 3220 6669 6c65 7320  matted, 2 files 
-00007170: 6c65 6674 2075 6e63 6861 6e67 6564 2c20  left unchanged, 
-00007180: 3220 6669 6c65 7320 6661 696c 6564 2074  2 files failed t
-00007190: 6f22 0a20 2020 2020 2020 2020 2020 2020  o".             
-000071a0: 2020 2022 2072 6566 6f72 6d61 742e 222c     " reformat.",
-000071b0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-000071c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000071d0: 6173 7365 7274 4571 7561 6c28 7265 706f  assertEqual(repo
-000071e0: 7274 2e72 6574 7572 6e5f 636f 6465 2c20  rt.return_code, 
-000071f0: 3132 3329 0a20 2020 2020 2020 2020 2020  123).           
-00007200: 2072 6570 6f72 742e 646f 6e65 2850 6174   report.done(Pat
-00007210: 6828 2266 3422 292c 2063 6572 6369 732e  h("f4"), cercis.
-00007220: 4368 616e 6765 642e 4e4f 290a 2020 2020  Changed.NO).    
-00007230: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00007240: 6572 7445 7175 616c 286c 656e 286f 7574  ertEqual(len(out
-00007250: 5f6c 696e 6573 292c 2030 290a 2020 2020  _lines), 0).    
-00007260: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00007270: 6572 7445 7175 616c 286c 656e 2865 7272  ertEqual(len(err
-00007280: 5f6c 696e 6573 292c 2032 290a 2020 2020  _lines), 2).    
-00007290: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000072a0: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-000072b0: 2020 2020 2020 2020 2020 756e 7374 796c            unstyl
-000072c0: 6528 7374 7228 7265 706f 7274 2929 2c0a  e(str(report)),.
-000072d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000072e0: 2232 2066 696c 6573 2072 6566 6f72 6d61  "2 files reforma
-000072f0: 7474 6564 2c20 3320 6669 6c65 7320 6c65  tted, 3 files le
-00007300: 6674 2075 6e63 6861 6e67 6564 2c20 3220  ft unchanged, 2 
-00007310: 6669 6c65 7320 6661 696c 6564 2074 6f22  files failed to"
-00007320: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007330: 2022 2072 6566 6f72 6d61 742e 222c 0a20   " reformat.",. 
-00007340: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00007350: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00007360: 7365 7274 4571 7561 6c28 7265 706f 7274  sertEqual(report
-00007370: 2e72 6574 7572 6e5f 636f 6465 2c20 3132  .return_code, 12
-00007380: 3329 0a20 2020 2020 2020 2020 2020 2072  3).            r
-00007390: 6570 6f72 742e 6368 6563 6b20 3d20 5472  eport.check = Tr
-000073a0: 7565 0a20 2020 2020 2020 2020 2020 2073  ue.            s
-000073b0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-000073c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000073d0: 2075 6e73 7479 6c65 2873 7472 2872 6570   unstyle(str(rep
-000073e0: 6f72 7429 292c 0a20 2020 2020 2020 2020  ort)),.         
-000073f0: 2020 2020 2020 2022 3220 6669 6c65 7320         "2 files 
-00007400: 776f 756c 6420 6265 2072 6566 6f72 6d61  would be reforma
-00007410: 7474 6564 2c20 3320 6669 6c65 7320 776f  tted, 3 files wo
-00007420: 756c 6420 6265 206c 6566 7420 756e 6368  uld be left unch
-00007430: 616e 6765 642c 2032 220a 2020 2020 2020  anged, 2".      
-00007440: 2020 2020 2020 2020 2020 2220 6669 6c65            " file
-00007450: 7320 776f 756c 6420 6661 696c 2074 6f20  s would fail to 
-00007460: 7265 666f 726d 6174 2e22 2c0a 2020 2020  reformat.",.    
-00007470: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00007480: 2020 2020 2020 7265 706f 7274 2e63 6865        report.che
-00007490: 636b 203d 2046 616c 7365 0a20 2020 2020  ck = False.     
-000074a0: 2020 2020 2020 2072 6570 6f72 742e 6469         report.di
-000074b0: 6666 203d 2054 7275 650a 2020 2020 2020  ff = True.      
-000074c0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-000074d0: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
-000074e0: 2020 2020 2020 2020 756e 7374 796c 6528          unstyle(
-000074f0: 7374 7228 7265 706f 7274 2929 2c0a 2020  str(report)),.  
-00007500: 2020 2020 2020 2020 2020 2020 2020 2232                "2
-00007510: 2066 696c 6573 2077 6f75 6c64 2062 6520   files would be 
-00007520: 7265 666f 726d 6174 7465 642c 2033 2066  reformatted, 3 f
-00007530: 696c 6573 2077 6f75 6c64 2062 6520 6c65  iles would be le
-00007540: 6674 2075 6e63 6861 6e67 6564 2c20 3222  ft unchanged, 2"
-00007550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007560: 2022 2066 696c 6573 2077 6f75 6c64 2066   " files would f
-00007570: 6169 6c20 746f 2072 6566 6f72 6d61 742e  ail to reformat.
-00007580: 222c 0a20 2020 2020 2020 2020 2020 2029  ",.            )
-00007590: 0a0a 2020 2020 6465 6620 7465 7374 5f72  ..    def test_r
-000075a0: 6570 6f72 745f 6e6f 726d 616c 2873 656c  eport_normal(sel
-000075b0: 6629 202d 3e20 4e6f 6e65 3a0a 2020 2020  f) -> None:.    
-000075c0: 2020 2020 7265 706f 7274 203d 2063 6572      report = cer
-000075d0: 6369 732e 5265 706f 7274 2829 0a20 2020  cis.Report().   
-000075e0: 2020 2020 206f 7574 5f6c 696e 6573 203d       out_lines =
-000075f0: 205b 5d0a 2020 2020 2020 2020 6572 725f   [].        err_
-00007600: 6c69 6e65 7320 3d20 5b5d 0a0a 2020 2020  lines = []..    
-00007610: 2020 2020 6465 6620 6f75 7428 6d73 673a      def out(msg:
-00007620: 2073 7472 2c20 2a2a 6b77 6172 6773 3a20   str, **kwargs: 
-00007630: 416e 7929 202d 3e20 4e6f 6e65 3a0a 2020  Any) -> None:.  
-00007640: 2020 2020 2020 2020 2020 6f75 745f 6c69            out_li
-00007650: 6e65 732e 6170 7065 6e64 286d 7367 290a  nes.append(msg).
-00007660: 0a20 2020 2020 2020 2064 6566 2065 7272  .        def err
-00007670: 286d 7367 3a20 7374 722c 202a 2a6b 7761  (msg: str, **kwa
-00007680: 7267 733a 2041 6e79 2920 2d3e 204e 6f6e  rgs: Any) -> Non
-00007690: 653a 0a20 2020 2020 2020 2020 2020 2065  e:.            e
-000076a0: 7272 5f6c 696e 6573 2e61 7070 656e 6428  rr_lines.append(
-000076b0: 6d73 6729 0a0a 2020 2020 2020 2020 7769  msg)..        wi
-000076c0: 7468 2070 6174 6368 2822 6365 7263 6973  th patch("cercis
-000076d0: 2e6f 7574 7075 742e 5f6f 7574 222c 206f  .output._out", o
-000076e0: 7574 292c 2070 6174 6368 2822 6365 7263  ut), patch("cerc
-000076f0: 6973 2e6f 7574 7075 742e 5f65 7272 222c  is.output._err",
-00007700: 2065 7272 293a 0a20 2020 2020 2020 2020   err):.         
-00007710: 2020 2072 6570 6f72 742e 646f 6e65 2850     report.done(P
-00007720: 6174 6828 2266 3122 292c 2063 6572 6369  ath("f1"), cerci
-00007730: 732e 4368 616e 6765 642e 4e4f 290a 2020  s.Changed.NO).  
-00007740: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00007750: 7373 6572 7445 7175 616c 286c 656e 286f  ssertEqual(len(o
-00007760: 7574 5f6c 696e 6573 292c 2030 290a 2020  ut_lines), 0).  
-00007770: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00007780: 7373 6572 7445 7175 616c 286c 656e 2865  ssertEqual(len(e
-00007790: 7272 5f6c 696e 6573 292c 2030 290a 2020  rr_lines), 0).  
-000077a0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-000077b0: 7373 6572 7445 7175 616c 2875 6e73 7479  ssertEqual(unsty
-000077c0: 6c65 2873 7472 2872 6570 6f72 7429 292c  le(str(report)),
-000077d0: 2022 3120 6669 6c65 206c 6566 7420 756e   "1 file left un
-000077e0: 6368 616e 6765 642e 2229 0a20 2020 2020  changed.").     
-000077f0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00007800: 7274 4571 7561 6c28 7265 706f 7274 2e72  rtEqual(report.r
-00007810: 6574 7572 6e5f 636f 6465 2c20 3029 0a20  eturn_code, 0). 
-00007820: 2020 2020 2020 2020 2020 2072 6570 6f72             repor
-00007830: 742e 646f 6e65 2850 6174 6828 2266 3222  t.done(Path("f2"
-00007840: 292c 2063 6572 6369 732e 4368 616e 6765  ), cercis.Change
-00007850: 642e 5945 5329 0a20 2020 2020 2020 2020  d.YES).         
-00007860: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00007870: 7561 6c28 6c65 6e28 6f75 745f 6c69 6e65  ual(len(out_line
-00007880: 7329 2c20 3129 0a20 2020 2020 2020 2020  s), 1).         
-00007890: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-000078a0: 7561 6c28 6c65 6e28 6572 725f 6c69 6e65  ual(len(err_line
-000078b0: 7329 2c20 3029 0a20 2020 2020 2020 2020  s), 0).         
-000078c0: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-000078d0: 7561 6c28 6f75 745f 6c69 6e65 735b 2d31  ual(out_lines[-1
-000078e0: 5d2c 2022 7265 666f 726d 6174 7465 6420  ], "reformatted 
-000078f0: 6632 2229 0a20 2020 2020 2020 2020 2020  f2").           
-00007900: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00007910: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
-00007920: 2020 2075 6e73 7479 6c65 2873 7472 2872     unstyle(str(r
-00007930: 6570 6f72 7429 292c 2022 3120 6669 6c65  eport)), "1 file
-00007940: 2072 6566 6f72 6d61 7474 6564 2c20 3120   reformatted, 1 
-00007950: 6669 6c65 206c 6566 7420 756e 6368 616e  file left unchan
-00007960: 6765 642e 220a 2020 2020 2020 2020 2020  ged.".          
-00007970: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00007980: 7265 706f 7274 2e64 6f6e 6528 5061 7468  report.done(Path
-00007990: 2822 6633 2229 2c20 6365 7263 6973 2e43  ("f3"), cercis.C
-000079a0: 6861 6e67 6564 2e43 4143 4845 4429 0a20  hanged.CACHED). 
-000079b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000079c0: 6173 7365 7274 4571 7561 6c28 6c65 6e28  assertEqual(len(
-000079d0: 6f75 745f 6c69 6e65 7329 2c20 3129 0a20  out_lines), 1). 
-000079e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000079f0: 6173 7365 7274 4571 7561 6c28 6c65 6e28  assertEqual(len(
-00007a00: 6572 725f 6c69 6e65 7329 2c20 3029 0a20  err_lines), 0). 
-00007a10: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00007a20: 6173 7365 7274 4571 7561 6c28 6f75 745f  assertEqual(out_
-00007a30: 6c69 6e65 735b 2d31 5d2c 2022 7265 666f  lines[-1], "refo
-00007a40: 726d 6174 7465 6420 6632 2229 0a20 2020  rmatted f2").   
-00007a50: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00007a60: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-00007a70: 2020 2020 2020 2020 2020 2075 6e73 7479             unsty
-00007a80: 6c65 2873 7472 2872 6570 6f72 7429 292c  le(str(report)),
-00007a90: 2022 3120 6669 6c65 2072 6566 6f72 6d61   "1 file reforma
-00007aa0: 7474 6564 2c20 3220 6669 6c65 7320 6c65  tted, 2 files le
-00007ab0: 6674 2075 6e63 6861 6e67 6564 2e22 0a20  ft unchanged.". 
-00007ac0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00007ad0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00007ae0: 7365 7274 4571 7561 6c28 7265 706f 7274  sertEqual(report
-00007af0: 2e72 6574 7572 6e5f 636f 6465 2c20 3029  .return_code, 0)
-00007b00: 0a20 2020 2020 2020 2020 2020 2072 6570  .            rep
-00007b10: 6f72 742e 6368 6563 6b20 3d20 5472 7565  ort.check = True
-00007b20: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00007b30: 662e 6173 7365 7274 4571 7561 6c28 7265  f.assertEqual(re
-00007b40: 706f 7274 2e72 6574 7572 6e5f 636f 6465  port.return_code
-00007b50: 2c20 3129 0a20 2020 2020 2020 2020 2020  , 1).           
-00007b60: 2072 6570 6f72 742e 6368 6563 6b20 3d20   report.check = 
-00007b70: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
-00007b80: 2020 7265 706f 7274 2e66 6169 6c65 6428    report.failed(
-00007b90: 5061 7468 2822 6531 2229 2c20 2262 6f6f  Path("e1"), "boo
-00007ba0: 6d22 290a 2020 2020 2020 2020 2020 2020  m").            
-00007bb0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00007bc0: 286c 656e 286f 7574 5f6c 696e 6573 292c  (len(out_lines),
-00007bd0: 2031 290a 2020 2020 2020 2020 2020 2020   1).            
-00007be0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00007bf0: 286c 656e 2865 7272 5f6c 696e 6573 292c  (len(err_lines),
-00007c00: 2031 290a 2020 2020 2020 2020 2020 2020   1).            
-00007c10: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00007c20: 2865 7272 5f6c 696e 6573 5b2d 315d 2c20  (err_lines[-1], 
-00007c30: 2265 7272 6f72 3a20 6361 6e6e 6f74 2066  "error: cannot f
-00007c40: 6f72 6d61 7420 6531 3a20 626f 6f6d 2229  ormat e1: boom")
-00007c50: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00007c60: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
-00007c70: 2020 2020 2020 2020 2020 2020 2020 2075                 u
-00007c80: 6e73 7479 6c65 2873 7472 2872 6570 6f72  nstyle(str(repor
-00007c90: 7429 292c 0a20 2020 2020 2020 2020 2020  t)),.           
-00007ca0: 2020 2020 2022 3120 6669 6c65 2072 6566       "1 file ref
-00007cb0: 6f72 6d61 7474 6564 2c20 3220 6669 6c65  ormatted, 2 file
-00007cc0: 7320 6c65 6674 2075 6e63 6861 6e67 6564  s left unchanged
-00007cd0: 2c20 3120 6669 6c65 2066 6169 6c65 6420  , 1 file failed 
-00007ce0: 746f 220a 2020 2020 2020 2020 2020 2020  to".            
-00007cf0: 2020 2020 2220 7265 666f 726d 6174 2e22      " reformat."
-00007d00: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-00007d10: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00007d20: 2e61 7373 6572 7445 7175 616c 2872 6570  .assertEqual(rep
-00007d30: 6f72 742e 7265 7475 726e 5f63 6f64 652c  ort.return_code,
-00007d40: 2031 3233 290a 2020 2020 2020 2020 2020   123).          
-00007d50: 2020 7265 706f 7274 2e64 6f6e 6528 5061    report.done(Pa
-00007d60: 7468 2822 6633 2229 2c20 6365 7263 6973  th("f3"), cercis
-00007d70: 2e43 6861 6e67 6564 2e59 4553 290a 2020  .Changed.YES).  
-00007d80: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00007d90: 7373 6572 7445 7175 616c 286c 656e 286f  ssertEqual(len(o
-00007da0: 7574 5f6c 696e 6573 292c 2032 290a 2020  ut_lines), 2).  
-00007db0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00007dc0: 7373 6572 7445 7175 616c 286c 656e 2865  ssertEqual(len(e
-00007dd0: 7272 5f6c 696e 6573 292c 2031 290a 2020  rr_lines), 1).  
-00007de0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00007df0: 7373 6572 7445 7175 616c 286f 7574 5f6c  ssertEqual(out_l
-00007e00: 696e 6573 5b2d 315d 2c20 2272 6566 6f72  ines[-1], "refor
-00007e10: 6d61 7474 6564 2066 3322 290a 2020 2020  matted f3").    
-00007e20: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00007e30: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-00007e40: 2020 2020 2020 2020 2020 756e 7374 796c            unstyl
-00007e50: 6528 7374 7228 7265 706f 7274 2929 2c0a  e(str(report)),.
-00007e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007e70: 2232 2066 696c 6573 2072 6566 6f72 6d61  "2 files reforma
-00007e80: 7474 6564 2c20 3220 6669 6c65 7320 6c65  tted, 2 files le
-00007e90: 6674 2075 6e63 6861 6e67 6564 2c20 3120  ft unchanged, 1 
-00007ea0: 6669 6c65 2066 6169 6c65 6420 746f 220a  file failed to".
-00007eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007ec0: 2220 7265 666f 726d 6174 2e22 2c0a 2020  " reformat.",.  
-00007ed0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00007ee0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00007ef0: 6572 7445 7175 616c 2872 6570 6f72 742e  ertEqual(report.
-00007f00: 7265 7475 726e 5f63 6f64 652c 2031 3233  return_code, 123
-00007f10: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00007f20: 706f 7274 2e66 6169 6c65 6428 5061 7468  port.failed(Path
-00007f30: 2822 6532 2229 2c20 2262 6f6f 6d22 290a  ("e2"), "boom").
-00007f40: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00007f50: 2e61 7373 6572 7445 7175 616c 286c 656e  .assertEqual(len
-00007f60: 286f 7574 5f6c 696e 6573 292c 2032 290a  (out_lines), 2).
-00007f70: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00007f80: 2e61 7373 6572 7445 7175 616c 286c 656e  .assertEqual(len
-00007f90: 2865 7272 5f6c 696e 6573 292c 2032 290a  (err_lines), 2).
-00007fa0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00007fb0: 2e61 7373 6572 7445 7175 616c 2865 7272  .assertEqual(err
-00007fc0: 5f6c 696e 6573 5b2d 315d 2c20 2265 7272  _lines[-1], "err
-00007fd0: 6f72 3a20 6361 6e6e 6f74 2066 6f72 6d61  or: cannot forma
-00007fe0: 7420 6532 3a20 626f 6f6d 2229 0a20 2020  t e2: boom").   
-00007ff0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00008000: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-00008010: 2020 2020 2020 2020 2020 2075 6e73 7479             unsty
-00008020: 6c65 2873 7472 2872 6570 6f72 7429 292c  le(str(report)),
-00008030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008040: 2022 3220 6669 6c65 7320 7265 666f 726d   "2 files reform
-00008050: 6174 7465 642c 2032 2066 696c 6573 206c  atted, 2 files l
-00008060: 6566 7420 756e 6368 616e 6765 642c 2032  eft unchanged, 2
-00008070: 2066 696c 6573 2066 6169 6c65 6420 746f   files failed to
-00008080: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00008090: 2020 2220 7265 666f 726d 6174 2e22 2c0a    " reformat.",.
-000080a0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-000080b0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-000080c0: 7373 6572 7445 7175 616c 2872 6570 6f72  ssertEqual(repor
-000080d0: 742e 7265 7475 726e 5f63 6f64 652c 2031  t.return_code, 1
-000080e0: 3233 290a 2020 2020 2020 2020 2020 2020  23).            
-000080f0: 7265 706f 7274 2e70 6174 685f 6967 6e6f  report.path_igno
-00008100: 7265 6428 5061 7468 2822 7761 7422 292c  red(Path("wat"),
-00008110: 2022 6e6f 206d 6174 6368 2229 0a20 2020   "no match").   
-00008120: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00008130: 7365 7274 4571 7561 6c28 6c65 6e28 6f75  sertEqual(len(ou
-00008140: 745f 6c69 6e65 7329 2c20 3229 0a20 2020  t_lines), 2).   
-00008150: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00008160: 7365 7274 4571 7561 6c28 6c65 6e28 6572  sertEqual(len(er
-00008170: 725f 6c69 6e65 7329 2c20 3229 0a20 2020  r_lines), 2).   
-00008180: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00008190: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-000081a0: 2020 2020 2020 2020 2020 2075 6e73 7479             unsty
-000081b0: 6c65 2873 7472 2872 6570 6f72 7429 292c  le(str(report)),
-000081c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000081d0: 2022 3220 6669 6c65 7320 7265 666f 726d   "2 files reform
-000081e0: 6174 7465 642c 2032 2066 696c 6573 206c  atted, 2 files l
-000081f0: 6566 7420 756e 6368 616e 6765 642c 2032  eft unchanged, 2
-00008200: 2066 696c 6573 2066 6169 6c65 6420 746f   files failed to
-00008210: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00008220: 2020 2220 7265 666f 726d 6174 2e22 2c0a    " reformat.",.
-00008230: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00008240: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00008250: 7373 6572 7445 7175 616c 2872 6570 6f72  ssertEqual(repor
-00008260: 742e 7265 7475 726e 5f63 6f64 652c 2031  t.return_code, 1
-00008270: 3233 290a 2020 2020 2020 2020 2020 2020  23).            
-00008280: 7265 706f 7274 2e64 6f6e 6528 5061 7468  report.done(Path
-00008290: 2822 6634 2229 2c20 6365 7263 6973 2e43  ("f4"), cercis.C
-000082a0: 6861 6e67 6564 2e4e 4f29 0a20 2020 2020  hanged.NO).     
-000082b0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-000082c0: 7274 4571 7561 6c28 6c65 6e28 6f75 745f  rtEqual(len(out_
-000082d0: 6c69 6e65 7329 2c20 3229 0a20 2020 2020  lines), 2).     
-000082e0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-000082f0: 7274 4571 7561 6c28 6c65 6e28 6572 725f  rtEqual(len(err_
-00008300: 6c69 6e65 7329 2c20 3229 0a20 2020 2020  lines), 2).     
-00008310: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00008320: 7274 4571 7561 6c28 0a20 2020 2020 2020  rtEqual(.       
-00008330: 2020 2020 2020 2020 2075 6e73 7479 6c65           unstyle
-00008340: 2873 7472 2872 6570 6f72 7429 292c 0a20  (str(report)),. 
-00008350: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00008360: 3220 6669 6c65 7320 7265 666f 726d 6174  2 files reformat
-00008370: 7465 642c 2033 2066 696c 6573 206c 6566  ted, 3 files lef
-00008380: 7420 756e 6368 616e 6765 642c 2032 2066  t unchanged, 2 f
-00008390: 696c 6573 2066 6169 6c65 6420 746f 220a  iles failed to".
-000083a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000083b0: 2220 7265 666f 726d 6174 2e22 2c0a 2020  " reformat.",.  
-000083c0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-000083d0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-000083e0: 6572 7445 7175 616c 2872 6570 6f72 742e  ertEqual(report.
-000083f0: 7265 7475 726e 5f63 6f64 652c 2031 3233  return_code, 123
-00008400: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00008410: 706f 7274 2e63 6865 636b 203d 2054 7275  port.check = Tru
-00008420: 650a 2020 2020 2020 2020 2020 2020 7365  e.            se
-00008430: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
-00008440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008450: 756e 7374 796c 6528 7374 7228 7265 706f  unstyle(str(repo
-00008460: 7274 2929 2c0a 2020 2020 2020 2020 2020  rt)),.          
-00008470: 2020 2020 2020 2232 2066 696c 6573 2077        "2 files w
-00008480: 6f75 6c64 2062 6520 7265 666f 726d 6174  ould be reformat
-00008490: 7465 642c 2033 2066 696c 6573 2077 6f75  ted, 3 files wou
-000084a0: 6c64 2062 6520 6c65 6674 2075 6e63 6861  ld be left uncha
-000084b0: 6e67 6564 2c20 3222 0a20 2020 2020 2020  nged, 2".       
-000084c0: 2020 2020 2020 2020 2022 2066 696c 6573           " files
-000084d0: 2077 6f75 6c64 2066 6169 6c20 746f 2072   would fail to r
-000084e0: 6566 6f72 6d61 742e 222c 0a20 2020 2020  eformat.",.     
-000084f0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00008500: 2020 2020 2072 6570 6f72 742e 6368 6563       report.chec
-00008510: 6b20 3d20 4661 6c73 650a 2020 2020 2020  k = False.      
-00008520: 2020 2020 2020 7265 706f 7274 2e64 6966        report.dif
-00008530: 6620 3d20 5472 7565 0a20 2020 2020 2020  f = True.       
-00008540: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-00008550: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
-00008560: 2020 2020 2020 2075 6e73 7479 6c65 2873         unstyle(s
-00008570: 7472 2872 6570 6f72 7429 292c 0a20 2020  tr(report)),.   
-00008580: 2020 2020 2020 2020 2020 2020 2022 3220               "2 
-00008590: 6669 6c65 7320 776f 756c 6420 6265 2072  files would be r
-000085a0: 6566 6f72 6d61 7474 6564 2c20 3320 6669  eformatted, 3 fi
-000085b0: 6c65 7320 776f 756c 6420 6265 206c 6566  les would be lef
-000085c0: 7420 756e 6368 616e 6765 642c 2032 220a  t unchanged, 2".
-000085d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000085e0: 2220 6669 6c65 7320 776f 756c 6420 6661  " files would fa
-000085f0: 696c 2074 6f20 7265 666f 726d 6174 2e22  il to reformat."
-00008600: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-00008610: 0a20 2020 2064 6566 2074 6573 745f 6c69  .    def test_li
-00008620: 6232 746f 335f 7061 7273 6528 7365 6c66  b2to3_parse(self
-00008630: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-00008640: 2020 2077 6974 6820 7365 6c66 2e61 7373     with self.ass
-00008650: 6572 7452 6169 7365 7328 6365 7263 6973  ertRaises(cercis
-00008660: 2e49 6e76 616c 6964 496e 7075 7429 3a0a  .InvalidInput):.
-00008670: 2020 2020 2020 2020 2020 2020 6365 7263              cerc
-00008680: 6973 2e6c 6962 3274 6f33 5f70 6172 7365  is.lib2to3_parse
-00008690: 2822 696e 7661 6c69 6420 7379 6e74 6178  ("invalid syntax
-000086a0: 2229 0a0a 2020 2020 2020 2020 7374 7261  ")..        stra
-000086b0: 6464 6c69 6e67 203d 2022 7820 2b20 7922  ddling = "x + y"
-000086c0: 0a20 2020 2020 2020 2063 6572 6369 732e  .        cercis.
-000086d0: 6c69 6232 746f 335f 7061 7273 6528 7374  lib2to3_parse(st
-000086e0: 7261 6464 6c69 6e67 290a 2020 2020 2020  raddling).      
-000086f0: 2020 6365 7263 6973 2e6c 6962 3274 6f33    cercis.lib2to3
-00008700: 5f70 6172 7365 2873 7472 6164 646c 696e  _parse(straddlin
-00008710: 672c 207b 5461 7267 6574 5665 7273 696f  g, {TargetVersio
-00008720: 6e2e 5059 3336 7d29 0a0a 2020 2020 2020  n.PY36})..      
-00008730: 2020 7079 325f 6f6e 6c79 203d 2022 7072    py2_only = "pr
-00008740: 696e 7420 7822 0a20 2020 2020 2020 2077  int x".        w
-00008750: 6974 6820 7365 6c66 2e61 7373 6572 7452  ith self.assertR
-00008760: 6169 7365 7328 6365 7263 6973 2e49 6e76  aises(cercis.Inv
-00008770: 616c 6964 496e 7075 7429 3a0a 2020 2020  alidInput):.    
-00008780: 2020 2020 2020 2020 6365 7263 6973 2e6c          cercis.l
-00008790: 6962 3274 6f33 5f70 6172 7365 2870 7932  ib2to3_parse(py2
-000087a0: 5f6f 6e6c 792c 207b 5461 7267 6574 5665  _only, {TargetVe
-000087b0: 7273 696f 6e2e 5059 3336 7d29 0a0a 2020  rsion.PY36})..  
-000087c0: 2020 2020 2020 7079 335f 6f6e 6c79 203d        py3_only =
-000087d0: 2022 6578 6563 2878 2c20 656e 643d 7929   "exec(x, end=y)
-000087e0: 220a 2020 2020 2020 2020 6365 7263 6973  ".        cercis
-000087f0: 2e6c 6962 3274 6f33 5f70 6172 7365 2870  .lib2to3_parse(p
-00008800: 7933 5f6f 6e6c 7929 0a20 2020 2020 2020  y3_only).       
-00008810: 2063 6572 6369 732e 6c69 6232 746f 335f   cercis.lib2to3_
-00008820: 7061 7273 6528 7079 335f 6f6e 6c79 2c20  parse(py3_only, 
-00008830: 7b54 6172 6765 7456 6572 7369 6f6e 2e50  {TargetVersion.P
-00008840: 5933 367d 290a 0a20 2020 2064 6566 2074  Y36})..    def t
-00008850: 6573 745f 6765 745f 6665 6174 7572 6573  est_get_features
-00008860: 5f75 7365 645f 6465 636f 7261 746f 7228  _used_decorator(
-00008870: 7365 6c66 2920 2d3e 204e 6f6e 653a 0a20  self) -> None:. 
-00008880: 2020 2020 2020 2023 2054 6573 7420 7468         # Test th
-00008890: 6520 6665 6174 7572 6520 6465 7465 6374  e feature detect
-000088a0: 696f 6e20 6f66 206e 6577 2064 6563 6f72  ion of new decor
-000088b0: 6174 6f72 2073 796e 7461 780a 2020 2020  ator syntax.    
-000088c0: 2020 2020 2320 7369 6e63 6520 7468 6973      # since this
-000088d0: 206d 616b 6573 2073 6f6d 6520 7465 7374   makes some test
-000088e0: 2063 6173 6573 206f 6620 7465 7374 5f67   cases of test_g
-000088f0: 6574 5f66 6561 7475 7265 735f 7573 6564  et_features_used
-00008900: 2829 0a20 2020 2020 2020 2023 2066 6169  ().        # fai
-00008910: 6c73 2069 6620 6974 2066 6169 6c73 2c20  ls if it fails, 
-00008920: 7468 6973 2069 7320 7465 7374 6564 2066  this is tested f
-00008930: 6972 7374 2073 6f20 7468 6174 2061 2075  irst so that a u
-00008940: 7365 6675 6c20 6361 7365 0a20 2020 2020  seful case.     
-00008950: 2020 2023 2069 7320 6964 656e 7469 6669     # is identifi
-00008960: 6564 0a20 2020 2020 2020 2073 696d 706c  ed.        simpl
-00008970: 6573 2c20 7265 6c61 7865 6420 3d20 7265  es, relaxed = re
-00008980: 6164 5f64 6174 6128 226d 6973 6365 6c6c  ad_data("miscell
-00008990: 616e 656f 7573 222c 2022 6465 636f 7261  aneous", "decora
-000089a0: 746f 7273 2229 0a20 2020 2020 2020 2023  tors").        #
-000089b0: 2073 6b69 7020 6578 706c 616e 6174 696f   skip explanatio
-000089c0: 6e20 636f 6d6d 656e 7473 2061 7420 7468  n comments at th
-000089d0: 6520 746f 7020 6f66 2074 6865 2066 696c  e top of the fil
-000089e0: 650a 2020 2020 2020 2020 666f 7220 7369  e.        for si
-000089f0: 6d70 6c65 5f74 6573 7420 696e 2073 696d  mple_test in sim
-00008a00: 706c 6573 2e73 706c 6974 2822 2323 2229  ples.split("##")
-00008a10: 5b31 3a5d 3a0a 2020 2020 2020 2020 2020  [1:]:.          
-00008a20: 2020 6e6f 6465 203d 2063 6572 6369 732e    node = cercis.
-00008a30: 6c69 6232 746f 335f 7061 7273 6528 7369  lib2to3_parse(si
-00008a40: 6d70 6c65 5f74 6573 7429 0a20 2020 2020  mple_test).     
-00008a50: 2020 2020 2020 2064 6563 6f72 6174 6f72         decorator
-00008a60: 203d 2073 7472 286e 6f64 652e 6368 696c   = str(node.chil
-00008a70: 6472 656e 5b30 5d2e 6368 696c 6472 656e  dren[0].children
-00008a80: 5b30 5d29 2e73 7472 6970 2829 0a20 2020  [0]).strip().   
-00008a90: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00008aa0: 7365 7274 4e6f 7449 6e28 0a20 2020 2020  sertNotIn(.     
-00008ab0: 2020 2020 2020 2020 2020 2046 6561 7475             Featu
-00008ac0: 7265 2e52 454c 4158 4544 5f44 4543 4f52  re.RELAXED_DECOR
-00008ad0: 4154 4f52 532c 0a20 2020 2020 2020 2020  ATORS,.         
-00008ae0: 2020 2020 2020 2063 6572 6369 732e 6765         cercis.ge
-00008af0: 745f 6665 6174 7572 6573 5f75 7365 6428  t_features_used(
-00008b00: 6e6f 6465 292c 0a20 2020 2020 2020 2020  node),.         
-00008b10: 2020 2020 2020 206d 7367 3d28 0a20 2020         msg=(.   
-00008b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008b30: 2066 2264 6563 6f72 6174 6f72 2027 7b64   f"decorator '{d
-00008b40: 6563 6f72 6174 6f72 7d27 2066 6f6c 6c6f  ecorator}' follo
-00008b50: 7773 2070 7974 686f 6e3c 3d33 2e38 2073  ws python<=3.8 s
-00008b60: 796e 7461 7822 0a20 2020 2020 2020 2020  yntax".         
-00008b70: 2020 2020 2020 2020 2020 2022 6275 7420             "but 
-00008b80: 6973 2064 6574 6563 7465 6420 6173 2033  is detected as 3
-00008b90: 2e39 2b22 0a20 2020 2020 2020 2020 2020  .9+".           
-00008ba0: 2020 2020 2020 2020 2023 2066 2254 6865           # f"The
-00008bb0: 2066 756c 6c20 6e6f 6465 2069 735c 6e7b   full node is\n{
-00008bc0: 6e6f 6465 2172 7d22 0a20 2020 2020 2020  node!r}".       
-00008bd0: 2020 2020 2020 2020 2029 2c0a 2020 2020           ),.    
-00008be0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00008bf0: 2020 2320 736b 6970 2074 6865 2027 2320    # skip the '# 
-00008c00: 6f75 7470 7574 2720 636f 6d6d 656e 7420  output' comment 
-00008c10: 6174 2074 6865 2074 6f70 206f 6620 7468  at the top of th
-00008c20: 6520 6f75 7470 7574 2070 6172 740a 2020  e output part.  
-00008c30: 2020 2020 2020 666f 7220 7265 6c61 7865        for relaxe
-00008c40: 645f 7465 7374 2069 6e20 7265 6c61 7865  d_test in relaxe
-00008c50: 642e 7370 6c69 7428 2223 2322 295b 313a  d.split("##")[1:
-00008c60: 5d3a 0a20 2020 2020 2020 2020 2020 206e  ]:.            n
-00008c70: 6f64 6520 3d20 6365 7263 6973 2e6c 6962  ode = cercis.lib
-00008c80: 3274 6f33 5f70 6172 7365 2872 656c 6178  2to3_parse(relax
-00008c90: 6564 5f74 6573 7429 0a20 2020 2020 2020  ed_test).       
-00008ca0: 2020 2020 2064 6563 6f72 6174 6f72 203d       decorator =
-00008cb0: 2073 7472 286e 6f64 652e 6368 696c 6472   str(node.childr
-00008cc0: 656e 5b30 5d2e 6368 696c 6472 656e 5b30  en[0].children[0
-00008cd0: 5d29 2e73 7472 6970 2829 0a20 2020 2020  ]).strip().     
-00008ce0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00008cf0: 7274 496e 280a 2020 2020 2020 2020 2020  rtIn(.          
-00008d00: 2020 2020 2020 4665 6174 7572 652e 5245        Feature.RE
-00008d10: 4c41 5845 445f 4445 434f 5241 544f 5253  LAXED_DECORATORS
-00008d20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00008d30: 2020 6365 7263 6973 2e67 6574 5f66 6561    cercis.get_fea
-00008d40: 7475 7265 735f 7573 6564 286e 6f64 6529  tures_used(node)
-00008d50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00008d60: 2020 6d73 673d 280a 2020 2020 2020 2020    msg=(.        
-00008d70: 2020 2020 2020 2020 2020 2020 6622 6465              f"de
-00008d80: 636f 7261 746f 7220 277b 6465 636f 7261  corator '{decora
-00008d90: 746f 727d 2720 7573 6573 2070 7974 686f  tor}' uses pytho
-00008da0: 6e33 2e39 2b20 7379 6e74 6178 220a 2020  n3.9+ syntax".  
-00008db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008dc0: 2020 2262 7574 2069 7320 6465 7465 6374    "but is detect
-00008dd0: 6564 2061 7320 7079 7468 6f6e 3c3d 332e  ed as python<=3.
-00008de0: 3822 0a20 2020 2020 2020 2020 2020 2020  8".             
-00008df0: 2020 2020 2020 2023 2066 2254 6865 2066         # f"The f
-00008e00: 756c 6c20 6e6f 6465 2069 735c 6e7b 6e6f  ull node is\n{no
-00008e10: 6465 2172 7d22 0a20 2020 2020 2020 2020  de!r}".         
-00008e20: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-00008e30: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-00008e40: 2074 6573 745f 6765 745f 6665 6174 7572   test_get_featur
-00008e50: 6573 5f75 7365 6428 7365 6c66 2920 2d3e  es_used(self) ->
-00008e60: 204e 6f6e 653a 0a20 2020 2020 2020 206e   None:.        n
-00008e70: 6f64 6520 3d20 6365 7263 6973 2e6c 6962  ode = cercis.lib
-00008e80: 3274 6f33 5f70 6172 7365 2822 6465 6620  2to3_parse("def 
-00008e90: 6628 2a2c 2061 7267 293a 202e 2e2e 5c6e  f(*, arg): ...\n
-00008ea0: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
-00008eb0: 6173 7365 7274 4571 7561 6c28 6365 7263  assertEqual(cerc
-00008ec0: 6973 2e67 6574 5f66 6561 7475 7265 735f  is.get_features_
-00008ed0: 7573 6564 286e 6f64 6529 2c20 7365 7428  used(node), set(
-00008ee0: 2929 0a20 2020 2020 2020 206e 6f64 6520  )).        node 
-00008ef0: 3d20 6365 7263 6973 2e6c 6962 3274 6f33  = cercis.lib2to3
-00008f00: 5f70 6172 7365 2822 6465 6620 6628 2a2c  _parse("def f(*,
-00008f10: 2061 7267 2c29 3a20 2e2e 2e5c 6e22 290a   arg,): ...\n").
-00008f20: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00008f30: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-00008f40: 2020 2020 2020 6365 7263 6973 2e67 6574        cercis.get
-00008f50: 5f66 6561 7475 7265 735f 7573 6564 286e  _features_used(n
-00008f60: 6f64 6529 2c20 7b46 6561 7475 7265 2e54  ode), {Feature.T
-00008f70: 5241 494c 494e 475f 434f 4d4d 415f 494e  RAILING_COMMA_IN
-00008f80: 5f44 4546 7d0a 2020 2020 2020 2020 290a  _DEF}.        ).
-00008f90: 2020 2020 2020 2020 6e6f 6465 203d 2063          node = c
-00008fa0: 6572 6369 732e 6c69 6232 746f 335f 7061  ercis.lib2to3_pa
-00008fb0: 7273 6528 2266 282a 6172 672c 295c 6e22  rse("f(*arg,)\n"
-00008fc0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00008fd0: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-00008fe0: 2020 2020 2020 2020 6365 7263 6973 2e67          cercis.g
-00008ff0: 6574 5f66 6561 7475 7265 735f 7573 6564  et_features_used
-00009000: 286e 6f64 6529 2c20 7b46 6561 7475 7265  (node), {Feature
-00009010: 2e54 5241 494c 494e 475f 434f 4d4d 415f  .TRAILING_COMMA_
-00009020: 494e 5f43 414c 4c7d 0a20 2020 2020 2020  IN_CALL}.       
-00009030: 2029 0a20 2020 2020 2020 206e 6f64 6520   ).        node 
-00009040: 3d20 6365 7263 6973 2e6c 6962 3274 6f33  = cercis.lib2to3
-00009050: 5f70 6172 7365 2822 6465 6620 6628 2a2c  _parse("def f(*,
-00009060: 2061 7267 293a 2066 2773 7472 696e 6727   arg): f'string'
-00009070: 5c6e 2229 0a20 2020 2020 2020 2073 656c  \n").        sel
-00009080: 662e 6173 7365 7274 4571 7561 6c28 6365  f.assertEqual(ce
-00009090: 7263 6973 2e67 6574 5f66 6561 7475 7265  rcis.get_feature
-000090a0: 735f 7573 6564 286e 6f64 6529 2c20 7b46  s_used(node), {F
-000090b0: 6561 7475 7265 2e46 5f53 5452 494e 4753  eature.F_STRINGS
-000090c0: 7d29 0a20 2020 2020 2020 206e 6f64 6520  }).        node 
-000090d0: 3d20 6365 7263 6973 2e6c 6962 3274 6f33  = cercis.lib2to3
-000090e0: 5f70 6172 7365 2822 3132 335f 3435 365c  _parse("123_456\
-000090f0: 6e22 290a 2020 2020 2020 2020 7365 6c66  n").        self
-00009100: 2e61 7373 6572 7445 7175 616c 2863 6572  .assertEqual(cer
-00009110: 6369 732e 6765 745f 6665 6174 7572 6573  cis.get_features
-00009120: 5f75 7365 6428 6e6f 6465 292c 207b 4665  _used(node), {Fe
-00009130: 6174 7572 652e 4e55 4d45 5249 435f 554e  ature.NUMERIC_UN
-00009140: 4445 5253 434f 5245 537d 290a 2020 2020  DERSCORES}).    
-00009150: 2020 2020 6e6f 6465 203d 2063 6572 6369      node = cerci
-00009160: 732e 6c69 6232 746f 335f 7061 7273 6528  s.lib2to3_parse(
-00009170: 2231 3233 3435 365c 6e22 290a 2020 2020  "123456\n").    
-00009180: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00009190: 7175 616c 2863 6572 6369 732e 6765 745f  qual(cercis.get_
-000091a0: 6665 6174 7572 6573 5f75 7365 6428 6e6f  features_used(no
-000091b0: 6465 292c 2073 6574 2829 290a 2020 2020  de), set()).    
-000091c0: 2020 2020 736f 7572 6365 2c20 6578 7065      source, expe
-000091d0: 6374 6564 203d 2072 6561 645f 6461 7461  cted = read_data
-000091e0: 2822 7369 6d70 6c65 5f63 6173 6573 222c  ("simple_cases",
-000091f0: 2022 6675 6e63 7469 6f6e 2229 0a20 2020   "function").   
-00009200: 2020 2020 206e 6f64 6520 3d20 6365 7263       node = cerc
-00009210: 6973 2e6c 6962 3274 6f33 5f70 6172 7365  is.lib2to3_parse
-00009220: 2873 6f75 7263 6529 0a20 2020 2020 2020  (source).       
-00009230: 2065 7870 6563 7465 645f 6665 6174 7572   expected_featur
-00009240: 6573 203d 207b 0a20 2020 2020 2020 2020  es = {.         
-00009250: 2020 2046 6561 7475 7265 2e54 5241 494c     Feature.TRAIL
-00009260: 494e 475f 434f 4d4d 415f 494e 5f43 414c  ING_COMMA_IN_CAL
-00009270: 4c2c 0a20 2020 2020 2020 2020 2020 2046  L,.            F
-00009280: 6561 7475 7265 2e54 5241 494c 494e 475f  eature.TRAILING_
-00009290: 434f 4d4d 415f 494e 5f44 4546 2c0a 2020  COMMA_IN_DEF,.  
-000092a0: 2020 2020 2020 2020 2020 4665 6174 7572            Featur
-000092b0: 652e 465f 5354 5249 4e47 532c 0a20 2020  e.F_STRINGS,.   
-000092c0: 2020 2020 207d 0a20 2020 2020 2020 2073       }.        s
-000092d0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-000092e0: 6365 7263 6973 2e67 6574 5f66 6561 7475  cercis.get_featu
-000092f0: 7265 735f 7573 6564 286e 6f64 6529 2c20  res_used(node), 
-00009300: 6578 7065 6374 6564 5f66 6561 7475 7265  expected_feature
-00009310: 7329 0a20 2020 2020 2020 206e 6f64 6520  s).        node 
-00009320: 3d20 6365 7263 6973 2e6c 6962 3274 6f33  = cercis.lib2to3
-00009330: 5f70 6172 7365 2865 7870 6563 7465 6429  _parse(expected)
-00009340: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00009350: 7365 7274 4571 7561 6c28 6365 7263 6973  sertEqual(cercis
-00009360: 2e67 6574 5f66 6561 7475 7265 735f 7573  .get_features_us
-00009370: 6564 286e 6f64 6529 2c20 6578 7065 6374  ed(node), expect
-00009380: 6564 5f66 6561 7475 7265 7329 0a20 2020  ed_features).   
-00009390: 2020 2020 2073 6f75 7263 652c 2065 7870       source, exp
-000093a0: 6563 7465 6420 3d20 7265 6164 5f64 6174  ected = read_dat
-000093b0: 6128 2273 696d 706c 655f 6361 7365 7322  a("simple_cases"
-000093c0: 2c20 2265 7870 7265 7373 696f 6e22 290a  , "expression").
-000093d0: 2020 2020 2020 2020 6e6f 6465 203d 2063          node = c
-000093e0: 6572 6369 732e 6c69 6232 746f 335f 7061  ercis.lib2to3_pa
-000093f0: 7273 6528 736f 7572 6365 290a 2020 2020  rse(source).    
-00009400: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00009410: 7175 616c 2863 6572 6369 732e 6765 745f  qual(cercis.get_
-00009420: 6665 6174 7572 6573 5f75 7365 6428 6e6f  features_used(no
-00009430: 6465 292c 2073 6574 2829 290a 2020 2020  de), set()).    
-00009440: 2020 2020 6e6f 6465 203d 2063 6572 6369      node = cerci
-00009450: 732e 6c69 6232 746f 335f 7061 7273 6528  s.lib2to3_parse(
-00009460: 6578 7065 6374 6564 290a 2020 2020 2020  expected).      
-00009470: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00009480: 616c 2863 6572 6369 732e 6765 745f 6665  al(cercis.get_fe
-00009490: 6174 7572 6573 5f75 7365 6428 6e6f 6465  atures_used(node
-000094a0: 292c 2073 6574 2829 290a 2020 2020 2020  ), set()).      
-000094b0: 2020 6e6f 6465 203d 2063 6572 6369 732e    node = cercis.
-000094c0: 6c69 6232 746f 335f 7061 7273 6528 226c  lib2to3_parse("l
-000094d0: 616d 6264 6120 612c 202f 2c20 623a 202e  ambda a, /, b: .
-000094e0: 2e2e 2229 0a20 2020 2020 2020 2073 656c  ..").        sel
-000094f0: 662e 6173 7365 7274 4571 7561 6c28 6365  f.assertEqual(ce
-00009500: 7263 6973 2e67 6574 5f66 6561 7475 7265  rcis.get_feature
-00009510: 735f 7573 6564 286e 6f64 6529 2c20 7b46  s_used(node), {F
-00009520: 6561 7475 7265 2e50 4f53 5f4f 4e4c 595f  eature.POS_ONLY_
-00009530: 4152 4755 4d45 4e54 537d 290a 2020 2020  ARGUMENTS}).    
-00009540: 2020 2020 6e6f 6465 203d 2063 6572 6369      node = cerci
-00009550: 732e 6c69 6232 746f 335f 7061 7273 6528  s.lib2to3_parse(
-00009560: 2264 6566 2066 6e28 612c 202f 2c20 6229  "def fn(a, /, b)
-00009570: 3a20 2e2e 2e22 290a 2020 2020 2020 2020  : ...").        
-00009580: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00009590: 2863 6572 6369 732e 6765 745f 6665 6174  (cercis.get_feat
-000095a0: 7572 6573 5f75 7365 6428 6e6f 6465 292c  ures_used(node),
-000095b0: 207b 4665 6174 7572 652e 504f 535f 4f4e   {Feature.POS_ON
-000095c0: 4c59 5f41 5247 554d 454e 5453 7d29 0a20  LY_ARGUMENTS}). 
-000095d0: 2020 2020 2020 206e 6f64 6520 3d20 6365         node = ce
-000095e0: 7263 6973 2e6c 6962 3274 6f33 5f70 6172  rcis.lib2to3_par
-000095f0: 7365 2822 6465 6620 666e 2829 3a20 7969  se("def fn(): yi
-00009600: 656c 6420 612c 2062 2229 0a20 2020 2020  eld a, b").     
-00009610: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00009620: 7561 6c28 6365 7263 6973 2e67 6574 5f66  ual(cercis.get_f
-00009630: 6561 7475 7265 735f 7573 6564 286e 6f64  eatures_used(nod
-00009640: 6529 2c20 7365 7428 2929 0a20 2020 2020  e), set()).     
-00009650: 2020 206e 6f64 6520 3d20 6365 7263 6973     node = cercis
-00009660: 2e6c 6962 3274 6f33 5f70 6172 7365 2822  .lib2to3_parse("
-00009670: 6465 6620 666e 2829 3a20 7265 7475 726e  def fn(): return
-00009680: 2061 2c20 6222 290a 2020 2020 2020 2020   a, b").        
-00009690: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-000096a0: 2863 6572 6369 732e 6765 745f 6665 6174  (cercis.get_feat
-000096b0: 7572 6573 5f75 7365 6428 6e6f 6465 292c  ures_used(node),
-000096c0: 2073 6574 2829 290a 2020 2020 2020 2020   set()).        
-000096d0: 6e6f 6465 203d 2063 6572 6369 732e 6c69  node = cercis.li
-000096e0: 6232 746f 335f 7061 7273 6528 2264 6566  b2to3_parse("def
-000096f0: 2066 6e28 293a 2079 6965 6c64 202a 622c   fn(): yield *b,
-00009700: 2063 2229 0a20 2020 2020 2020 2073 656c   c").        sel
-00009710: 662e 6173 7365 7274 4571 7561 6c28 6365  f.assertEqual(ce
-00009720: 7263 6973 2e67 6574 5f66 6561 7475 7265  rcis.get_feature
-00009730: 735f 7573 6564 286e 6f64 6529 2c20 7b46  s_used(node), {F
-00009740: 6561 7475 7265 2e55 4e50 4143 4b49 4e47  eature.UNPACKING
-00009750: 5f4f 4e5f 464c 4f57 7d29 0a20 2020 2020  _ON_FLOW}).     
-00009760: 2020 206e 6f64 6520 3d20 6365 7263 6973     node = cercis
-00009770: 2e6c 6962 3274 6f33 5f70 6172 7365 2822  .lib2to3_parse("
-00009780: 6465 6620 666e 2829 3a20 7265 7475 726e  def fn(): return
-00009790: 2061 2c20 2a62 2c20 6322 290a 2020 2020   a, *b, c").    
-000097a0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-000097b0: 7175 616c 2863 6572 6369 732e 6765 745f  qual(cercis.get_
-000097c0: 6665 6174 7572 6573 5f75 7365 6428 6e6f  features_used(no
-000097d0: 6465 292c 207b 4665 6174 7572 652e 554e  de), {Feature.UN
-000097e0: 5041 434b 494e 475f 4f4e 5f46 4c4f 577d  PACKING_ON_FLOW}
-000097f0: 290a 2020 2020 2020 2020 6e6f 6465 203d  ).        node =
-00009800: 2063 6572 6369 732e 6c69 6232 746f 335f   cercis.lib2to3_
-00009810: 7061 7273 6528 2278 203d 2061 2c20 2a62  parse("x = a, *b
-00009820: 2c20 6322 290a 2020 2020 2020 2020 7365  , c").        se
-00009830: 6c66 2e61 7373 6572 7445 7175 616c 2863  lf.assertEqual(c
-00009840: 6572 6369 732e 6765 745f 6665 6174 7572  ercis.get_featur
-00009850: 6573 5f75 7365 6428 6e6f 6465 292c 2073  es_used(node), s
-00009860: 6574 2829 290a 2020 2020 2020 2020 6e6f  et()).        no
-00009870: 6465 203d 2063 6572 6369 732e 6c69 6232  de = cercis.lib2
-00009880: 746f 335f 7061 7273 6528 2278 3a20 416e  to3_parse("x: An
-00009890: 7920 3d20 7265 6775 6c61 7222 290a 2020  y = regular").  
-000098a0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-000098b0: 7445 7175 616c 2863 6572 6369 732e 6765  tEqual(cercis.ge
-000098c0: 745f 6665 6174 7572 6573 5f75 7365 6428  t_features_used(
-000098d0: 6e6f 6465 292c 2073 6574 2829 290a 2020  node), set()).  
-000098e0: 2020 2020 2020 6e6f 6465 203d 2063 6572        node = cer
-000098f0: 6369 732e 6c69 6232 746f 335f 7061 7273  cis.lib2to3_pars
-00009900: 6528 2278 3a20 416e 7920 3d20 2872 6567  e("x: Any = (reg
-00009910: 756c 6172 2c20 7265 6775 6c61 7229 2229  ular, regular)")
-00009920: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00009930: 7365 7274 4571 7561 6c28 6365 7263 6973  sertEqual(cercis
-00009940: 2e67 6574 5f66 6561 7475 7265 735f 7573  .get_features_us
-00009950: 6564 286e 6f64 6529 2c20 7365 7428 2929  ed(node), set())
-00009960: 0a20 2020 2020 2020 206e 6f64 6520 3d20  .        node = 
-00009970: 6365 7263 6973 2e6c 6962 3274 6f33 5f70  cercis.lib2to3_p
-00009980: 6172 7365 2822 783a 2041 6e79 203d 2043  arse("x: Any = C
-00009990: 6f6d 706c 6578 2854 7970 6528 3129 295b  omplex(Type(1))[
-000099a0: 736f 6d65 7468 696e 675d 2229 0a20 2020  something]").   
-000099b0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-000099c0: 4571 7561 6c28 6365 7263 6973 2e67 6574  Equal(cercis.get
-000099d0: 5f66 6561 7475 7265 735f 7573 6564 286e  _features_used(n
-000099e0: 6f64 6529 2c20 7365 7428 2929 0a20 2020  ode), set()).   
-000099f0: 2020 2020 206e 6f64 6520 3d20 6365 7263       node = cerc
-00009a00: 6973 2e6c 6962 3274 6f33 5f70 6172 7365  is.lib2to3_parse
-00009a10: 2822 783a 2054 7570 6c65 5b69 6e74 2c20  ("x: Tuple[int, 
-00009a20: 2e2e 2e5d 203d 2061 2c20 622c 2063 2229  ...] = a, b, c")
-00009a30: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-00009a40: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-00009a50: 2020 2020 2020 2063 6572 6369 732e 6765         cercis.ge
-00009a60: 745f 6665 6174 7572 6573 5f75 7365 6428  t_features_used(
-00009a70: 6e6f 6465 292c 207b 4665 6174 7572 652e  node), {Feature.
-00009a80: 414e 4e5f 4153 5349 474e 5f45 5854 454e  ANN_ASSIGN_EXTEN
-00009a90: 4445 445f 5248 537d 0a20 2020 2020 2020  DED_RHS}.       
-00009aa0: 2029 0a20 2020 2020 2020 206e 6f64 6520   ).        node 
-00009ab0: 3d20 6365 7263 6973 2e6c 6962 3274 6f33  = cercis.lib2to3
-00009ac0: 5f70 6172 7365 2822 7472 793a 2070 6173  _parse("try: pas
-00009ad0: 735c 6e65 7863 6570 7420 536f 6d65 7468  s\nexcept Someth
-00009ae0: 696e 673a 2070 6173 7322 290a 2020 2020  ing: pass").    
-00009af0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00009b00: 7175 616c 2863 6572 6369 732e 6765 745f  qual(cercis.get_
-00009b10: 6665 6174 7572 6573 5f75 7365 6428 6e6f  features_used(no
-00009b20: 6465 292c 2073 6574 2829 290a 2020 2020  de), set()).    
-00009b30: 2020 2020 6e6f 6465 203d 2063 6572 6369      node = cerci
-00009b40: 732e 6c69 6232 746f 335f 7061 7273 6528  s.lib2to3_parse(
-00009b50: 2274 7279 3a20 7061 7373 5c6e 6578 6365  "try: pass\nexce
-00009b60: 7074 2028 2a53 6f6d 6574 6869 6e67 2c29  pt (*Something,)
-00009b70: 3a20 7061 7373 2229 0a20 2020 2020 2020  : pass").       
-00009b80: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00009b90: 6c28 6365 7263 6973 2e67 6574 5f66 6561  l(cercis.get_fea
-00009ba0: 7475 7265 735f 7573 6564 286e 6f64 6529  tures_used(node)
-00009bb0: 2c20 7365 7428 2929 0a20 2020 2020 2020  , set()).       
-00009bc0: 206e 6f64 6520 3d20 6365 7263 6973 2e6c   node = cercis.l
-00009bd0: 6962 3274 6f33 5f70 6172 7365 2822 7472  ib2to3_parse("tr
-00009be0: 793a 2070 6173 735c 6e65 7863 6570 7420  y: pass\nexcept 
-00009bf0: 2a47 726f 7570 3a20 7061 7373 2229 0a20  *Group: pass"). 
-00009c00: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00009c10: 7274 4571 7561 6c28 6365 7263 6973 2e67  rtEqual(cercis.g
-00009c20: 6574 5f66 6561 7475 7265 735f 7573 6564  et_features_used
-00009c30: 286e 6f64 6529 2c20 7b46 6561 7475 7265  (node), {Feature
-00009c40: 2e45 5843 4550 545f 5354 4152 7d29 0a20  .EXCEPT_STAR}). 
-00009c50: 2020 2020 2020 206e 6f64 6520 3d20 6365         node = ce
-00009c60: 7263 6973 2e6c 6962 3274 6f33 5f70 6172  rcis.lib2to3_par
-00009c70: 7365 2822 615b 2a62 5d22 290a 2020 2020  se("a[*b]").    
-00009c80: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00009c90: 7175 616c 2863 6572 6369 732e 6765 745f  qual(cercis.get_
-00009ca0: 6665 6174 7572 6573 5f75 7365 6428 6e6f  features_used(no
-00009cb0: 6465 292c 207b 4665 6174 7572 652e 5641  de), {Feature.VA
-00009cc0: 5249 4144 4943 5f47 454e 4552 4943 537d  RIADIC_GENERICS}
-00009cd0: 290a 2020 2020 2020 2020 6e6f 6465 203d  ).        node =
-00009ce0: 2063 6572 6369 732e 6c69 6232 746f 335f   cercis.lib2to3_
-00009cf0: 7061 7273 6528 2261 5b78 2c20 2a79 2829  parse("a[x, *y()
-00009d00: 2c20 7a5d 203d 2074 2229 0a20 2020 2020  , z] = t").     
-00009d10: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
-00009d20: 7561 6c28 6365 7263 6973 2e67 6574 5f66  ual(cercis.get_f
-00009d30: 6561 7475 7265 735f 7573 6564 286e 6f64  eatures_used(nod
-00009d40: 6529 2c20 7b46 6561 7475 7265 2e56 4152  e), {Feature.VAR
-00009d50: 4941 4449 435f 4745 4e45 5249 4353 7d29  IADIC_GENERICS})
-00009d60: 0a20 2020 2020 2020 206e 6f64 6520 3d20  .        node = 
-00009d70: 6365 7263 6973 2e6c 6962 3274 6f33 5f70  cercis.lib2to3_p
-00009d80: 6172 7365 2822 6465 6620 666e 282a 6172  arse("def fn(*ar
-00009d90: 6773 3a20 2a54 293a 2070 6173 7322 290a  gs: *T): pass").
-00009da0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00009db0: 6572 7445 7175 616c 2863 6572 6369 732e  ertEqual(cercis.
-00009dc0: 6765 745f 6665 6174 7572 6573 5f75 7365  get_features_use
-00009dd0: 6428 6e6f 6465 292c 207b 4665 6174 7572  d(node), {Featur
-00009de0: 652e 5641 5249 4144 4943 5f47 454e 4552  e.VARIADIC_GENER
-00009df0: 4943 537d 290a 0a20 2020 2064 6566 2074  ICS})..    def t
-00009e00: 6573 745f 6765 745f 6665 6174 7572 6573  est_get_features
-00009e10: 5f75 7365 645f 666f 725f 6675 7475 7265  _used_for_future
-00009e20: 5f66 6c61 6773 2873 656c 6629 202d 3e20  _flags(self) -> 
-00009e30: 4e6f 6e65 3a0a 2020 2020 2020 2020 666f  None:.        fo
-00009e40: 7220 7372 632c 2066 6561 7475 7265 7320  r src, features 
-00009e50: 696e 205b 0a20 2020 2020 2020 2020 2020  in [.           
-00009e60: 2028 2266 726f 6d20 5f5f 6675 7475 7265   ("from __future
-00009e70: 5f5f 2069 6d70 6f72 7420 616e 6e6f 7461  __ import annota
-00009e80: 7469 6f6e 7322 2c20 7b46 6561 7475 7265  tions", {Feature
-00009e90: 2e46 5554 5552 455f 414e 4e4f 5441 5449  .FUTURE_ANNOTATI
-00009ea0: 4f4e 537d 292c 0a20 2020 2020 2020 2020  ONS}),.         
-00009eb0: 2020 2028 0a20 2020 2020 2020 2020 2020     (.           
-00009ec0: 2020 2020 2022 6672 6f6d 205f 5f66 7574       "from __fut
-00009ed0: 7572 655f 5f20 696d 706f 7274 2028 6f74  ure__ import (ot
-00009ee0: 6865 722c 2061 6e6e 6f74 6174 696f 6e73  her, annotations
-00009ef0: 2922 2c0a 2020 2020 2020 2020 2020 2020  )",.            
-00009f00: 2020 2020 7b46 6561 7475 7265 2e46 5554      {Feature.FUT
-00009f10: 5552 455f 414e 4e4f 5441 5449 4f4e 537d  URE_ANNOTATIONS}
-00009f20: 2c0a 2020 2020 2020 2020 2020 2020 292c  ,.            ),
-00009f30: 0a20 2020 2020 2020 2020 2020 2028 2261  .            ("a
-00009f40: 203d 2031 202b 2032 5c6e 6672 6f6d 2073   = 1 + 2\nfrom s
-00009f50: 6f6d 6574 6869 6e67 2069 6d70 6f72 7420  omething import 
-00009f60: 616e 6e6f 7461 7469 6f6e 7322 2c20 7365  annotations", se
-00009f70: 7428 2929 2c0a 2020 2020 2020 2020 2020  t()),.          
-00009f80: 2020 2822 6672 6f6d 205f 5f66 7574 7572    ("from __futur
-00009f90: 655f 5f20 696d 706f 7274 2078 2c20 7922  e__ import x, y"
-00009fa0: 2c20 7365 7428 2929 2c0a 2020 2020 2020  , set()),.      
-00009fb0: 2020 5d3a 0a20 2020 2020 2020 2020 2020    ]:.           
-00009fc0: 2077 6974 6820 7365 6c66 2e73 7562 5465   with self.subTe
-00009fd0: 7374 2873 7263 3d73 7263 2c20 6665 6174  st(src=src, feat
-00009fe0: 7572 6573 3d66 6561 7475 7265 7329 3a0a  ures=features):.
-00009ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a000: 6e6f 6465 203d 2063 6572 6369 732e 6c69  node = cercis.li
-0000a010: 6232 746f 335f 7061 7273 6528 7372 6329  b2to3_parse(src)
-0000a020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a030: 2066 7574 7572 655f 696d 706f 7274 7320   future_imports 
-0000a040: 3d20 6365 7263 6973 2e67 6574 5f66 7574  = cercis.get_fut
-0000a050: 7572 655f 696d 706f 7274 7328 6e6f 6465  ure_imports(node
-0000a060: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0000a070: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-0000a080: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
-0000a090: 2020 2020 2020 2020 6365 7263 6973 2e67          cercis.g
-0000a0a0: 6574 5f66 6561 7475 7265 735f 7573 6564  et_features_used
-0000a0b0: 286e 6f64 652c 2066 7574 7572 655f 696d  (node, future_im
-0000a0c0: 706f 7274 733d 6675 7475 7265 5f69 6d70  ports=future_imp
-0000a0d0: 6f72 7473 292c 0a20 2020 2020 2020 2020  orts),.         
-0000a0e0: 2020 2020 2020 2020 2020 2066 6561 7475             featu
-0000a0f0: 7265 732c 0a20 2020 2020 2020 2020 2020  res,.           
-0000a100: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-0000a110: 7465 7374 5f67 6574 5f66 7574 7572 655f  test_get_future_
-0000a120: 696d 706f 7274 7328 7365 6c66 2920 2d3e  imports(self) ->
-0000a130: 204e 6f6e 653a 0a20 2020 2020 2020 206e   None:.        n
-0000a140: 6f64 6520 3d20 6365 7263 6973 2e6c 6962  ode = cercis.lib
-0000a150: 3274 6f33 5f70 6172 7365 2822 5c6e 2229  2to3_parse("\n")
-0000a160: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-0000a170: 7365 7274 4571 7561 6c28 7365 7428 292c  sertEqual(set(),
-0000a180: 2063 6572 6369 732e 6765 745f 6675 7475   cercis.get_futu
-0000a190: 7265 5f69 6d70 6f72 7473 286e 6f64 6529  re_imports(node)
-0000a1a0: 290a 2020 2020 2020 2020 6e6f 6465 203d  ).        node =
-0000a1b0: 2063 6572 6369 732e 6c69 6232 746f 335f   cercis.lib2to3_
-0000a1c0: 7061 7273 6528 2266 726f 6d20 5f5f 6675  parse("from __fu
-0000a1d0: 7475 7265 5f5f 2069 6d70 6f72 7420 6365  ture__ import ce
-0000a1e0: 7263 6973 5c6e 2229 0a20 2020 2020 2020  rcis\n").       
-0000a1f0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-0000a200: 6c28 7b22 6365 7263 6973 227d 2c20 6365  l({"cercis"}, ce
-0000a210: 7263 6973 2e67 6574 5f66 7574 7572 655f  rcis.get_future_
-0000a220: 696d 706f 7274 7328 6e6f 6465 2929 0a20  imports(node)). 
-0000a230: 2020 2020 2020 206e 6f64 6520 3d20 6365         node = ce
-0000a240: 7263 6973 2e6c 6962 3274 6f33 5f70 6172  rcis.lib2to3_par
-0000a250: 7365 2822 6672 6f6d 205f 5f66 7574 7572  se("from __futur
-0000a260: 655f 5f20 696d 706f 7274 206d 756c 7469  e__ import multi
-0000a270: 706c 652c 2069 6d70 6f72 7473 5c6e 2229  ple, imports\n")
-0000a280: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-0000a290: 7365 7274 4571 7561 6c28 7b22 6d75 6c74  sertEqual({"mult
-0000a2a0: 6970 6c65 222c 2022 696d 706f 7274 7322  iple", "imports"
-0000a2b0: 7d2c 2063 6572 6369 732e 6765 745f 6675  }, cercis.get_fu
-0000a2c0: 7475 7265 5f69 6d70 6f72 7473 286e 6f64  ture_imports(nod
-0000a2d0: 6529 290a 2020 2020 2020 2020 6e6f 6465  e)).        node
-0000a2e0: 203d 2063 6572 6369 732e 6c69 6232 746f   = cercis.lib2to
-0000a2f0: 335f 7061 7273 6528 2266 726f 6d20 5f5f  3_parse("from __
-0000a300: 6675 7475 7265 5f5f 2069 6d70 6f72 7420  future__ import 
-0000a310: 2870 6172 656e 7468 6573 697a 6564 2c20  (parenthesized, 
-0000a320: 696d 706f 7274 7329 5c6e 2229 0a20 2020  imports)\n").   
-0000a330: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0000a340: 4571 7561 6c28 7b22 7061 7265 6e74 6865  Equal({"parenthe
-0000a350: 7369 7a65 6422 2c20 2269 6d70 6f72 7473  sized", "imports
-0000a360: 227d 2c20 6365 7263 6973 2e67 6574 5f66  "}, cercis.get_f
-0000a370: 7574 7572 655f 696d 706f 7274 7328 6e6f  uture_imports(no
-0000a380: 6465 2929 0a20 2020 2020 2020 206e 6f64  de)).        nod
-0000a390: 6520 3d20 6365 7263 6973 2e6c 6962 3274  e = cercis.lib2t
-0000a3a0: 6f33 5f70 6172 7365 280a 2020 2020 2020  o3_parse(.      
-0000a3b0: 2020 2020 2020 2266 726f 6d20 5f5f 6675        "from __fu
-0000a3c0: 7475 7265 5f5f 2069 6d70 6f72 7420 6d75  ture__ import mu
-0000a3d0: 6c74 6970 6c65 5c6e 6672 6f6d 205f 5f66  ltiple\nfrom __f
-0000a3e0: 7574 7572 655f 5f20 696d 706f 7274 2069  uture__ import i
-0000a3f0: 6d70 6f72 7473 5c6e 220a 2020 2020 2020  mports\n".      
-0000a400: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-0000a410: 2e61 7373 6572 7445 7175 616c 287b 226d  .assertEqual({"m
-0000a420: 756c 7469 706c 6522 2c20 2269 6d70 6f72  ultiple", "impor
-0000a430: 7473 227d 2c20 6365 7263 6973 2e67 6574  ts"}, cercis.get
-0000a440: 5f66 7574 7572 655f 696d 706f 7274 7328  _future_imports(
-0000a450: 6e6f 6465 2929 0a20 2020 2020 2020 206e  node)).        n
-0000a460: 6f64 6520 3d20 6365 7263 6973 2e6c 6962  ode = cercis.lib
-0000a470: 3274 6f33 5f70 6172 7365 2822 2320 636f  2to3_parse("# co
-0000a480: 6d6d 656e 745c 6e66 726f 6d20 5f5f 6675  mment\nfrom __fu
-0000a490: 7475 7265 5f5f 2069 6d70 6f72 7420 6365  ture__ import ce
-0000a4a0: 7263 6973 5c6e 2229 0a20 2020 2020 2020  rcis\n").       
-0000a4b0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-0000a4c0: 6c28 7b22 6365 7263 6973 227d 2c20 6365  l({"cercis"}, ce
-0000a4d0: 7263 6973 2e67 6574 5f66 7574 7572 655f  rcis.get_future_
-0000a4e0: 696d 706f 7274 7328 6e6f 6465 2929 0a20  imports(node)). 
-0000a4f0: 2020 2020 2020 206e 6f64 6520 3d20 6365         node = ce
-0000a500: 7263 6973 2e6c 6962 3274 6f33 5f70 6172  rcis.lib2to3_par
-0000a510: 7365 2827 2222 2264 6f63 7374 7269 6e67  se('"""docstring
-0000a520: 2222 225c 6e66 726f 6d20 5f5f 6675 7475  """\nfrom __futu
-0000a530: 7265 5f5f 2069 6d70 6f72 7420 6365 7263  re__ import cerc
-0000a540: 6973 5c6e 2729 0a20 2020 2020 2020 2073  is\n').        s
-0000a550: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-0000a560: 7b22 6365 7263 6973 227d 2c20 6365 7263  {"cercis"}, cerc
-0000a570: 6973 2e67 6574 5f66 7574 7572 655f 696d  is.get_future_im
-0000a580: 706f 7274 7328 6e6f 6465 2929 0a20 2020  ports(node)).   
-0000a590: 2020 2020 206e 6f64 6520 3d20 6365 7263       node = cerc
-0000a5a0: 6973 2e6c 6962 3274 6f33 5f70 6172 7365  is.lib2to3_parse
-0000a5b0: 280a 2020 2020 2020 2020 2020 2020 2273  (.            "s
-0000a5c0: 6f6d 6528 6f74 6865 722c 2063 6f64 6529  ome(other, code)
-0000a5d0: 5c6e 6672 6f6d 205f 5f66 7574 7572 655f  \nfrom __future_
-0000a5e0: 5f20 696d 706f 7274 2063 6572 6369 735c  _ import cercis\
-0000a5f0: 6e22 0a20 2020 2020 2020 2029 0a20 2020  n".        ).   
-0000a600: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0000a610: 4571 7561 6c28 7365 7428 292c 2063 6572  Equal(set(), cer
-0000a620: 6369 732e 6765 745f 6675 7475 7265 5f69  cis.get_future_i
-0000a630: 6d70 6f72 7473 286e 6f64 6529 290a 2020  mports(node)).  
-0000a640: 2020 2020 2020 6e6f 6465 203d 2063 6572        node = cer
-0000a650: 6369 732e 6c69 6232 746f 335f 7061 7273  cis.lib2to3_pars
-0000a660: 6528 2266 726f 6d20 736f 6d65 2e6d 6f64  e("from some.mod
-0000a670: 756c 6520 696d 706f 7274 2063 6572 6369  ule import cerci
-0000a680: 735c 6e22 290a 2020 2020 2020 2020 7365  s\n").        se
-0000a690: 6c66 2e61 7373 6572 7445 7175 616c 2873  lf.assertEqual(s
-0000a6a0: 6574 2829 2c20 6365 7263 6973 2e67 6574  et(), cercis.get
-0000a6b0: 5f66 7574 7572 655f 696d 706f 7274 7328  _future_imports(
-0000a6c0: 6e6f 6465 2929 0a20 2020 2020 2020 206e  node)).        n
-0000a6d0: 6f64 6520 3d20 6365 7263 6973 2e6c 6962  ode = cercis.lib
-0000a6e0: 3274 6f33 5f70 6172 7365 280a 2020 2020  2to3_parse(.    
-0000a6f0: 2020 2020 2020 2020 2266 726f 6d20 5f5f          "from __
-0000a700: 6675 7475 7265 5f5f 2069 6d70 6f72 7420  future__ import 
-0000a710: 756e 6963 6f64 655f 6c69 7465 7261 6c73  unicode_literals
-0000a720: 2061 7320 5f75 6e69 636f 6465 5f6c 6974   as _unicode_lit
-0000a730: 6572 616c 7322 0a20 2020 2020 2020 2029  erals".        )
-0000a740: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-0000a750: 7365 7274 4571 7561 6c28 7b22 756e 6963  sertEqual({"unic
-0000a760: 6f64 655f 6c69 7465 7261 6c73 227d 2c20  ode_literals"}, 
-0000a770: 6365 7263 6973 2e67 6574 5f66 7574 7572  cercis.get_futur
-0000a780: 655f 696d 706f 7274 7328 6e6f 6465 2929  e_imports(node))
-0000a790: 0a20 2020 2020 2020 206e 6f64 6520 3d20  .        node = 
-0000a7a0: 6365 7263 6973 2e6c 6962 3274 6f33 5f70  cercis.lib2to3_p
-0000a7b0: 6172 7365 280a 2020 2020 2020 2020 2020  arse(.          
-0000a7c0: 2020 2266 726f 6d20 5f5f 6675 7475 7265    "from __future
-0000a7d0: 5f5f 2069 6d70 6f72 7420 756e 6963 6f64  __ import unicod
-0000a7e0: 655f 6c69 7465 7261 6c73 2061 7320 5f6c  e_literals as _l
-0000a7f0: 6f6c 2c20 7072 696e 7422 0a20 2020 2020  ol, print".     
-0000a800: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
-0000a810: 662e 6173 7365 7274 4571 7561 6c28 7b22  f.assertEqual({"
-0000a820: 756e 6963 6f64 655f 6c69 7465 7261 6c73  unicode_literals
-0000a830: 222c 2022 7072 696e 7422 7d2c 2063 6572  ", "print"}, cer
-0000a840: 6369 732e 6765 745f 6675 7475 7265 5f69  cis.get_future_i
-0000a850: 6d70 6f72 7473 286e 6f64 6529 290a 0a20  mports(node)).. 
-0000a860: 2020 2040 7079 7465 7374 2e6d 6172 6b2e     @pytest.mark.
-0000a870: 696e 636f 6d70 6174 6962 6c65 5f77 6974  incompatible_wit
-0000a880: 685f 6d79 7079 630a 2020 2020 6465 6620  h_mypyc.    def 
-0000a890: 7465 7374 5f64 6562 7567 5f76 6973 6974  test_debug_visit
-0000a8a0: 6f72 2873 656c 6629 202d 3e20 4e6f 6e65  or(self) -> None
-0000a8b0: 3a0a 2020 2020 2020 2020 736f 7572 6365  :.        source
-0000a8c0: 2c20 5f20 3d20 7265 6164 5f64 6174 6128  , _ = read_data(
-0000a8d0: 226d 6973 6365 6c6c 616e 656f 7573 222c  "miscellaneous",
-0000a8e0: 2022 6465 6275 675f 7669 7369 746f 7222   "debug_visitor"
-0000a8f0: 290a 2020 2020 2020 2020 6578 7065 6374  ).        expect
-0000a900: 6564 2c20 5f20 3d20 7265 6164 5f64 6174  ed, _ = read_dat
-0000a910: 6128 226d 6973 6365 6c6c 616e 656f 7573  a("miscellaneous
-0000a920: 222c 2022 6465 6275 675f 7669 7369 746f  ", "debug_visito
-0000a930: 722e 6f75 7422 290a 2020 2020 2020 2020  r.out").        
-0000a940: 6f75 745f 6c69 6e65 7320 3d20 5b5d 0a20  out_lines = []. 
-0000a950: 2020 2020 2020 2065 7272 5f6c 696e 6573         err_lines
-0000a960: 203d 205b 5d0a 0a20 2020 2020 2020 2064   = []..        d
-0000a970: 6566 206f 7574 286d 7367 3a20 7374 722c  ef out(msg: str,
-0000a980: 202a 2a6b 7761 7267 733a 2041 6e79 2920   **kwargs: Any) 
-0000a990: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-0000a9a0: 2020 2020 206f 7574 5f6c 696e 6573 2e61       out_lines.a
-0000a9b0: 7070 656e 6428 6d73 6729 0a0a 2020 2020  ppend(msg)..    
-0000a9c0: 2020 2020 6465 6620 6572 7228 6d73 673a      def err(msg:
-0000a9d0: 2073 7472 2c20 2a2a 6b77 6172 6773 3a20   str, **kwargs: 
-0000a9e0: 416e 7929 202d 3e20 4e6f 6e65 3a0a 2020  Any) -> None:.  
-0000a9f0: 2020 2020 2020 2020 2020 6572 725f 6c69            err_li
-0000aa00: 6e65 732e 6170 7065 6e64 286d 7367 290a  nes.append(msg).
-0000aa10: 0a20 2020 2020 2020 2077 6974 6820 7061  .        with pa
-0000aa20: 7463 6828 2263 6572 6369 732e 6465 6275  tch("cercis.debu
-0000aa30: 672e 6f75 7422 2c20 6f75 7429 3a0a 2020  g.out", out):.  
-0000aa40: 2020 2020 2020 2020 2020 4465 6275 6756            DebugV
-0000aa50: 6973 6974 6f72 2e73 686f 7728 736f 7572  isitor.show(sour
-0000aa60: 6365 290a 2020 2020 2020 2020 6163 7475  ce).        actu
-0000aa70: 616c 203d 2022 5c6e 222e 6a6f 696e 286f  al = "\n".join(o
-0000aa80: 7574 5f6c 696e 6573 2920 2b20 225c 6e22  ut_lines) + "\n"
-0000aa90: 0a20 2020 2020 2020 206c 6f67 5f6e 616d  .        log_nam
-0000aaa0: 6520 3d20 2222 0a20 2020 2020 2020 2069  e = "".        i
-0000aab0: 6620 6578 7065 6374 6564 2021 3d20 6163  f expected != ac
-0000aac0: 7475 616c 3a0a 2020 2020 2020 2020 2020  tual:.          
-0000aad0: 2020 6c6f 675f 6e61 6d65 203d 2063 6572    log_name = cer
-0000aae0: 6369 732e 6475 6d70 5f74 6f5f 6669 6c65  cis.dump_to_file
-0000aaf0: 282a 6f75 745f 6c69 6e65 7329 0a20 2020  (*out_lines).   
-0000ab00: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0000ab10: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
-0000ab20: 2020 2065 7870 6563 7465 642c 0a20 2020     expected,.   
-0000ab30: 2020 2020 2020 2020 2061 6374 7561 6c2c           actual,
-0000ab40: 0a20 2020 2020 2020 2020 2020 2066 2241  .            f"A
-0000ab50: 5354 2070 7269 6e74 206f 7574 2069 7320  ST print out is 
-0000ab60: 6469 6666 6572 656e 742e 2041 6374 7561  different. Actua
-0000ab70: 6c20 7665 7273 696f 6e20 6475 6d70 6564  l version dumped
-0000ab80: 2074 6f20 7b6c 6f67 5f6e 616d 657d 222c   to {log_name}",
-0000ab90: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-0000aba0: 6465 6620 7465 7374 5f66 6f72 6d61 745f  def test_format_
-0000abb0: 6669 6c65 5f63 6f6e 7465 6e74 7328 7365  file_contents(se
-0000abc0: 6c66 2920 2d3e 204e 6f6e 653a 0a20 2020  lf) -> None:.   
-0000abd0: 2020 2020 206d 6f64 6520 3d20 4445 4641       mode = DEFA
-0000abe0: 554c 545f 4d4f 4445 0a20 2020 2020 2020  ULT_MODE.       
-0000abf0: 2065 6d70 7479 203d 2022 220a 2020 2020   empty = "".    
-0000ac00: 2020 2020 7769 7468 2073 656c 662e 6173      with self.as
-0000ac10: 7365 7274 5261 6973 6573 2863 6572 6369  sertRaises(cerci
-0000ac20: 732e 4e6f 7468 696e 6743 6861 6e67 6564  s.NothingChanged
-0000ac30: 293a 0a20 2020 2020 2020 2020 2020 2063  ):.            c
-0000ac40: 6572 6369 732e 666f 726d 6174 5f66 696c  ercis.format_fil
-0000ac50: 655f 636f 6e74 656e 7473 2865 6d70 7479  e_contents(empty
-0000ac60: 2c20 6d6f 6465 3d6d 6f64 652c 2066 6173  , mode=mode, fas
-0000ac70: 743d 4661 6c73 6529 0a20 2020 2020 2020  t=False).       
-0000ac80: 206a 7573 745f 6e6c 203d 2022 5c6e 220a   just_nl = "\n".
-0000ac90: 2020 2020 2020 2020 7769 7468 2073 656c          with sel
-0000aca0: 662e 6173 7365 7274 5261 6973 6573 2863  f.assertRaises(c
-0000acb0: 6572 6369 732e 4e6f 7468 696e 6743 6861  ercis.NothingCha
-0000acc0: 6e67 6564 293a 0a20 2020 2020 2020 2020  nged):.         
-0000acd0: 2020 2063 6572 6369 732e 666f 726d 6174     cercis.format
-0000ace0: 5f66 696c 655f 636f 6e74 656e 7473 286a  _file_contents(j
-0000acf0: 7573 745f 6e6c 2c20 6d6f 6465 3d6d 6f64  ust_nl, mode=mod
-0000ad00: 652c 2066 6173 743d 4661 6c73 6529 0a20  e, fast=False). 
-0000ad10: 2020 2020 2020 2073 616d 6520 3d20 226a         same = "j
-0000ad20: 203d 205b 312c 2032 2c20 335d 5c6e 220a   = [1, 2, 3]\n".
-0000ad30: 2020 2020 2020 2020 7769 7468 2073 656c          with sel
-0000ad40: 662e 6173 7365 7274 5261 6973 6573 2863  f.assertRaises(c
-0000ad50: 6572 6369 732e 4e6f 7468 696e 6743 6861  ercis.NothingCha
-0000ad60: 6e67 6564 293a 0a20 2020 2020 2020 2020  nged):.         
-0000ad70: 2020 2063 6572 6369 732e 666f 726d 6174     cercis.format
-0000ad80: 5f66 696c 655f 636f 6e74 656e 7473 2873  _file_contents(s
-0000ad90: 616d 652c 206d 6f64 653d 6d6f 6465 2c20  ame, mode=mode, 
-0000ada0: 6661 7374 3d46 616c 7365 290a 2020 2020  fast=False).    
-0000adb0: 2020 2020 6469 6666 6572 656e 7420 3d20      different = 
-0000adc0: 226a 203d 205b 312c 322c 335d 220a 2020  "j = [1,2,3]".  
-0000add0: 2020 2020 2020 6578 7065 6374 6564 203d        expected =
-0000ade0: 2073 616d 650a 2020 2020 2020 2020 6163   same.        ac
-0000adf0: 7475 616c 203d 2063 6572 6369 732e 666f  tual = cercis.fo
-0000ae00: 726d 6174 5f66 696c 655f 636f 6e74 656e  rmat_file_conten
-0000ae10: 7473 2864 6966 6665 7265 6e74 2c20 6d6f  ts(different, mo
-0000ae20: 6465 3d6d 6f64 652c 2066 6173 743d 4661  de=mode, fast=Fa
-0000ae30: 6c73 6529 0a20 2020 2020 2020 2073 656c  lse).        sel
-0000ae40: 662e 6173 7365 7274 4571 7561 6c28 6578  f.assertEqual(ex
-0000ae50: 7065 6374 6564 2c20 6163 7475 616c 290a  pected, actual).
-0000ae60: 2020 2020 2020 2020 696e 7661 6c69 6420          invalid 
-0000ae70: 3d20 2272 6574 7572 6e20 6966 2079 6f75  = "return if you
-0000ae80: 2063 616e 220a 2020 2020 2020 2020 7769   can".        wi
-0000ae90: 7468 2073 656c 662e 6173 7365 7274 5261  th self.assertRa
-0000aea0: 6973 6573 2863 6572 6369 732e 496e 7661  ises(cercis.Inva
-0000aeb0: 6c69 6449 6e70 7574 2920 6173 2065 3a0a  lidInput) as e:.
-0000aec0: 2020 2020 2020 2020 2020 2020 6365 7263              cerc
-0000aed0: 6973 2e66 6f72 6d61 745f 6669 6c65 5f63  is.format_file_c
-0000aee0: 6f6e 7465 6e74 7328 696e 7661 6c69 642c  ontents(invalid,
-0000aef0: 206d 6f64 653d 6d6f 6465 2c20 6661 7374   mode=mode, fast
-0000af00: 3d46 616c 7365 290a 2020 2020 2020 2020  =False).        
-0000af10: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-0000af20: 2873 7472 2865 2e65 7863 6570 7469 6f6e  (str(e.exception
-0000af30: 292c 2022 4361 6e6e 6f74 2070 6172 7365  ), "Cannot parse
-0000af40: 3a20 313a 373a 2072 6574 7572 6e20 6966  : 1:7: return if
-0000af50: 2079 6f75 2063 616e 2229 0a0a 2020 2020   you can")..    
-0000af60: 2020 2020 6d6f 6465 203d 2063 6572 6369      mode = cerci
-0000af70: 732e 4d6f 6465 2870 7265 7669 6577 3d54  s.Mode(preview=T
-0000af80: 7275 6529 0a20 2020 2020 2020 206a 7573  rue).        jus
-0000af90: 745f 6372 6c66 203d 2022 5c72 5c6e 220a  t_crlf = "\r\n".
-0000afa0: 2020 2020 2020 2020 7769 7468 2073 656c          with sel
-0000afb0: 662e 6173 7365 7274 5261 6973 6573 2863  f.assertRaises(c
-0000afc0: 6572 6369 732e 4e6f 7468 696e 6743 6861  ercis.NothingCha
-0000afd0: 6e67 6564 293a 0a20 2020 2020 2020 2020  nged):.         
-0000afe0: 2020 2063 6572 6369 732e 666f 726d 6174     cercis.format
-0000aff0: 5f66 696c 655f 636f 6e74 656e 7473 286a  _file_contents(j
-0000b000: 7573 745f 6372 6c66 2c20 6d6f 6465 3d6d  ust_crlf, mode=m
-0000b010: 6f64 652c 2066 6173 743d 4661 6c73 6529  ode, fast=False)
-0000b020: 0a20 2020 2020 2020 206a 7573 745f 7768  .        just_wh
-0000b030: 6974 6573 7061 6365 5f6e 6c20 3d20 225c  itespace_nl = "\
-0000b040: 6e5c 745c 6e20 5c6e 5c74 205c 6e20 5c74  n\t\n \n\t \n \t
-0000b050: 5c6e 5c6e 220a 2020 2020 2020 2020 6163  \n\n".        ac
-0000b060: 7475 616c 203d 2063 6572 6369 732e 666f  tual = cercis.fo
-0000b070: 726d 6174 5f66 696c 655f 636f 6e74 656e  rmat_file_conten
-0000b080: 7473 286a 7573 745f 7768 6974 6573 7061  ts(just_whitespa
-0000b090: 6365 5f6e 6c2c 206d 6f64 653d 6d6f 6465  ce_nl, mode=mode
-0000b0a0: 2c20 6661 7374 3d46 616c 7365 290a 2020  , fast=False).  
-0000b0b0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0000b0c0: 7445 7175 616c 2822 5c6e 222c 2061 6374  tEqual("\n", act
-0000b0d0: 7561 6c29 0a20 2020 2020 2020 206a 7573  ual).        jus
-0000b0e0: 745f 7768 6974 6573 7061 6365 5f63 726c  t_whitespace_crl
-0000b0f0: 6620 3d20 225c 725c 6e5c 745c 725c 6e20  f = "\r\n\t\r\n 
-0000b100: 5c72 5c6e 5c74 205c 725c 6e20 5c74 5c72  \r\n\t \r\n \t\r
-0000b110: 5c6e 5c72 5c6e 220a 2020 2020 2020 2020  \n\r\n".        
-0000b120: 6163 7475 616c 203d 2063 6572 6369 732e  actual = cercis.
-0000b130: 666f 726d 6174 5f66 696c 655f 636f 6e74  format_file_cont
-0000b140: 656e 7473 280a 2020 2020 2020 2020 2020  ents(.          
-0000b150: 2020 6a75 7374 5f77 6869 7465 7370 6163    just_whitespac
-0000b160: 655f 6372 6c66 2c20 6d6f 6465 3d6d 6f64  e_crlf, mode=mod
-0000b170: 652c 2066 6173 743d 4661 6c73 650a 2020  e, fast=False.  
-0000b180: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0000b190: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-0000b1a0: 2822 5c72 5c6e 222c 2061 6374 7561 6c29  ("\r\n", actual)
-0000b1b0: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
-0000b1c0: 6e64 6d61 726b 6572 2873 656c 6629 202d  ndmarker(self) -
-0000b1d0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-0000b1e0: 6e20 3d20 6365 7263 6973 2e6c 6962 3274  n = cercis.lib2t
-0000b1f0: 6f33 5f70 6172 7365 2822 5c6e 2229 0a20  o3_parse("\n"). 
-0000b200: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-0000b210: 7274 4571 7561 6c28 6e2e 7479 7065 2c20  rtEqual(n.type, 
-0000b220: 6365 7263 6973 2e73 796d 732e 6669 6c65  cercis.syms.file
-0000b230: 5f69 6e70 7574 290a 2020 2020 2020 2020  _input).        
-0000b240: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-0000b250: 286c 656e 286e 2e63 6869 6c64 7265 6e29  (len(n.children)
-0000b260: 2c20 3129 0a20 2020 2020 2020 2073 656c  , 1).        sel
-0000b270: 662e 6173 7365 7274 4571 7561 6c28 6e2e  f.assertEqual(n.
-0000b280: 6368 696c 6472 656e 5b30 5d2e 7479 7065  children[0].type
-0000b290: 2c20 6365 7263 6973 2e74 6f6b 656e 2e45  , cercis.token.E
-0000b2a0: 4e44 4d41 524b 4552 290a 0a20 2020 2040  NDMARKER)..    @
-0000b2b0: 7079 7465 7374 2e6d 6172 6b2e 696e 636f  pytest.mark.inco
-0000b2c0: 6d70 6174 6962 6c65 5f77 6974 685f 6d79  mpatible_with_my
-0000b2d0: 7079 630a 2020 2020 4075 6e69 7474 6573  pyc.    @unittes
-0000b2e0: 742e 736b 6970 4966 286f 732e 656e 7669  t.skipIf(os.envi
-0000b2f0: 726f 6e2e 6765 7428 2253 4b49 505f 4153  ron.get("SKIP_AS
-0000b300: 545f 5052 494e 5422 292c 2022 7573 6572  T_PRINT"), "user
-0000b310: 2073 6574 2053 4b49 505f 4153 545f 5052   set SKIP_AST_PR
-0000b320: 494e 5422 290a 2020 2020 6465 6620 7465  INT").    def te
-0000b330: 7374 5f61 7373 6572 7446 6f72 6d61 7445  st_assertFormatE
-0000b340: 7175 616c 2873 656c 6629 202d 3e20 4e6f  qual(self) -> No
-0000b350: 6e65 3a0a 2020 2020 2020 2020 6f75 745f  ne:.        out_
-0000b360: 6c69 6e65 7320 3d20 5b5d 0a20 2020 2020  lines = [].     
-0000b370: 2020 2065 7272 5f6c 696e 6573 203d 205b     err_lines = [
-0000b380: 5d0a 0a20 2020 2020 2020 2064 6566 206f  ]..        def o
-0000b390: 7574 286d 7367 3a20 7374 722c 202a 2a6b  ut(msg: str, **k
-0000b3a0: 7761 7267 733a 2041 6e79 2920 2d3e 204e  wargs: Any) -> N
-0000b3b0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0000b3c0: 206f 7574 5f6c 696e 6573 2e61 7070 656e   out_lines.appen
-0000b3d0: 6428 6d73 6729 0a0a 2020 2020 2020 2020  d(msg)..        
-0000b3e0: 6465 6620 6572 7228 6d73 673a 2073 7472  def err(msg: str
-0000b3f0: 2c20 2a2a 6b77 6172 6773 3a20 416e 7929  , **kwargs: Any)
-0000b400: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-0000b410: 2020 2020 2020 6572 725f 6c69 6e65 732e        err_lines.
-0000b420: 6170 7065 6e64 286d 7367 290a 0a20 2020  append(msg)..   
-0000b430: 2020 2020 2077 6974 6820 7061 7463 6828       with patch(
-0000b440: 2263 6572 6369 732e 6f75 7470 7574 2e5f  "cercis.output._
-0000b450: 6f75 7422 2c20 6f75 7429 2c20 7061 7463  out", out), patc
-0000b460: 6828 2263 6572 6369 732e 6f75 7470 7574  h("cercis.output
-0000b470: 2e5f 6572 7222 2c20 6572 7229 3a0a 2020  ._err", err):.  
-0000b480: 2020 2020 2020 2020 2020 7769 7468 2073            with s
-0000b490: 656c 662e 6173 7365 7274 5261 6973 6573  elf.assertRaises
-0000b4a0: 2841 7373 6572 7469 6f6e 4572 726f 7229  (AssertionError)
-0000b4b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000b4c0: 2020 7365 6c66 2e61 7373 6572 7446 6f72    self.assertFor
-0000b4d0: 6d61 7445 7175 616c 2822 6a20 3d20 5b31  matEqual("j = [1
-0000b4e0: 2c20 322c 2033 5d22 2c20 226a 203d 205b  , 2, 3]", "j = [
-0000b4f0: 312c 2032 2c20 332c 5d22 290a 0a20 2020  1, 2, 3,]")..   
-0000b500: 2020 2020 206f 7574 5f73 7472 203d 2022       out_str = "
-0000b510: 222e 6a6f 696e 286f 7574 5f6c 696e 6573  ".join(out_lines
-0000b520: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-0000b530: 7373 6572 7449 6e28 2245 7870 6563 7465  ssertIn("Expecte
-0000b540: 6420 7472 6565 3a22 2c20 6f75 745f 7374  d tree:", out_st
-0000b550: 7229 0a20 2020 2020 2020 2073 656c 662e  r).        self.
-0000b560: 6173 7365 7274 496e 2822 4163 7475 616c  assertIn("Actual
-0000b570: 2074 7265 653a 222c 206f 7574 5f73 7472   tree:", out_str
-0000b580: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-0000b590: 7373 6572 7445 7175 616c 2822 222e 6a6f  ssertEqual("".jo
-0000b5a0: 696e 2865 7272 5f6c 696e 6573 292c 2022  in(err_lines), "
-0000b5b0: 2229 0a0a 2020 2020 4065 7665 6e74 5f6c  ")..    @event_l
-0000b5c0: 6f6f 7028 290a 2020 2020 4070 6174 6368  oop().    @patch
-0000b5d0: 2822 636f 6e63 7572 7265 6e74 2e66 7574  ("concurrent.fut
-0000b5e0: 7572 6573 2e50 726f 6365 7373 506f 6f6c  ures.ProcessPool
-0000b5f0: 4578 6563 7574 6f72 222c 204d 6167 6963  Executor", Magic
-0000b600: 4d6f 636b 2873 6964 655f 6566 6665 6374  Mock(side_effect
-0000b610: 3d4f 5345 7272 6f72 2929 0a20 2020 2064  =OSError)).    d
-0000b620: 6566 2074 6573 745f 776f 726b 735f 696e  ef test_works_in
-0000b630: 5f6d 6f6e 6f5f 7072 6f63 6573 735f 6f6e  _mono_process_on
-0000b640: 6c79 5f65 6e76 6972 6f6e 6d65 6e74 2873  ly_environment(s
-0000b650: 656c 6629 202d 3e20 4e6f 6e65 3a0a 2020  elf) -> None:.  
-0000b660: 2020 2020 2020 7769 7468 2063 6163 6865        with cache
-0000b670: 5f64 6972 2829 2061 7320 776f 726b 7370  _dir() as worksp
-0000b680: 6163 653a 0a20 2020 2020 2020 2020 2020  ace:.           
-0000b690: 2066 6f72 2066 2069 6e20 5b0a 2020 2020   for f in [.    
-0000b6a0: 2020 2020 2020 2020 2020 2020 2877 6f72              (wor
-0000b6b0: 6b73 7061 6365 202f 2022 6f6e 652e 7079  kspace / "one.py
-0000b6c0: 2229 2e72 6573 6f6c 7665 2829 2c0a 2020  ").resolve(),.  
-0000b6d0: 2020 2020 2020 2020 2020 2020 2020 2877                (w
-0000b6e0: 6f72 6b73 7061 6365 202f 2022 7477 6f2e  orkspace / "two.
-0000b6f0: 7079 2229 2e72 6573 6f6c 7665 2829 2c0a  py").resolve(),.
-0000b700: 2020 2020 2020 2020 2020 2020 5d3a 0a20              ]:. 
-0000b710: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000b720: 2e77 7269 7465 5f74 6578 7428 2770 7269  .write_text('pri
-0000b730: 6e74 2822 6865 6c6c 6f22 295c 6e27 290a  nt("hello")\n').
-0000b740: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000b750: 2e69 6e76 6f6b 6542 6c61 636b 285b 7374  .invokeBlack([st
-0000b760: 7228 776f 726b 7370 6163 6529 5d29 0a0a  r(workspace)])..
-0000b770: 2020 2020 4065 7665 6e74 5f6c 6f6f 7028      @event_loop(
-0000b780: 290a 2020 2020 6465 6620 7465 7374 5f63  ).    def test_c
-0000b790: 6865 636b 5f64 6966 665f 7573 655f 746f  heck_diff_use_to
-0000b7a0: 6765 7468 6572 2873 656c 6629 202d 3e20  gether(self) -> 
-0000b7b0: 4e6f 6e65 3a0a 2020 2020 2020 2020 7371  None:.        sq
-0000b7c0: 203d 2022 2d2d 7369 6e67 6c65 2d71 756f   = "--single-quo
-0000b7d0: 7465 3d46 616c 7365 220a 2020 2020 2020  te=False".      
-0000b7e0: 2020 6c6c 203d 2022 2d2d 6c69 6e65 2d6c    ll = "--line-l
-0000b7f0: 656e 6774 683d 3838 220a 2020 2020 2020  ength=88".      
-0000b800: 2020 7769 7468 2063 6163 6865 5f64 6972    with cache_dir
-0000b810: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-0000b820: 2320 4669 6c65 7320 7768 6963 6820 7769  # Files which wi
-0000b830: 6c6c 2062 6520 7265 666f 726d 6174 7465  ll be reformatte
-0000b840: 642e 0a20 2020 2020 2020 2020 2020 2073  d..            s
-0000b850: 7263 3120 3d20 6765 745f 6361 7365 5f70  rc1 = get_case_p
-0000b860: 6174 6828 226d 6973 6365 6c6c 616e 656f  ath("miscellaneo
-0000b870: 7573 222c 2022 7374 7269 6e67 5f71 756f  us", "string_quo
-0000b880: 7465 7322 290a 2020 2020 2020 2020 2020  tes").          
-0000b890: 2020 7365 6c66 2e69 6e76 6f6b 6542 6c61    self.invokeBla
-0000b8a0: 636b 285b 7374 7228 7372 6331 292c 2022  ck([str(src1), "
-0000b8b0: 2d2d 6469 6666 222c 2022 2d2d 6368 6563  --diff", "--chec
-0000b8c0: 6b22 2c20 7371 2c20 6c6c 5d2c 2065 7869  k", sq, ll], exi
-0000b8d0: 745f 636f 6465 3d31 290a 2020 2020 2020  t_code=1).      
-0000b8e0: 2020 2020 2020 2320 4669 6c65 7320 7768        # Files wh
-0000b8f0: 6963 6820 7769 6c6c 206e 6f74 2062 6520  ich will not be 
-0000b900: 7265 666f 726d 6174 7465 642e 0a20 2020  reformatted..   
-0000b910: 2020 2020 2020 2020 2073 7263 3220 3d20           src2 = 
-0000b920: 6765 745f 6361 7365 5f70 6174 6828 2273  get_case_path("s
-0000b930: 696d 706c 655f 6361 7365 7322 2c20 2263  imple_cases", "c
-0000b940: 6f6d 706f 7369 7469 6f6e 2229 0a20 2020  omposition").   
-0000b950: 2020 2020 2020 2020 2073 656c 662e 696e           self.in
-0000b960: 766f 6b65 426c 6163 6b28 5b73 7472 2873  vokeBlack([str(s
-0000b970: 7263 3229 2c20 222d 2d64 6966 6622 2c20  rc2), "--diff", 
-0000b980: 222d 2d63 6865 636b 222c 2073 712c 206c  "--check", sq, l
-0000b990: 6c5d 290a 2020 2020 2020 2020 2020 2020  l]).            
-0000b9a0: 2320 4d75 6c74 6920 6669 6c65 2063 6f6d  # Multi file com
-0000b9b0: 6d61 6e64 2e0a 2020 2020 2020 2020 2020  mand..          
-0000b9c0: 2020 7365 6c66 2e69 6e76 6f6b 6542 6c61    self.invokeBla
-0000b9d0: 636b 280a 2020 2020 2020 2020 2020 2020  ck(.            
-0000b9e0: 2020 2020 5b73 7472 2873 7263 3129 2c20      [str(src1), 
-0000b9f0: 7374 7228 7372 6332 292c 2022 2d2d 6469  str(src2), "--di
-0000ba00: 6666 222c 2022 2d2d 6368 6563 6b22 2c20  ff", "--check", 
-0000ba10: 7371 2c20 6c6c 5d2c 0a20 2020 2020 2020  sq, ll],.       
-0000ba20: 2020 2020 2020 2020 2065 7869 745f 636f           exit_co
-0000ba30: 6465 3d31 2c0a 2020 2020 2020 2020 2020  de=1,.          
-0000ba40: 2020 290a 0a20 2020 2064 6566 2074 6573    )..    def tes
-0000ba50: 745f 6e6f 5f73 7263 5f66 6169 6c73 2873  t_no_src_fails(s
-0000ba60: 656c 6629 202d 3e20 4e6f 6e65 3a0a 2020  elf) -> None:.  
-0000ba70: 2020 2020 2020 7769 7468 2063 6163 6865        with cache
-0000ba80: 5f64 6972 2829 3a0a 2020 2020 2020 2020  _dir():.        
-0000ba90: 2020 2020 7365 6c66 2e69 6e76 6f6b 6542      self.invokeB
-0000baa0: 6c61 636b 285b 5d2c 2065 7869 745f 636f  lack([], exit_co
-0000bab0: 6465 3d31 290a 0a20 2020 2064 6566 2074  de=1)..    def t
-0000bac0: 6573 745f 7372 635f 616e 645f 636f 6465  est_src_and_code
-0000bad0: 5f66 6169 6c73 2873 656c 6629 202d 3e20  _fails(self) -> 
-0000bae0: 4e6f 6e65 3a0a 2020 2020 2020 2020 7769  None:.        wi
-0000baf0: 7468 2063 6163 6865 5f64 6972 2829 3a0a  th cache_dir():.
-0000bb00: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000bb10: 2e69 6e76 6f6b 6542 6c61 636b 285b 222e  .invokeBlack([".
-0000bb20: 222c 2022 2d63 222c 2022 3022 5d2c 2065  ", "-c", "0"], e
-0000bb30: 7869 745f 636f 6465 3d31 290a 0a20 2020  xit_code=1)..   
-0000bb40: 2064 6566 2074 6573 745f 6272 6f6b 656e   def test_broken
-0000bb50: 5f73 796d 6c69 6e6b 2873 656c 6629 202d  _symlink(self) -
-0000bb60: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-0000bb70: 7769 7468 2063 6163 6865 5f64 6972 2829  with cache_dir()
-0000bb80: 2061 7320 776f 726b 7370 6163 653a 0a20   as workspace:. 
-0000bb90: 2020 2020 2020 2020 2020 2073 796d 6c69             symli
-0000bba0: 6e6b 203d 2077 6f72 6b73 7061 6365 202f  nk = workspace /
-0000bbb0: 2022 6272 6f6b 656e 5f6c 696e 6b2e 7079   "broken_link.py
-0000bbc0: 220a 2020 2020 2020 2020 2020 2020 7472  ".            tr
-0000bbd0: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
-0000bbe0: 2020 2073 796d 6c69 6e6b 2e73 796d 6c69     symlink.symli
-0000bbf0: 6e6b 5f74 6f28 226e 6f6e 6578 6973 7465  nk_to("nonexiste
-0000bc00: 6e74 2e70 7922 290a 2020 2020 2020 2020  nt.py").        
-0000bc10: 2020 2020 6578 6365 7074 2028 4f53 4572      except (OSEr
-0000bc20: 726f 722c 204e 6f74 496d 706c 656d 656e  ror, NotImplemen
-0000bc30: 7465 6445 7272 6f72 2920 6173 2065 3a0a  tedError) as e:.
-0000bc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bc50: 7365 6c66 2e73 6b69 7054 6573 7428 6622  self.skipTest(f"
-0000bc60: 4361 6e27 7420 6372 6561 7465 2073 796d  Can't create sym
-0000bc70: 6c69 6e6b 733a 207b 657d 2229 0a20 2020  links: {e}").   
-0000bc80: 2020 2020 2020 2020 2073 656c 662e 696e           self.in
-0000bc90: 766f 6b65 426c 6163 6b28 5b73 7472 2877  vokeBlack([str(w
-0000bca0: 6f72 6b73 7061 6365 2e72 6573 6f6c 7665  orkspace.resolve
-0000bcb0: 2829 295d 290a 0a20 2020 2064 6566 2074  ())])..    def t
-0000bcc0: 6573 745f 7369 6e67 6c65 5f66 696c 655f  est_single_file_
-0000bcd0: 666f 7263 655f 7079 6928 7365 6c66 2920  force_pyi(self) 
-0000bce0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-0000bcf0: 2070 7969 5f6d 6f64 6520 3d20 7265 706c   pyi_mode = repl
-0000bd00: 6163 6528 4445 4641 554c 545f 4d4f 4445  ace(DEFAULT_MODE
-0000bd10: 2c20 6973 5f70 7969 3d54 7275 6529 0a20  , is_pyi=True). 
-0000bd20: 2020 2020 2020 2063 6f6e 7465 6e74 732c         contents,
-0000bd30: 2065 7870 6563 7465 6420 3d20 7265 6164   expected = read
-0000bd40: 5f64 6174 6128 226d 6973 6365 6c6c 616e  _data("miscellan
-0000bd50: 656f 7573 222c 2022 666f 7263 655f 7079  eous", "force_py
-0000bd60: 6922 290a 2020 2020 2020 2020 7769 7468  i").        with
-0000bd70: 2063 6163 6865 5f64 6972 2829 2061 7320   cache_dir() as 
-0000bd80: 776f 726b 7370 6163 653a 0a20 2020 2020  workspace:.     
-0000bd90: 2020 2020 2020 2070 6174 6820 3d20 2877         path = (w
-0000bda0: 6f72 6b73 7061 6365 202f 2022 6669 6c65  orkspace / "file
-0000bdb0: 2e70 7922 292e 7265 736f 6c76 6528 290a  .py").resolve().
-0000bdc0: 2020 2020 2020 2020 2020 2020 7769 7468              with
-0000bdd0: 206f 7065 6e28 7061 7468 2c20 2277 2229   open(path, "w")
-0000bde0: 2061 7320 6668 3a0a 2020 2020 2020 2020   as fh:.        
-0000bdf0: 2020 2020 2020 2020 6668 2e77 7269 7465          fh.write
-0000be00: 2863 6f6e 7465 6e74 7329 0a20 2020 2020  (contents).     
-0000be10: 2020 2020 2020 2073 656c 662e 696e 766f         self.invo
-0000be20: 6b65 426c 6163 6b28 5b73 7472 2870 6174  keBlack([str(pat
-0000be30: 6829 2c20 222d 2d70 7969 225d 290a 2020  h), "--pyi"]).  
-0000be40: 2020 2020 2020 2020 2020 7769 7468 206f            with o
-0000be50: 7065 6e28 7061 7468 2c20 2272 2229 2061  pen(path, "r") a
-0000be60: 7320 6668 3a0a 2020 2020 2020 2020 2020  s fh:.          
-0000be70: 2020 2020 2020 6163 7475 616c 203d 2066        actual = f
-0000be80: 682e 7265 6164 2829 0a20 2020 2020 2020  h.read().       
-0000be90: 2020 2020 2023 2076 6572 6966 7920 6361       # verify ca
-0000bea0: 6368 6520 7769 7468 202d 2d70 7969 2069  che with --pyi i
-0000beb0: 7320 7365 7061 7261 7465 0a20 2020 2020  s separate.     
-0000bec0: 2020 2020 2020 2070 7969 5f63 6163 6865         pyi_cache
-0000bed0: 203d 2063 6572 6369 732e 7265 6164 5f63   = cercis.read_c
-0000bee0: 6163 6865 2870 7969 5f6d 6f64 6529 0a20  ache(pyi_mode). 
-0000bef0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000bf00: 6173 7365 7274 496e 2873 7472 2870 6174  assertIn(str(pat
-0000bf10: 6829 2c20 7079 695f 6361 6368 6529 0a20  h), pyi_cache). 
-0000bf20: 2020 2020 2020 2020 2020 206e 6f72 6d61             norma
-0000bf30: 6c5f 6361 6368 6520 3d20 6365 7263 6973  l_cache = cercis
-0000bf40: 2e72 6561 645f 6361 6368 6528 4445 4641  .read_cache(DEFA
-0000bf50: 554c 545f 4d4f 4445 290a 2020 2020 2020  ULT_MODE).      
-0000bf60: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0000bf70: 744e 6f74 496e 2873 7472 2870 6174 6829  tNotIn(str(path)
-0000bf80: 2c20 6e6f 726d 616c 5f63 6163 6865 290a  , normal_cache).
-0000bf90: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0000bfa0: 6572 7446 6f72 6d61 7445 7175 616c 2865  ertFormatEqual(e
-0000bfb0: 7870 6563 7465 642c 2061 6374 7561 6c29  xpected, actual)
-0000bfc0: 0a20 2020 2020 2020 2063 6572 6369 732e  .        cercis.
-0000bfd0: 6173 7365 7274 5f65 7175 6976 616c 656e  assert_equivalen
-0000bfe0: 7428 636f 6e74 656e 7473 2c20 6163 7475  t(contents, actu
-0000bff0: 616c 290a 2020 2020 2020 2020 6365 7263  al).        cerc
-0000c000: 6973 2e61 7373 6572 745f 7374 6162 6c65  is.assert_stable
-0000c010: 2863 6f6e 7465 6e74 732c 2061 6374 7561  (contents, actua
-0000c020: 6c2c 2070 7969 5f6d 6f64 6529 0a0a 2020  l, pyi_mode)..  
-0000c030: 2020 4065 7665 6e74 5f6c 6f6f 7028 290a    @event_loop().
-0000c040: 2020 2020 6465 6620 7465 7374 5f6d 756c      def test_mul
-0000c050: 7469 5f66 696c 655f 666f 7263 655f 7079  ti_file_force_py
-0000c060: 6928 7365 6c66 2920 2d3e 204e 6f6e 653a  i(self) -> None:
-0000c070: 0a20 2020 2020 2020 2072 6567 5f6d 6f64  .        reg_mod
-0000c080: 6520 3d20 4445 4641 554c 545f 4d4f 4445  e = DEFAULT_MODE
-0000c090: 0a20 2020 2020 2020 2070 7969 5f6d 6f64  .        pyi_mod
-0000c0a0: 6520 3d20 7265 706c 6163 6528 4445 4641  e = replace(DEFA
-0000c0b0: 554c 545f 4d4f 4445 2c20 6973 5f70 7969  ULT_MODE, is_pyi
-0000c0c0: 3d54 7275 6529 0a20 2020 2020 2020 2063  =True).        c
-0000c0d0: 6f6e 7465 6e74 732c 2065 7870 6563 7465  ontents, expecte
-0000c0e0: 6420 3d20 7265 6164 5f64 6174 6128 226d  d = read_data("m
-0000c0f0: 6973 6365 6c6c 616e 656f 7573 222c 2022  iscellaneous", "
-0000c100: 666f 7263 655f 7079 6922 290a 2020 2020  force_pyi").    
-0000c110: 2020 2020 7769 7468 2063 6163 6865 5f64      with cache_d
-0000c120: 6972 2829 2061 7320 776f 726b 7370 6163  ir() as workspac
-0000c130: 653a 0a20 2020 2020 2020 2020 2020 2070  e:.            p
-0000c140: 6174 6873 203d 205b 0a20 2020 2020 2020  aths = [.       
-0000c150: 2020 2020 2020 2020 2028 776f 726b 7370           (worksp
-0000c160: 6163 6520 2f20 2266 696c 6531 2e70 7922  ace / "file1.py"
-0000c170: 292e 7265 736f 6c76 6528 292c 0a20 2020  ).resolve(),.   
-0000c180: 2020 2020 2020 2020 2020 2020 2028 776f               (wo
-0000c190: 726b 7370 6163 6520 2f20 2266 696c 6532  rkspace / "file2
-0000c1a0: 2e70 7922 292e 7265 736f 6c76 6528 292c  .py").resolve(),
-0000c1b0: 0a20 2020 2020 2020 2020 2020 205d 0a20  .            ]. 
-0000c1c0: 2020 2020 2020 2020 2020 2066 6f72 2070             for p
-0000c1d0: 6174 6820 696e 2070 6174 6873 3a0a 2020  ath in paths:.  
-0000c1e0: 2020 2020 2020 2020 2020 2020 2020 7769                wi
-0000c1f0: 7468 206f 7065 6e28 7061 7468 2c20 2277  th open(path, "w
-0000c200: 2229 2061 7320 6668 3a0a 2020 2020 2020  ") as fh:.      
-0000c210: 2020 2020 2020 2020 2020 2020 2020 6668                fh
-0000c220: 2e77 7269 7465 2863 6f6e 7465 6e74 7329  .write(contents)
-0000c230: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000c240: 662e 696e 766f 6b65 426c 6163 6b28 5b73  f.invokeBlack([s
-0000c250: 7472 2870 2920 666f 7220 7020 696e 2070  tr(p) for p in p
-0000c260: 6174 6873 5d20 2b20 5b22 2d2d 7079 6922  aths] + ["--pyi"
-0000c270: 5d29 0a20 2020 2020 2020 2020 2020 2066  ]).            f
-0000c280: 6f72 2070 6174 6820 696e 2070 6174 6873  or path in paths
-0000c290: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000c2a0: 2020 7769 7468 206f 7065 6e28 7061 7468    with open(path
-0000c2b0: 2c20 2272 2229 2061 7320 6668 3a0a 2020  , "r") as fh:.  
-0000c2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c2d0: 2020 6163 7475 616c 203d 2066 682e 7265    actual = fh.re
-0000c2e0: 6164 2829 0a20 2020 2020 2020 2020 2020  ad().           
-0000c2f0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
-0000c300: 4571 7561 6c28 6163 7475 616c 2c20 6578  Equal(actual, ex
-0000c310: 7065 6374 6564 290a 2020 2020 2020 2020  pected).        
-0000c320: 2020 2020 2320 7665 7269 6679 2063 6163      # verify cac
-0000c330: 6865 2077 6974 6820 2d2d 7079 6920 6973  he with --pyi is
-0000c340: 2073 6570 6172 6174 650a 2020 2020 2020   separate.      
-0000c350: 2020 2020 2020 7079 695f 6361 6368 6520        pyi_cache 
-0000c360: 3d20 6365 7263 6973 2e72 6561 645f 6361  = cercis.read_ca
-0000c370: 6368 6528 7079 695f 6d6f 6465 290a 2020  che(pyi_mode).  
-0000c380: 2020 2020 2020 2020 2020 6e6f 726d 616c            normal
-0000c390: 5f63 6163 6865 203d 2063 6572 6369 732e  _cache = cercis.
-0000c3a0: 7265 6164 5f63 6163 6865 2872 6567 5f6d  read_cache(reg_m
-0000c3b0: 6f64 6529 0a20 2020 2020 2020 2020 2020  ode).           
-0000c3c0: 2066 6f72 2070 6174 6820 696e 2070 6174   for path in pat
-0000c3d0: 6873 3a0a 2020 2020 2020 2020 2020 2020  hs:.            
-0000c3e0: 2020 2020 7365 6c66 2e61 7373 6572 7449      self.assertI
-0000c3f0: 6e28 7374 7228 7061 7468 292c 2070 7969  n(str(path), pyi
-0000c400: 5f63 6163 6865 290a 2020 2020 2020 2020  _cache).        
-0000c410: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0000c420: 6572 744e 6f74 496e 2873 7472 2870 6174  ertNotIn(str(pat
-0000c430: 6829 2c20 6e6f 726d 616c 5f63 6163 6865  h), normal_cache
-0000c440: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
-0000c450: 7069 7065 5f66 6f72 6365 5f70 7969 2873  pipe_force_pyi(s
-0000c460: 656c 6629 202d 3e20 4e6f 6e65 3a0a 2020  elf) -> None:.  
-0000c470: 2020 2020 2020 736f 7572 6365 2c20 6578        source, ex
-0000c480: 7065 6374 6564 203d 2072 6561 645f 6461  pected = read_da
-0000c490: 7461 2822 6d69 7363 656c 6c61 6e65 6f75  ta("miscellaneou
-0000c4a0: 7322 2c20 2266 6f72 6365 5f70 7969 2229  s", "force_pyi")
-0000c4b0: 0a20 2020 2020 2020 2072 6573 756c 7420  .        result 
-0000c4c0: 3d20 436c 6952 756e 6e65 7228 292e 696e  = CliRunner().in
-0000c4d0: 766f 6b65 280a 2020 2020 2020 2020 2020  voke(.          
-0000c4e0: 2020 6365 7263 6973 2e6d 6169 6e2c 205b    cercis.main, [
-0000c4f0: 222d 222c 2022 2d71 222c 2022 2d2d 7079  "-", "-q", "--py
-0000c500: 6922 5d2c 2069 6e70 7574 3d42 7974 6573  i"], input=Bytes
-0000c510: 494f 2873 6f75 7263 652e 656e 636f 6465  IO(source.encode
-0000c520: 2822 7574 6638 2229 290a 2020 2020 2020  ("utf8")).      
-0000c530: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-0000c540: 2e61 7373 6572 7445 7175 616c 2872 6573  .assertEqual(res
-0000c550: 756c 742e 6578 6974 5f63 6f64 652c 2030  ult.exit_code, 0
-0000c560: 290a 2020 2020 2020 2020 6163 7475 616c  ).        actual
-0000c570: 203d 2072 6573 756c 742e 6f75 7470 7574   = result.output
-0000c580: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-0000c590: 7365 7274 466f 726d 6174 4571 7561 6c28  sertFormatEqual(
-0000c5a0: 6163 7475 616c 2c20 6578 7065 6374 6564  actual, expected
-0000c5b0: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
-0000c5c0: 7369 6e67 6c65 5f66 696c 655f 666f 7263  single_file_forc
-0000c5d0: 655f 7079 3336 2873 656c 6629 202d 3e20  e_py36(self) -> 
-0000c5e0: 4e6f 6e65 3a0a 2020 2020 2020 2020 7265  None:.        re
-0000c5f0: 675f 6d6f 6465 203d 2044 4546 4155 4c54  g_mode = DEFAULT
-0000c600: 5f4d 4f44 450a 2020 2020 2020 2020 7079  _MODE.        py
-0000c610: 3336 5f6d 6f64 6520 3d20 7265 706c 6163  36_mode = replac
-0000c620: 6528 4445 4641 554c 545f 4d4f 4445 2c20  e(DEFAULT_MODE, 
-0000c630: 7461 7267 6574 5f76 6572 7369 6f6e 733d  target_versions=
-0000c640: 5059 3336 5f56 4552 5349 4f4e 5329 0a20  PY36_VERSIONS). 
-0000c650: 2020 2020 2020 2073 6f75 7263 652c 2065         source, e
-0000c660: 7870 6563 7465 6420 3d20 7265 6164 5f64  xpected = read_d
-0000c670: 6174 6128 226d 6973 6365 6c6c 616e 656f  ata("miscellaneo
-0000c680: 7573 222c 2022 666f 7263 655f 7079 3336  us", "force_py36
-0000c690: 2229 0a20 2020 2020 2020 2077 6974 6820  ").        with 
-0000c6a0: 6361 6368 655f 6469 7228 2920 6173 2077  cache_dir() as w
-0000c6b0: 6f72 6b73 7061 6365 3a0a 2020 2020 2020  orkspace:.      
-0000c6c0: 2020 2020 2020 7061 7468 203d 2028 776f        path = (wo
-0000c6d0: 726b 7370 6163 6520 2f20 2266 696c 652e  rkspace / "file.
-0000c6e0: 7079 2229 2e72 6573 6f6c 7665 2829 0a20  py").resolve(). 
-0000c6f0: 2020 2020 2020 2020 2020 2077 6974 6820             with 
-0000c700: 6f70 656e 2870 6174 682c 2022 7722 2920  open(path, "w") 
-0000c710: 6173 2066 683a 0a20 2020 2020 2020 2020  as fh:.         
-0000c720: 2020 2020 2020 2066 682e 7772 6974 6528         fh.write(
-0000c730: 736f 7572 6365 290a 2020 2020 2020 2020  source).        
-0000c740: 2020 2020 7365 6c66 2e69 6e76 6f6b 6542      self.invokeB
-0000c750: 6c61 636b 285b 7374 7228 7061 7468 292c  lack([str(path),
-0000c760: 202a 5059 3336 5f41 5247 535d 290a 2020   *PY36_ARGS]).  
-0000c770: 2020 2020 2020 2020 2020 7769 7468 206f            with o
-0000c780: 7065 6e28 7061 7468 2c20 2272 2229 2061  pen(path, "r") a
-0000c790: 7320 6668 3a0a 2020 2020 2020 2020 2020  s fh:.          
-0000c7a0: 2020 2020 2020 6163 7475 616c 203d 2066        actual = f
-0000c7b0: 682e 7265 6164 2829 0a20 2020 2020 2020  h.read().       
-0000c7c0: 2020 2020 2023 2076 6572 6966 7920 6361       # verify ca
-0000c7d0: 6368 6520 7769 7468 202d 2d74 6172 6765  che with --targe
-0000c7e0: 742d 7665 7273 696f 6e20 6973 2073 6570  t-version is sep
-0000c7f0: 6172 6174 650a 2020 2020 2020 2020 2020  arate.          
-0000c800: 2020 7079 3336 5f63 6163 6865 203d 2063    py36_cache = c
-0000c810: 6572 6369 732e 7265 6164 5f63 6163 6865  ercis.read_cache
-0000c820: 2870 7933 365f 6d6f 6465 290a 2020 2020  (py36_mode).    
-0000c830: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-0000c840: 6572 7449 6e28 7374 7228 7061 7468 292c  ertIn(str(path),
-0000c850: 2070 7933 365f 6361 6368 6529 0a20 2020   py36_cache).   
-0000c860: 2020 2020 2020 2020 206e 6f72 6d61 6c5f           normal_
-0000c870: 6361 6368 6520 3d20 6365 7263 6973 2e72  cache = cercis.r
-0000c880: 6561 645f 6361 6368 6528 7265 675f 6d6f  ead_cache(reg_mo
-0000c890: 6465 290a 2020 2020 2020 2020 2020 2020  de).            
-0000c8a0: 7365 6c66 2e61 7373 6572 744e 6f74 496e  self.assertNotIn
-0000c8b0: 2873 7472 2870 6174 6829 2c20 6e6f 726d  (str(path), norm
-0000c8c0: 616c 5f63 6163 6865 290a 2020 2020 2020  al_cache).      
-0000c8d0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-0000c8e0: 616c 2861 6374 7561 6c2c 2065 7870 6563  al(actual, expec
-0000c8f0: 7465 6429 0a0a 2020 2020 4065 7665 6e74  ted)..    @event
-0000c900: 5f6c 6f6f 7028 290a 2020 2020 6465 6620  _loop().    def 
-0000c910: 7465 7374 5f6d 756c 7469 5f66 696c 655f  test_multi_file_
-0000c920: 666f 7263 655f 7079 3336 2873 656c 6629  force_py36(self)
-0000c930: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-0000c940: 2020 7265 675f 6d6f 6465 203d 2044 4546    reg_mode = DEF
-0000c950: 4155 4c54 5f4d 4f44 450a 2020 2020 2020  AULT_MODE.      
-0000c960: 2020 7079 3336 5f6d 6f64 6520 3d20 7265    py36_mode = re
-0000c970: 706c 6163 6528 4445 4641 554c 545f 4d4f  place(DEFAULT_MO
-0000c980: 4445 2c20 7461 7267 6574 5f76 6572 7369  DE, target_versi
-0000c990: 6f6e 733d 5059 3336 5f56 4552 5349 4f4e  ons=PY36_VERSION
-0000c9a0: 5329 0a20 2020 2020 2020 2073 6f75 7263  S).        sourc
-0000c9b0: 652c 2065 7870 6563 7465 6420 3d20 7265  e, expected = re
-0000c9c0: 6164 5f64 6174 6128 226d 6973 6365 6c6c  ad_data("miscell
-0000c9d0: 616e 656f 7573 222c 2022 666f 7263 655f  aneous", "force_
-0000c9e0: 7079 3336 2229 0a20 2020 2020 2020 2077  py36").        w
-0000c9f0: 6974 6820 6361 6368 655f 6469 7228 2920  ith cache_dir() 
-0000ca00: 6173 2077 6f72 6b73 7061 6365 3a0a 2020  as workspace:.  
-0000ca10: 2020 2020 2020 2020 2020 7061 7468 7320            paths 
-0000ca20: 3d20 5b0a 2020 2020 2020 2020 2020 2020  = [.            
-0000ca30: 2020 2020 2877 6f72 6b73 7061 6365 202f      (workspace /
-0000ca40: 2022 6669 6c65 312e 7079 2229 2e72 6573   "file1.py").res
-0000ca50: 6f6c 7665 2829 2c0a 2020 2020 2020 2020  olve(),.        
-0000ca60: 2020 2020 2020 2020 2877 6f72 6b73 7061          (workspa
-0000ca70: 6365 202f 2022 6669 6c65 322e 7079 2229  ce / "file2.py")
-0000ca80: 2e72 6573 6f6c 7665 2829 2c0a 2020 2020  .resolve(),.    
-0000ca90: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
-0000caa0: 2020 2020 2020 666f 7220 7061 7468 2069        for path i
-0000cab0: 6e20 7061 7468 733a 0a20 2020 2020 2020  n paths:.       
-0000cac0: 2020 2020 2020 2020 2077 6974 6820 6f70           with op
-0000cad0: 656e 2870 6174 682c 2022 7722 2920 6173  en(path, "w") as
-0000cae0: 2066 683a 0a20 2020 2020 2020 2020 2020   fh:.           
-0000caf0: 2020 2020 2020 2020 2066 682e 7772 6974           fh.writ
-0000cb00: 6528 736f 7572 6365 290a 2020 2020 2020  e(source).      
-0000cb10: 2020 2020 2020 7365 6c66 2e69 6e76 6f6b        self.invok
-0000cb20: 6542 6c61 636b 285b 7374 7228 7029 2066  eBlack([str(p) f
-0000cb30: 6f72 2070 2069 6e20 7061 7468 735d 202b  or p in paths] +
-0000cb40: 2050 5933 365f 4152 4753 290a 2020 2020   PY36_ARGS).    
-0000cb50: 2020 2020 2020 2020 666f 7220 7061 7468          for path
-0000cb60: 2069 6e20 7061 7468 733a 0a20 2020 2020   in paths:.     
-0000cb70: 2020 2020 2020 2020 2020 2077 6974 6820             with 
-0000cb80: 6f70 656e 2870 6174 682c 2022 7222 2920  open(path, "r") 
-0000cb90: 6173 2066 683a 0a20 2020 2020 2020 2020  as fh:.         
-0000cba0: 2020 2020 2020 2020 2020 2061 6374 7561             actua
-0000cbb0: 6c20 3d20 6668 2e72 6561 6428 290a 2020  l = fh.read().  
-0000cbc0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0000cbd0: 6c66 2e61 7373 6572 7445 7175 616c 2861  lf.assertEqual(a
-0000cbe0: 6374 7561 6c2c 2065 7870 6563 7465 6429  ctual, expected)
-0000cbf0: 0a20 2020 2020 2020 2020 2020 2023 2076  .            # v
-0000cc00: 6572 6966 7920 6361 6368 6520 7769 7468  erify cache with
-0000cc10: 202d 2d74 6172 6765 742d 7665 7273 696f   --target-versio
-0000cc20: 6e20 6973 2073 6570 6172 6174 650a 2020  n is separate.  
-0000cc30: 2020 2020 2020 2020 2020 7079 695f 6361            pyi_ca
-0000cc40: 6368 6520 3d20 6365 7263 6973 2e72 6561  che = cercis.rea
-0000cc50: 645f 6361 6368 6528 7079 3336 5f6d 6f64  d_cache(py36_mod
-0000cc60: 6529 0a20 2020 2020 2020 2020 2020 206e  e).            n
-0000cc70: 6f72 6d61 6c5f 6361 6368 6520 3d20 6365  ormal_cache = ce
-0000cc80: 7263 6973 2e72 6561 645f 6361 6368 6528  rcis.read_cache(
-0000cc90: 7265 675f 6d6f 6465 290a 2020 2020 2020  reg_mode).      
-0000cca0: 2020 2020 2020 666f 7220 7061 7468 2069        for path i
-0000ccb0: 6e20 7061 7468 733a 0a20 2020 2020 2020  n paths:.       
-0000ccc0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-0000ccd0: 7365 7274 496e 2873 7472 2870 6174 6829  sertIn(str(path)
-0000cce0: 2c20 7079 695f 6361 6368 6529 0a20 2020  , pyi_cache).   
-0000ccf0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000cd00: 662e 6173 7365 7274 4e6f 7449 6e28 7374  f.assertNotIn(st
-0000cd10: 7228 7061 7468 292c 206e 6f72 6d61 6c5f  r(path), normal_
-0000cd20: 6361 6368 6529 0a0a 2020 2020 6465 6620  cache)..    def 
-0000cd30: 7465 7374 5f70 6970 655f 666f 7263 655f  test_pipe_force_
-0000cd40: 7079 3336 2873 656c 6629 202d 3e20 4e6f  py36(self) -> No
-0000cd50: 6e65 3a0a 2020 2020 2020 2020 736f 7572  ne:.        sour
-0000cd60: 6365 2c20 6578 7065 6374 6564 203d 2072  ce, expected = r
-0000cd70: 6561 645f 6461 7461 2822 6d69 7363 656c  ead_data("miscel
-0000cd80: 6c61 6e65 6f75 7322 2c20 2266 6f72 6365  laneous", "force
-0000cd90: 5f70 7933 3622 290a 2020 2020 2020 2020  _py36").        
-0000cda0: 7265 7375 6c74 203d 2043 6c69 5275 6e6e  result = CliRunn
-0000cdb0: 6572 2829 2e69 6e76 6f6b 6528 0a20 2020  er().invoke(.   
-0000cdc0: 2020 2020 2020 2020 2063 6572 6369 732e           cercis.
-0000cdd0: 6d61 696e 2c0a 2020 2020 2020 2020 2020  main,.          
-0000cde0: 2020 5b22 2d22 2c20 222d 7122 2c20 222d    ["-", "-q", "-
-0000cdf0: 2d74 6172 6765 742d 7665 7273 696f 6e3d  -target-version=
-0000ce00: 7079 3336 225d 2c0a 2020 2020 2020 2020  py36"],.        
-0000ce10: 2020 2020 696e 7075 743d 4279 7465 7349      input=BytesI
-0000ce20: 4f28 736f 7572 6365 2e65 6e63 6f64 6528  O(source.encode(
-0000ce30: 2275 7466 3822 2929 2c0a 2020 2020 2020  "utf8")),.      
-0000ce40: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-0000ce50: 2e61 7373 6572 7445 7175 616c 2872 6573  .assertEqual(res
-0000ce60: 756c 742e 6578 6974 5f63 6f64 652c 2030  ult.exit_code, 0
-0000ce70: 290a 2020 2020 2020 2020 6163 7475 616c  ).        actual
-0000ce80: 203d 2072 6573 756c 742e 6f75 7470 7574   = result.output
-0000ce90: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
-0000cea0: 7365 7274 466f 726d 6174 4571 7561 6c28  sertFormatEqual(
-0000ceb0: 6163 7475 616c 2c20 6578 7065 6374 6564  actual, expected
-0000cec0: 290a 0a20 2020 2040 7079 7465 7374 2e6d  )..    @pytest.m
-0000ced0: 6172 6b2e 696e 636f 6d70 6174 6962 6c65  ark.incompatible
-0000cee0: 5f77 6974 685f 6d79 7079 630a 2020 2020  _with_mypyc.    
-0000cef0: 6465 6620 7465 7374 5f72 6566 6f72 6d61  def test_reforma
-0000cf00: 745f 6f6e 655f 7769 7468 5f73 7464 696e  t_one_with_stdin
-0000cf10: 2873 656c 6629 202d 3e20 4e6f 6e65 3a0a  (self) -> None:.
-0000cf20: 2020 2020 2020 2020 7769 7468 2070 6174          with pat
-0000cf30: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
-0000cf40: 2263 6572 6369 732e 666f 726d 6174 5f73  "cercis.format_s
-0000cf50: 7464 696e 5f74 6f5f 7374 646f 7574 222c  tdin_to_stdout",
-0000cf60: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0000cf70: 7572 6e5f 7661 6c75 653d 6c61 6d62 6461  urn_value=lambda
-0000cf80: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
-0000cf90: 3a20 6365 7263 6973 2e43 6861 6e67 6564  : cercis.Changed
-0000cfa0: 2e59 4553 2c0a 2020 2020 2020 2020 2920  .YES,.        ) 
-0000cfb0: 6173 2066 7374 733a 0a20 2020 2020 2020  as fsts:.       
-0000cfc0: 2020 2020 2072 6570 6f72 7420 3d20 4d61       report = Ma
-0000cfd0: 6769 634d 6f63 6b28 290a 2020 2020 2020  gicMock().      
-0000cfe0: 2020 2020 2020 7061 7468 203d 2050 6174        path = Pat
-0000cff0: 6828 222d 2229 0a20 2020 2020 2020 2020  h("-").         
-0000d000: 2020 2063 6572 6369 732e 7265 666f 726d     cercis.reform
-0000d010: 6174 5f6f 6e65 280a 2020 2020 2020 2020  at_one(.        
-0000d020: 2020 2020 2020 2020 7061 7468 2c0a 2020          path,.  
-0000d030: 2020 2020 2020 2020 2020 2020 2020 6661                fa
-0000d040: 7374 3d54 7275 652c 0a20 2020 2020 2020  st=True,.       
-0000d050: 2020 2020 2020 2020 2077 7269 7465 5f62           write_b
-0000d060: 6163 6b3d 6365 7263 6973 2e57 7269 7465  ack=cercis.Write
-0000d070: 4261 636b 2e59 4553 2c0a 2020 2020 2020  Back.YES,.      
-0000d080: 2020 2020 2020 2020 2020 6d6f 6465 3d44            mode=D
-0000d090: 4546 4155 4c54 5f4d 4f44 452c 0a20 2020  EFAULT_MODE,.   
-0000d0a0: 2020 2020 2020 2020 2020 2020 2072 6570               rep
-0000d0b0: 6f72 743d 7265 706f 7274 2c0a 2020 2020  ort=report,.    
-0000d0c0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0000d0d0: 2020 2020 2020 6673 7473 2e61 7373 6572        fsts.asser
-0000d0e0: 745f 6361 6c6c 6564 5f6f 6e63 6528 290a  t_called_once().
-0000d0f0: 2020 2020 2020 2020 2020 2020 7265 706f              repo
-0000d100: 7274 2e64 6f6e 652e 6173 7365 7274 5f63  rt.done.assert_c
-0000d110: 616c 6c65 645f 7769 7468 2870 6174 682c  alled_with(path,
-0000d120: 2063 6572 6369 732e 4368 616e 6765 642e   cercis.Changed.
-0000d130: 5945 5329 0a0a 2020 2020 4070 7974 6573  YES)..    @pytes
-0000d140: 742e 6d61 726b 2e69 6e63 6f6d 7061 7469  t.mark.incompati
-0000d150: 626c 655f 7769 7468 5f6d 7970 7963 0a20  ble_with_mypyc. 
-0000d160: 2020 2064 6566 2074 6573 745f 7265 666f     def test_refo
-0000d170: 726d 6174 5f6f 6e65 5f77 6974 685f 7374  rmat_one_with_st
-0000d180: 6469 6e5f 6669 6c65 6e61 6d65 2873 656c  din_filename(sel
-0000d190: 6629 202d 3e20 4e6f 6e65 3a0a 2020 2020  f) -> None:.    
-0000d1a0: 2020 2020 7769 7468 2070 6174 6368 280a      with patch(.
-0000d1b0: 2020 2020 2020 2020 2020 2020 2263 6572              "cer
-0000d1c0: 6369 732e 666f 726d 6174 5f73 7464 696e  cis.format_stdin
-0000d1d0: 5f74 6f5f 7374 646f 7574 222c 0a20 2020  _to_stdout",.   
-0000d1e0: 2020 2020 2020 2020 2072 6574 7572 6e5f           return_
-0000d1f0: 7661 6c75 653d 6c61 6d62 6461 202a 6172  value=lambda *ar
-0000d200: 6773 2c20 2a2a 6b77 6172 6773 3a20 6365  gs, **kwargs: ce
-0000d210: 7263 6973 2e43 6861 6e67 6564 2e59 4553  rcis.Changed.YES
-0000d220: 2c0a 2020 2020 2020 2020 2920 6173 2066  ,.        ) as f
-0000d230: 7374 733a 0a20 2020 2020 2020 2020 2020  sts:.           
-0000d240: 2072 6570 6f72 7420 3d20 4d61 6769 634d   report = MagicM
-0000d250: 6f63 6b28 290a 2020 2020 2020 2020 2020  ock().          
-0000d260: 2020 7020 3d20 2266 6f6f 2e70 7922 0a20    p = "foo.py". 
-0000d270: 2020 2020 2020 2020 2020 2070 6174 6820             path 
-0000d280: 3d20 5061 7468 2866 225f 5f42 4c41 434b  = Path(f"__BLACK
-0000d290: 5f53 5444 494e 5f46 494c 454e 414d 455f  _STDIN_FILENAME_
-0000d2a0: 5f7b 707d 2229 0a20 2020 2020 2020 2020  _{p}").         
-0000d2b0: 2020 2065 7870 6563 7465 6420 3d20 5061     expected = Pa
-0000d2c0: 7468 2870 290a 2020 2020 2020 2020 2020  th(p).          
-0000d2d0: 2020 6365 7263 6973 2e72 6566 6f72 6d61    cercis.reforma
-0000d2e0: 745f 6f6e 6528 0a20 2020 2020 2020 2020  t_one(.         
-0000d2f0: 2020 2020 2020 2070 6174 682c 0a20 2020         path,.   
-0000d300: 2020 2020 2020 2020 2020 2020 2066 6173               fas
-0000d310: 743d 5472 7565 2c0a 2020 2020 2020 2020  t=True,.        
-0000d320: 2020 2020 2020 2020 7772 6974 655f 6261          write_ba
-0000d330: 636b 3d63 6572 6369 732e 5772 6974 6542  ck=cercis.WriteB
-0000d340: 6163 6b2e 5945 532c 0a20 2020 2020 2020  ack.YES,.       
-0000d350: 2020 2020 2020 2020 206d 6f64 653d 4445           mode=DE
-0000d360: 4641 554c 545f 4d4f 4445 2c0a 2020 2020  FAULT_MODE,.    
-0000d370: 2020 2020 2020 2020 2020 2020 7265 706f              repo
-0000d380: 7274 3d72 6570 6f72 742c 0a20 2020 2020  rt=report,.     
-0000d390: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0000d3a0: 2020 2020 2066 7374 732e 6173 7365 7274       fsts.assert
-0000d3b0: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
-0000d3c0: 6828 0a20 2020 2020 2020 2020 2020 2020  h(.             
-0000d3d0: 2020 2066 6173 743d 5472 7565 2c20 7772     fast=True, wr
-0000d3e0: 6974 655f 6261 636b 3d63 6572 6369 732e  ite_back=cercis.
-0000d3f0: 5772 6974 6542 6163 6b2e 5945 532c 206d  WriteBack.YES, m
-0000d400: 6f64 653d 4445 4641 554c 545f 4d4f 4445  ode=DEFAULT_MODE
-0000d410: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0000d420: 2020 2020 2020 2020 2020 2023 205f 5f42             # __B
-0000d430: 4c41 434b 5f53 5444 494e 5f46 494c 454e  LACK_STDIN_FILEN
-0000d440: 414d 455f 5f20 7368 6f75 6c64 2068 6176  AME__ should hav
-0000d450: 6520 6265 656e 2073 7472 6970 7065 640a  e been stripped.
-0000d460: 2020 2020 2020 2020 2020 2020 7265 706f              repo
-0000d470: 7274 2e64 6f6e 652e 6173 7365 7274 5f63  rt.done.assert_c
-0000d480: 616c 6c65 645f 7769 7468 2865 7870 6563  alled_with(expec
-0000d490: 7465 642c 2063 6572 6369 732e 4368 616e  ted, cercis.Chan
-0000d4a0: 6765 642e 5945 5329 0a0a 2020 2020 4070  ged.YES)..    @p
-0000d4b0: 7974 6573 742e 6d61 726b 2e69 6e63 6f6d  ytest.mark.incom
-0000d4c0: 7061 7469 626c 655f 7769 7468 5f6d 7970  patible_with_myp
-0000d4d0: 7963 0a20 2020 2064 6566 2074 6573 745f  yc.    def test_
-0000d4e0: 7265 666f 726d 6174 5f6f 6e65 5f77 6974  reformat_one_wit
-0000d4f0: 685f 7374 6469 6e5f 6669 6c65 6e61 6d65  h_stdin_filename
-0000d500: 5f70 7969 2873 656c 6629 202d 3e20 4e6f  _pyi(self) -> No
-0000d510: 6e65 3a0a 2020 2020 2020 2020 7769 7468  ne:.        with
-0000d520: 2070 6174 6368 280a 2020 2020 2020 2020   patch(.        
-0000d530: 2020 2020 2263 6572 6369 732e 666f 726d      "cercis.form
-0000d540: 6174 5f73 7464 696e 5f74 6f5f 7374 646f  at_stdin_to_stdo
-0000d550: 7574 222c 0a20 2020 2020 2020 2020 2020  ut",.           
-0000d560: 2072 6574 7572 6e5f 7661 6c75 653d 6c61   return_value=la
-0000d570: 6d62 6461 202a 6172 6773 2c20 2a2a 6b77  mbda *args, **kw
-0000d580: 6172 6773 3a20 6365 7263 6973 2e43 6861  args: cercis.Cha
-0000d590: 6e67 6564 2e59 4553 2c0a 2020 2020 2020  nged.YES,.      
-0000d5a0: 2020 2920 6173 2066 7374 733a 0a20 2020    ) as fsts:.   
-0000d5b0: 2020 2020 2020 2020 2072 6570 6f72 7420           report 
-0000d5c0: 3d20 4d61 6769 634d 6f63 6b28 290a 2020  = MagicMock().  
-0000d5d0: 2020 2020 2020 2020 2020 7020 3d20 2266            p = "f
-0000d5e0: 6f6f 2e70 7969 220a 2020 2020 2020 2020  oo.pyi".        
-0000d5f0: 2020 2020 7061 7468 203d 2050 6174 6828      path = Path(
-0000d600: 6622 5f5f 424c 4143 4b5f 5354 4449 4e5f  f"__BLACK_STDIN_
-0000d610: 4649 4c45 4e41 4d45 5f5f 7b70 7d22 290a  FILENAME__{p}").
-0000d620: 2020 2020 2020 2020 2020 2020 6578 7065              expe
-0000d630: 6374 6564 203d 2050 6174 6828 7029 0a20  cted = Path(p). 
-0000d640: 2020 2020 2020 2020 2020 2063 6572 6369             cerci
-0000d650: 732e 7265 666f 726d 6174 5f6f 6e65 280a  s.reformat_one(.
-0000d660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d670: 7061 7468 2c0a 2020 2020 2020 2020 2020  path,.          
-0000d680: 2020 2020 2020 6661 7374 3d54 7275 652c        fast=True,
-0000d690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d6a0: 2077 7269 7465 5f62 6163 6b3d 6365 7263   write_back=cerc
-0000d6b0: 6973 2e57 7269 7465 4261 636b 2e59 4553  is.WriteBack.YES
-0000d6c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000d6d0: 2020 6d6f 6465 3d44 4546 4155 4c54 5f4d    mode=DEFAULT_M
-0000d6e0: 4f44 452c 0a20 2020 2020 2020 2020 2020  ODE,.           
-0000d6f0: 2020 2020 2072 6570 6f72 743d 7265 706f       report=repo
-0000d700: 7274 2c0a 2020 2020 2020 2020 2020 2020  rt,.            
-0000d710: 290a 2020 2020 2020 2020 2020 2020 6673  ).            fs
-0000d720: 7473 2e61 7373 6572 745f 6361 6c6c 6564  ts.assert_called
-0000d730: 5f6f 6e63 655f 7769 7468 280a 2020 2020  _once_with(.    
-0000d740: 2020 2020 2020 2020 2020 2020 6661 7374              fast
-0000d750: 3d54 7275 652c 0a20 2020 2020 2020 2020  =True,.         
-0000d760: 2020 2020 2020 2077 7269 7465 5f62 6163         write_bac
-0000d770: 6b3d 6365 7263 6973 2e57 7269 7465 4261  k=cercis.WriteBa
-0000d780: 636b 2e59 4553 2c0a 2020 2020 2020 2020  ck.YES,.        
-0000d790: 2020 2020 2020 2020 6d6f 6465 3d72 6570          mode=rep
-0000d7a0: 6c61 6365 2844 4546 4155 4c54 5f4d 4f44  lace(DEFAULT_MOD
-0000d7b0: 452c 2069 735f 7079 693d 5472 7565 292c  E, is_pyi=True),
-0000d7c0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0000d7d0: 2020 2020 2020 2020 2020 2023 205f 5f42             # __B
-0000d7e0: 4c41 434b 5f53 5444 494e 5f46 494c 454e  LACK_STDIN_FILEN
-0000d7f0: 414d 455f 5f20 7368 6f75 6c64 2068 6176  AME__ should hav
-0000d800: 6520 6265 656e 2073 7472 6970 7065 640a  e been stripped.
-0000d810: 2020 2020 2020 2020 2020 2020 7265 706f              repo
-0000d820: 7274 2e64 6f6e 652e 6173 7365 7274 5f63  rt.done.assert_c
-0000d830: 616c 6c65 645f 7769 7468 2865 7870 6563  alled_with(expec
-0000d840: 7465 642c 2063 6572 6369 732e 4368 616e  ted, cercis.Chan
-0000d850: 6765 642e 5945 5329 0a0a 2020 2020 4070  ged.YES)..    @p
-0000d860: 7974 6573 742e 6d61 726b 2e69 6e63 6f6d  ytest.mark.incom
-0000d870: 7061 7469 626c 655f 7769 7468 5f6d 7970  patible_with_myp
-0000d880: 7963 0a20 2020 2064 6566 2074 6573 745f  yc.    def test_
-0000d890: 7265 666f 726d 6174 5f6f 6e65 5f77 6974  reformat_one_wit
-0000d8a0: 685f 7374 6469 6e5f 6669 6c65 6e61 6d65  h_stdin_filename
-0000d8b0: 5f69 7079 6e62 2873 656c 6629 202d 3e20  _ipynb(self) -> 
-0000d8c0: 4e6f 6e65 3a0a 2020 2020 2020 2020 7769  None:.        wi
-0000d8d0: 7468 2070 6174 6368 280a 2020 2020 2020  th patch(.      
-0000d8e0: 2020 2020 2020 2263 6572 6369 732e 666f        "cercis.fo
-0000d8f0: 726d 6174 5f73 7464 696e 5f74 6f5f 7374  rmat_stdin_to_st
-0000d900: 646f 7574 222c 0a20 2020 2020 2020 2020  dout",.         
-0000d910: 2020 2072 6574 7572 6e5f 7661 6c75 653d     return_value=
-0000d920: 6c61 6d62 6461 202a 6172 6773 2c20 2a2a  lambda *args, **
-0000d930: 6b77 6172 6773 3a20 6365 7263 6973 2e43  kwargs: cercis.C
-0000d940: 6861 6e67 6564 2e59 4553 2c0a 2020 2020  hanged.YES,.    
-0000d950: 2020 2020 2920 6173 2066 7374 733a 0a20      ) as fsts:. 
-0000d960: 2020 2020 2020 2020 2020 2072 6570 6f72             repor
-0000d970: 7420 3d20 4d61 6769 634d 6f63 6b28 290a  t = MagicMock().
-0000d980: 2020 2020 2020 2020 2020 2020 7020 3d20              p = 
-0000d990: 2266 6f6f 2e69 7079 6e62 220a 2020 2020  "foo.ipynb".    
-0000d9a0: 2020 2020 2020 2020 7061 7468 203d 2050          path = P
-0000d9b0: 6174 6828 6622 5f5f 424c 4143 4b5f 5354  ath(f"__BLACK_ST
-0000d9c0: 4449 4e5f 4649 4c45 4e41 4d45 5f5f 7b70  DIN_FILENAME__{p
-0000d9d0: 7d22 290a 2020 2020 2020 2020 2020 2020  }").            
-0000d9e0: 6578 7065 6374 6564 203d 2050 6174 6828  expected = Path(
-0000d9f0: 7029 0a20 2020 2020 2020 2020 2020 2063  p).            c
-0000da00: 6572 6369 732e 7265 666f 726d 6174 5f6f  ercis.reformat_o
-0000da10: 6e65 280a 2020 2020 2020 2020 2020 2020  ne(.            
-0000da20: 2020 2020 7061 7468 2c0a 2020 2020 2020      path,.      
-0000da30: 2020 2020 2020 2020 2020 6661 7374 3d54            fast=T
-0000da40: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
-0000da50: 2020 2020 2077 7269 7465 5f62 6163 6b3d       write_back=
-0000da60: 6365 7263 6973 2e57 7269 7465 4261 636b  cercis.WriteBack
-0000da70: 2e59 4553 2c0a 2020 2020 2020 2020 2020  .YES,.          
-0000da80: 2020 2020 2020 6d6f 6465 3d44 4546 4155        mode=DEFAU
-0000da90: 4c54 5f4d 4f44 452c 0a20 2020 2020 2020  LT_MODE,.       
-0000daa0: 2020 2020 2020 2020 2072 6570 6f72 743d           report=
-0000dab0: 7265 706f 7274 2c0a 2020 2020 2020 2020  report,.        
-0000dac0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0000dad0: 2020 6673 7473 2e61 7373 6572 745f 6361    fsts.assert_ca
-0000dae0: 6c6c 6564 5f6f 6e63 655f 7769 7468 280a  lled_once_with(.
-0000daf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000db00: 6661 7374 3d54 7275 652c 0a20 2020 2020  fast=True,.     
-0000db10: 2020 2020 2020 2020 2020 2077 7269 7465             write
-0000db20: 5f62 6163 6b3d 6365 7263 6973 2e57 7269  _back=cercis.Wri
-0000db30: 7465 4261 636b 2e59 4553 2c0a 2020 2020  teBack.YES,.    
-0000db40: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-0000db50: 3d72 6570 6c61 6365 2844 4546 4155 4c54  =replace(DEFAULT
-0000db60: 5f4d 4f44 452c 2069 735f 6970 796e 623d  _MODE, is_ipynb=
-0000db70: 5472 7565 292c 0a20 2020 2020 2020 2020  True),.         
-0000db80: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0000db90: 2023 205f 5f42 4c41 434b 5f53 5444 494e   # __BLACK_STDIN
-0000dba0: 5f46 494c 454e 414d 455f 5f20 7368 6f75  _FILENAME__ shou
-0000dbb0: 6c64 2068 6176 6520 6265 656e 2073 7472  ld have been str
-0000dbc0: 6970 7065 640a 2020 2020 2020 2020 2020  ipped.          
-0000dbd0: 2020 7265 706f 7274 2e64 6f6e 652e 6173    report.done.as
-0000dbe0: 7365 7274 5f63 616c 6c65 645f 7769 7468  sert_called_with
-0000dbf0: 2865 7870 6563 7465 642c 2063 6572 6369  (expected, cerci
-0000dc00: 732e 4368 616e 6765 642e 5945 5329 0a0a  s.Changed.YES)..
-0000dc10: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
-0000dc20: 2e69 6e63 6f6d 7061 7469 626c 655f 7769  .incompatible_wi
-0000dc30: 7468 5f6d 7970 7963 0a20 2020 2064 6566  th_mypyc.    def
-0000dc40: 2074 6573 745f 7265 666f 726d 6174 5f6f   test_reformat_o
-0000dc50: 6e65 5f77 6974 685f 7374 6469 6e5f 616e  ne_with_stdin_an
-0000dc60: 645f 6578 6973 7469 6e67 5f70 6174 6828  d_existing_path(
-0000dc70: 7365 6c66 2920 2d3e 204e 6f6e 653a 0a20  self) -> None:. 
-0000dc80: 2020 2020 2020 2077 6974 6820 7061 7463         with patc
-0000dc90: 6828 0a20 2020 2020 2020 2020 2020 2022  h(.            "
-0000dca0: 6365 7263 6973 2e66 6f72 6d61 745f 7374  cercis.format_st
-0000dcb0: 6469 6e5f 746f 5f73 7464 6f75 7422 2c0a  din_to_stdout",.
-0000dcc0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000dcd0: 726e 5f76 616c 7565 3d6c 616d 6264 6120  rn_value=lambda 
-0000dce0: 2a61 7267 732c 202a 2a6b 7761 7267 733a  *args, **kwargs:
-0000dcf0: 2063 6572 6369 732e 4368 616e 6765 642e   cercis.Changed.
-0000dd00: 5945 532c 0a20 2020 2020 2020 2029 2061  YES,.        ) a
-0000dd10: 7320 6673 7473 3a0a 2020 2020 2020 2020  s fsts:.        
-0000dd20: 2020 2020 7265 706f 7274 203d 204d 6167      report = Mag
-0000dd30: 6963 4d6f 636b 2829 0a20 2020 2020 2020  icMock().       
-0000dd40: 2020 2020 2023 2045 7665 6e20 7769 7468       # Even with
-0000dd50: 2061 6e20 6578 6973 7469 6e67 2066 696c   an existing fil
-0000dd60: 652c 2073 696e 6365 2077 6520 6172 6520  e, since we are 
-0000dd70: 666f 7263 696e 6720 7374 6469 6e2c 2063  forcing stdin, c
-0000dd80: 6572 6369 730a 2020 2020 2020 2020 2020  ercis.          
-0000dd90: 2020 2320 7368 6f75 6c64 206f 7574 7075    # should outpu
-0000dda0: 7420 746f 2073 7464 6f75 7420 616e 6420  t to stdout and 
-0000ddb0: 6e6f 7420 6d6f 6469 6679 2074 6865 2066  not modify the f
-0000ddc0: 696c 6520 696e 706c 6163 650a 2020 2020  ile inplace.    
-0000ddd0: 2020 2020 2020 2020 7020 3d20 5448 4953          p = THIS
-0000dde0: 5f44 4952 202f 2022 6461 7461 2220 2f20  _DIR / "data" / 
-0000ddf0: 2273 696d 706c 655f 6361 7365 7322 202f  "simple_cases" /
-0000de00: 2022 636f 6c6c 6563 7469 6f6e 732e 7079   "collections.py
-0000de10: 220a 2020 2020 2020 2020 2020 2020 2320  ".            # 
-0000de20: 4d61 6b65 2073 7572 6520 6973 5f66 696c  Make sure is_fil
-0000de30: 6520 6163 7475 616c 6c79 2072 6574 7572  e actually retur
-0000de40: 6e73 2054 7275 650a 2020 2020 2020 2020  ns True.        
-0000de50: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
-0000de60: 7275 6528 702e 6973 5f66 696c 6528 2929  rue(p.is_file())
-0000de70: 0a20 2020 2020 2020 2020 2020 2070 6174  .            pat
-0000de80: 6820 3d20 5061 7468 2866 225f 5f42 4c41  h = Path(f"__BLA
-0000de90: 434b 5f53 5444 494e 5f46 494c 454e 414d  CK_STDIN_FILENAM
-0000dea0: 455f 5f7b 707d 2229 0a20 2020 2020 2020  E__{p}").       
-0000deb0: 2020 2020 2065 7870 6563 7465 6420 3d20       expected = 
-0000dec0: 5061 7468 2870 290a 2020 2020 2020 2020  Path(p).        
-0000ded0: 2020 2020 6365 7263 6973 2e72 6566 6f72      cercis.refor
-0000dee0: 6d61 745f 6f6e 6528 0a20 2020 2020 2020  mat_one(.       
-0000def0: 2020 2020 2020 2020 2070 6174 682c 0a20           path,. 
-0000df00: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000df10: 6173 743d 5472 7565 2c0a 2020 2020 2020  ast=True,.      
-0000df20: 2020 2020 2020 2020 2020 7772 6974 655f            write_
-0000df30: 6261 636b 3d63 6572 6369 732e 5772 6974  back=cercis.Writ
-0000df40: 6542 6163 6b2e 5945 532c 0a20 2020 2020  eBack.YES,.     
-0000df50: 2020 2020 2020 2020 2020 206d 6f64 653d             mode=
-0000df60: 4445 4641 554c 545f 4d4f 4445 2c0a 2020  DEFAULT_MODE,.  
-0000df70: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0000df80: 706f 7274 3d72 6570 6f72 742c 0a20 2020  port=report,.   
-0000df90: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0000dfa0: 2020 2020 2020 2066 7374 732e 6173 7365         fsts.asse
-0000dfb0: 7274 5f63 616c 6c65 645f 6f6e 6365 2829  rt_called_once()
-0000dfc0: 0a20 2020 2020 2020 2020 2020 2023 205f  .            # _
-0000dfd0: 5f42 4c41 434b 5f53 5444 494e 5f46 494c  _BLACK_STDIN_FIL
-0000dfe0: 454e 414d 455f 5f20 7368 6f75 6c64 2068  ENAME__ should h
-0000dff0: 6176 6520 6265 656e 2073 7472 6970 7065  ave been strippe
-0000e000: 640a 2020 2020 2020 2020 2020 2020 7265  d.            re
-0000e010: 706f 7274 2e64 6f6e 652e 6173 7365 7274  port.done.assert
-0000e020: 5f63 616c 6c65 645f 7769 7468 2865 7870  _called_with(exp
-0000e030: 6563 7465 642c 2063 6572 6369 732e 4368  ected, cercis.Ch
-0000e040: 616e 6765 642e 5945 5329 0a0a 2020 2020  anged.YES)..    
-0000e050: 6465 6620 7465 7374 5f72 6566 6f72 6d61  def test_reforma
-0000e060: 745f 6f6e 655f 7769 7468 5f73 7464 696e  t_one_with_stdin
-0000e070: 5f65 6d70 7479 2873 656c 6629 202d 3e20  _empty(self) -> 
-0000e080: 4e6f 6e65 3a0a 2020 2020 2020 2020 6361  None:.        ca
-0000e090: 7365 7320 3d20 5b0a 2020 2020 2020 2020  ses = [.        
-0000e0a0: 2020 2020 2822 222c 2022 2229 2c0a 2020      ("", ""),.  
-0000e0b0: 2020 2020 2020 2020 2020 2822 5c6e 222c            ("\n",
-0000e0c0: 2022 5c6e 2229 2c0a 2020 2020 2020 2020   "\n"),.        
-0000e0d0: 2020 2020 2822 5c72 5c6e 222c 2022 5c72      ("\r\n", "\r
-0000e0e0: 5c6e 2229 2c0a 2020 2020 2020 2020 2020  \n"),.          
-0000e0f0: 2020 2822 205c 7422 2c20 2222 292c 0a20    (" \t", ""),. 
-0000e100: 2020 2020 2020 2020 2020 2028 2220 5c74             (" \t
-0000e110: 5c6e 5c74 2022 2c20 225c 6e22 292c 0a20  \n\t ", "\n"),. 
-0000e120: 2020 2020 2020 2020 2020 2028 2220 5c74             (" \t
-0000e130: 5c72 5c6e 5c74 2022 2c20 225c 725c 6e22  \r\n\t ", "\r\n"
-0000e140: 292c 0a20 2020 2020 2020 205d 0a0a 2020  ),.        ]..  
-0000e150: 2020 2020 2020 6465 6620 5f6e 6577 5f77        def _new_w
-0000e160: 7261 7070 6572 280a 2020 2020 2020 2020  rapper(.        
-0000e170: 2020 2020 2020 2020 6f75 7470 7574 3a20          output: 
-0000e180: 696f 2e53 7472 696e 6749 4f2c 2069 6f5f  io.StringIO, io_
-0000e190: 5465 7874 494f 5772 6170 7065 723a 2054  TextIOWrapper: T
-0000e1a0: 7970 655b 696f 2e54 6578 7449 4f57 7261  ype[io.TextIOWra
-0000e1b0: 7070 6572 5d0a 2020 2020 2020 2020 2920  pper].        ) 
-0000e1c0: 2d3e 2043 616c 6c61 626c 655b 5b41 6e79  -> Callable[[Any
-0000e1d0: 2c20 416e 795d 2c20 696f 2e54 6578 7449  , Any], io.TextI
-0000e1e0: 4f57 7261 7070 6572 5d3a 0a20 2020 2020  OWrapper]:.     
-0000e1f0: 2020 2020 2020 2064 6566 2067 6574 5f6f         def get_o
-0000e200: 7574 7075 7428 2a61 7267 733a 2041 6e79  utput(*args: Any
-0000e210: 2c20 2a2a 6b77 6172 6773 3a20 416e 7929  , **kwargs: Any)
-0000e220: 202d 3e20 696f 2e54 6578 7449 4f57 7261   -> io.TextIOWra
-0000e230: 7070 6572 3a0a 2020 2020 2020 2020 2020  pper:.          
-0000e240: 2020 2020 2020 6966 2061 7267 7320 3d3d        if args ==
-0000e250: 2028 7379 732e 7374 646f 7574 2e62 7566   (sys.stdout.buf
-0000e260: 6665 722c 293a 0a20 2020 2020 2020 2020  fer,):.         
-0000e270: 2020 2020 2020 2020 2020 2023 2049 7427             # It'
-0000e280: 7320 6066 6f72 6d61 745f 7374 6469 6e5f  s `format_stdin_
-0000e290: 746f 5f73 7464 6f75 7428 2960 2063 616c  to_stdout()` cal
-0000e2a0: 6c69 6e67 2060 696f 2e54 6578 7449 4f57  ling `io.TextIOW
-0000e2b0: 7261 7070 6572 2829 602c 0a20 2020 2020  rapper()`,.     
-0000e2c0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0000e2d0: 2072 6574 7572 6e20 6f75 7220 6d6f 636b   return our mock
-0000e2e0: 206f 626a 6563 742e 0a20 2020 2020 2020   object..       
-0000e2f0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-0000e300: 7572 6e20 6f75 7470 7574 0a20 2020 2020  urn output.     
-0000e310: 2020 2020 2020 2020 2020 2023 2049 7427             # It'
-0000e320: 7320 736f 6d65 7468 696e 6720 656c 7365  s something else
-0000e330: 2028 692e 652e 2060 6465 636f 6465 5f62   (i.e. `decode_b
-0000e340: 7974 6573 2829 6029 2063 616c 6c69 6e67  ytes()`) calling
-0000e350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e360: 2023 2060 696f 2e54 6578 7449 4f57 7261   # `io.TextIOWra
-0000e370: 7070 6572 2829 602c 2070 6173 7320 7468  pper()`, pass th
-0000e380: 726f 7567 6820 746f 2074 6865 206f 7269  rough to the ori
-0000e390: 6769 6e61 6c20 696d 706c 656d 656e 7461  ginal implementa
-0000e3a0: 7469 6f6e 2e0a 2020 2020 2020 2020 2020  tion..          
-0000e3b0: 2020 2020 2020 2320 5365 6520 6469 7363        # See disc
-0000e3c0: 7573 7369 6f6e 2069 6e20 6874 7470 733a  ussion in https:
-0000e3d0: 2f2f 6769 7468 7562 2e63 6f6d 2f70 7366  //github.com/psf
-0000e3e0: 2f62 6c61 636b 2f70 756c 6c2f 3234 3839  /black/pull/2489
-0000e3f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e400: 2072 6574 7572 6e20 696f 5f54 6578 7449   return io_TextI
-0000e410: 4f57 7261 7070 6572 282a 6172 6773 2c20  OWrapper(*args, 
-0000e420: 2a2a 6b77 6172 6773 290a 0a20 2020 2020  **kwargs)..     
-0000e430: 2020 2020 2020 2072 6574 7572 6e20 6765         return ge
-0000e440: 745f 6f75 7470 7574 0a0a 2020 2020 2020  t_output..      
-0000e450: 2020 6d6f 6465 203d 2063 6572 6369 732e    mode = cercis.
-0000e460: 4d6f 6465 2870 7265 7669 6577 3d54 7275  Mode(preview=Tru
-0000e470: 6529 0a20 2020 2020 2020 2066 6f72 2063  e).        for c
-0000e480: 6f6e 7465 6e74 2c20 6578 7065 6374 6564  ontent, expected
-0000e490: 2069 6e20 6361 7365 733a 0a20 2020 2020   in cases:.     
-0000e4a0: 2020 2020 2020 206f 7574 7075 7420 3d20         output = 
-0000e4b0: 696f 2e53 7472 696e 6749 4f28 290a 2020  io.StringIO().  
-0000e4c0: 2020 2020 2020 2020 2020 696f 5f54 6578            io_Tex
-0000e4d0: 7449 4f57 7261 7070 6572 203d 2069 6f2e  tIOWrapper = io.
-0000e4e0: 5465 7874 494f 5772 6170 7065 720a 0a20  TextIOWrapper.. 
-0000e4f0: 2020 2020 2020 2020 2020 2077 6974 6820             with 
-0000e500: 7061 7463 6828 2269 6f2e 5465 7874 494f  patch("io.TextIO
-0000e510: 5772 6170 7065 7222 2c20 5f6e 6577 5f77  Wrapper", _new_w
-0000e520: 7261 7070 6572 286f 7574 7075 742c 2069  rapper(output, i
-0000e530: 6f5f 5465 7874 494f 5772 6170 7065 7229  o_TextIOWrapper)
-0000e540: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0000e550: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-0000e560: 2020 2020 2020 2020 2020 2020 6365 7263              cerc
-0000e570: 6973 2e66 6f72 6d61 745f 7374 6469 6e5f  is.format_stdin_
-0000e580: 746f 5f73 7464 6f75 7428 0a20 2020 2020  to_stdout(.     
-0000e590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e5a0: 2020 2066 6173 743d 5472 7565 2c0a 2020     fast=True,.  
-0000e5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e5c0: 2020 2020 2020 636f 6e74 656e 743d 636f        content=co
-0000e5d0: 6e74 656e 742c 0a20 2020 2020 2020 2020  ntent,.         
-0000e5e0: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-0000e5f0: 7269 7465 5f62 6163 6b3d 6365 7263 6973  rite_back=cercis
-0000e600: 2e57 7269 7465 4261 636b 2e59 4553 2c0a  .WriteBack.YES,.
-0000e610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e620: 2020 2020 2020 2020 6d6f 6465 3d6d 6f64          mode=mod
-0000e630: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-0000e640: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0000e650: 2020 2020 2020 2020 2065 7863 6570 7420           except 
-0000e660: 696f 2e55 6e73 7570 706f 7274 6564 4f70  io.UnsupportedOp
-0000e670: 6572 6174 696f 6e3a 0a20 2020 2020 2020  eration:.       
-0000e680: 2020 2020 2020 2020 2020 2020 2070 6173               pas
-0000e690: 7320 2023 2053 7472 696e 6749 4f20 646f  s  # StringIO do
-0000e6a0: 6573 206e 6f74 2073 7570 706f 7274 2064  es not support d
-0000e6b0: 6574 6163 680a 2020 2020 2020 2020 2020  etach.          
-0000e6c0: 2020 2020 2020 6173 7365 7274 206f 7574        assert out
-0000e6d0: 7075 742e 6765 7476 616c 7565 2829 203d  put.getvalue() =
-0000e6e0: 3d20 6578 7065 6374 6564 0a0a 2020 2020  = expected..    
-0000e6f0: 2020 2020 2320 416e 2065 6d70 7479 2073      # An empty s
-0000e700: 7472 696e 6720 6973 2074 6865 206f 6e6c  tring is the onl
-0000e710: 7920 7465 7374 2063 6173 6520 666f 7220  y test case for 
-0000e720: 6070 7265 7669 6577 3d46 616c 7365 600a  `preview=False`.
-0000e730: 2020 2020 2020 2020 6f75 7470 7574 203d          output =
-0000e740: 2069 6f2e 5374 7269 6e67 494f 2829 0a20   io.StringIO(). 
-0000e750: 2020 2020 2020 2069 6f5f 5465 7874 494f         io_TextIO
-0000e760: 5772 6170 7065 7220 3d20 696f 2e54 6578  Wrapper = io.Tex
-0000e770: 7449 4f57 7261 7070 6572 0a20 2020 2020  tIOWrapper.     
-0000e780: 2020 2077 6974 6820 7061 7463 6828 2269     with patch("i
-0000e790: 6f2e 5465 7874 494f 5772 6170 7065 7222  o.TextIOWrapper"
-0000e7a0: 2c20 5f6e 6577 5f77 7261 7070 6572 286f  , _new_wrapper(o
-0000e7b0: 7574 7075 742c 2069 6f5f 5465 7874 494f  utput, io_TextIO
-0000e7c0: 5772 6170 7065 7229 293a 0a20 2020 2020  Wrapper)):.     
-0000e7d0: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-0000e7e0: 2020 2020 2020 2020 2020 2020 6365 7263              cerc
-0000e7f0: 6973 2e66 6f72 6d61 745f 7374 6469 6e5f  is.format_stdin_
-0000e800: 746f 5f73 7464 6f75 7428 0a20 2020 2020  to_stdout(.     
-0000e810: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000e820: 6173 743d 5472 7565 2c0a 2020 2020 2020  ast=True,.      
-0000e830: 2020 2020 2020 2020 2020 2020 2020 636f                co
-0000e840: 6e74 656e 743d 2222 2c0a 2020 2020 2020  ntent="",.      
-0000e850: 2020 2020 2020 2020 2020 2020 2020 7772                wr
-0000e860: 6974 655f 6261 636b 3d63 6572 6369 732e  ite_back=cercis.
-0000e870: 5772 6974 6542 6163 6b2e 5945 532c 0a20  WriteBack.YES,. 
-0000e880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e890: 2020 206d 6f64 653d 4445 4641 554c 545f     mode=DEFAULT_
-0000e8a0: 4d4f 4445 2c0a 2020 2020 2020 2020 2020  MODE,.          
-0000e8b0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0000e8c0: 2020 2020 6578 6365 7074 2069 6f2e 556e      except io.Un
-0000e8d0: 7375 7070 6f72 7465 644f 7065 7261 7469  supportedOperati
-0000e8e0: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
-0000e8f0: 2020 2020 7061 7373 2020 2320 5374 7269      pass  # Stri
-0000e900: 6e67 494f 2064 6f65 7320 6e6f 7420 7375  ngIO does not su
-0000e910: 7070 6f72 7420 6465 7461 6368 0a20 2020  pport detach.   
-0000e920: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
-0000e930: 6f75 7470 7574 2e67 6574 7661 6c75 6528  output.getvalue(
-0000e940: 2920 3d3d 2022 220a 0a20 2020 2064 6566  ) == ""..    def
-0000e950: 2074 6573 745f 696e 7661 6c69 645f 636c   test_invalid_cl
-0000e960: 695f 7265 6765 7828 7365 6c66 2920 2d3e  i_regex(self) ->
-0000e970: 204e 6f6e 653a 0a20 2020 2020 2020 2066   None:.        f
-0000e980: 6f72 206f 7074 696f 6e20 696e 205b 222d  or option in ["-
-0000e990: 2d69 6e63 6c75 6465 222c 2022 2d2d 6578  -include", "--ex
-0000e9a0: 636c 7564 6522 2c20 222d 2d65 7874 656e  clude", "--exten
-0000e9b0: 642d 6578 636c 7564 6522 2c20 222d 2d66  d-exclude", "--f
-0000e9c0: 6f72 6365 2d65 7863 6c75 6465 225d 3a0a  orce-exclude"]:.
-0000e9d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000e9e0: 2e69 6e76 6f6b 6542 6c61 636b 285b 222d  .invokeBlack(["-
-0000e9f0: 222c 206f 7074 696f 6e2c 2022 2a2a 2829  ", option, "**()
-0000ea00: 2821 212a 2922 5d2c 2065 7869 745f 636f  (!!*)"], exit_co
-0000ea10: 6465 3d32 290a 0a20 2020 2064 6566 2074  de=2)..    def t
-0000ea20: 6573 745f 7265 7175 6972 6564 5f76 6572  est_required_ver
-0000ea30: 7369 6f6e 5f6d 6174 6368 6573 5f76 6572  sion_matches_ver
-0000ea40: 7369 6f6e 2873 656c 6629 202d 3e20 4e6f  sion(self) -> No
-0000ea50: 6e65 3a0a 2020 2020 2020 2020 7365 6c66  ne:.        self
-0000ea60: 2e69 6e76 6f6b 6542 6c61 636b 280a 2020  .invokeBlack(.  
-0000ea70: 2020 2020 2020 2020 2020 5b22 2d2d 7265            ["--re
-0000ea80: 7175 6972 6564 2d76 6572 7369 6f6e 222c  quired-version",
-0000ea90: 2063 6572 6369 732e 5f5f 7665 7273 696f   cercis.__versio
-0000eaa0: 6e5f 5f2c 2022 2d63 222c 2022 3022 5d2c  n__, "-c", "0"],
-0000eab0: 0a20 2020 2020 2020 2020 2020 2065 7869  .            exi
-0000eac0: 745f 636f 6465 3d30 2c0a 2020 2020 2020  t_code=0,.      
-0000ead0: 2020 2020 2020 6967 6e6f 7265 5f63 6f6e        ignore_con
-0000eae0: 6669 673d 5472 7565 2c0a 2020 2020 2020  fig=True,.      
-0000eaf0: 2020 290a 0a20 2020 2064 6566 2074 6573    )..    def tes
-0000eb00: 745f 7265 7175 6972 6564 5f76 6572 7369  t_required_versi
-0000eb10: 6f6e 5f6d 6174 6368 6573 5f70 6172 7469  on_matches_parti
-0000eb20: 616c 5f76 6572 7369 6f6e 2873 656c 6629  al_version(self)
-0000eb30: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-0000eb40: 2020 7365 6c66 2e69 6e76 6f6b 6542 6c61    self.invokeBla
-0000eb50: 636b 280a 2020 2020 2020 2020 2020 2020  ck(.            
-0000eb60: 5b22 2d2d 7265 7175 6972 6564 2d76 6572  ["--required-ver
-0000eb70: 7369 6f6e 222c 2063 6572 6369 732e 5f5f  sion", cercis.__
-0000eb80: 7665 7273 696f 6e5f 5f2e 7370 6c69 7428  version__.split(
-0000eb90: 222e 2229 5b30 5d2c 2022 2d63 222c 2022  ".")[0], "-c", "
-0000eba0: 3022 5d2c 0a20 2020 2020 2020 2020 2020  0"],.           
-0000ebb0: 2065 7869 745f 636f 6465 3d30 2c0a 2020   exit_code=0,.  
-0000ebc0: 2020 2020 2020 2020 2020 6967 6e6f 7265            ignore
-0000ebd0: 5f63 6f6e 6669 673d 5472 7565 2c0a 2020  _config=True,.  
-0000ebe0: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-0000ebf0: 2074 6573 745f 7265 7175 6972 6564 5f76   test_required_v
-0000ec00: 6572 7369 6f6e 5f64 6f65 735f 6e6f 745f  ersion_does_not_
-0000ec10: 6d61 7463 685f 6f6e 5f6d 696e 6f72 5f76  match_on_minor_v
-0000ec20: 6572 7369 6f6e 2873 656c 6629 202d 3e20  ersion(self) -> 
-0000ec30: 4e6f 6e65 3a0a 2020 2020 2020 2020 7365  None:.        se
-0000ec40: 6c66 2e69 6e76 6f6b 6542 6c61 636b 280a  lf.invokeBlack(.
-0000ec50: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
-0000ec60: 2020 2020 2020 2020 2020 2020 2020 222d                "-
-0000ec70: 2d72 6571 7569 7265 642d 7665 7273 696f  -required-versio
-0000ec80: 6e22 2c0a 2020 2020 2020 2020 2020 2020  n",.            
-0000ec90: 2020 2020 6365 7263 6973 2e5f 5f76 6572      cercis.__ver
-0000eca0: 7369 6f6e 5f5f 2e73 706c 6974 2822 2e22  sion__.split("."
-0000ecb0: 295b 305d 202b 2022 2e39 3939 222c 0a20  )[0] + ".999",. 
-0000ecc0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000ecd0: 2d63 222c 0a20 2020 2020 2020 2020 2020  -c",.           
-0000ece0: 2020 2020 2022 3022 2c0a 2020 2020 2020       "0",.      
-0000ecf0: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
-0000ed00: 2020 2020 2065 7869 745f 636f 6465 3d31       exit_code=1
-0000ed10: 2c0a 2020 2020 2020 2020 2020 2020 6967  ,.            ig
-0000ed20: 6e6f 7265 5f63 6f6e 6669 673d 5472 7565  nore_config=True
-0000ed30: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-0000ed40: 2064 6566 2074 6573 745f 7265 7175 6972   def test_requir
-0000ed50: 6564 5f76 6572 7369 6f6e 5f64 6f65 735f  ed_version_does_
-0000ed60: 6e6f 745f 6d61 7463 685f 7665 7273 696f  not_match_versio
-0000ed70: 6e28 7365 6c66 2920 2d3e 204e 6f6e 653a  n(self) -> None:
-0000ed80: 0a20 2020 2020 2020 2072 6573 756c 7420  .        result 
-0000ed90: 3d20 426c 6163 6b52 756e 6e65 7228 292e  = BlackRunner().
-0000eda0: 696e 766f 6b65 280a 2020 2020 2020 2020  invoke(.        
-0000edb0: 2020 2020 6365 7263 6973 2e6d 6169 6e2c      cercis.main,
-0000edc0: 0a20 2020 2020 2020 2020 2020 205b 222d  .            ["-
-0000edd0: 2d72 6571 7569 7265 642d 7665 7273 696f  -required-versio
-0000ede0: 6e22 2c20 2232 302e 3939 6222 2c20 222d  n", "20.99b", "-
-0000edf0: 6322 2c20 2230 225d 2c0a 2020 2020 2020  c", "0"],.      
-0000ee00: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-0000ee10: 2e61 7373 6572 7445 7175 616c 2872 6573  .assertEqual(res
-0000ee20: 756c 742e 6578 6974 5f63 6f64 652c 2031  ult.exit_code, 1
-0000ee30: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-0000ee40: 7373 6572 7449 6e28 2272 6571 7569 7265  ssertIn("require
-0000ee50: 6420 7665 7273 696f 6e22 2c20 7265 7375  d version", resu
-0000ee60: 6c74 2e73 7464 6572 7229 0a0a 2020 2020  lt.stderr)..    
-0000ee70: 6465 6620 7465 7374 5f70 7265 7365 7276  def test_preserv
-0000ee80: 6573 5f6c 696e 655f 656e 6469 6e67 7328  es_line_endings(
-0000ee90: 7365 6c66 2920 2d3e 204e 6f6e 653a 0a20  self) -> None:. 
-0000eea0: 2020 2020 2020 2077 6974 6820 5465 6d70         with Temp
-0000eeb0: 6f72 6172 7944 6972 6563 746f 7279 2829  oraryDirectory()
-0000eec0: 2061 7320 776f 726b 7370 6163 653a 0a20   as workspace:. 
-0000eed0: 2020 2020 2020 2020 2020 2074 6573 745f             test_
-0000eee0: 6669 6c65 203d 2050 6174 6828 776f 726b  file = Path(work
-0000eef0: 7370 6163 6529 202f 2022 7465 7374 2e70  space) / "test.p
-0000ef00: 7922 0a20 2020 2020 2020 2020 2020 2066  y".            f
-0000ef10: 6f72 206e 6c20 696e 205b 225c 6e22 2c20  or nl in ["\n", 
-0000ef20: 225c 725c 6e22 5d3a 0a20 2020 2020 2020  "\r\n"]:.       
-0000ef30: 2020 2020 2020 2020 2063 6f6e 7465 6e74           content
-0000ef40: 7320 3d20 6e6c 2e6a 6f69 6e28 5b22 6465  s = nl.join(["de
-0000ef50: 6620 6628 2020 293a 222c 2022 2020 2020  f f(  ):", "    
-0000ef60: 7061 7373 225d 290a 2020 2020 2020 2020  pass"]).        
-0000ef70: 2020 2020 2020 2020 7465 7374 5f66 696c          test_fil
-0000ef80: 652e 7772 6974 655f 6279 7465 7328 636f  e.write_bytes(co
-0000ef90: 6e74 656e 7473 2e65 6e63 6f64 6528 2929  ntents.encode())
-0000efa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000efb0: 2066 6628 7465 7374 5f66 696c 652c 2077   ff(test_file, w
-0000efc0: 7269 7465 5f62 6163 6b3d 6365 7263 6973  rite_back=cercis
-0000efd0: 2e57 7269 7465 4261 636b 2e59 4553 290a  .WriteBack.YES).
-0000efe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eff0: 7570 6461 7465 645f 636f 6e74 656e 7473  updated_contents
-0000f000: 3a20 6279 7465 7320 3d20 7465 7374 5f66  : bytes = test_f
-0000f010: 696c 652e 7265 6164 5f62 7974 6573 2829  ile.read_bytes()
-0000f020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f030: 2073 656c 662e 6173 7365 7274 496e 286e   self.assertIn(n
-0000f040: 6c2e 656e 636f 6465 2829 2c20 7570 6461  l.encode(), upda
-0000f050: 7465 645f 636f 6e74 656e 7473 290a 2020  ted_contents).  
-0000f060: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0000f070: 206e 6c20 3d3d 2022 5c6e 223a 0a20 2020   nl == "\n":.   
-0000f080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f090: 2073 656c 662e 6173 7365 7274 4e6f 7449   self.assertNotI
-0000f0a0: 6e28 6222 5c72 5c6e 222c 2075 7064 6174  n(b"\r\n", updat
-0000f0b0: 6564 5f63 6f6e 7465 6e74 7329 0a0a 2020  ed_contents)..  
-0000f0c0: 2020 6465 6620 7465 7374 5f70 7265 7365    def test_prese
-0000f0d0: 7276 6573 5f6c 696e 655f 656e 6469 6e67  rves_line_ending
-0000f0e0: 735f 7669 615f 7374 6469 6e28 7365 6c66  s_via_stdin(self
-0000f0f0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-0000f100: 2020 2066 6f72 206e 6c20 696e 205b 225c     for nl in ["\
-0000f110: 6e22 2c20 225c 725c 6e22 5d3a 0a20 2020  n", "\r\n"]:.   
-0000f120: 2020 2020 2020 2020 2063 6f6e 7465 6e74           content
-0000f130: 7320 3d20 6e6c 2e6a 6f69 6e28 5b22 6465  s = nl.join(["de
-0000f140: 6620 6628 2020 293a 222c 2022 2020 2020  f f(  ):", "    
-0000f150: 7061 7373 225d 290a 2020 2020 2020 2020  pass"]).        
-0000f160: 2020 2020 7275 6e6e 6572 203d 2042 6c61      runner = Bla
-0000f170: 636b 5275 6e6e 6572 2829 0a20 2020 2020  ckRunner().     
-0000f180: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
-0000f190: 7275 6e6e 6572 2e69 6e76 6f6b 6528 0a20  runner.invoke(. 
-0000f1a0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0000f1b0: 6572 6369 732e 6d61 696e 2c20 5b22 2d22  ercis.main, ["-"
-0000f1c0: 2c20 222d 2d66 6173 7422 5d2c 2069 6e70  , "--fast"], inp
-0000f1d0: 7574 3d42 7974 6573 494f 2863 6f6e 7465  ut=BytesIO(conte
-0000f1e0: 6e74 732e 656e 636f 6465 2822 7574 6638  nts.encode("utf8
-0000f1f0: 2229 290a 2020 2020 2020 2020 2020 2020  ")).            
-0000f200: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-0000f210: 6c66 2e61 7373 6572 7445 7175 616c 2872  lf.assertEqual(r
-0000f220: 6573 756c 742e 6578 6974 5f63 6f64 652c  esult.exit_code,
-0000f230: 2030 290a 2020 2020 2020 2020 2020 2020   0).            
-0000f240: 6f75 7470 7574 203d 2072 6573 756c 742e  output = result.
-0000f250: 7374 646f 7574 5f62 7974 6573 0a20 2020  stdout_bytes.   
-0000f260: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-0000f270: 7365 7274 496e 286e 6c2e 656e 636f 6465  sertIn(nl.encode
-0000f280: 2822 7574 6638 2229 2c20 6f75 7470 7574  ("utf8"), output
-0000f290: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-0000f2a0: 206e 6c20 3d3d 2022 5c6e 223a 0a20 2020   nl == "\n":.   
-0000f2b0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000f2c0: 662e 6173 7365 7274 4e6f 7449 6e28 6222  f.assertNotIn(b"
-0000f2d0: 5c72 5c6e 222c 206f 7574 7075 7429 0a0a  \r\n", output)..
-0000f2e0: 2020 2020 6465 6620 7465 7374 5f6e 6f72      def test_nor
-0000f2f0: 6d61 6c69 7a65 5f6c 696e 655f 656e 6469  malize_line_endi
-0000f300: 6e67 7328 7365 6c66 2920 2d3e 204e 6f6e  ngs(self) -> Non
-0000f310: 653a 0a20 2020 2020 2020 2077 6974 6820  e:.        with 
-0000f320: 5465 6d70 6f72 6172 7944 6972 6563 746f  TemporaryDirecto
-0000f330: 7279 2829 2061 7320 776f 726b 7370 6163  ry() as workspac
-0000f340: 653a 0a20 2020 2020 2020 2020 2020 2074  e:.            t
-0000f350: 6573 745f 6669 6c65 203d 2050 6174 6828  est_file = Path(
-0000f360: 776f 726b 7370 6163 6529 202f 2022 7465  workspace) / "te
-0000f370: 7374 2e70 7922 0a20 2020 2020 2020 2020  st.py".         
-0000f380: 2020 2066 6f72 2064 6174 612c 2065 7870     for data, exp
-0000f390: 6563 7465 6420 696e 2028 0a20 2020 2020  ected in (.     
-0000f3a0: 2020 2020 2020 2020 2020 2028 6222 635c             (b"c\
-0000f3b0: 725c 6e63 5c6e 2022 2c20 6222 635c 725c  r\nc\n ", b"c\r\
-0000f3c0: 6e63 5c72 5c6e 2229 2c0a 2020 2020 2020  nc\r\n"),.      
-0000f3d0: 2020 2020 2020 2020 2020 2862 226c 5c6e            (b"l\n
-0000f3e0: 6c5c 725c 6e20 222c 2062 226c 5c6e 6c5c  l\r\n ", b"l\nl\
-0000f3f0: 6e22 292c 0a20 2020 2020 2020 2020 2020  n"),.           
-0000f400: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
-0000f410: 2020 2020 7465 7374 5f66 696c 652e 7772      test_file.wr
-0000f420: 6974 655f 6279 7465 7328 6461 7461 290a  ite_bytes(data).
-0000f430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f440: 6666 2874 6573 745f 6669 6c65 2c20 7772  ff(test_file, wr
-0000f450: 6974 655f 6261 636b 3d63 6572 6369 732e  ite_back=cercis.
-0000f460: 5772 6974 6542 6163 6b2e 5945 5329 0a20  WriteBack.YES). 
-0000f470: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000f480: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-0000f490: 7465 7374 5f66 696c 652e 7265 6164 5f62  test_file.read_b
-0000f4a0: 7974 6573 2829 2c20 6578 7065 6374 6564  ytes(), expected
-0000f4b0: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
-0000f4c0: 6173 7365 7274 5f65 7175 6976 616c 656e  assert_equivalen
-0000f4d0: 745f 6469 6666 6572 656e 745f 6173 7473  t_different_asts
-0000f4e0: 2873 656c 6629 202d 3e20 4e6f 6e65 3a0a  (self) -> None:.
-0000f4f0: 2020 2020 2020 2020 7769 7468 2073 656c          with sel
-0000f500: 662e 6173 7365 7274 5261 6973 6573 2841  f.assertRaises(A
-0000f510: 7373 6572 7469 6f6e 4572 726f 7229 3a0a  ssertionError):.
-0000f520: 2020 2020 2020 2020 2020 2020 6365 7263              cerc
-0000f530: 6973 2e61 7373 6572 745f 6571 7569 7661  is.assert_equiva
-0000f540: 6c65 6e74 2822 7b7d 222c 2022 4e6f 6e65  lent("{}", "None
-0000f550: 2229 0a0a 2020 2020 6465 6620 7465 7374  ")..    def test
-0000f560: 5f73 6868 685f 636c 6963 6b28 7365 6c66  _shhh_click(self
-0000f570: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-0000f580: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-0000f590: 2020 2020 6672 6f6d 2063 6c69 636b 2069      from click i
-0000f5a0: 6d70 6f72 7420 5f75 6e69 636f 6465 6675  mport _unicodefu
-0000f5b0: 6e20 2023 2074 7970 653a 2069 676e 6f72  n  # type: ignor
-0000f5c0: 650a 2020 2020 2020 2020 6578 6365 7074  e.        except
-0000f5d0: 2049 6d70 6f72 7445 7272 6f72 3a0a 2020   ImportError:.  
-0000f5e0: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
-0000f5f0: 6b69 7054 6573 7428 2249 6e63 6f6d 7061  kipTest("Incompa
-0000f600: 7469 626c 6520 436c 6963 6b20 7665 7273  tible Click vers
-0000f610: 696f 6e22 290a 0a20 2020 2020 2020 2069  ion")..        i
-0000f620: 6620 6e6f 7420 6861 7361 7474 7228 5f75  f not hasattr(_u
-0000f630: 6e69 636f 6465 6675 6e2c 2022 5f76 6572  nicodefun, "_ver
-0000f640: 6966 795f 7079 7468 6f6e 5f65 6e76 2229  ify_python_env")
-0000f650: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-0000f660: 6c66 2e73 6b69 7054 6573 7428 2249 6e63  lf.skipTest("Inc
-0000f670: 6f6d 7061 7469 626c 6520 436c 6963 6b20  ompatible Click 
-0000f680: 7665 7273 696f 6e22 290a 0a20 2020 2020  version")..     
-0000f690: 2020 2023 2046 6972 7374 2c20 6c65 7427     # First, let'
-0000f6a0: 7320 7365 6520 6966 2043 6c69 636b 2069  s see if Click i
-0000f6b0: 7320 6372 6173 6869 6e67 2077 6974 6820  s crashing with 
-0000f6c0: 6120 7072 6566 6572 7265 6420 4153 4349  a preferred ASCI
-0000f6d0: 4920 6368 6172 7365 742e 0a20 2020 2020  I charset..     
-0000f6e0: 2020 2077 6974 6820 7061 7463 6828 226c     with patch("l
-0000f6f0: 6f63 616c 652e 6765 7470 7265 6665 7272  ocale.getpreferr
-0000f700: 6564 656e 636f 6469 6e67 2229 2061 7320  edencoding") as 
-0000f710: 6770 653a 0a20 2020 2020 2020 2020 2020  gpe:.           
-0000f720: 2067 7065 2e72 6574 7572 6e5f 7661 6c75   gpe.return_valu
-0000f730: 6520 3d20 2241 5343 4949 220a 2020 2020  e = "ASCII".    
-0000f740: 2020 2020 2020 2020 7769 7468 2073 656c          with sel
-0000f750: 662e 6173 7365 7274 5261 6973 6573 2852  f.assertRaises(R
-0000f760: 756e 7469 6d65 4572 726f 7229 3a0a 2020  untimeError):.  
-0000f770: 2020 2020 2020 2020 2020 2020 2020 5f75                _u
-0000f780: 6e69 636f 6465 6675 6e2e 5f76 6572 6966  nicodefun._verif
-0000f790: 795f 7079 7468 6f6e 5f65 6e76 2829 0a20  y_python_env(). 
-0000f7a0: 2020 2020 2020 2023 204e 6f77 2c20 6c65         # Now, le
-0000f7b0: 7427 7320 7369 6c65 6e63 6520 436c 6963  t's silence Clic
-0000f7c0: 6b2e 2e2e 0a20 2020 2020 2020 2063 6572  k....        cer
-0000f7d0: 6369 732e 7061 7463 685f 636c 6963 6b28  cis.patch_click(
-0000f7e0: 290a 2020 2020 2020 2020 2320 2e2e 2e61  ).        # ...a
-0000f7f0: 6e64 2063 6f6e 6669 726d 2069 7427 7320  nd confirm it's 
-0000f800: 7369 6c65 6e74 2e0a 2020 2020 2020 2020  silent..        
-0000f810: 7769 7468 2070 6174 6368 2822 6c6f 6361  with patch("loca
-0000f820: 6c65 2e67 6574 7072 6566 6572 7265 6465  le.getpreferrede
-0000f830: 6e63 6f64 696e 6722 2920 6173 2067 7065  ncoding") as gpe
-0000f840: 3a0a 2020 2020 2020 2020 2020 2020 6770  :.            gp
-0000f850: 652e 7265 7475 726e 5f76 616c 7565 203d  e.return_value =
-0000f860: 2022 4153 4349 4922 0a20 2020 2020 2020   "ASCII".       
-0000f870: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
-0000f880: 2020 2020 2020 2020 2020 5f75 6e69 636f            _unico
-0000f890: 6465 6675 6e2e 5f76 6572 6966 795f 7079  defun._verify_py
-0000f8a0: 7468 6f6e 5f65 6e76 2829 0a20 2020 2020  thon_env().     
-0000f8b0: 2020 2020 2020 2065 7863 6570 7420 5275         except Ru
-0000f8c0: 6e74 696d 6545 7272 6f72 2061 7320 7265  ntimeError as re
-0000f8d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000f8e0: 2020 7365 6c66 2e66 6169 6c28 6622 6070    self.fail(f"`p
-0000f8f0: 6174 6368 5f63 6c69 636b 2829 6020 6661  atch_click()` fa
-0000f900: 696c 6564 2c20 6578 6365 7074 696f 6e20  iled, exception 
-0000f910: 7374 696c 6c20 7261 6973 6564 3a20 7b72  still raised: {r
-0000f920: 657d 2229 0a0a 2020 2020 6465 6620 7465  e}")..    def te
-0000f930: 7374 5f72 6f6f 745f 6c6f 6767 6572 5f6e  st_root_logger_n
-0000f940: 6f74 5f75 7365 645f 6469 7265 6374 6c79  ot_used_directly
-0000f950: 2873 656c 6629 202d 3e20 4e6f 6e65 3a0a  (self) -> None:.
-0000f960: 2020 2020 2020 2020 6465 6620 6661 696c          def fail
-0000f970: 282a 6172 6773 3a20 416e 792c 202a 2a6b  (*args: Any, **k
-0000f980: 7761 7267 733a 2041 6e79 2920 2d3e 204e  wargs: Any) -> N
-0000f990: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0000f9a0: 2073 656c 662e 6661 696c 2822 5265 636f   self.fail("Reco
-0000f9b0: 7264 2063 7265 6174 6564 2077 6974 6820  rd created with 
-0000f9c0: 726f 6f74 206c 6f67 6765 7222 290a 0a20  root logger").. 
-0000f9d0: 2020 2020 2020 2077 6974 6820 7061 7463         with patc
-0000f9e0: 682e 6d75 6c74 6970 6c65 280a 2020 2020  h.multiple(.    
-0000f9f0: 2020 2020 2020 2020 6c6f 6767 696e 672e          logging.
-0000fa00: 726f 6f74 2c0a 2020 2020 2020 2020 2020  root,.          
-0000fa10: 2020 6465 6275 673d 6661 696c 2c0a 2020    debug=fail,.  
-0000fa20: 2020 2020 2020 2020 2020 696e 666f 3d66            info=f
-0000fa30: 6169 6c2c 0a20 2020 2020 2020 2020 2020  ail,.           
-0000fa40: 2077 6172 6e69 6e67 3d66 6169 6c2c 0a20   warning=fail,. 
-0000fa50: 2020 2020 2020 2020 2020 2065 7272 6f72             error
-0000fa60: 3d66 6169 6c2c 0a20 2020 2020 2020 2020  =fail,.         
-0000fa70: 2020 2063 7269 7469 6361 6c3d 6661 696c     critical=fail
-0000fa80: 2c0a 2020 2020 2020 2020 2020 2020 6c6f  ,.            lo
-0000fa90: 673d 6661 696c 2c0a 2020 2020 2020 2020  g=fail,.        
-0000faa0: 293a 0a20 2020 2020 2020 2020 2020 2066  ):.            f
-0000fab0: 6628 5448 4953 5f44 4952 202f 2022 7574  f(THIS_DIR / "ut
-0000fac0: 696c 2e70 7922 290a 0a20 2020 2064 6566  il.py")..    def
-0000fad0: 2074 6573 745f 696e 7661 6c69 645f 636f   test_invalid_co
-0000fae0: 6e66 6967 5f72 6574 7572 6e5f 636f 6465  nfig_return_code
-0000faf0: 2873 656c 6629 202d 3e20 4e6f 6e65 3a0a  (self) -> None:.
-0000fb00: 2020 2020 2020 2020 746d 705f 6669 6c65          tmp_file
-0000fb10: 203d 2050 6174 6828 6365 7263 6973 2e64   = Path(cercis.d
-0000fb20: 756d 705f 746f 5f66 696c 6528 2929 0a20  ump_to_file()). 
-0000fb30: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-0000fb40: 2020 2020 2020 2020 746d 705f 636f 6e66          tmp_conf
-0000fb50: 6967 203d 2050 6174 6828 6365 7263 6973  ig = Path(cercis
-0000fb60: 2e64 756d 705f 746f 5f66 696c 6528 2929  .dump_to_file())
-0000fb70: 0a20 2020 2020 2020 2020 2020 2074 6d70  .            tmp
-0000fb80: 5f63 6f6e 6669 672e 756e 6c69 6e6b 2829  _config.unlink()
-0000fb90: 0a20 2020 2020 2020 2020 2020 2061 7267  .            arg
-0000fba0: 7320 3d20 5b22 2d2d 636f 6e66 6967 222c  s = ["--config",
-0000fbb0: 2073 7472 2874 6d70 5f63 6f6e 6669 6729   str(tmp_config)
-0000fbc0: 2c20 7374 7228 746d 705f 6669 6c65 295d  , str(tmp_file)]
-0000fbd0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000fbe0: 662e 696e 766f 6b65 426c 6163 6b28 6172  f.invokeBlack(ar
-0000fbf0: 6773 2c20 6578 6974 5f63 6f64 653d 322c  gs, exit_code=2,
-0000fc00: 2069 676e 6f72 655f 636f 6e66 6967 3d46   ignore_config=F
-0000fc10: 616c 7365 290a 2020 2020 2020 2020 6669  alse).        fi
-0000fc20: 6e61 6c6c 793a 0a20 2020 2020 2020 2020  nally:.         
-0000fc30: 2020 2074 6d70 5f66 696c 652e 756e 6c69     tmp_file.unli
-0000fc40: 6e6b 2829 0a0a 2020 2020 6465 6620 7465  nk()..    def te
-0000fc50: 7374 5f70 6172 7365 5f70 7970 726f 6a65  st_parse_pyproje
-0000fc60: 6374 5f74 6f6d 6c28 7365 6c66 2920 2d3e  ct_toml(self) ->
-0000fc70: 204e 6f6e 653a 0a20 2020 2020 2020 2074   None:.        t
-0000fc80: 6573 745f 746f 6d6c 5f66 696c 6520 3d20  est_toml_file = 
-0000fc90: 5448 4953 5f44 4952 202f 2022 7465 7374  THIS_DIR / "test
-0000fca0: 2e74 6f6d 6c22 0a20 2020 2020 2020 2063  .toml".        c
-0000fcb0: 6f6e 6669 6720 3d20 6365 7263 6973 2e70  onfig = cercis.p
-0000fcc0: 6172 7365 5f70 7970 726f 6a65 6374 5f74  arse_pyproject_t
-0000fcd0: 6f6d 6c28 7374 7228 7465 7374 5f74 6f6d  oml(str(test_tom
-0000fce0: 6c5f 6669 6c65 2929 0a20 2020 2020 2020  l_file)).       
-0000fcf0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-0000fd00: 6c28 636f 6e66 6967 5b22 7665 7262 6f73  l(config["verbos
-0000fd10: 6522 5d2c 2031 290a 2020 2020 2020 2020  e"], 1).        
-0000fd20: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-0000fd30: 2863 6f6e 6669 675b 2263 6865 636b 225d  (config["check"]
-0000fd40: 2c20 226e 6f22 290a 2020 2020 2020 2020  , "no").        
-0000fd50: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-0000fd60: 2863 6f6e 6669 675b 2264 6966 6622 5d2c  (config["diff"],
-0000fd70: 2022 7922 290a 2020 2020 2020 2020 7365   "y").        se
-0000fd80: 6c66 2e61 7373 6572 7445 7175 616c 2863  lf.assertEqual(c
-0000fd90: 6f6e 6669 675b 2263 6f6c 6f72 225d 2c20  onfig["color"], 
-0000fda0: 5472 7565 290a 2020 2020 2020 2020 7365  True).        se
-0000fdb0: 6c66 2e61 7373 6572 7445 7175 616c 2863  lf.assertEqual(c
-0000fdc0: 6f6e 6669 675b 226c 696e 655f 6c65 6e67  onfig["line_leng
-0000fdd0: 7468 225d 2c20 3739 290a 2020 2020 2020  th"], 79).      
-0000fde0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-0000fdf0: 616c 2863 6f6e 6669 675b 2274 6172 6765  al(config["targe
-0000fe00: 745f 7665 7273 696f 6e22 5d2c 205b 2270  t_version"], ["p
-0000fe10: 7933 3622 2c20 2270 7933 3722 2c20 2270  y36", "py37", "p
-0000fe20: 7933 3822 5d29 0a20 2020 2020 2020 2073  y38"]).        s
-0000fe30: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-0000fe40: 636f 6e66 6967 5b22 7079 7468 6f6e 5f63  config["python_c
-0000fe50: 656c 6c5f 6d61 6769 6373 225d 2c20 5b22  ell_magics"], ["
-0000fe60: 6375 7374 6f6d 3122 2c20 2263 7573 746f  custom1", "custo
-0000fe70: 6d32 225d 290a 2020 2020 2020 2020 7365  m2"]).        se
-0000fe80: 6c66 2e61 7373 6572 7445 7175 616c 2863  lf.assertEqual(c
-0000fe90: 6f6e 6669 675b 2265 7863 6c75 6465 225d  onfig["exclude"]
-0000fea0: 2c20 7222 5c2e 7079 693f 2422 290a 2020  , r"\.pyi?$").  
-0000feb0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
-0000fec0: 7445 7175 616c 2863 6f6e 6669 675b 2269  tEqual(config["i
-0000fed0: 6e63 6c75 6465 225d 2c20 7222 5c2e 7079  nclude"], r"\.py
-0000fee0: 3f24 2229 0a0a 2020 2020 6465 6620 7465  ?$")..    def te
-0000fef0: 7374 5f70 6172 7365 5f70 7970 726f 6a65  st_parse_pyproje
-0000ff00: 6374 5f74 6f6d 6c5f 7072 6f6a 6563 745f  ct_toml_project_
-0000ff10: 6d65 7461 6461 7461 2873 656c 6629 202d  metadata(self) -
-0000ff20: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-0000ff30: 666f 7220 7465 7374 5f74 6f6d 6c2c 2065  for test_toml, e
-0000ff40: 7870 6563 7465 6420 696e 205b 0a20 2020  xpected in [.   
-0000ff50: 2020 2020 2020 2020 2028 226f 6e6c 795f           ("only_
-0000ff60: 626c 6163 6b5f 7079 7072 6f6a 6563 742e  black_pyproject.
-0000ff70: 746f 6d6c 222c 205b 2270 7933 3130 225d  toml", ["py310"]
-0000ff80: 292c 0a20 2020 2020 2020 2020 2020 2028  ),.            (
-0000ff90: 226f 6e6c 795f 6d65 7461 6461 7461 5f70  "only_metadata_p
-0000ffa0: 7970 726f 6a65 6374 2e74 6f6d 6c22 2c20  yproject.toml", 
-0000ffb0: 5b22 7079 3337 222c 2022 7079 3338 222c  ["py37", "py38",
-0000ffc0: 2022 7079 3339 222c 2022 7079 3331 3022   "py39", "py310"
-0000ffd0: 5d29 2c0a 2020 2020 2020 2020 2020 2020  ]),.            
-0000ffe0: 2822 6e65 6974 6865 725f 7079 7072 6f6a  ("neither_pyproj
-0000fff0: 6563 742e 746f 6d6c 222c 204e 6f6e 6529  ect.toml", None)
-00010000: 2c0a 2020 2020 2020 2020 2020 2020 2822  ,.            ("
-00010010: 626f 7468 5f70 7970 726f 6a65 6374 2e74  both_pyproject.t
-00010020: 6f6d 6c22 2c20 5b22 7079 3331 3022 5d29  oml", ["py310"])
-00010030: 2c0a 2020 2020 2020 2020 5d3a 0a20 2020  ,.        ]:.   
-00010040: 2020 2020 2020 2020 2074 6573 745f 746f           test_to
-00010050: 6d6c 5f66 696c 6520 3d20 5448 4953 5f44  ml_file = THIS_D
-00010060: 4952 202f 2022 6461 7461 2220 2f20 2270  IR / "data" / "p
-00010070: 726f 6a65 6374 5f6d 6574 6164 6174 6122  roject_metadata"
-00010080: 202f 2074 6573 745f 746f 6d6c 0a20 2020   / test_toml.   
-00010090: 2020 2020 2020 2020 2063 6f6e 6669 6720           config 
-000100a0: 3d20 6365 7263 6973 2e70 6172 7365 5f70  = cercis.parse_p
-000100b0: 7970 726f 6a65 6374 5f74 6f6d 6c28 7374  yproject_toml(st
-000100c0: 7228 7465 7374 5f74 6f6d 6c5f 6669 6c65  r(test_toml_file
-000100d0: 2929 0a20 2020 2020 2020 2020 2020 2073  )).            s
-000100e0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-000100f0: 636f 6e66 6967 2e67 6574 2822 7461 7267  config.get("targ
-00010100: 6574 5f76 6572 7369 6f6e 2229 2c20 6578  et_version"), ex
-00010110: 7065 6374 6564 290a 0a20 2020 2064 6566  pected)..    def
-00010120: 2074 6573 745f 696e 6665 725f 7461 7267   test_infer_targ
-00010130: 6574 5f76 6572 7369 6f6e 2873 656c 6629  et_version(self)
-00010140: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-00010150: 2020 666f 7220 7665 7273 696f 6e2c 2065    for version, e
-00010160: 7870 6563 7465 6420 696e 205b 0a20 2020  xpected in [.   
-00010170: 2020 2020 2020 2020 2028 2233 2e36 222c           ("3.6",
-00010180: 205b 5461 7267 6574 5665 7273 696f 6e2e   [TargetVersion.
-00010190: 5059 3336 5d29 2c0a 2020 2020 2020 2020  PY36]),.        
-000101a0: 2020 2020 2822 332e 3131 2e30 7263 3122      ("3.11.0rc1"
-000101b0: 2c20 5b54 6172 6765 7456 6572 7369 6f6e  , [TargetVersion
-000101c0: 2e50 5933 3131 5d29 2c0a 2020 2020 2020  .PY311]),.      
-000101d0: 2020 2020 2020 2822 3e3d 332e 3130 222c        (">=3.10",
-000101e0: 205b 5461 7267 6574 5665 7273 696f 6e2e   [TargetVersion.
-000101f0: 5059 3331 302c 2054 6172 6765 7456 6572  PY310, TargetVer
-00010200: 7369 6f6e 2e50 5933 3131 2c20 5461 7267  sion.PY311, Targ
-00010210: 6574 5665 7273 696f 6e2e 5059 3331 325d  etVersion.PY312]
-00010220: 292c 0a20 2020 2020 2020 2020 2020 2028  ),.            (
-00010230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010240: 2022 3e3d 332e 3130 2e36 222c 0a20 2020   ">=3.10.6",.   
-00010250: 2020 2020 2020 2020 2020 2020 205b 5461               [Ta
-00010260: 7267 6574 5665 7273 696f 6e2e 5059 3331  rgetVersion.PY31
-00010270: 302c 2054 6172 6765 7456 6572 7369 6f6e  0, TargetVersion
-00010280: 2e50 5933 3131 2c20 5461 7267 6574 5665  .PY311, TargetVe
-00010290: 7273 696f 6e2e 5059 3331 325d 2c0a 2020  rsion.PY312],.  
-000102a0: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
-000102b0: 2020 2020 2020 2020 2028 223c 332e 3622           ("<3.6"
-000102c0: 2c20 5b54 6172 6765 7456 6572 7369 6f6e  , [TargetVersion
-000102d0: 2e50 5933 332c 2054 6172 6765 7456 6572  .PY33, TargetVer
-000102e0: 7369 6f6e 2e50 5933 342c 2054 6172 6765  sion.PY34, Targe
-000102f0: 7456 6572 7369 6f6e 2e50 5933 355d 292c  tVersion.PY35]),
-00010300: 0a20 2020 2020 2020 2020 2020 2028 223e  .            (">
-00010310: 332e 372c 3c33 2e31 3022 2c20 5b54 6172  3.7,<3.10", [Tar
-00010320: 6765 7456 6572 7369 6f6e 2e50 5933 382c  getVersion.PY38,
-00010330: 2054 6172 6765 7456 6572 7369 6f6e 2e50   TargetVersion.P
-00010340: 5933 395d 292c 0a20 2020 2020 2020 2020  Y39]),.         
-00010350: 2020 2028 0a20 2020 2020 2020 2020 2020     (.           
-00010360: 2020 2020 2022 3e33 2e37 2c21 3d33 2e38       ">3.7,!=3.8
-00010370: 2c21 3d33 2e39 222c 0a20 2020 2020 2020  ,!=3.9",.       
-00010380: 2020 2020 2020 2020 205b 5461 7267 6574           [Target
-00010390: 5665 7273 696f 6e2e 5059 3331 302c 2054  Version.PY310, T
-000103a0: 6172 6765 7456 6572 7369 6f6e 2e50 5933  argetVersion.PY3
-000103b0: 3131 2c20 5461 7267 6574 5665 7273 696f  11, TargetVersio
-000103c0: 6e2e 5059 3331 325d 2c0a 2020 2020 2020  n.PY312],.      
-000103d0: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
-000103e0: 2020 2020 2028 0a20 2020 2020 2020 2020       (.         
-000103f0: 2020 2020 2020 2022 3e20 332e 392e 342c         "> 3.9.4,
-00010400: 2021 3d20 332e 3130 2e33 222c 0a20 2020   != 3.10.3",.   
-00010410: 2020 2020 2020 2020 2020 2020 205b 0a20               [. 
-00010420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010430: 2020 2054 6172 6765 7456 6572 7369 6f6e     TargetVersion
-00010440: 2e50 5933 392c 0a20 2020 2020 2020 2020  .PY39,.         
-00010450: 2020 2020 2020 2020 2020 2054 6172 6765             Targe
-00010460: 7456 6572 7369 6f6e 2e50 5933 3130 2c0a  tVersion.PY310,.
-00010470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010480: 2020 2020 5461 7267 6574 5665 7273 696f      TargetVersio
-00010490: 6e2e 5059 3331 312c 0a20 2020 2020 2020  n.PY311,.       
-000104a0: 2020 2020 2020 2020 2020 2020 2054 6172               Tar
-000104b0: 6765 7456 6572 7369 6f6e 2e50 5933 3132  getVersion.PY312
-000104c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000104d0: 2020 5d2c 0a20 2020 2020 2020 2020 2020    ],.           
-000104e0: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
-000104f0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00010500: 2020 2221 3d33 2e33 2c21 3d33 2e34 222c    "!=3.3,!=3.4",
-00010510: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010520: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
-00010530: 2020 2020 2020 2054 6172 6765 7456 6572         TargetVer
-00010540: 7369 6f6e 2e50 5933 352c 0a20 2020 2020  sion.PY35,.     
-00010550: 2020 2020 2020 2020 2020 2020 2020 2054                 T
-00010560: 6172 6765 7456 6572 7369 6f6e 2e50 5933  argetVersion.PY3
-00010570: 362c 0a20 2020 2020 2020 2020 2020 2020  6,.             
-00010580: 2020 2020 2020 2054 6172 6765 7456 6572         TargetVer
-00010590: 7369 6f6e 2e50 5933 372c 0a20 2020 2020  sion.PY37,.     
-000105a0: 2020 2020 2020 2020 2020 2020 2020 2054                 T
-000105b0: 6172 6765 7456 6572 7369 6f6e 2e50 5933  argetVersion.PY3
-000105c0: 382c 0a20 2020 2020 2020 2020 2020 2020  8,.             
-000105d0: 2020 2020 2020 2054 6172 6765 7456 6572         TargetVer
-000105e0: 7369 6f6e 2e50 5933 392c 0a20 2020 2020  sion.PY39,.     
-000105f0: 2020 2020 2020 2020 2020 2020 2020 2054                 T
-00010600: 6172 6765 7456 6572 7369 6f6e 2e50 5933  argetVersion.PY3
-00010610: 3130 2c0a 2020 2020 2020 2020 2020 2020  10,.            
-00010620: 2020 2020 2020 2020 5461 7267 6574 5665          TargetVe
-00010630: 7273 696f 6e2e 5059 3331 312c 0a20 2020  rsion.PY311,.   
-00010640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010650: 2054 6172 6765 7456 6572 7369 6f6e 2e50   TargetVersion.P
-00010660: 5933 3132 2c0a 2020 2020 2020 2020 2020  Y312,.          
-00010670: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
-00010680: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
-00010690: 2020 2020 280a 2020 2020 2020 2020 2020      (.          
-000106a0: 2020 2020 2020 223d 3d33 2e2a 222c 0a20        "==3.*",. 
-000106b0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-000106c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000106d0: 2020 2020 2054 6172 6765 7456 6572 7369       TargetVersi
-000106e0: 6f6e 2e50 5933 332c 0a20 2020 2020 2020  on.PY33,.       
-000106f0: 2020 2020 2020 2020 2020 2020 2054 6172               Tar
-00010700: 6765 7456 6572 7369 6f6e 2e50 5933 342c  getVersion.PY34,
-00010710: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010720: 2020 2020 2054 6172 6765 7456 6572 7369       TargetVersi
-00010730: 6f6e 2e50 5933 352c 0a20 2020 2020 2020  on.PY35,.       
-00010740: 2020 2020 2020 2020 2020 2020 2054 6172               Tar
-00010750: 6765 7456 6572 7369 6f6e 2e50 5933 362c  getVersion.PY36,
-00010760: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010770: 2020 2020 2054 6172 6765 7456 6572 7369       TargetVersi
-00010780: 6f6e 2e50 5933 372c 0a20 2020 2020 2020  on.PY37,.       
-00010790: 2020 2020 2020 2020 2020 2020 2054 6172               Tar
-000107a0: 6765 7456 6572 7369 6f6e 2e50 5933 382c  getVersion.PY38,
-000107b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000107c0: 2020 2020 2054 6172 6765 7456 6572 7369       TargetVersi
-000107d0: 6f6e 2e50 5933 392c 0a20 2020 2020 2020  on.PY39,.       
-000107e0: 2020 2020 2020 2020 2020 2020 2054 6172               Tar
-000107f0: 6765 7456 6572 7369 6f6e 2e50 5933 3130  getVersion.PY310
-00010800: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00010810: 2020 2020 2020 5461 7267 6574 5665 7273        TargetVers
-00010820: 696f 6e2e 5059 3331 312c 0a20 2020 2020  ion.PY311,.     
-00010830: 2020 2020 2020 2020 2020 2020 2020 2054                 T
-00010840: 6172 6765 7456 6572 7369 6f6e 2e50 5933  argetVersion.PY3
-00010850: 3132 2c0a 2020 2020 2020 2020 2020 2020  12,.            
-00010860: 2020 2020 5d2c 0a20 2020 2020 2020 2020      ],.         
-00010870: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
-00010880: 2020 2822 3d3d 332e 382e 2a22 2c20 5b54    ("==3.8.*", [T
-00010890: 6172 6765 7456 6572 7369 6f6e 2e50 5933  argetVersion.PY3
-000108a0: 385d 292c 0a20 2020 2020 2020 2020 2020  8]),.           
-000108b0: 2028 4e6f 6e65 2c20 4e6f 6e65 292c 0a20   (None, None),. 
-000108c0: 2020 2020 2020 2020 2020 2028 2222 2c20             ("", 
-000108d0: 4e6f 6e65 292c 0a20 2020 2020 2020 2020  None),.         
-000108e0: 2020 2028 2269 6e76 616c 6964 222c 204e     ("invalid", N
-000108f0: 6f6e 6529 2c0a 2020 2020 2020 2020 2020  one),.          
-00010900: 2020 2822 3d3d 696e 7661 6c69 6422 2c20    ("==invalid", 
-00010910: 4e6f 6e65 292c 0a20 2020 2020 2020 2020  None),.         
-00010920: 2020 2028 223e 332e 392c 213d 696e 7661     (">3.9,!=inva
-00010930: 6c69 6422 2c20 4e6f 6e65 292c 0a20 2020  lid", None),.   
-00010940: 2020 2020 2020 2020 2028 2233 222c 204e           ("3", N
-00010950: 6f6e 6529 2c0a 2020 2020 2020 2020 2020  one),.          
-00010960: 2020 2822 332e 3222 2c20 4e6f 6e65 292c    ("3.2", None),
-00010970: 0a20 2020 2020 2020 2020 2020 2028 2232  .            ("2
-00010980: 2e37 2e31 3822 2c20 4e6f 6e65 292c 0a20  .7.18", None),. 
-00010990: 2020 2020 2020 2020 2020 2028 223d 3d32             ("==2
-000109a0: 2e37 222c 204e 6f6e 6529 2c0a 2020 2020  .7", None),.    
-000109b0: 2020 2020 2020 2020 2822 3e33 2e31 302c          (">3.10,
-000109c0: 3c33 2e31 3122 2c20 4e6f 6e65 292c 0a20  <3.11", None),. 
-000109d0: 2020 2020 2020 205d 3a0a 2020 2020 2020         ]:.      
-000109e0: 2020 2020 2020 7465 7374 5f74 6f6d 6c20        test_toml 
-000109f0: 3d20 7b22 7072 6f6a 6563 7422 3a20 7b22  = {"project": {"
-00010a00: 7265 7175 6972 6573 2d70 7974 686f 6e22  requires-python"
-00010a10: 3a20 7665 7273 696f 6e7d 7d0a 2020 2020  : version}}.    
-00010a20: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
-00010a30: 2063 6572 6369 732e 6669 6c65 732e 696e   cercis.files.in
-00010a40: 6665 725f 7461 7267 6574 5f76 6572 7369  fer_target_versi
-00010a50: 6f6e 2874 6573 745f 746f 6d6c 290a 2020  on(test_toml).  
-00010a60: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-00010a70: 7373 6572 7445 7175 616c 2872 6573 756c  ssertEqual(resul
-00010a80: 742c 2065 7870 6563 7465 6429 0a0a 2020  t, expected)..  
-00010a90: 2020 6465 6620 7465 7374 5f72 6561 645f    def test_read_
-00010aa0: 7079 7072 6f6a 6563 745f 746f 6d6c 2873  pyproject_toml(s
-00010ab0: 656c 6629 202d 3e20 4e6f 6e65 3a0a 2020  elf) -> None:.  
-00010ac0: 2020 2020 2020 7465 7374 5f74 6f6d 6c5f        test_toml_
-00010ad0: 6669 6c65 203d 2054 4849 535f 4449 5220  file = THIS_DIR 
-00010ae0: 2f20 2274 6573 742e 746f 6d6c 220a 2020  / "test.toml".  
-00010af0: 2020 2020 2020 6661 6b65 5f63 7478 203d        fake_ctx =
-00010b00: 2046 616b 6543 6f6e 7465 7874 2829 0a20   FakeContext(). 
-00010b10: 2020 2020 2020 2063 6572 6369 732e 7265         cercis.re
-00010b20: 6164 5f70 7970 726f 6a65 6374 5f74 6f6d  ad_pyproject_tom
-00010b30: 6c28 6661 6b65 5f63 7478 2c20 4661 6b65  l(fake_ctx, Fake
-00010b40: 5061 7261 6d65 7465 7228 292c 2073 7472  Parameter(), str
-00010b50: 2874 6573 745f 746f 6d6c 5f66 696c 6529  (test_toml_file)
-00010b60: 290a 2020 2020 2020 2020 636f 6e66 6967  ).        config
-00010b70: 203d 2066 616b 655f 6374 782e 6465 6661   = fake_ctx.defa
-00010b80: 756c 745f 6d61 700a 2020 2020 2020 2020  ult_map.        
-00010b90: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-00010ba0: 2863 6f6e 6669 675b 2276 6572 626f 7365  (config["verbose
-00010bb0: 225d 2c20 2231 2229 0a20 2020 2020 2020  "], "1").       
-00010bc0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00010bd0: 6c28 636f 6e66 6967 5b22 6368 6563 6b22  l(config["check"
-00010be0: 5d2c 2022 6e6f 2229 0a20 2020 2020 2020  ], "no").       
-00010bf0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00010c00: 6c28 636f 6e66 6967 5b22 6469 6666 225d  l(config["diff"]
-00010c10: 2c20 2279 2229 0a20 2020 2020 2020 2073  , "y").        s
-00010c20: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
-00010c30: 636f 6e66 6967 5b22 636f 6c6f 7222 5d2c  config["color"],
-00010c40: 2022 5472 7565 2229 0a20 2020 2020 2020   "True").       
-00010c50: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00010c60: 6c28 636f 6e66 6967 5b22 6c69 6e65 5f6c  l(config["line_l
-00010c70: 656e 6774 6822 5d2c 2022 3739 2229 0a20  ength"], "79"). 
-00010c80: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
-00010c90: 7274 4571 7561 6c28 636f 6e66 6967 5b22  rtEqual(config["
-00010ca0: 7461 7267 6574 5f76 6572 7369 6f6e 225d  target_version"]
-00010cb0: 2c20 5b22 7079 3336 222c 2022 7079 3337  , ["py36", "py37
-00010cc0: 222c 2022 7079 3338 225d 290a 2020 2020  ", "py38"]).    
-00010cd0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00010ce0: 7175 616c 2863 6f6e 6669 675b 2265 7863  qual(config["exc
-00010cf0: 6c75 6465 225d 2c20 7222 5c2e 7079 693f  lude"], r"\.pyi?
-00010d00: 2422 290a 2020 2020 2020 2020 7365 6c66  $").        self
-00010d10: 2e61 7373 6572 7445 7175 616c 2863 6f6e  .assertEqual(con
-00010d20: 6669 675b 2269 6e63 6c75 6465 225d 2c20  fig["include"], 
-00010d30: 7222 5c2e 7079 3f24 2229 0a0a 2020 2020  r"\.py?$")..    
-00010d40: 4070 7974 6573 742e 6d61 726b 2e69 6e63  @pytest.mark.inc
-00010d50: 6f6d 7061 7469 626c 655f 7769 7468 5f6d  ompatible_with_m
-00010d60: 7970 7963 0a20 2020 2064 6566 2074 6573  ypyc.    def tes
-00010d70: 745f 6669 6e64 5f70 726f 6a65 6374 5f72  t_find_project_r
-00010d80: 6f6f 7428 7365 6c66 2920 2d3e 204e 6f6e  oot(self) -> Non
-00010d90: 653a 0a20 2020 2020 2020 2077 6974 6820  e:.        with 
-00010da0: 5465 6d70 6f72 6172 7944 6972 6563 746f  TemporaryDirecto
-00010db0: 7279 2829 2061 7320 776f 726b 7370 6163  ry() as workspac
-00010dc0: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-00010dd0: 6f6f 7420 3d20 5061 7468 2877 6f72 6b73  oot = Path(works
-00010de0: 7061 6365 290a 2020 2020 2020 2020 2020  pace).          
-00010df0: 2020 7465 7374 5f64 6972 203d 2072 6f6f    test_dir = roo
-00010e00: 7420 2f20 2274 6573 7422 0a20 2020 2020  t / "test".     
-00010e10: 2020 2020 2020 2074 6573 745f 6469 722e         test_dir.
-00010e20: 6d6b 6469 7228 290a 0a20 2020 2020 2020  mkdir()..       
-00010e30: 2020 2020 2073 7263 5f64 6972 203d 2072       src_dir = r
-00010e40: 6f6f 7420 2f20 2273 7263 220a 2020 2020  oot / "src".    
-00010e50: 2020 2020 2020 2020 7372 635f 6469 722e          src_dir.
-00010e60: 6d6b 6469 7228 290a 0a20 2020 2020 2020  mkdir()..       
-00010e70: 2020 2020 2072 6f6f 745f 7079 7072 6f6a       root_pyproj
-00010e80: 6563 7420 3d20 726f 6f74 202f 2022 7079  ect = root / "py
-00010e90: 7072 6f6a 6563 742e 746f 6d6c 220a 2020  project.toml".  
-00010ea0: 2020 2020 2020 2020 2020 726f 6f74 5f70            root_p
-00010eb0: 7970 726f 6a65 6374 2e74 6f75 6368 2829  yproject.touch()
-00010ec0: 0a20 2020 2020 2020 2020 2020 2073 7263  .            src
-00010ed0: 5f70 7970 726f 6a65 6374 203d 2073 7263  _pyproject = src
-00010ee0: 5f64 6972 202f 2022 7079 7072 6f6a 6563  _dir / "pyprojec
-00010ef0: 742e 746f 6d6c 220a 2020 2020 2020 2020  t.toml".        
-00010f00: 2020 2020 7372 635f 7079 7072 6f6a 6563      src_pyprojec
-00010f10: 742e 746f 7563 6828 290a 2020 2020 2020  t.touch().      
-00010f20: 2020 2020 2020 7372 635f 7079 7468 6f6e        src_python
-00010f30: 203d 2073 7263 5f64 6972 202f 2022 666f   = src_dir / "fo
-00010f40: 6f2e 7079 220a 2020 2020 2020 2020 2020  o.py".          
-00010f50: 2020 7372 635f 7079 7468 6f6e 2e74 6f75    src_python.tou
-00010f60: 6368 2829 0a0a 2020 2020 2020 2020 2020  ch()..          
-00010f70: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00010f80: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
-00010f90: 2020 2020 6365 7263 6973 2e66 696e 645f      cercis.find_
-00010fa0: 7072 6f6a 6563 745f 726f 6f74 2828 7372  project_root((sr
-00010fb0: 635f 6469 722c 2074 6573 745f 6469 7229  c_dir, test_dir)
-00010fc0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00010fd0: 2020 2028 726f 6f74 2e72 6573 6f6c 7665     (root.resolve
-00010fe0: 2829 2c20 2270 7970 726f 6a65 6374 2e74  (), "pyproject.t
-00010ff0: 6f6d 6c22 292c 0a20 2020 2020 2020 2020  oml"),.         
-00011000: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00011010: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00011020: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
-00011030: 2020 2063 6572 6369 732e 6669 6e64 5f70     cercis.find_p
-00011040: 726f 6a65 6374 5f72 6f6f 7428 2873 7263  roject_root((src
-00011050: 5f64 6972 2c29 292c 0a20 2020 2020 2020  _dir,)),.       
-00011060: 2020 2020 2020 2020 2028 7372 635f 6469           (src_di
-00011070: 722e 7265 736f 6c76 6528 292c 2022 7079  r.resolve(), "py
-00011080: 7072 6f6a 6563 742e 746f 6d6c 2229 2c0a  project.toml"),.
-00011090: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-000110a0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
-000110b0: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
-000110c0: 2020 2020 2020 2020 2020 2020 6365 7263              cerc
-000110d0: 6973 2e66 696e 645f 7072 6f6a 6563 745f  is.find_project_
-000110e0: 726f 6f74 2828 7372 635f 7079 7468 6f6e  root((src_python
-000110f0: 2c29 292c 0a20 2020 2020 2020 2020 2020  ,)),.           
-00011100: 2020 2020 2028 7372 635f 6469 722e 7265       (src_dir.re
-00011110: 736f 6c76 6528 292c 2022 7079 7072 6f6a  solve(), "pyproj
-00011120: 6563 742e 746f 6d6c 2229 2c0a 2020 2020  ect.toml"),.    
-00011130: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00011140: 2020 2020 2020 2077 6974 6820 6368 616e         with chan
-00011150: 6765 5f64 6972 6563 746f 7279 2874 6573  ge_directory(tes
-00011160: 745f 6469 7229 3a0a 2020 2020 2020 2020  t_dir):.        
-00011170: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
-00011180: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
-00011190: 2020 2020 2020 2020 2020 2020 2020 6365                ce
-000111a0: 7263 6973 2e66 696e 645f 7072 6f6a 6563  rcis.find_projec
-000111b0: 745f 726f 6f74 2828 222d 222c 292c 2073  t_root(("-",), s
-000111c0: 7464 696e 5f66 696c 656e 616d 653d 222e  tdin_filename=".
-000111d0: 2e2f 7372 632f 612e 7079 2229 2c0a 2020  ./src/a.py"),.  
-000111e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000111f0: 2020 2873 7263 5f64 6972 2e72 6573 6f6c    (src_dir.resol
-00011200: 7665 2829 2c20 2270 7970 726f 6a65 6374  ve(), "pyproject
-00011210: 2e74 6f6d 6c22 292c 0a20 2020 2020 2020  .toml"),.       
-00011220: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00011230: 4070 6174 6368 280a 2020 2020 2020 2020  @patch(.        
-00011240: 2263 6572 6369 732e 6669 6c65 732e 6669  "cercis.files.fi
-00011250: 6e64 5f75 7365 725f 7079 7072 6f6a 6563  nd_user_pyprojec
-00011260: 745f 746f 6d6c 222c 0a20 2020 2029 0a20  t_toml",.    ). 
-00011270: 2020 2064 6566 2074 6573 745f 6669 6e64     def test_find
-00011280: 5f70 7970 726f 6a65 6374 5f74 6f6d 6c28  _pyproject_toml(
-00011290: 7365 6c66 2c20 6669 6e64 5f75 7365 725f  self, find_user_
-000112a0: 7079 7072 6f6a 6563 745f 746f 6d6c 3a20  pyproject_toml: 
-000112b0: 4d61 6769 634d 6f63 6b29 202d 3e20 4e6f  MagicMock) -> No
-000112c0: 6e65 3a0a 2020 2020 2020 2020 6669 6e64  ne:.        find
-000112d0: 5f75 7365 725f 7079 7072 6f6a 6563 745f  _user_pyproject_
-000112e0: 746f 6d6c 2e73 6964 655f 6566 6665 6374  toml.side_effect
-000112f0: 203d 2052 756e 7469 6d65 4572 726f 7228   = RuntimeError(
-00011300: 290a 0a20 2020 2020 2020 2077 6974 6820  )..        with 
-00011310: 7265 6469 7265 6374 5f73 7464 6572 7228  redirect_stderr(
-00011320: 696f 2e53 7472 696e 6749 4f28 2929 2061  io.StringIO()) a
-00011330: 7320 7374 6465 7272 3a0a 2020 2020 2020  s stderr:.      
-00011340: 2020 2020 2020 7265 7375 6c74 203d 2063        result = c
-00011350: 6572 6369 732e 6669 6c65 732e 6669 6e64  ercis.files.find
-00011360: 5f70 7970 726f 6a65 6374 5f74 6f6d 6c28  _pyproject_toml(
-00011370: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011380: 2070 6174 685f 7365 6172 6368 5f73 7461   path_search_sta
-00011390: 7274 3d28 7374 7228 5061 7468 2e63 7764  rt=(str(Path.cwd
-000113a0: 2829 2e72 6f6f 7429 2c29 0a20 2020 2020  ().root),).     
-000113b0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-000113c0: 2020 6173 7365 7274 2072 6573 756c 7420    assert result 
-000113d0: 6973 204e 6f6e 650a 2020 2020 2020 2020  is None.        
-000113e0: 6572 7220 3d20 7374 6465 7272 2e67 6574  err = stderr.get
-000113f0: 7661 6c75 6528 290a 2020 2020 2020 2020  value().        
-00011400: 6173 7365 7274 2022 4967 6e6f 7269 6e67  assert "Ignoring
-00011410: 2075 7365 7220 636f 6e66 6967 7572 6174   user configurat
-00011420: 696f 6e22 2069 6e20 6572 720a 0a20 2020  ion" in err..   
-00011430: 2040 7061 7463 6828 0a20 2020 2020 2020   @patch(.       
-00011440: 2022 6365 7263 6973 2e66 696c 6573 2e66   "cercis.files.f
-00011450: 696e 645f 7573 6572 5f70 7970 726f 6a65  ind_user_pyproje
-00011460: 6374 5f74 6f6d 6c22 2c0a 2020 2020 2020  ct_toml",.      
-00011470: 2020 6365 7263 6973 2e66 696c 6573 2e66    cercis.files.f
-00011480: 696e 645f 7573 6572 5f70 7970 726f 6a65  ind_user_pyproje
-00011490: 6374 5f74 6f6d 6c2e 5f5f 7772 6170 7065  ct_toml.__wrappe
-000114a0: 645f 5f2c 0a20 2020 2029 0a20 2020 2064  d__,.    ).    d
-000114b0: 6566 2074 6573 745f 6669 6e64 5f75 7365  ef test_find_use
-000114c0: 725f 7079 7072 6f6a 6563 745f 746f 6d6c  r_pyproject_toml
-000114d0: 5f6c 696e 7578 2873 656c 6629 202d 3e20  _linux(self) -> 
-000114e0: 4e6f 6e65 3a0a 2020 2020 2020 2020 6966  None:.        if
-000114f0: 2073 7973 7465 6d28 2920 3d3d 2022 5769   system() == "Wi
-00011500: 6e64 6f77 7322 3a0a 2020 2020 2020 2020  ndows":.        
-00011510: 2020 2020 7265 7475 726e 0a0a 2020 2020      return..    
-00011520: 2020 2020 2320 5465 7374 2069 6620 5844      # Test if XD
-00011530: 475f 434f 4e46 4947 5f48 4f4d 4520 6973  G_CONFIG_HOME is
-00011540: 2063 6865 636b 6564 0a20 2020 2020 2020   checked.       
-00011550: 2077 6974 6820 5465 6d70 6f72 6172 7944   with TemporaryD
-00011560: 6972 6563 746f 7279 2829 2061 7320 776f  irectory() as wo
-00011570: 726b 7370 6163 653a 0a20 2020 2020 2020  rkspace:.       
-00011580: 2020 2020 2074 6d70 5f75 7365 725f 636f       tmp_user_co
-00011590: 6e66 6967 203d 2050 6174 6828 776f 726b  nfig = Path(work
-000115a0: 7370 6163 6529 202f 2022 6365 7263 6973  space) / "cercis
-000115b0: 220a 2020 2020 2020 2020 2020 2020 7769  ".            wi
-000115c0: 7468 2070 6174 6368 2e64 6963 7428 226f  th patch.dict("o
-000115d0: 732e 656e 7669 726f 6e22 2c20 7b22 5844  s.environ", {"XD
-000115e0: 475f 434f 4e46 4947 5f48 4f4d 4522 3a20  G_CONFIG_HOME": 
-000115f0: 776f 726b 7370 6163 657d 293a 0a20 2020  workspace}):.   
-00011600: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00011610: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
-00011620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011630: 2020 2063 6572 6369 732e 6669 6c65 732e     cercis.files.
-00011640: 6669 6e64 5f75 7365 725f 7079 7072 6f6a  find_user_pyproj
-00011650: 6563 745f 746f 6d6c 2829 2c20 746d 705f  ect_toml(), tmp_
-00011660: 7573 6572 5f63 6f6e 6669 672e 7265 736f  user_config.reso
-00011670: 6c76 6528 290a 2020 2020 2020 2020 2020  lve().          
-00011680: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00011690: 2023 2054 6573 7420 6661 6c6c 6261 636b   # Test fallback
-000116a0: 2066 6f72 2058 4447 5f43 4f4e 4649 475f   for XDG_CONFIG_
-000116b0: 484f 4d45 0a20 2020 2020 2020 2077 6974  HOME.        wit
-000116c0: 6820 7061 7463 682e 6469 6374 2822 6f73  h patch.dict("os
-000116d0: 2e65 6e76 6972 6f6e 2229 3a0a 2020 2020  .environ"):.    
-000116e0: 2020 2020 2020 2020 6f73 2e65 6e76 6972          os.envir
-000116f0: 6f6e 2e70 6f70 2822 5844 475f 434f 4e46  on.pop("XDG_CONF
-00011700: 4947 5f48 4f4d 4522 2c20 4e6f 6e65 290a  IG_HOME", None).
-00011710: 2020 2020 2020 2020 2020 2020 6661 6c6c              fall
-00011720: 6261 636b 5f75 7365 725f 636f 6e66 6967  back_user_config
-00011730: 203d 2050 6174 6828 227e 2f2e 636f 6e66   = Path("~/.conf
-00011740: 6967 2229 2e65 7870 616e 6475 7365 7228  ig").expanduser(
-00011750: 2920 2f20 2263 6572 6369 7322 0a20 2020  ) / "cercis".   
-00011760: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
-00011770: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
-00011780: 2020 2020 2020 2020 2020 2063 6572 6369             cerci
-00011790: 732e 6669 6c65 732e 6669 6e64 5f75 7365  s.files.find_use
-000117a0: 725f 7079 7072 6f6a 6563 745f 746f 6d6c  r_pyproject_toml
-000117b0: 2829 2c20 6661 6c6c 6261 636b 5f75 7365  (), fallback_use
-000117c0: 725f 636f 6e66 6967 2e72 6573 6f6c 7665  r_config.resolve
-000117d0: 2829 0a20 2020 2020 2020 2020 2020 2029  ().            )
-000117e0: 0a0a 2020 2020 6465 6620 7465 7374 5f66  ..    def test_f
-000117f0: 696e 645f 7573 6572 5f70 7970 726f 6a65  ind_user_pyproje
-00011800: 6374 5f74 6f6d 6c5f 7769 6e64 6f77 7328  ct_toml_windows(
-00011810: 7365 6c66 2920 2d3e 204e 6f6e 653a 0a20  self) -> None:. 
-00011820: 2020 2020 2020 2069 6620 7379 7374 656d         if system
-00011830: 2829 2021 3d20 2257 696e 646f 7773 223a  () != "Windows":
-00011840: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00011850: 7572 6e0a 0a20 2020 2020 2020 2075 7365  urn..        use
-00011860: 725f 636f 6e66 6967 5f70 6174 6820 3d20  r_config_path = 
-00011870: 5061 7468 2e68 6f6d 6528 2920 2f20 222e  Path.home() / ".
-00011880: 6365 7263 6973 220a 2020 2020 2020 2020  cercis".        
-00011890: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
-000118a0: 280a 2020 2020 2020 2020 2020 2020 6365  (.            ce
-000118b0: 7263 6973 2e66 696c 6573 2e66 696e 645f  rcis.files.find_
-000118c0: 7573 6572 5f70 7970 726f 6a65 6374 5f74  user_pyproject_t
-000118d0: 6f6d 6c28 292c 2075 7365 725f 636f 6e66  oml(), user_conf
-000118e0: 6967 5f70 6174 682e 7265 736f 6c76 6528  ig_path.resolve(
-000118f0: 290a 2020 2020 2020 2020 290a 0a20 2020  ).        )..   
-00011900: 2064 6566 2074 6573 745f 6270 6f5f 3333   def test_bpo_33
-00011910: 3636 305f 776f 726b 6172 6f75 6e64 2873  660_workaround(s
-00011920: 656c 6629 202d 3e20 4e6f 6e65 3a0a 2020  elf) -> None:.  
-00011930: 2020 2020 2020 6966 2073 7973 7465 6d28        if system(
-00011940: 2920 3d3d 2022 5769 6e64 6f77 7322 3a0a  ) == "Windows":.
-00011950: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00011960: 726e 0a0a 2020 2020 2020 2020 2320 6874  rn..        # ht
-00011970: 7470 733a 2f2f 6275 6773 2e70 7974 686f  tps://bugs.pytho
-00011980: 6e2e 6f72 672f 6973 7375 6533 3336 3630  n.org/issue33660
-00011990: 0a20 2020 2020 2020 2072 6f6f 7420 3d20  .        root = 
-000119a0: 5061 7468 2822 2f22 290a 2020 2020 2020  Path("/").      
-000119b0: 2020 7769 7468 2063 6861 6e67 655f 6469    with change_di
-000119c0: 7265 6374 6f72 7928 726f 6f74 293a 0a20  rectory(root):. 
-000119d0: 2020 2020 2020 2020 2020 2070 6174 6820             path 
-000119e0: 3d20 5061 7468 2822 776f 726b 7370 6163  = Path("workspac
-000119f0: 6522 2920 2f20 2270 726f 6a65 6374 220a  e") / "project".
-00011a00: 2020 2020 2020 2020 2020 2020 7265 706f              repo
-00011a10: 7274 203d 2063 6572 6369 732e 5265 706f  rt = cercis.Repo
-00011a20: 7274 2876 6572 626f 7365 3d54 7275 6529  rt(verbose=True)
-00011a30: 0a20 2020 2020 2020 2020 2020 206e 6f72  .            nor
-00011a40: 6d61 6c69 7a65 645f 7061 7468 203d 2063  malized_path = c
-00011a50: 6572 6369 732e 6e6f 726d 616c 697a 655f  ercis.normalize_
-00011a60: 7061 7468 5f6d 6179 6265 5f69 676e 6f72  path_maybe_ignor
-00011a70: 6528 7061 7468 2c20 726f 6f74 2c20 7265  e(path, root, re
-00011a80: 706f 7274 290a 2020 2020 2020 2020 2020  port).          
-00011a90: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
-00011aa0: 616c 286e 6f72 6d61 6c69 7a65 645f 7061  al(normalized_pa
-00011ab0: 7468 2c20 2277 6f72 6b73 7061 6365 2f70  th, "workspace/p
-00011ac0: 726f 6a65 6374 2229 0a0a 2020 2020 6465  roject")..    de
-00011ad0: 6620 7465 7374 5f6e 6f72 6d61 6c69 7a65  f test_normalize
-00011ae0: 5f70 6174 685f 6967 6e6f 7265 5f77 696e  _path_ignore_win
-00011af0: 646f 7773 5f6a 756e 6374 696f 6e73 5f6f  dows_junctions_o
-00011b00: 7574 7369 6465 5f6f 665f 726f 6f74 2873  utside_of_root(s
-00011b10: 656c 6629 202d 3e20 4e6f 6e65 3a0a 2020  elf) -> None:.  
-00011b20: 2020 2020 2020 6966 2073 7973 7465 6d28        if system(
-00011b30: 2920 213d 2022 5769 6e64 6f77 7322 3a0a  ) != "Windows":.
-00011b40: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00011b50: 726e 0a0a 2020 2020 2020 2020 7769 7468  rn..        with
-00011b60: 2054 656d 706f 7261 7279 4469 7265 6374   TemporaryDirect
-00011b70: 6f72 7928 2920 6173 2077 6f72 6b73 7061  ory() as workspa
-00011b80: 6365 3a0a 2020 2020 2020 2020 2020 2020  ce:.            
-00011b90: 726f 6f74 203d 2050 6174 6828 776f 726b  root = Path(work
-00011ba0: 7370 6163 6529 0a20 2020 2020 2020 2020  space).         
-00011bb0: 2020 206a 756e 6374 696f 6e5f 6469 7220     junction_dir 
-00011bc0: 3d20 726f 6f74 202f 2022 6a75 6e63 7469  = root / "juncti
-00011bd0: 6f6e 220a 2020 2020 2020 2020 2020 2020  on".            
-00011be0: 6a75 6e63 7469 6f6e 5f74 6172 6765 745f  junction_target_
-00011bf0: 6f75 7473 6964 655f 6f66 5f72 6f6f 7420  outside_of_root 
-00011c00: 3d20 726f 6f74 202f 2022 2e2e 220a 2020  = root / "..".  
-00011c10: 2020 2020 2020 2020 2020 6f73 2e73 7973            os.sys
-00011c20: 7465 6d28 6622 6d6b 6c69 6e6b 202f 4a20  tem(f"mklink /J 
-00011c30: 7b6a 756e 6374 696f 6e5f 6469 727d 207b  {junction_dir} {
-00011c40: 6a75 6e63 7469 6f6e 5f74 6172 6765 745f  junction_target_
-00011c50: 6f75 7473 6964 655f 6f66 5f72 6f6f 747d  outside_of_root}
-00011c60: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
-00011c70: 7265 706f 7274 203d 2063 6572 6369 732e  report = cercis.
-00011c80: 5265 706f 7274 2876 6572 626f 7365 3d54  Report(verbose=T
-00011c90: 7275 6529 0a20 2020 2020 2020 2020 2020  rue).           
-00011ca0: 206e 6f72 6d61 6c69 7a65 645f 7061 7468   normalized_path
-00011cb0: 203d 2063 6572 6369 732e 6e6f 726d 616c   = cercis.normal
-00011cc0: 697a 655f 7061 7468 5f6d 6179 6265 5f69  ize_path_maybe_i
-00011cd0: 676e 6f72 6528 0a20 2020 2020 2020 2020  gnore(.         
-00011ce0: 2020 2020 2020 206a 756e 6374 696f 6e5f         junction_
-00011cf0: 6469 722c 2072 6f6f 742c 2072 6570 6f72  dir, root, repor
-00011d00: 740a 2020 2020 2020 2020 2020 2020 290a  t.            ).
-00011d10: 2020 2020 2020 2020 2020 2020 2320 4d61              # Ma
-00011d20: 6e75 616c 6c79 2064 656c 6574 6520 666f  nually delete fo
-00011d30: 7220 5079 7468 6f6e 203c 2033 2e38 0a20  r Python < 3.8. 
-00011d40: 2020 2020 2020 2020 2020 206f 732e 7379             os.sy
-00011d50: 7374 656d 2866 2272 6d64 6972 207b 6a75  stem(f"rmdir {ju
-00011d60: 6e63 7469 6f6e 5f64 6972 7d22 290a 0a20  nction_dir}").. 
-00011d70: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00011d80: 6173 7365 7274 4571 7561 6c28 6e6f 726d  assertEqual(norm
-00011d90: 616c 697a 6564 5f70 6174 682c 204e 6f6e  alized_path, Non
-00011da0: 6529 0a0a 2020 2020 6465 6620 7465 7374  e)..    def test
-00011db0: 5f6e 6577 6c69 6e65 5f63 6f6d 6d65 6e74  _newline_comment
-00011dc0: 5f69 6e74 6572 6163 7469 6f6e 2873 656c  _interaction(sel
-00011dd0: 6629 202d 3e20 4e6f 6e65 3a0a 2020 2020  f) -> None:.    
-00011de0: 2020 2020 736f 7572 6365 203d 2022 636c      source = "cl
-00011df0: 6173 7320 413a 5c5c 5c72 5c6e 2320 7479  ass A:\\\r\n# ty
-00011e00: 7065 3a20 6967 6e6f 7265 5c6e 2070 6173  pe: ignore\n pas
-00011e10: 735c 6e22 0a20 2020 2020 2020 206f 7574  s\n".        out
-00011e20: 7075 7420 3d20 6365 7263 6973 2e66 6f72  put = cercis.for
-00011e30: 6d61 745f 7374 7228 736f 7572 6365 2c20  mat_str(source, 
-00011e40: 6d6f 6465 3d44 4546 4155 4c54 5f4d 4f44  mode=DEFAULT_MOD
-00011e50: 4529 0a20 2020 2020 2020 2063 6572 6369  E).        cerci
-00011e60: 732e 6173 7365 7274 5f73 7461 626c 6528  s.assert_stable(
-00011e70: 736f 7572 6365 2c20 6f75 7470 7574 2c20  source, output, 
-00011e80: 6d6f 6465 3d44 4546 4155 4c54 5f4d 4f44  mode=DEFAULT_MOD
-00011e90: 4529 0a0a 2020 2020 6465 6620 7465 7374  E)..    def test
-00011ea0: 5f62 706f 5f32 3134 325f 776f 726b 6172  _bpo_2142_workar
-00011eb0: 6f75 6e64 2873 656c 6629 202d 3e20 4e6f  ound(self) -> No
-00011ec0: 6e65 3a0a 2020 2020 2020 2020 2320 6874  ne:.        # ht
-00011ed0: 7470 733a 2f2f 6275 6773 2e70 7974 686f  tps://bugs.pytho
-00011ee0: 6e2e 6f72 672f 6973 7375 6532 3134 320a  n.org/issue2142.
-00011ef0: 0a20 2020 2020 2020 2073 6f75 7263 652c  .        source,
-00011f00: 205f 203d 2072 6561 645f 6461 7461 2822   _ = read_data("
-00011f10: 6d69 7363 656c 6c61 6e65 6f75 7322 2c20  miscellaneous", 
-00011f20: 226d 6973 7369 6e67 5f66 696e 616c 5f6e  "missing_final_n
-00011f30: 6577 6c69 6e65 2229 0a20 2020 2020 2020  ewline").       
-00011f40: 2023 2072 6561 645f 6461 7461 2061 6464   # read_data add
-00011f50: 7320 6120 7472 6169 6c69 6e67 206e 6577  s a trailing new
-00011f60: 6c69 6e65 0a20 2020 2020 2020 2073 6f75  line.        sou
-00011f70: 7263 6520 3d20 736f 7572 6365 2e72 7374  rce = source.rst
-00011f80: 7269 7028 290a 2020 2020 2020 2020 6578  rip().        ex
-00011f90: 7065 6374 6564 2c20 5f20 3d20 7265 6164  pected, _ = read
-00011fa0: 5f64 6174 6128 226d 6973 6365 6c6c 616e  _data("miscellan
-00011fb0: 656f 7573 222c 2022 6d69 7373 696e 675f  eous", "missing_
-00011fc0: 6669 6e61 6c5f 6e65 776c 696e 652e 6469  final_newline.di
-00011fd0: 6666 2229 0a20 2020 2020 2020 2074 6d70  ff").        tmp
-00011fe0: 5f66 696c 6520 3d20 5061 7468 2863 6572  _file = Path(cer
-00011ff0: 6369 732e 6475 6d70 5f74 6f5f 6669 6c65  cis.dump_to_file
-00012000: 2873 6f75 7263 652c 2065 6e73 7572 655f  (source, ensure_
-00012010: 6669 6e61 6c5f 6e65 776c 696e 653d 4661  final_newline=Fa
-00012020: 6c73 6529 290a 2020 2020 2020 2020 6469  lse)).        di
-00012030: 6666 5f68 6561 6465 7220 3d20 7265 2e63  ff_header = re.c
-00012040: 6f6d 7069 6c65 280a 2020 2020 2020 2020  ompile(.        
-00012050: 2020 2020 7266 227b 7265 2e65 7363 6170      rf"{re.escap
-00012060: 6528 7374 7228 746d 705f 6669 6c65 2929  e(str(tmp_file))
-00012070: 7d5c 745c 645c 645c 645c 642d 5c64 5c64  }\t\d\d\d\d-\d\d
-00012080: 2d5c 645c 6420 220a 2020 2020 2020 2020  -\d\d ".        
-00012090: 2020 2020 7222 5c64 5c64 3a5c 645c 643a      r"\d\d:\d\d:
-000120a0: 5c64 5c64 5c2e 5c64 5c64 5c64 5c64 5c64  \d\d\.\d\d\d\d\d
-000120b0: 5c64 5c2b 5c64 5c64 3a5c 645c 6422 0a20  \d\+\d\d:\d\d". 
-000120c0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000120d0: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
-000120e0: 2020 7265 7375 6c74 203d 2042 6c61 636b    result = Black
-000120f0: 5275 6e6e 6572 2829 2e69 6e76 6f6b 6528  Runner().invoke(
-00012100: 6365 7263 6973 2e6d 6169 6e2c 205b 222d  cercis.main, ["-
-00012110: 2d64 6966 6622 2c20 7374 7228 746d 705f  -diff", str(tmp_
-00012120: 6669 6c65 295d 290a 2020 2020 2020 2020  file)]).        
-00012130: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
-00012140: 7175 616c 2872 6573 756c 742e 6578 6974  qual(result.exit
-00012150: 5f63 6f64 652c 2030 290a 2020 2020 2020  _code, 0).      
-00012160: 2020 6669 6e61 6c6c 793a 0a20 2020 2020    finally:.     
-00012170: 2020 2020 2020 206f 732e 756e 6c69 6e6b         os.unlink
-00012180: 2874 6d70 5f66 696c 6529 0a20 2020 2020  (tmp_file).     
-00012190: 2020 2061 6374 7561 6c20 3d20 7265 7375     actual = resu
-000121a0: 6c74 2e6f 7574 7075 740a 2020 2020 2020  lt.output.      
-000121b0: 2020 6163 7475 616c 203d 2064 6966 665f    actual = diff_
-000121c0: 6865 6164 6572 2e73 7562 2844 4554 4552  header.sub(DETER
-000121d0: 4d49 4e49 5354 4943 5f48 4541 4445 522c  MINISTIC_HEADER,
-000121e0: 2061 6374 7561 6c29 0a20 2020 2020 2020   actual).       
-000121f0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
-00012200: 6c28 6163 7475 616c 2c20 6578 7065 6374  l(actual, expect
-00012210: 6564 290a 0a20 2020 2040 7374 6174 6963  ed)..    @static
-00012220: 6d65 7468 6f64 0a20 2020 2064 6566 2063  method.    def c
-00012230: 6f6d 7061 7265 5f72 6573 756c 7473 280a  ompare_results(.
-00012240: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-00012250: 6c74 3a20 636c 6963 6b2e 7465 7374 696e  lt: click.testin
-00012260: 672e 5265 7375 6c74 2c20 6578 7065 6374  g.Result, expect
-00012270: 6564 5f76 616c 7565 3a20 7374 722c 2065  ed_value: str, e
-00012280: 7870 6563 7465 645f 6578 6974 5f63 6f64  xpected_exit_cod
-00012290: 653a 2069 6e74 0a20 2020 2029 202d 3e20  e: int.    ) -> 
-000122a0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2222  None:.        ""
-000122b0: 2248 656c 7065 7220 6d65 7468 6f64 2074  "Helper method t
-000122c0: 6f20 7465 7374 2074 6865 2076 616c 7565  o test the value
-000122d0: 2061 6e64 2065 7869 7420 636f 6465 206f   and exit code o
-000122e0: 6620 6120 636c 6963 6b20 5265 7375 6c74  f a click Result
-000122f0: 2e22 2222 0a20 2020 2020 2020 2061 7373  .""".        ass
-00012300: 6572 7420 280a 2020 2020 2020 2020 2020  ert (.          
-00012310: 2020 7265 7375 6c74 2e6f 7574 7075 7420    result.output 
-00012320: 3d3d 2065 7870 6563 7465 645f 7661 6c75  == expected_valu
-00012330: 650a 2020 2020 2020 2020 292c 2022 5468  e.        ), "Th
-00012340: 6520 6f75 7470 7574 2064 6964 206e 6f74  e output did not
-00012350: 206d 6174 6368 2074 6865 2065 7870 6563   match the expec
-00012360: 7465 6420 7661 6c75 652e 220a 2020 2020  ted value.".    
-00012370: 2020 2020 6173 7365 7274 2072 6573 756c      assert resul
-00012380: 742e 6578 6974 5f63 6f64 6520 3d3d 2065  t.exit_code == e
-00012390: 7870 6563 7465 645f 6578 6974 5f63 6f64  xpected_exit_cod
-000123a0: 652c 2022 5468 6520 6578 6974 2063 6f64  e, "The exit cod
-000123b0: 6520 6973 2069 6e63 6f72 7265 6374 2e22  e is incorrect."
-000123c0: 0a0a 2020 2020 6465 6620 7465 7374 5f63  ..    def test_c
-000123d0: 6f64 655f 6f70 7469 6f6e 2873 656c 6629  ode_option(self)
-000123e0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-000123f0: 2020 2222 2254 6573 7420 7468 6520 636f    """Test the co
-00012400: 6465 206f 7074 696f 6e20 7769 7468 206e  de option with n
-00012410: 6f20 6368 616e 6765 732e 2222 220a 2020  o changes.""".  
-00012420: 2020 2020 2020 636f 6465 203d 2022 7072        code = "pr
-00012430: 696e 7428 2748 656c 6c6f 2077 6f72 6c64  int('Hello world
-00012440: 2729 5c6e 220a 2020 2020 2020 2020 6172  ')\n".        ar
-00012450: 6773 203d 205b 222d 2d63 6f64 6522 2c20  gs = ["--code", 
-00012460: 636f 6465 2c20 222d 2d73 696e 676c 652d  code, "--single-
-00012470: 7175 6f74 653d 5472 7565 225d 0a20 2020  quote=True"].   
-00012480: 2020 2020 2072 6573 756c 7420 3d20 436c       result = Cl
-00012490: 6952 756e 6e65 7228 292e 696e 766f 6b65  iRunner().invoke
-000124a0: 2863 6572 6369 732e 6d61 696e 2c20 6172  (cercis.main, ar
-000124b0: 6773 290a 0a20 2020 2020 2020 2073 656c  gs)..        sel
-000124c0: 662e 636f 6d70 6172 655f 7265 7375 6c74  f.compare_result
-000124d0: 7328 7265 7375 6c74 2c20 636f 6465 2c20  s(result, code, 
-000124e0: 3029 0a0a 2020 2020 6465 6620 7465 7374  0)..    def test
-000124f0: 5f63 6f64 655f 6f70 7469 6f6e 5f63 6861  _code_option_cha
-00012500: 6e67 6564 2873 656c 6629 202d 3e20 4e6f  nged(self) -> No
-00012510: 6e65 3a0a 2020 2020 2020 2020 2222 2254  ne:.        """T
-00012520: 6573 7420 7468 6520 636f 6465 206f 7074  est the code opt
-00012530: 696f 6e20 7768 656e 2063 6861 6e67 6573  ion when changes
-00012540: 2061 7265 2072 6571 7569 7265 642e 2222   are required.""
-00012550: 220a 2020 2020 2020 2020 636f 6465 203d  ".        code =
-00012560: 2027 7072 696e 7428 2268 656c 6c6f 2077   'print("hello w
-00012570: 6f72 6c64 2229 270a 2020 2020 2020 2020  orld")'.        
-00012580: 666f 726d 6174 7465 6420 3d20 6365 7263  formatted = cerc
-00012590: 6973 2e66 6f72 6d61 745f 7374 7228 636f  is.format_str(co
-000125a0: 6465 2c20 6d6f 6465 3d44 4546 4155 4c54  de, mode=DEFAULT
-000125b0: 5f4d 4f44 4529 0a0a 2020 2020 2020 2020  _MODE)..        
-000125c0: 6172 6773 203d 205b 222d 2d63 6f64 6522  args = ["--code"
-000125d0: 2c20 636f 6465 2c20 222d 2d73 696e 676c  , code, "--singl
-000125e0: 652d 7175 6f74 653d 5472 7565 225d 0a20  e-quote=True"]. 
-000125f0: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
-00012600: 436c 6952 756e 6e65 7228 292e 696e 766f  CliRunner().invo
-00012610: 6b65 2863 6572 6369 732e 6d61 696e 2c20  ke(cercis.main, 
-00012620: 6172 6773 290a 0a20 2020 2020 2020 2073  args)..        s
-00012630: 656c 662e 636f 6d70 6172 655f 7265 7375  elf.compare_resu
-00012640: 6c74 7328 7265 7375 6c74 2c20 666f 726d  lts(result, form
-00012650: 6174 7465 642c 2030 290a 0a20 2020 2064  atted, 0)..    d
-00012660: 6566 2074 6573 745f 636f 6465 5f6f 7074  ef test_code_opt
-00012670: 696f 6e5f 6368 6563 6b28 7365 6c66 2920  ion_check(self) 
-00012680: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00012690: 2022 2222 5465 7374 2074 6865 2063 6f64   """Test the cod
-000126a0: 6520 6f70 7469 6f6e 2077 6865 6e20 6368  e option when ch
-000126b0: 6563 6b20 6973 2070 6173 7365 642e 2222  eck is passed.""
-000126c0: 220a 2020 2020 2020 2020 6172 6773 203d  ".        args =
-000126d0: 205b 222d 2d63 6865 636b 222c 2022 2d2d   ["--check", "--
-000126e0: 636f 6465 222c 2027 7072 696e 7428 2248  code", 'print("H
-000126f0: 656c 6c6f 2077 6f72 6c64 2229 5c6e 275d  ello world")\n']
-00012700: 0a20 2020 2020 2020 2072 6573 756c 7420  .        result 
-00012710: 3d20 436c 6952 756e 6e65 7228 292e 696e  = CliRunner().in
-00012720: 766f 6b65 2863 6572 6369 732e 6d61 696e  voke(cercis.main
-00012730: 2c20 6172 6773 290a 2020 2020 2020 2020  , args).        
-00012740: 7365 6c66 2e63 6f6d 7061 7265 5f72 6573  self.compare_res
-00012750: 756c 7473 2872 6573 756c 742c 2022 222c  ults(result, "",
-00012760: 2030 290a 0a20 2020 2064 6566 2074 6573   0)..    def tes
-00012770: 745f 636f 6465 5f6f 7074 696f 6e5f 6368  t_code_option_ch
-00012780: 6563 6b5f 6368 616e 6765 6428 7365 6c66  eck_changed(self
-00012790: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-000127a0: 2020 2022 2222 5465 7374 2074 6865 2063     """Test the c
-000127b0: 6f64 6520 6f70 7469 6f6e 2077 6865 6e20  ode option when 
-000127c0: 6368 616e 6765 7320 6172 6520 7265 7175  changes are requ
-000127d0: 6972 6564 2c20 616e 6420 6368 6563 6b20  ired, and check 
-000127e0: 6973 2070 6173 7365 642e 2222 220a 2020  is passed.""".  
-000127f0: 2020 2020 2020 6172 6773 203d 205b 222d        args = ["-
-00012800: 2d63 6865 636b 222c 2022 2d2d 636f 6465  -check", "--code
-00012810: 222c 2022 7072 696e 7428 2768 656c 6c6f  ", "print('hello
-00012820: 2077 6f72 6c64 2729 225d 0a20 2020 2020   world')"].     
-00012830: 2020 2072 6573 756c 7420 3d20 436c 6952     result = CliR
-00012840: 756e 6e65 7228 292e 696e 766f 6b65 2863  unner().invoke(c
-00012850: 6572 6369 732e 6d61 696e 2c20 6172 6773  ercis.main, args
-00012860: 290a 2020 2020 2020 2020 7365 6c66 2e63  ).        self.c
-00012870: 6f6d 7061 7265 5f72 6573 756c 7473 2872  ompare_results(r
-00012880: 6573 756c 742c 2022 222c 2031 290a 0a20  esult, "", 1).. 
-00012890: 2020 2064 6566 2074 6573 745f 636f 6465     def test_code
-000128a0: 5f6f 7074 696f 6e5f 6469 6666 2873 656c  _option_diff(sel
-000128b0: 6629 202d 3e20 4e6f 6e65 3a0a 2020 2020  f) -> None:.    
-000128c0: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
-000128d0: 636f 6465 206f 7074 696f 6e20 7768 656e  code option when
-000128e0: 2064 6966 6620 6973 2070 6173 7365 642e   diff is passed.
-000128f0: 2222 220a 2020 2020 2020 2020 636f 6465  """.        code
-00012900: 203d 2027 7072 696e 7428 2268 656c 6c6f   = 'print("hello
-00012910: 2077 6f72 6c64 2229 270a 2020 2020 2020   world")'.      
-00012920: 2020 666f 726d 6174 7465 6420 3d20 6365    formatted = ce
-00012930: 7263 6973 2e66 6f72 6d61 745f 7374 7228  rcis.format_str(
-00012940: 636f 6465 2c20 6d6f 6465 3d44 4546 4155  code, mode=DEFAU
-00012950: 4c54 5f4d 4f44 4529 0a20 2020 2020 2020  LT_MODE).       
-00012960: 2072 6573 756c 745f 6469 6666 203d 2064   result_diff = d
-00012970: 6966 6628 636f 6465 2c20 666f 726d 6174  iff(code, format
-00012980: 7465 642c 2022 5354 4449 4e22 2c20 2253  ted, "STDIN", "S
-00012990: 5444 4f55 5422 290a 0a20 2020 2020 2020  TDOUT")..       
-000129a0: 2061 7267 7320 3d20 5b22 2d2d 6469 6666   args = ["--diff
-000129b0: 222c 2022 2d2d 636f 6465 222c 2063 6f64  ", "--code", cod
-000129c0: 652c 2022 2d2d 7369 6e67 6c65 2d71 756f  e, "--single-quo
-000129d0: 7465 3d54 7275 6522 5d0a 2020 2020 2020  te=True"].      
-000129e0: 2020 7265 7375 6c74 203d 2043 6c69 5275    result = CliRu
-000129f0: 6e6e 6572 2829 2e69 6e76 6f6b 6528 6365  nner().invoke(ce
-00012a00: 7263 6973 2e6d 6169 6e2c 2061 7267 7329  rcis.main, args)
-00012a10: 0a0a 2020 2020 2020 2020 2320 5265 6d6f  ..        # Remo
-00012a20: 7665 2074 696d 6520 6672 6f6d 2064 6966  ve time from dif
-00012a30: 660a 2020 2020 2020 2020 6f75 7470 7574  f.        output
-00012a40: 203d 2044 4946 465f 5449 4d45 2e73 7562   = DIFF_TIME.sub
-00012a50: 2822 222c 2072 6573 756c 742e 6f75 7470  ("", result.outp
-00012a60: 7574 290a 0a20 2020 2020 2020 2061 7373  ut)..        ass
-00012a70: 6572 7420 6f75 7470 7574 203d 3d20 7265  ert output == re
-00012a80: 7375 6c74 5f64 6966 662c 2022 5468 6520  sult_diff, "The 
-00012a90: 6f75 7470 7574 2064 6964 206e 6f74 206d  output did not m
-00012aa0: 6174 6368 2074 6865 2065 7870 6563 7465  atch the expecte
-00012ab0: 6420 7661 6c75 652e 220a 2020 2020 2020  d value.".      
-00012ac0: 2020 6173 7365 7274 2072 6573 756c 742e    assert result.
-00012ad0: 6578 6974 5f63 6f64 6520 3d3d 2030 2c20  exit_code == 0, 
-00012ae0: 2254 6865 2065 7869 7420 636f 6465 2069  "The exit code i
-00012af0: 7320 696e 636f 7272 6563 742e 220a 0a20  s incorrect.".. 
-00012b00: 2020 2064 6566 2074 6573 745f 636f 6465     def test_code
-00012b10: 5f6f 7074 696f 6e5f 636f 6c6f 725f 6469  _option_color_di
-00012b20: 6666 2873 656c 6629 202d 3e20 4e6f 6e65  ff(self) -> None
-00012b30: 3a0a 2020 2020 2020 2020 2222 2254 6573  :.        """Tes
-00012b40: 7420 7468 6520 636f 6465 206f 7074 696f  t the code optio
-00012b50: 6e20 7768 656e 2063 6f6c 6f72 2061 6e64  n when color and
-00012b60: 2064 6966 6620 6172 6520 7061 7373 6564   diff are passed
-00012b70: 2e22 2222 0a20 2020 2020 2020 2063 6f64  .""".        cod
-00012b80: 6520 3d20 2770 7269 6e74 2822 6865 6c6c  e = 'print("hell
-00012b90: 6f20 776f 726c 6422 2927 0a20 2020 2020  o world")'.     
-00012ba0: 2020 2066 6f72 6d61 7474 6564 203d 2063     formatted = c
-00012bb0: 6572 6369 732e 666f 726d 6174 5f73 7472  ercis.format_str
-00012bc0: 2863 6f64 652c 206d 6f64 653d 4445 4641  (code, mode=DEFA
-00012bd0: 554c 545f 4d4f 4445 290a 0a20 2020 2020  ULT_MODE)..     
-00012be0: 2020 2072 6573 756c 745f 6469 6666 203d     result_diff =
-00012bf0: 2064 6966 6628 636f 6465 2c20 666f 726d   diff(code, form
-00012c00: 6174 7465 642c 2022 5354 4449 4e22 2c20  atted, "STDIN", 
-00012c10: 2253 5444 4f55 5422 290a 2020 2020 2020  "STDOUT").      
-00012c20: 2020 7265 7375 6c74 5f64 6966 6620 3d20    result_diff = 
-00012c30: 636f 6c6f 725f 6469 6666 2872 6573 756c  color_diff(resul
-00012c40: 745f 6469 6666 290a 0a20 2020 2020 2020  t_diff)..       
-00012c50: 2061 7267 7320 3d20 5b22 2d2d 6469 6666   args = ["--diff
-00012c60: 222c 2022 2d2d 636f 6c6f 7222 2c20 222d  ", "--color", "-
-00012c70: 2d63 6f64 6522 2c20 636f 6465 2c20 222d  -code", code, "-
-00012c80: 2d73 696e 676c 652d 7175 6f74 653d 5472  -single-quote=Tr
-00012c90: 7565 225d 0a20 2020 2020 2020 2072 6573  ue"].        res
-00012ca0: 756c 7420 3d20 436c 6952 756e 6e65 7228  ult = CliRunner(
-00012cb0: 292e 696e 766f 6b65 2863 6572 6369 732e  ).invoke(cercis.
-00012cc0: 6d61 696e 2c20 6172 6773 290a 0a20 2020  main, args)..   
-00012cd0: 2020 2020 2023 2052 656d 6f76 6520 7469       # Remove ti
-00012ce0: 6d65 2066 726f 6d20 6469 6666 0a20 2020  me from diff.   
-00012cf0: 2020 2020 206f 7574 7075 7420 3d20 4449       output = DI
-00012d00: 4646 5f54 494d 452e 7375 6228 2222 2c20  FF_TIME.sub("", 
-00012d10: 7265 7375 6c74 2e6f 7574 7075 7429 0a0a  result.output)..
-00012d20: 2020 2020 2020 2020 6173 7365 7274 206f          assert o
-00012d30: 7574 7075 7420 3d3d 2072 6573 756c 745f  utput == result_
-00012d40: 6469 6666 2c20 2254 6865 206f 7574 7075  diff, "The outpu
-00012d50: 7420 6469 6420 6e6f 7420 6d61 7463 6820  t did not match 
-00012d60: 7468 6520 6578 7065 6374 6564 2076 616c  the expected val
-00012d70: 7565 2e22 0a20 2020 2020 2020 2061 7373  ue.".        ass
-00012d80: 6572 7420 7265 7375 6c74 2e65 7869 745f  ert result.exit_
-00012d90: 636f 6465 203d 3d20 302c 2022 5468 6520  code == 0, "The 
-00012da0: 6578 6974 2063 6f64 6520 6973 2069 6e63  exit code is inc
-00012db0: 6f72 7265 6374 2e22 0a0a 2020 2020 4070  orrect."..    @p
-00012dc0: 7974 6573 742e 6d61 726b 2e69 6e63 6f6d  ytest.mark.incom
-00012dd0: 7061 7469 626c 655f 7769 7468 5f6d 7970  patible_with_myp
-00012de0: 7963 0a20 2020 2064 6566 2074 6573 745f  yc.    def test_
-00012df0: 636f 6465 5f6f 7074 696f 6e5f 7361 6665  code_option_safe
-00012e00: 2873 656c 6629 202d 3e20 4e6f 6e65 3a0a  (self) -> None:.
-00012e10: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
-00012e20: 7468 6174 2074 6865 2063 6f64 6520 6f70  that the code op
-00012e30: 7469 6f6e 2074 6872 6f77 7320 616e 2065  tion throws an e
-00012e40: 7272 6f72 2077 6865 6e20 7468 6520 7361  rror when the sa
-00012e50: 6e69 7479 2063 6865 636b 7320 6661 696c  nity checks fail
-00012e60: 2e22 2222 0a20 2020 2020 2020 2023 2050  .""".        # P
-00012e70: 6174 6368 2063 6572 6369 732e 6173 7365  atch cercis.asse
-00012e80: 7274 5f65 7175 6976 616c 656e 7420 746f  rt_equivalent to
-00012e90: 2065 6e73 7572 6520 7468 6520 7361 6e69   ensure the sani
-00012ea0: 7479 2063 6865 636b 7320 6661 696c 0a20  ty checks fail. 
-00012eb0: 2020 2020 2020 2077 6974 6820 7061 7463         with patc
-00012ec0: 682e 6f62 6a65 6374 2863 6572 6369 732c  h.object(cercis,
-00012ed0: 2022 6173 7365 7274 5f65 7175 6976 616c   "assert_equival
-00012ee0: 656e 7422 2c20 7369 6465 5f65 6666 6563  ent", side_effec
-00012ef0: 743d 4173 7365 7274 696f 6e45 7272 6f72  t=AssertionError
-00012f00: 293a 0a20 2020 2020 2020 2020 2020 2063  ):.            c
-00012f10: 6f64 6520 3d20 2770 7269 6e74 2822 4865  ode = 'print("He
-00012f20: 6c6c 6f20 776f 726c 6422 2927 0a20 2020  llo world")'.   
-00012f30: 2020 2020 2020 2020 2065 7272 6f72 5f6d           error_m
-00012f40: 7367 203d 2066 227b 636f 6465 7d5c 6e65  sg = f"{code}\ne
-00012f50: 7272 6f72 3a20 6361 6e6e 6f74 2066 6f72  rror: cannot for
-00012f60: 6d61 7420 3c73 7472 696e 673e 3a20 5c6e  mat <string>: \n
-00012f70: 220a 0a20 2020 2020 2020 2020 2020 2061  "..            a
-00012f80: 7267 7320 3d20 5b22 2d2d 7361 6665 222c  rgs = ["--safe",
-00012f90: 2022 2d2d 636f 6465 222c 2063 6f64 655d   "--code", code]
-00012fa0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-00012fb0: 756c 7420 3d20 436c 6952 756e 6e65 7228  ult = CliRunner(
-00012fc0: 292e 696e 766f 6b65 2863 6572 6369 732e  ).invoke(cercis.
-00012fd0: 6d61 696e 2c20 6172 6773 290a 0a20 2020  main, args)..   
-00012fe0: 2020 2020 2020 2020 2073 656c 662e 636f           self.co
-00012ff0: 6d70 6172 655f 7265 7375 6c74 7328 7265  mpare_results(re
-00013000: 7375 6c74 2c20 6572 726f 725f 6d73 672c  sult, error_msg,
-00013010: 2031 3233 290a 0a20 2020 2064 6566 2074   123)..    def t
-00013020: 6573 745f 636f 6465 5f6f 7074 696f 6e5f  est_code_option_
-00013030: 6661 7374 2873 656c 6629 202d 3e20 4e6f  fast(self) -> No
-00013040: 6e65 3a0a 2020 2020 2020 2020 2222 2254  ne:.        """T
-00013050: 6573 7420 7468 6174 2074 6865 2063 6f64  est that the cod
-00013060: 6520 6f70 7469 6f6e 2069 676e 6f72 6573  e option ignores
-00013070: 2065 7272 6f72 7320 7768 656e 2074 6865   errors when the
-00013080: 2073 616e 6974 7920 6368 6563 6b73 2066   sanity checks f
-00013090: 6169 6c2e 2222 220a 2020 2020 2020 2020  ail.""".        
-000130a0: 2320 5061 7463 6820 6365 7263 6973 2e61  # Patch cercis.a
-000130b0: 7373 6572 745f 6571 7569 7661 6c65 6e74  ssert_equivalent
-000130c0: 2074 6f20 656e 7375 7265 2074 6865 2073   to ensure the s
-000130d0: 616e 6974 7920 6368 6563 6b73 2066 6169  anity checks fai
-000130e0: 6c0a 2020 2020 2020 2020 7769 7468 2070  l.        with p
-000130f0: 6174 6368 2e6f 626a 6563 7428 6365 7263  atch.object(cerc
-00013100: 6973 2c20 2261 7373 6572 745f 6571 7569  is, "assert_equi
-00013110: 7661 6c65 6e74 222c 2073 6964 655f 6566  valent", side_ef
-00013120: 6665 6374 3d41 7373 6572 7469 6f6e 4572  fect=AssertionEr
-00013130: 726f 7229 3a0a 2020 2020 2020 2020 2020  ror):.          
-00013140: 2020 636f 6465 203d 2022 7072 696e 7428    code = "print(
-00013150: 2748 656c 6c6f 2077 6f72 6c64 2729 220a  'Hello world')".
-00013160: 2020 2020 2020 2020 2020 2020 666f 726d              form
-00013170: 6174 7465 6420 3d20 6365 7263 6973 2e66  atted = cercis.f
-00013180: 6f72 6d61 745f 7374 7228 636f 6465 2c20  ormat_str(code, 
-00013190: 6d6f 6465 3d44 4546 4155 4c54 5f4d 4f44  mode=DEFAULT_MOD
-000131a0: 4529 0a0a 2020 2020 2020 2020 2020 2020  E)..            
-000131b0: 6172 6773 203d 205b 222d 2d66 6173 7422  args = ["--fast"
-000131c0: 2c20 222d 2d63 6f64 6522 2c20 636f 6465  , "--code", code
-000131d0: 2c20 222d 2d73 696e 676c 652d 7175 6f74  , "--single-quot
-000131e0: 653d 5472 7565 225d 0a20 2020 2020 2020  e=True"].       
-000131f0: 2020 2020 2072 6573 756c 7420 3d20 436c       result = Cl
-00013200: 6952 756e 6e65 7228 292e 696e 766f 6b65  iRunner().invoke
-00013210: 2863 6572 6369 732e 6d61 696e 2c20 6172  (cercis.main, ar
-00013220: 6773 290a 0a20 2020 2020 2020 2020 2020  gs)..           
-00013230: 2073 656c 662e 636f 6d70 6172 655f 7265   self.compare_re
-00013240: 7375 6c74 7328 7265 7375 6c74 2c20 666f  sults(result, fo
-00013250: 726d 6174 7465 642c 2030 290a 0a20 2020  rmatted, 0)..   
-00013260: 2040 7079 7465 7374 2e6d 6172 6b2e 696e   @pytest.mark.in
-00013270: 636f 6d70 6174 6962 6c65 5f77 6974 685f  compatible_with_
-00013280: 6d79 7079 630a 2020 2020 6465 6620 7465  mypyc.    def te
-00013290: 7374 5f63 6f64 655f 6f70 7469 6f6e 5f63  st_code_option_c
-000132a0: 6f6e 6669 6728 7365 6c66 2920 2d3e 204e  onfig(self) -> N
-000132b0: 6f6e 653a 0a20 2020 2020 2020 2022 2222  one:.        """
-000132c0: 0a20 2020 2020 2020 2054 6573 7420 7468  .        Test th
-000132d0: 6174 2074 6865 2063 6f64 6520 6f70 7469  at the code opti
-000132e0: 6f6e 2066 696e 6473 2074 6865 2070 7970  on finds the pyp
-000132f0: 726f 6a65 6374 2e74 6f6d 6c20 696e 2074  roject.toml in t
-00013300: 6865 2063 7572 7265 6e74 2064 6972 6563  he current direc
-00013310: 746f 7279 2e0a 2020 2020 2020 2020 2222  tory..        ""
-00013320: 220a 2020 2020 2020 2020 7769 7468 2070  ".        with p
-00013330: 6174 6368 2e6f 626a 6563 7428 6365 7263  atch.object(cerc
-00013340: 6973 2c20 2270 6172 7365 5f70 7970 726f  is, "parse_pypro
-00013350: 6a65 6374 5f74 6f6d 6c22 2c20 7265 7475  ject_toml", retu
-00013360: 726e 5f76 616c 7565 3d7b 7d29 2061 7320  rn_value={}) as 
-00013370: 7061 7273 653a 0a20 2020 2020 2020 2020  parse:.         
-00013380: 2020 2061 7267 7320 3d20 5b22 2d2d 636f     args = ["--co
-00013390: 6465 222c 2022 7072 696e 7422 5d0a 2020  de", "print"].  
-000133a0: 2020 2020 2020 2020 2020 2320 5468 6973            # This
-000133b0: 2069 7320 7468 6520 6f6e 6c79 2064 6972   is the only dir
-000133c0: 6563 746f 7279 206b 6e6f 776e 2074 6f20  ectory known to 
-000133d0: 636f 6e74 6169 6e20 6120 7079 7072 6f6a  contain a pyproj
-000133e0: 6563 742e 746f 6d6c 0a20 2020 2020 2020  ect.toml.       
-000133f0: 2020 2020 2077 6974 6820 6368 616e 6765       with change
-00013400: 5f64 6972 6563 746f 7279 2850 524f 4a45  _directory(PROJE
-00013410: 4354 5f52 4f4f 5429 3a0a 2020 2020 2020  CT_ROOT):.      
-00013420: 2020 2020 2020 2020 2020 436c 6952 756e            CliRun
-00013430: 6e65 7228 292e 696e 766f 6b65 2863 6572  ner().invoke(cer
-00013440: 6369 732e 6d61 696e 2c20 6172 6773 290a  cis.main, args).
-00013450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013460: 7079 7072 6f6a 6563 745f 7061 7468 203d  pyproject_path =
-00013470: 2050 6174 6828 5061 7468 2e63 7764 2829   Path(Path.cwd()
-00013480: 2c20 2270 7970 726f 6a65 6374 2e74 6f6d  , "pyproject.tom
-00013490: 6c22 292e 7265 736f 6c76 6528 290a 0a20  l").resolve().. 
-000134a0: 2020 2020 2020 2020 2020 2061 7373 6572             asser
-000134b0: 7420 280a 2020 2020 2020 2020 2020 2020  t (.            
-000134c0: 2020 2020 6c65 6e28 7061 7273 652e 6d6f      len(parse.mo
-000134d0: 636b 5f63 616c 6c73 2920 3e3d 2031 0a20  ck_calls) >= 1. 
-000134e0: 2020 2020 2020 2020 2020 2029 2c20 2245             ), "E
-000134f0: 7870 6563 7465 6420 636f 6e66 6967 2070  xpected config p
-00013500: 6172 7365 2074 6f20 6265 2063 616c 6c65  arse to be calle
-00013510: 6420 7769 7468 2074 6865 2063 7572 7265  d with the curre
-00013520: 6e74 2064 6972 6563 746f 7279 2e22 0a0a  nt directory."..
-00013530: 2020 2020 2020 2020 2020 2020 5f2c 2063              _, c
-00013540: 616c 6c5f 6172 6773 2c20 5f20 3d20 7061  all_args, _ = pa
-00013550: 7273 652e 6d6f 636b 5f63 616c 6c73 5b30  rse.mock_calls[0
-00013560: 5d0a 2020 2020 2020 2020 2020 2020 6173  ].            as
-00013570: 7365 7274 2028 0a20 2020 2020 2020 2020  sert (.         
-00013580: 2020 2020 2020 2063 616c 6c5f 6172 6773         call_args
-00013590: 5b30 5d2e 6c6f 7765 7228 2920 3d3d 2073  [0].lower() == s
-000135a0: 7472 2870 7970 726f 6a65 6374 5f70 6174  tr(pyproject_pat
-000135b0: 6829 2e6c 6f77 6572 2829 0a20 2020 2020  h).lower().     
-000135c0: 2020 2020 2020 2029 2c20 2249 6e63 6f72         ), "Incor
-000135d0: 7265 6374 2063 6f6e 6669 6720 6c6f 6164  rect config load
-000135e0: 6564 2e22 0a0a 2020 2020 4070 7974 6573  ed."..    @pytes
-000135f0: 742e 6d61 726b 2e69 6e63 6f6d 7061 7469  t.mark.incompati
-00013600: 626c 655f 7769 7468 5f6d 7970 7963 0a20  ble_with_mypyc. 
-00013610: 2020 2064 6566 2074 6573 745f 636f 6465     def test_code
-00013620: 5f6f 7074 696f 6e5f 7061 7265 6e74 5f63  _option_parent_c
-00013630: 6f6e 6669 6728 7365 6c66 2920 2d3e 204e  onfig(self) -> N
-00013640: 6f6e 653a 0a20 2020 2020 2020 2022 2222  one:.        """
-00013650: 0a20 2020 2020 2020 2054 6573 7420 7468  .        Test th
-00013660: 6174 2074 6865 2063 6f64 6520 6f70 7469  at the code opti
-00013670: 6f6e 2066 696e 6473 2074 6865 2070 7970  on finds the pyp
-00013680: 726f 6a65 6374 2e74 6f6d 6c20 696e 2074  roject.toml in t
-00013690: 6865 2070 6172 656e 7420 6469 7265 6374  he parent direct
-000136a0: 6f72 792e 0a20 2020 2020 2020 2022 2222  ory..        """
-000136b0: 0a20 2020 2020 2020 2077 6974 6820 7061  .        with pa
-000136c0: 7463 682e 6f62 6a65 6374 2863 6572 6369  tch.object(cerci
-000136d0: 732c 2022 7061 7273 655f 7079 7072 6f6a  s, "parse_pyproj
-000136e0: 6563 745f 746f 6d6c 222c 2072 6574 7572  ect_toml", retur
-000136f0: 6e5f 7661 6c75 653d 7b7d 2920 6173 2070  n_value={}) as p
-00013700: 6172 7365 3a0a 2020 2020 2020 2020 2020  arse:.          
-00013710: 2020 7769 7468 2063 6861 6e67 655f 6469    with change_di
-00013720: 7265 6374 6f72 7928 5448 4953 5f44 4952  rectory(THIS_DIR
-00013730: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00013740: 2020 2061 7267 7320 3d20 5b22 2d2d 636f     args = ["--co
-00013750: 6465 222c 2022 7072 696e 7422 5d0a 2020  de", "print"].  
-00013760: 2020 2020 2020 2020 2020 2020 2020 436c                Cl
-00013770: 6952 756e 6e65 7228 292e 696e 766f 6b65  iRunner().invoke
-00013780: 2863 6572 6369 732e 6d61 696e 2c20 6172  (cercis.main, ar
-00013790: 6773 290a 0a20 2020 2020 2020 2020 2020  gs)..           
-000137a0: 2020 2020 2070 7970 726f 6a65 6374 5f70       pyproject_p
-000137b0: 6174 6820 3d20 5061 7468 2850 6174 6828  ath = Path(Path(
-000137c0: 292e 6377 6428 292e 7061 7265 6e74 2c20  ).cwd().parent, 
-000137d0: 2270 7970 726f 6a65 6374 2e74 6f6d 6c22  "pyproject.toml"
-000137e0: 292e 7265 736f 6c76 6528 290a 2020 2020  ).resolve().    
-000137f0: 2020 2020 2020 2020 2020 2020 6173 7365              asse
-00013800: 7274 2028 0a20 2020 2020 2020 2020 2020  rt (.           
-00013810: 2020 2020 2020 2020 206c 656e 2870 6172           len(par
-00013820: 7365 2e6d 6f63 6b5f 6361 6c6c 7329 203e  se.mock_calls) >
-00013830: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
-00013840: 2020 2020 292c 2022 4578 7065 6374 6564      ), "Expected
-00013850: 2063 6f6e 6669 6720 7061 7273 6520 746f   config parse to
-00013860: 2062 6520 6361 6c6c 6564 2077 6974 6820   be called with 
-00013870: 7468 6520 6375 7272 656e 7420 6469 7265  the current dire
-00013880: 6374 6f72 792e 220a 0a20 2020 2020 2020  ctory."..       
-00013890: 2020 2020 2020 2020 205f 2c20 6361 6c6c           _, call
-000138a0: 5f61 7267 732c 205f 203d 2070 6172 7365  _args, _ = parse
-000138b0: 2e6d 6f63 6b5f 6361 6c6c 735b 305d 0a20  .mock_calls[0]. 
-000138c0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-000138d0: 7373 6572 7420 280a 2020 2020 2020 2020  ssert (.        
-000138e0: 2020 2020 2020 2020 2020 2020 6361 6c6c              call
-000138f0: 5f61 7267 735b 305d 2e6c 6f77 6572 2829  _args[0].lower()
-00013900: 203d 3d20 7374 7228 7079 7072 6f6a 6563   == str(pyprojec
-00013910: 745f 7061 7468 292e 6c6f 7765 7228 290a  t_path).lower().
-00013920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013930: 292c 2022 496e 636f 7272 6563 7420 636f  ), "Incorrect co
-00013940: 6e66 6967 206c 6f61 6465 642e 220a 0a20  nfig loaded.".. 
-00013950: 2020 2064 6566 2074 6573 745f 666f 725f     def test_for_
-00013960: 6861 6e64 6c65 645f 756e 6578 7065 6374  handled_unexpect
-00013970: 6564 5f65 6f66 5f65 7272 6f72 2873 656c  ed_eof_error(sel
-00013980: 6629 202d 3e20 4e6f 6e65 3a0a 2020 2020  f) -> None:.    
-00013990: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000139a0: 5465 7374 2074 6861 7420 616e 2075 6e65  Test that an une
-000139b0: 7870 6563 7465 6420 454f 4620 5379 6e74  xpected EOF Synt
-000139c0: 6178 4572 726f 7220 6973 206e 6963 656c  axError is nicel
-000139d0: 7920 7072 6573 656e 7465 642e 0a20 2020  y presented..   
-000139e0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000139f0: 2077 6974 6820 7079 7465 7374 2e72 6169   with pytest.rai
-00013a00: 7365 7328 6365 7263 6973 2e70 6172 7369  ses(cercis.parsi
-00013a10: 6e67 2e49 6e76 616c 6964 496e 7075 7429  ng.InvalidInput)
-00013a20: 2061 7320 6578 635f 696e 666f 3a0a 2020   as exc_info:.  
-00013a30: 2020 2020 2020 2020 2020 6365 7263 6973            cercis
-00013a40: 2e6c 6962 3274 6f33 5f70 6172 7365 2822  .lib2to3_parse("
-00013a50: 7072 696e 7428 222c 207b 7d29 0a0a 2020  print(", {})..  
-00013a60: 2020 2020 2020 6578 635f 696e 666f 2e6d        exc_info.m
-00013a70: 6174 6368 2822 4361 6e6e 6f74 2070 6172  atch("Cannot par
-00013a80: 7365 3a20 323a 303a 2045 4f46 2069 6e20  se: 2:0: EOF in 
-00013a90: 6d75 6c74 692d 6c69 6e65 2073 7461 7465  multi-line state
-00013aa0: 6d65 6e74 2229 0a0a 2020 2020 6465 6620  ment")..    def 
-00013ab0: 7465 7374 5f65 7175 6976 616c 656e 6379  test_equivalency
-00013ac0: 5f61 7374 5f70 6172 7365 5f66 6169 6c75  _ast_parse_failu
-00013ad0: 7265 5f69 6e63 6c75 6465 735f 6572 726f  re_includes_erro
-00013ae0: 7228 7365 6c66 2920 2d3e 204e 6f6e 653a  r(self) -> None:
-00013af0: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
-00013b00: 7465 7374 2e72 6169 7365 7328 4173 7365  test.raises(Asse
-00013b10: 7274 696f 6e45 7272 6f72 2920 6173 2065  rtionError) as e
-00013b20: 7272 3a0a 2020 2020 2020 2020 2020 2020  rr:.            
-00013b30: 6365 7263 6973 2e61 7373 6572 745f 6571  cercis.assert_eq
-00013b40: 7569 7661 6c65 6e74 2822 61c2 abc2 bb61  uivalent("a....a
-00013b50: 2020 3d20 3122 2c20 2261 c2ab c2bb 6120    = 1", "a....a 
-00013b60: 203d 2031 2229 0a0a 2020 2020 2020 2020   = 1")..        
-00013b70: 6572 722e 6d61 7463 6828 222d 2d73 6166  err.match("--saf
-00013b80: 6522 290a 2020 2020 2020 2020 2320 556e  e").        # Un
-00013b90: 666f 7274 756e 6174 656c 7920 7468 6520  fortunately the 
-00013ba0: 5379 6e74 6178 4572 726f 7220 6d65 7373  SyntaxError mess
-00013bb0: 6167 6520 6861 7320 6368 616e 6765 6420  age has changed 
-00013bc0: 696e 206e 6577 6572 2076 6572 7369 6f6e  in newer version
-00013bd0: 7320 736f 2077 650a 2020 2020 2020 2020  s so we.        
-00013be0: 2320 6361 6e27 7420 6d61 7463 6820 6974  # can't match it
-00013bf0: 2064 6972 6563 746c 792e 0a20 2020 2020   directly..     
-00013c00: 2020 2065 7272 2e6d 6174 6368 2822 696e     err.match("in
-00013c10: 7661 6c69 6420 6368 6172 6163 7465 7222  valid character"
-00013c20: 290a 2020 2020 2020 2020 6572 722e 6d61  ).        err.ma
-00013c30: 7463 6828 7222 5c28 3c75 6e6b 6e6f 776e  tch(r"\(<unknown
-00013c40: 3e2c 206c 696e 6520 315c 2922 290a 0a0a  >, line 1\)")...
-00013c50: 636c 6173 7320 5465 7374 4361 6368 696e  class TestCachin
-00013c60: 673a 0a20 2020 2064 6566 2074 6573 745f  g:.    def test_
-00013c70: 6765 745f 6361 6368 655f 6469 7228 0a20  get_cache_dir(. 
-00013c80: 2020 2020 2020 2020 2020 2073 656c 662c             self,
-00013c90: 0a20 2020 2020 2020 2020 2020 2074 6d70  .            tmp
-00013ca0: 5f70 6174 683a 2050 6174 682c 0a20 2020  _path: Path,.   
-00013cb0: 2020 2020 2020 2020 206d 6f6e 6b65 7970           monkeyp
-00013cc0: 6174 6368 3a20 7079 7465 7374 2e4d 6f6e  atch: pytest.Mon
-00013cd0: 6b65 7950 6174 6368 2c0a 2020 2020 2920  keyPatch,.    ) 
-00013ce0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-00013cf0: 2023 2043 7265 6174 6520 6d75 6c74 6970   # Create multip
-00013d00: 6c65 2063 6163 6865 2064 6972 6563 746f  le cache directo
-00013d10: 7269 6573 0a20 2020 2020 2020 2077 6f72  ries.        wor
-00013d20: 6b73 7061 6365 3120 3d20 746d 705f 7061  kspace1 = tmp_pa
-00013d30: 7468 202f 2022 7773 3122 0a20 2020 2020  th / "ws1".     
-00013d40: 2020 2077 6f72 6b73 7061 6365 312e 6d6b     workspace1.mk
-00013d50: 6469 7228 290a 2020 2020 2020 2020 776f  dir().        wo
-00013d60: 726b 7370 6163 6532 203d 2074 6d70 5f70  rkspace2 = tmp_p
-00013d70: 6174 6820 2f20 2277 7332 220a 2020 2020  ath / "ws2".    
-00013d80: 2020 2020 776f 726b 7370 6163 6532 2e6d      workspace2.m
-00013d90: 6b64 6972 2829 0a0a 2020 2020 2020 2020  kdir()..        
-00013da0: 2320 466f 7263 6520 7573 6572 5f63 6163  # Force user_cac
-00013db0: 6865 5f64 6972 2074 6f20 7573 6520 7468  he_dir to use th
-00013dc0: 6520 7465 6d70 6f72 6172 7920 6469 7265  e temporary dire
-00013dd0: 6374 6f72 7920 666f 7220 6561 7369 6572  ctory for easier
-00013de0: 2061 7373 6572 7469 6f6e 730a 2020 2020   assertions.    
-00013df0: 2020 2020 7061 7463 685f 7573 6572 5f63      patch_user_c
-00013e00: 6163 6865 5f64 6972 203d 2070 6174 6368  ache_dir = patch
-00013e10: 280a 2020 2020 2020 2020 2020 2020 7461  (.            ta
-00013e20: 7267 6574 3d22 6365 7263 6973 2e63 6163  rget="cercis.cac
-00013e30: 6865 2e75 7365 725f 6361 6368 655f 6469  he.user_cache_di
-00013e40: 7222 2c0a 2020 2020 2020 2020 2020 2020  r",.            
-00013e50: 6175 746f 7370 6563 3d54 7275 652c 0a20  autospec=True,. 
-00013e60: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00013e70: 6e5f 7661 6c75 653d 7374 7228 776f 726b  n_value=str(work
-00013e80: 7370 6163 6531 292c 0a20 2020 2020 2020  space1),.       
-00013e90: 2029 0a0a 2020 2020 2020 2020 2320 4966   )..        # If
-00013ea0: 2042 4c41 434b 5f43 4143 4845 5f44 4952   BLACK_CACHE_DIR
-00013eb0: 2069 7320 6e6f 7420 7365 742c 2075 7365   is not set, use
-00013ec0: 2075 7365 725f 6361 6368 655f 6469 720a   user_cache_dir.
-00013ed0: 2020 2020 2020 2020 6d6f 6e6b 6579 7061          monkeypa
-00013ee0: 7463 682e 6465 6c65 6e76 2822 424c 4143  tch.delenv("BLAC
-00013ef0: 4b5f 4341 4348 455f 4449 5222 2c20 7261  K_CACHE_DIR", ra
-00013f00: 6973 696e 673d 4661 6c73 6529 0a20 2020  ising=False).   
-00013f10: 2020 2020 2077 6974 6820 7061 7463 685f       with patch_
-00013f20: 7573 6572 5f63 6163 6865 5f64 6972 3a0a  user_cache_dir:.
-00013f30: 2020 2020 2020 2020 2020 2020 6173 7365              asse
-00013f40: 7274 2067 6574 5f63 6163 6865 5f64 6972  rt get_cache_dir
-00013f50: 2829 203d 3d20 776f 726b 7370 6163 6531  () == workspace1
-00013f60: 0a0a 2020 2020 2020 2020 2320 4966 2069  ..        # If i
-00013f70: 7420 6973 2073 6574 2c20 7573 6520 7468  t is set, use th
-00013f80: 6520 7061 7468 2070 726f 7669 6465 6420  e path provided 
-00013f90: 696e 2074 6865 2065 6e76 2076 6172 2e0a  in the env var..
-00013fa0: 2020 2020 2020 2020 6d6f 6e6b 6579 7061          monkeypa
-00013fb0: 7463 682e 7365 7465 6e76 2822 424c 4143  tch.setenv("BLAC
-00013fc0: 4b5f 4341 4348 455f 4449 5222 2c20 7374  K_CACHE_DIR", st
-00013fd0: 7228 776f 726b 7370 6163 6532 2929 0a20  r(workspace2)). 
-00013fe0: 2020 2020 2020 2061 7373 6572 7420 6765         assert ge
-00013ff0: 745f 6361 6368 655f 6469 7228 2920 3d3d  t_cache_dir() ==
-00014000: 2077 6f72 6b73 7061 6365 320a 0a20 2020   workspace2..   
-00014010: 2064 6566 2074 6573 745f 6361 6368 655f   def test_cache_
-00014020: 6272 6f6b 656e 5f66 696c 6528 7365 6c66  broken_file(self
-00014030: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-00014040: 2020 206d 6f64 6520 3d20 4445 4641 554c     mode = DEFAUL
-00014050: 545f 4d4f 4445 0a20 2020 2020 2020 2077  T_MODE.        w
-00014060: 6974 6820 6361 6368 655f 6469 7228 2920  ith cache_dir() 
-00014070: 6173 2077 6f72 6b73 7061 6365 3a0a 2020  as workspace:.  
-00014080: 2020 2020 2020 2020 2020 6361 6368 655f            cache_
-00014090: 6669 6c65 203d 2067 6574 5f63 6163 6865  file = get_cache
-000140a0: 5f66 696c 6528 6d6f 6465 290a 2020 2020  _file(mode).    
-000140b0: 2020 2020 2020 2020 6361 6368 655f 6669          cache_fi
-000140c0: 6c65 2e77 7269 7465 5f74 6578 7428 2274  le.write_text("t
-000140d0: 6869 7320 6973 206e 6f74 2061 2070 6963  his is not a pic
-000140e0: 6b6c 6522 290a 2020 2020 2020 2020 2020  kle").          
-000140f0: 2020 6173 7365 7274 2063 6572 6369 732e    assert cercis.
-00014100: 7265 6164 5f63 6163 6865 286d 6f64 6529  read_cache(mode)
-00014110: 203d 3d20 7b7d 0a20 2020 2020 2020 2020   == {}.         
-00014120: 2020 2073 7263 203d 2028 776f 726b 7370     src = (worksp
-00014130: 6163 6520 2f20 2274 6573 742e 7079 2229  ace / "test.py")
-00014140: 2e72 6573 6f6c 7665 2829 0a20 2020 2020  .resolve().     
-00014150: 2020 2020 2020 2073 7263 2e77 7269 7465         src.write
-00014160: 5f74 6578 7428 2270 7269 6e74 2827 6865  _text("print('he
-00014170: 6c6c 6f27 2922 290a 2020 2020 2020 2020  llo')").        
-00014180: 2020 2020 696e 766f 6b65 426c 6163 6b28      invokeBlack(
-00014190: 5b73 7472 2873 7263 295d 290a 2020 2020  [str(src)]).    
-000141a0: 2020 2020 2020 2020 6361 6368 6520 3d20          cache = 
-000141b0: 6365 7263 6973 2e72 6561 645f 6361 6368  cercis.read_cach
-000141c0: 6528 6d6f 6465 290a 2020 2020 2020 2020  e(mode).        
-000141d0: 2020 2020 6173 7365 7274 2073 7472 2873      assert str(s
-000141e0: 7263 2920 696e 2063 6163 6865 0a0a 2020  rc) in cache..  
-000141f0: 2020 6465 6620 7465 7374 5f63 6163 6865    def test_cache
-00014200: 5f73 696e 676c 655f 6669 6c65 5f61 6c72  _single_file_alr
-00014210: 6561 6479 5f63 6163 6865 6428 7365 6c66  eady_cached(self
-00014220: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-00014230: 2020 206d 6f64 6520 3d20 4445 4641 554c     mode = DEFAUL
-00014240: 545f 4d4f 4445 0a20 2020 2020 2020 2077  T_MODE.        w
-00014250: 6974 6820 6361 6368 655f 6469 7228 2920  ith cache_dir() 
-00014260: 6173 2077 6f72 6b73 7061 6365 3a0a 2020  as workspace:.  
-00014270: 2020 2020 2020 2020 2020 7372 6320 3d20            src = 
-00014280: 2877 6f72 6b73 7061 6365 202f 2022 7465  (workspace / "te
-00014290: 7374 2e70 7922 292e 7265 736f 6c76 6528  st.py").resolve(
-000142a0: 290a 2020 2020 2020 2020 2020 2020 7372  ).            sr
-000142b0: 632e 7772 6974 655f 7465 7874 2822 7072  c.write_text("pr
-000142c0: 696e 7428 2768 656c 6c6f 2729 2229 0a20  int('hello')"). 
-000142d0: 2020 2020 2020 2020 2020 2063 6572 6369             cerci
-000142e0: 732e 7772 6974 655f 6361 6368 6528 7b7d  s.write_cache({}
-000142f0: 2c20 5b73 7263 5d2c 206d 6f64 6529 0a20  , [src], mode). 
-00014300: 2020 2020 2020 2020 2020 2069 6e76 6f6b             invok
-00014310: 6542 6c61 636b 285b 7374 7228 7372 6329  eBlack([str(src)
-00014320: 5d29 0a20 2020 2020 2020 2020 2020 2061  ]).            a
-00014330: 7373 6572 7420 7372 632e 7265 6164 5f74  ssert src.read_t
-00014340: 6578 7428 2920 3d3d 2022 7072 696e 7428  ext() == "print(
-00014350: 2768 656c 6c6f 2729 220a 0a20 2020 2040  'hello')"..    @
-00014360: 6576 656e 745f 6c6f 6f70 2829 0a20 2020  event_loop().   
-00014370: 2064 6566 2074 6573 745f 6361 6368 655f   def test_cache_
-00014380: 6d75 6c74 6970 6c65 5f66 696c 6573 2873  multiple_files(s
-00014390: 656c 6629 202d 3e20 4e6f 6e65 3a0a 2020  elf) -> None:.  
-000143a0: 2020 2020 2020 6d6f 6465 203d 2044 4546        mode = DEF
-000143b0: 4155 4c54 5f4d 4f44 450a 2020 2020 2020  AULT_MODE.      
-000143c0: 2020 7769 7468 2063 6163 6865 5f64 6972    with cache_dir
-000143d0: 2829 2061 7320 776f 726b 7370 6163 652c  () as workspace,
-000143e0: 2070 6174 6368 280a 2020 2020 2020 2020   patch(.        
-000143f0: 2020 2020 2263 6f6e 6375 7272 656e 742e      "concurrent.
-00014400: 6675 7475 7265 732e 5072 6f63 6573 7350  futures.ProcessP
-00014410: 6f6f 6c45 7865 6375 746f 7222 2c20 6e65  oolExecutor", ne
-00014420: 773d 5468 7265 6164 506f 6f6c 4578 6563  w=ThreadPoolExec
-00014430: 7574 6f72 0a20 2020 2020 2020 2029 3a0a  utor.        ):.
-00014440: 2020 2020 2020 2020 2020 2020 6f6e 6520              one 
-00014450: 3d20 2877 6f72 6b73 7061 6365 202f 2022  = (workspace / "
-00014460: 6f6e 652e 7079 2229 2e72 6573 6f6c 7665  one.py").resolve
-00014470: 2829 0a20 2020 2020 2020 2020 2020 2077  ().            w
-00014480: 6974 6820 6f6e 652e 6f70 656e 2822 7722  ith one.open("w"
-00014490: 2920 6173 2066 6f62 6a3a 0a20 2020 2020  ) as fobj:.     
-000144a0: 2020 2020 2020 2020 2020 2066 6f62 6a2e             fobj.
-000144b0: 7772 6974 6528 2270 7269 6e74 2827 6865  write("print('he
-000144c0: 6c6c 6f27 2922 290a 2020 2020 2020 2020  llo')").        
-000144d0: 2020 2020 7477 6f20 3d20 2877 6f72 6b73      two = (works
-000144e0: 7061 6365 202f 2022 7477 6f2e 7079 2229  pace / "two.py")
-000144f0: 2e72 6573 6f6c 7665 2829 0a20 2020 2020  .resolve().     
-00014500: 2020 2020 2020 2077 6974 6820 7477 6f2e         with two.
-00014510: 6f70 656e 2822 7722 2920 6173 2066 6f62  open("w") as fob
-00014520: 6a3a 0a20 2020 2020 2020 2020 2020 2020  j:.             
-00014530: 2020 2066 6f62 6a2e 7772 6974 6528 2270     fobj.write("p
-00014540: 7269 6e74 2827 6865 6c6c 6f27 2922 290a  rint('hello')").
-00014550: 2020 2020 2020 2020 2020 2020 6365 7263              cerc
-00014560: 6973 2e77 7269 7465 5f63 6163 6865 287b  is.write_cache({
-00014570: 7d2c 205b 6f6e 655d 2c20 6d6f 6465 290a  }, [one], mode).
-00014580: 2020 2020 2020 2020 2020 2020 696e 766f              invo
-00014590: 6b65 426c 6163 6b28 5b73 7472 2877 6f72  keBlack([str(wor
-000145a0: 6b73 7061 6365 292c 2022 2d2d 7369 6e67  kspace), "--sing
-000145b0: 6c65 2d71 756f 7465 3d46 616c 7365 225d  le-quote=False"]
-000145c0: 290a 2020 2020 2020 2020 2020 2020 7769  ).            wi
-000145d0: 7468 206f 6e65 2e6f 7065 6e28 2272 2229  th one.open("r")
-000145e0: 2061 7320 666f 626a 3a0a 2020 2020 2020   as fobj:.      
-000145f0: 2020 2020 2020 2020 2020 6173 7365 7274            assert
-00014600: 2066 6f62 6a2e 7265 6164 2829 203d 3d20   fobj.read() == 
-00014610: 2270 7269 6e74 2827 6865 6c6c 6f27 2922  "print('hello')"
-00014620: 0a20 2020 2020 2020 2020 2020 2077 6974  .            wit
-00014630: 6820 7477 6f2e 6f70 656e 2822 7222 2920  h two.open("r") 
-00014640: 6173 2066 6f62 6a3a 0a20 2020 2020 2020  as fobj:.       
-00014650: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
-00014660: 666f 626a 2e72 6561 6428 2920 3d3d 2027  fobj.read() == '
-00014670: 7072 696e 7428 2268 656c 6c6f 2229 5c6e  print("hello")\n
-00014680: 270a 2020 2020 2020 2020 2020 2020 6361  '.            ca
-00014690: 6368 6520 3d20 6365 7263 6973 2e72 6561  che = cercis.rea
-000146a0: 645f 6361 6368 6528 6d6f 6465 290a 2020  d_cache(mode).  
-000146b0: 2020 2020 2020 2020 2020 6173 7365 7274            assert
-000146c0: 2073 7472 286f 6e65 2920 696e 2063 6163   str(one) in cac
-000146d0: 6865 0a20 2020 2020 2020 2020 2020 2061  he.            a
-000146e0: 7373 6572 7420 7374 7228 7477 6f29 2069  ssert str(two) i
-000146f0: 6e20 6361 6368 650a 0a20 2020 2040 7079  n cache..    @py
-00014700: 7465 7374 2e6d 6172 6b2e 7061 7261 6d65  test.mark.parame
-00014710: 7472 697a 6528 2263 6f6c 6f72 222c 205b  trize("color", [
-00014720: 4661 6c73 652c 2054 7275 655d 2c20 6964  False, True], id
-00014730: 733d 5b22 6e6f 2d63 6f6c 6f72 222c 2022  s=["no-color", "
-00014740: 7769 7468 2d63 6f6c 6f72 225d 290a 2020  with-color"]).  
-00014750: 2020 6465 6620 7465 7374 5f6e 6f5f 6361    def test_no_ca
-00014760: 6368 655f 7768 656e 5f77 7269 7465 6261  che_when_writeba
-00014770: 636b 5f64 6966 6628 7365 6c66 2c20 636f  ck_diff(self, co
-00014780: 6c6f 723a 2062 6f6f 6c29 202d 3e20 4e6f  lor: bool) -> No
-00014790: 6e65 3a0a 2020 2020 2020 2020 6d6f 6465  ne:.        mode
-000147a0: 203d 2044 4546 4155 4c54 5f4d 4f44 450a   = DEFAULT_MODE.
-000147b0: 2020 2020 2020 2020 7769 7468 2063 6163          with cac
-000147c0: 6865 5f64 6972 2829 2061 7320 776f 726b  he_dir() as work
-000147d0: 7370 6163 653a 0a20 2020 2020 2020 2020  space:.         
-000147e0: 2020 2073 7263 203d 2028 776f 726b 7370     src = (worksp
-000147f0: 6163 6520 2f20 2274 6573 742e 7079 2229  ace / "test.py")
-00014800: 2e72 6573 6f6c 7665 2829 0a20 2020 2020  .resolve().     
-00014810: 2020 2020 2020 2077 6974 6820 7372 632e         with src.
-00014820: 6f70 656e 2822 7722 2920 6173 2066 6f62  open("w") as fob
-00014830: 6a3a 0a20 2020 2020 2020 2020 2020 2020  j:.             
-00014840: 2020 2066 6f62 6a2e 7772 6974 6528 2270     fobj.write("p
-00014850: 7269 6e74 2827 6865 6c6c 6f27 2922 290a  rint('hello')").
-00014860: 2020 2020 2020 2020 2020 2020 7769 7468              with
-00014870: 2070 6174 6368 2822 6365 7263 6973 2e72   patch("cercis.r
-00014880: 6561 645f 6361 6368 6522 2920 6173 2072  ead_cache") as r
-00014890: 6561 645f 6361 6368 652c 2070 6174 6368  ead_cache, patch
-000148a0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000148b0: 2020 2263 6572 6369 732e 7772 6974 655f    "cercis.write_
-000148c0: 6361 6368 6522 0a20 2020 2020 2020 2020  cache".         
-000148d0: 2020 2029 2061 7320 7772 6974 655f 6361     ) as write_ca
-000148e0: 6368 653a 0a20 2020 2020 2020 2020 2020  che:.           
-000148f0: 2020 2020 2063 6d64 203d 205b 7374 7228       cmd = [str(
-00014900: 7372 6329 2c20 222d 2d64 6966 6622 5d0a  src), "--diff"].
-00014910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014920: 6966 2063 6f6c 6f72 3a0a 2020 2020 2020  if color:.      
-00014930: 2020 2020 2020 2020 2020 2020 2020 636d                cm
-00014940: 642e 6170 7065 6e64 2822 2d2d 636f 6c6f  d.append("--colo
-00014950: 7222 290a 2020 2020 2020 2020 2020 2020  r").            
-00014960: 2020 2020 696e 766f 6b65 426c 6163 6b28      invokeBlack(
-00014970: 636d 6429 0a20 2020 2020 2020 2020 2020  cmd).           
-00014980: 2020 2020 2063 6163 6865 5f66 696c 6520       cache_file 
-00014990: 3d20 6765 745f 6361 6368 655f 6669 6c65  = get_cache_file
-000149a0: 286d 6f64 6529 0a20 2020 2020 2020 2020  (mode).         
-000149b0: 2020 2020 2020 2061 7373 6572 7420 6361         assert ca
-000149c0: 6368 655f 6669 6c65 2e65 7869 7374 7328  che_file.exists(
-000149d0: 2920 6973 2046 616c 7365 0a20 2020 2020  ) is False.     
-000149e0: 2020 2020 2020 2020 2020 2077 7269 7465             write
-000149f0: 5f63 6163 6865 2e61 7373 6572 745f 6e6f  _cache.assert_no
-00014a00: 745f 6361 6c6c 6564 2829 0a20 2020 2020  t_called().     
-00014a10: 2020 2020 2020 2020 2020 2072 6561 645f             read_
-00014a20: 6361 6368 652e 6173 7365 7274 5f6e 6f74  cache.assert_not
-00014a30: 5f63 616c 6c65 6428 290a 0a20 2020 2040  _called()..    @
-00014a40: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
-00014a50: 6d65 7472 697a 6528 2263 6f6c 6f72 222c  metrize("color",
-00014a60: 205b 4661 6c73 652c 2054 7275 655d 2c20   [False, True], 
-00014a70: 6964 733d 5b22 6e6f 2d63 6f6c 6f72 222c  ids=["no-color",
-00014a80: 2022 7769 7468 2d63 6f6c 6f72 225d 290a   "with-color"]).
-00014a90: 2020 2020 4065 7665 6e74 5f6c 6f6f 7028      @event_loop(
-00014aa0: 290a 2020 2020 6465 6620 7465 7374 5f6f  ).    def test_o
-00014ab0: 7574 7075 745f 6c6f 636b 696e 675f 7768  utput_locking_wh
-00014ac0: 656e 5f77 7269 7465 6261 636b 5f64 6966  en_writeback_dif
-00014ad0: 6628 7365 6c66 2c20 636f 6c6f 723a 2062  f(self, color: b
-00014ae0: 6f6f 6c29 202d 3e20 4e6f 6e65 3a0a 2020  ool) -> None:.  
-00014af0: 2020 2020 2020 7769 7468 2063 6163 6865        with cache
-00014b00: 5f64 6972 2829 2061 7320 776f 726b 7370  _dir() as worksp
-00014b10: 6163 653a 0a20 2020 2020 2020 2020 2020  ace:.           
-00014b20: 2066 6f72 2074 6167 2069 6e20 7261 6e67   for tag in rang
-00014b30: 6528 302c 2034 293a 0a20 2020 2020 2020  e(0, 4):.       
-00014b40: 2020 2020 2020 2020 2073 7263 203d 2028           src = (
-00014b50: 776f 726b 7370 6163 6520 2f20 6622 7465  workspace / f"te
-00014b60: 7374 7b74 6167 7d2e 7079 2229 2e72 6573  st{tag}.py").res
-00014b70: 6f6c 7665 2829 0a20 2020 2020 2020 2020  olve().         
-00014b80: 2020 2020 2020 2077 6974 6820 7372 632e         with src.
-00014b90: 6f70 656e 2822 7722 2920 6173 2066 6f62  open("w") as fob
-00014ba0: 6a3a 0a20 2020 2020 2020 2020 2020 2020  j:.             
-00014bb0: 2020 2020 2020 2066 6f62 6a2e 7772 6974         fobj.writ
-00014bc0: 6528 2270 7269 6e74 2827 6865 6c6c 6f27  e("print('hello'
-00014bd0: 2922 290a 2020 2020 2020 2020 2020 2020  )").            
-00014be0: 7769 7468 2070 6174 6368 280a 2020 2020  with patch(.    
-00014bf0: 2020 2020 2020 2020 2020 2020 2263 6572              "cer
-00014c00: 6369 732e 636f 6e63 7572 7265 6e63 792e  cis.concurrency.
-00014c10: 4d61 6e61 6765 7222 2c20 7772 6170 733d  Manager", wraps=
-00014c20: 6d75 6c74 6970 726f 6365 7373 696e 672e  multiprocessing.
-00014c30: 4d61 6e61 6765 720a 2020 2020 2020 2020  Manager.        
-00014c40: 2020 2020 2920 6173 206d 6772 3a0a 2020      ) as mgr:.  
-00014c50: 2020 2020 2020 2020 2020 2020 2020 636d                cm
-00014c60: 6420 3d20 5b22 2d2d 6469 6666 222c 2073  d = ["--diff", s
-00014c70: 7472 2877 6f72 6b73 7061 6365 295d 0a20  tr(workspace)]. 
-00014c80: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00014c90: 6620 636f 6c6f 723a 0a20 2020 2020 2020  f color:.       
-00014ca0: 2020 2020 2020 2020 2020 2020 2063 6d64               cmd
-00014cb0: 2e61 7070 656e 6428 222d 2d63 6f6c 6f72  .append("--color
-00014cc0: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-00014cd0: 2020 2069 6e76 6f6b 6542 6c61 636b 2863     invokeBlack(c
-00014ce0: 6d64 2c20 6578 6974 5f63 6f64 653d 3029  md, exit_code=0)
-00014cf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014d00: 2023 2074 6869 7320 6973 6e27 7420 7175   # this isn't qu
-00014d10: 6974 6520 646f 696e 6720 7768 6174 2077  ite doing what w
-00014d20: 6520 7761 6e74 2c20 6275 7420 6966 2069  e want, but if i
-00014d30: 7420 5f69 736e 2774 5f0a 2020 2020 2020  t _isn't_.      
-00014d40: 2020 2020 2020 2020 2020 2320 6361 6c6c            # call
-00014d50: 6564 2074 6865 6e20 7765 2063 616e 6e6f  ed then we canno
-00014d60: 7420 6265 2075 7369 6e67 2074 6865 206c  t be using the l
-00014d70: 6f63 6b20 6974 2070 726f 7669 6465 730a  ock it provides.
-00014d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014d90: 6d67 722e 6173 7365 7274 5f63 616c 6c65  mgr.assert_calle
-00014da0: 6428 290a 0a20 2020 2064 6566 2074 6573  d()..    def tes
-00014db0: 745f 6e6f 5f63 6163 6865 5f77 6865 6e5f  t_no_cache_when_
-00014dc0: 7374 6469 6e28 7365 6c66 2920 2d3e 204e  stdin(self) -> N
-00014dd0: 6f6e 653a 0a20 2020 2020 2020 206d 6f64  one:.        mod
-00014de0: 6520 3d20 4445 4641 554c 545f 4d4f 4445  e = DEFAULT_MODE
-00014df0: 0a20 2020 2020 2020 2077 6974 6820 6361  .        with ca
-00014e00: 6368 655f 6469 7228 293a 0a20 2020 2020  che_dir():.     
-00014e10: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
-00014e20: 436c 6952 756e 6e65 7228 292e 696e 766f  CliRunner().invo
-00014e30: 6b65 280a 2020 2020 2020 2020 2020 2020  ke(.            
-00014e40: 2020 2020 6365 7263 6973 2e6d 6169 6e2c      cercis.main,
-00014e50: 205b 222d 225d 2c20 696e 7075 743d 4279   ["-"], input=By
-00014e60: 7465 7349 4f28 6222 7072 696e 7428 2768  tesIO(b"print('h
-00014e70: 656c 6c6f 2729 2229 0a20 2020 2020 2020  ello')").       
-00014e80: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00014e90: 2020 2061 7373 6572 7420 6e6f 7420 7265     assert not re
-00014ea0: 7375 6c74 2e65 7869 745f 636f 6465 0a20  sult.exit_code. 
-00014eb0: 2020 2020 2020 2020 2020 2063 6163 6865             cache
-00014ec0: 5f66 696c 6520 3d20 6765 745f 6361 6368  _file = get_cach
-00014ed0: 655f 6669 6c65 286d 6f64 6529 0a20 2020  e_file(mode).   
-00014ee0: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
-00014ef0: 6e6f 7420 6361 6368 655f 6669 6c65 2e65  not cache_file.e
-00014f00: 7869 7374 7328 290a 0a20 2020 2064 6566  xists()..    def
-00014f10: 2074 6573 745f 7265 6164 5f63 6163 6865   test_read_cache
-00014f20: 5f6e 6f5f 6361 6368 6566 696c 6528 7365  _no_cachefile(se
-00014f30: 6c66 2920 2d3e 204e 6f6e 653a 0a20 2020  lf) -> None:.   
-00014f40: 2020 2020 206d 6f64 6520 3d20 4445 4641       mode = DEFA
-00014f50: 554c 545f 4d4f 4445 0a20 2020 2020 2020  ULT_MODE.       
-00014f60: 2077 6974 6820 6361 6368 655f 6469 7228   with cache_dir(
-00014f70: 293a 0a20 2020 2020 2020 2020 2020 2061  ):.            a
-00014f80: 7373 6572 7420 6365 7263 6973 2e72 6561  ssert cercis.rea
-00014f90: 645f 6361 6368 6528 6d6f 6465 2920 3d3d  d_cache(mode) ==
-00014fa0: 207b 7d0a 0a20 2020 2064 6566 2074 6573   {}..    def tes
-00014fb0: 745f 7772 6974 655f 6361 6368 655f 7265  t_write_cache_re
-00014fc0: 6164 5f63 6163 6865 2873 656c 6629 202d  ad_cache(self) -
-00014fd0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00014fe0: 6d6f 6465 203d 2044 4546 4155 4c54 5f4d  mode = DEFAULT_M
-00014ff0: 4f44 450a 2020 2020 2020 2020 7769 7468  ODE.        with
-00015000: 2063 6163 6865 5f64 6972 2829 2061 7320   cache_dir() as 
-00015010: 776f 726b 7370 6163 653a 0a20 2020 2020  workspace:.     
-00015020: 2020 2020 2020 2073 7263 203d 2028 776f         src = (wo
-00015030: 726b 7370 6163 6520 2f20 2274 6573 742e  rkspace / "test.
-00015040: 7079 2229 2e72 6573 6f6c 7665 2829 0a20  py").resolve(). 
-00015050: 2020 2020 2020 2020 2020 2073 7263 2e74             src.t
-00015060: 6f75 6368 2829 0a20 2020 2020 2020 2020  ouch().         
-00015070: 2020 2063 6572 6369 732e 7772 6974 655f     cercis.write_
-00015080: 6361 6368 6528 7b7d 2c20 5b73 7263 5d2c  cache({}, [src],
-00015090: 206d 6f64 6529 0a20 2020 2020 2020 2020   mode).         
-000150a0: 2020 2063 6163 6865 203d 2063 6572 6369     cache = cerci
-000150b0: 732e 7265 6164 5f63 6163 6865 286d 6f64  s.read_cache(mod
-000150c0: 6529 0a20 2020 2020 2020 2020 2020 2061  e).            a
-000150d0: 7373 6572 7420 7374 7228 7372 6329 2069  ssert str(src) i
-000150e0: 6e20 6361 6368 650a 2020 2020 2020 2020  n cache.        
-000150f0: 2020 2020 6173 7365 7274 2063 6163 6865      assert cache
-00015100: 5b73 7472 2873 7263 295d 203d 3d20 6365  [str(src)] == ce
-00015110: 7263 6973 2e67 6574 5f63 6163 6865 5f69  rcis.get_cache_i
-00015120: 6e66 6f28 7372 6329 0a0a 2020 2020 6465  nfo(src)..    de
-00015130: 6620 7465 7374 5f66 696c 7465 725f 6361  f test_filter_ca
-00015140: 6368 6564 2873 656c 6629 202d 3e20 4e6f  ched(self) -> No
-00015150: 6e65 3a0a 2020 2020 2020 2020 7769 7468  ne:.        with
-00015160: 2054 656d 706f 7261 7279 4469 7265 6374   TemporaryDirect
-00015170: 6f72 7928 2920 6173 2077 6f72 6b73 7061  ory() as workspa
-00015180: 6365 3a0a 2020 2020 2020 2020 2020 2020  ce:.            
-00015190: 7061 7468 203d 2050 6174 6828 776f 726b  path = Path(work
-000151a0: 7370 6163 6529 0a20 2020 2020 2020 2020  space).         
-000151b0: 2020 2075 6e63 6163 6865 6420 3d20 2870     uncached = (p
-000151c0: 6174 6820 2f20 2275 6e63 6163 6865 6422  ath / "uncached"
-000151d0: 292e 7265 736f 6c76 6528 290a 2020 2020  ).resolve().    
-000151e0: 2020 2020 2020 2020 6361 6368 6564 203d          cached =
-000151f0: 2028 7061 7468 202f 2022 6361 6368 6564   (path / "cached
-00015200: 2229 2e72 6573 6f6c 7665 2829 0a20 2020  ").resolve().   
-00015210: 2020 2020 2020 2020 2063 6163 6865 645f           cached_
-00015220: 6275 745f 6368 616e 6765 6420 3d20 2870  but_changed = (p
-00015230: 6174 6820 2f20 2263 6861 6e67 6564 2229  ath / "changed")
-00015240: 2e72 6573 6f6c 7665 2829 0a20 2020 2020  .resolve().     
-00015250: 2020 2020 2020 2075 6e63 6163 6865 642e         uncached.
-00015260: 746f 7563 6828 290a 2020 2020 2020 2020  touch().        
-00015270: 2020 2020 6361 6368 6564 2e74 6f75 6368      cached.touch
-00015280: 2829 0a20 2020 2020 2020 2020 2020 2063  ().            c
-00015290: 6163 6865 645f 6275 745f 6368 616e 6765  ached_but_change
-000152a0: 642e 746f 7563 6828 290a 2020 2020 2020  d.touch().      
-000152b0: 2020 2020 2020 6361 6368 6520 3d20 7b0a        cache = {.
-000152c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000152d0: 7374 7228 6361 6368 6564 293a 2063 6572  str(cached): cer
-000152e0: 6369 732e 6765 745f 6361 6368 655f 696e  cis.get_cache_in
-000152f0: 666f 2863 6163 6865 6429 2c0a 2020 2020  fo(cached),.    
-00015300: 2020 2020 2020 2020 2020 2020 7374 7228              str(
-00015310: 6361 6368 6564 5f62 7574 5f63 6861 6e67  cached_but_chang
-00015320: 6564 293a 2028 302e 302c 2030 292c 0a20  ed): (0.0, 0),. 
-00015330: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
-00015340: 2020 2020 2020 2020 2074 6f64 6f2c 2064           todo, d
-00015350: 6f6e 6520 3d20 6365 7263 6973 2e63 6163  one = cercis.cac
-00015360: 6865 2e66 696c 7465 725f 6361 6368 6564  he.filter_cached
-00015370: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00015380: 2020 6361 6368 652c 207b 756e 6361 6368    cache, {uncach
-00015390: 6564 2c20 6361 6368 6564 2c20 6361 6368  ed, cached, cach
-000153a0: 6564 5f62 7574 5f63 6861 6e67 6564 7d0a  ed_but_changed}.
-000153b0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-000153c0: 2020 2020 2020 2020 2020 6173 7365 7274            assert
-000153d0: 2074 6f64 6f20 3d3d 207b 756e 6361 6368   todo == {uncach
-000153e0: 6564 2c20 6361 6368 6564 5f62 7574 5f63  ed, cached_but_c
-000153f0: 6861 6e67 6564 7d0a 2020 2020 2020 2020  hanged}.        
-00015400: 2020 2020 6173 7365 7274 2064 6f6e 6520      assert done 
-00015410: 3d3d 207b 6361 6368 6564 7d0a 0a20 2020  == {cached}..   
-00015420: 2064 6566 2074 6573 745f 7772 6974 655f   def test_write_
-00015430: 6361 6368 655f 6372 6561 7465 735f 6469  cache_creates_di
-00015440: 7265 6374 6f72 795f 6966 5f6e 6565 6465  rectory_if_neede
-00015450: 6428 7365 6c66 2920 2d3e 204e 6f6e 653a  d(self) -> None:
-00015460: 0a20 2020 2020 2020 206d 6f64 6520 3d20  .        mode = 
-00015470: 4445 4641 554c 545f 4d4f 4445 0a20 2020  DEFAULT_MODE.   
-00015480: 2020 2020 2077 6974 6820 6361 6368 655f       with cache_
-00015490: 6469 7228 6578 6973 7473 3d46 616c 7365  dir(exists=False
-000154a0: 2920 6173 2077 6f72 6b73 7061 6365 3a0a  ) as workspace:.
-000154b0: 2020 2020 2020 2020 2020 2020 6173 7365              asse
-000154c0: 7274 206e 6f74 2077 6f72 6b73 7061 6365  rt not workspace
-000154d0: 2e65 7869 7374 7328 290a 2020 2020 2020  .exists().      
-000154e0: 2020 2020 2020 6365 7263 6973 2e77 7269        cercis.wri
-000154f0: 7465 5f63 6163 6865 287b 7d2c 205b 5d2c  te_cache({}, [],
-00015500: 206d 6f64 6529 0a20 2020 2020 2020 2020   mode).         
-00015510: 2020 2061 7373 6572 7420 776f 726b 7370     assert worksp
-00015520: 6163 652e 6578 6973 7473 2829 0a0a 2020  ace.exists()..  
-00015530: 2020 4065 7665 6e74 5f6c 6f6f 7028 290a    @event_loop().
-00015540: 2020 2020 6465 6620 7465 7374 5f66 6169      def test_fai
-00015550: 6c65 645f 666f 726d 6174 7469 6e67 5f64  led_formatting_d
-00015560: 6f65 735f 6e6f 745f 6765 745f 6361 6368  oes_not_get_cach
-00015570: 6564 2873 656c 6629 202d 3e20 4e6f 6e65  ed(self) -> None
-00015580: 3a0a 2020 2020 2020 2020 6d6f 6465 203d  :.        mode =
-00015590: 2044 4546 4155 4c54 5f4d 4f44 450a 2020   DEFAULT_MODE.  
-000155a0: 2020 2020 2020 7769 7468 2063 6163 6865        with cache
-000155b0: 5f64 6972 2829 2061 7320 776f 726b 7370  _dir() as worksp
-000155c0: 6163 652c 2070 6174 6368 280a 2020 2020  ace, patch(.    
-000155d0: 2020 2020 2020 2020 2263 6f6e 6375 7272          "concurr
-000155e0: 656e 742e 6675 7475 7265 732e 5072 6f63  ent.futures.Proc
-000155f0: 6573 7350 6f6f 6c45 7865 6375 746f 7222  essPoolExecutor"
-00015600: 2c20 6e65 773d 5468 7265 6164 506f 6f6c  , new=ThreadPool
-00015610: 4578 6563 7574 6f72 0a20 2020 2020 2020  Executor.       
-00015620: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
-00015630: 6661 696c 696e 6720 3d20 2877 6f72 6b73  failing = (works
-00015640: 7061 6365 202f 2022 6661 696c 696e 672e  pace / "failing.
-00015650: 7079 2229 2e72 6573 6f6c 7665 2829 0a20  py").resolve(). 
-00015660: 2020 2020 2020 2020 2020 2077 6974 6820             with 
-00015670: 6661 696c 696e 672e 6f70 656e 2822 7722  failing.open("w"
-00015680: 2920 6173 2066 6f62 6a3a 0a20 2020 2020  ) as fobj:.     
-00015690: 2020 2020 2020 2020 2020 2066 6f62 6a2e             fobj.
-000156a0: 7772 6974 6528 226e 6f74 2061 6374 7561  write("not actua
-000156b0: 6c6c 7920 7079 7468 6f6e 2229 0a20 2020  lly python").   
-000156c0: 2020 2020 2020 2020 2063 6c65 616e 203d           clean =
-000156d0: 2028 776f 726b 7370 6163 6520 2f20 2263   (workspace / "c
-000156e0: 6c65 616e 2e70 7922 292e 7265 736f 6c76  lean.py").resolv
-000156f0: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
-00015700: 7769 7468 2063 6c65 616e 2e6f 7065 6e28  with clean.open(
-00015710: 2277 2229 2061 7320 666f 626a 3a0a 2020  "w") as fobj:.  
-00015720: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00015730: 626a 2e77 7269 7465 2827 7072 696e 7428  bj.write('print(
-00015740: 2268 656c 6c6f 2229 5c6e 2729 0a20 2020  "hello")\n').   
-00015750: 2020 2020 2020 2020 2069 6e76 6f6b 6542           invokeB
-00015760: 6c61 636b 285b 7374 7228 776f 726b 7370  lack([str(worksp
-00015770: 6163 6529 5d2c 2065 7869 745f 636f 6465  ace)], exit_code
-00015780: 3d31 3233 290a 2020 2020 2020 2020 2020  =123).          
-00015790: 2020 6361 6368 6520 3d20 6365 7263 6973    cache = cercis
-000157a0: 2e72 6561 645f 6361 6368 6528 6d6f 6465  .read_cache(mode
-000157b0: 290a 2020 2020 2020 2020 2020 2020 6173  ).            as
-000157c0: 7365 7274 2073 7472 2866 6169 6c69 6e67  sert str(failing
-000157d0: 2920 6e6f 7420 696e 2063 6163 6865 0a20  ) not in cache. 
-000157e0: 2020 2020 2020 2020 2020 2061 7373 6572             asser
-000157f0: 7420 7374 7228 636c 6561 6e29 2069 6e20  t str(clean) in 
-00015800: 6361 6368 650a 0a20 2020 2064 6566 2074  cache..    def t
-00015810: 6573 745f 7772 6974 655f 6361 6368 655f  est_write_cache_
-00015820: 7772 6974 655f 6661 696c 2873 656c 6629  write_fail(self)
-00015830: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-00015840: 2020 6d6f 6465 203d 2044 4546 4155 4c54    mode = DEFAULT
-00015850: 5f4d 4f44 450a 2020 2020 2020 2020 7769  _MODE.        wi
-00015860: 7468 2063 6163 6865 5f64 6972 2829 2c20  th cache_dir(), 
-00015870: 7061 7463 682e 6f62 6a65 6374 2850 6174  patch.object(Pat
-00015880: 682c 2022 6f70 656e 2229 2061 7320 6d6f  h, "open") as mo
-00015890: 636b 3a0a 2020 2020 2020 2020 2020 2020  ck:.            
-000158a0: 6d6f 636b 2e73 6964 655f 6566 6665 6374  mock.side_effect
-000158b0: 203d 204f 5345 7272 6f72 0a20 2020 2020   = OSError.     
-000158c0: 2020 2020 2020 2063 6572 6369 732e 7772         cercis.wr
-000158d0: 6974 655f 6361 6368 6528 7b7d 2c20 5b5d  ite_cache({}, []
-000158e0: 2c20 6d6f 6465 290a 0a20 2020 2064 6566  , mode)..    def
-000158f0: 2074 6573 745f 7265 6164 5f63 6163 6865   test_read_cache
-00015900: 5f6c 696e 655f 6c65 6e67 7468 7328 7365  _line_lengths(se
-00015910: 6c66 2920 2d3e 204e 6f6e 653a 0a20 2020  lf) -> None:.   
-00015920: 2020 2020 206d 6f64 6520 3d20 4445 4641       mode = DEFA
-00015930: 554c 545f 4d4f 4445 0a20 2020 2020 2020  ULT_MODE.       
-00015940: 2073 686f 7274 5f6d 6f64 6520 3d20 7265   short_mode = re
-00015950: 706c 6163 6528 4445 4641 554c 545f 4d4f  place(DEFAULT_MO
-00015960: 4445 2c20 6c69 6e65 5f6c 656e 6774 683d  DE, line_length=
-00015970: 3129 0a20 2020 2020 2020 2077 6974 6820  1).        with 
-00015980: 6361 6368 655f 6469 7228 2920 6173 2077  cache_dir() as w
-00015990: 6f72 6b73 7061 6365 3a0a 2020 2020 2020  orkspace:.      
-000159a0: 2020 2020 2020 7061 7468 203d 2028 776f        path = (wo
-000159b0: 726b 7370 6163 6520 2f20 2266 696c 652e  rkspace / "file.
-000159c0: 7079 2229 2e72 6573 6f6c 7665 2829 0a20  py").resolve(). 
-000159d0: 2020 2020 2020 2020 2020 2070 6174 682e             path.
-000159e0: 746f 7563 6828 290a 2020 2020 2020 2020  touch().        
-000159f0: 2020 2020 6365 7263 6973 2e77 7269 7465      cercis.write
-00015a00: 5f63 6163 6865 287b 7d2c 205b 7061 7468  _cache({}, [path
-00015a10: 5d2c 206d 6f64 6529 0a20 2020 2020 2020  ], mode).       
-00015a20: 2020 2020 206f 6e65 203d 2063 6572 6369       one = cerci
-00015a30: 732e 7265 6164 5f63 6163 6865 286d 6f64  s.read_cache(mod
-00015a40: 6529 0a20 2020 2020 2020 2020 2020 2061  e).            a
-00015a50: 7373 6572 7420 7374 7228 7061 7468 2920  ssert str(path) 
-00015a60: 696e 206f 6e65 0a20 2020 2020 2020 2020  in one.         
-00015a70: 2020 2074 776f 203d 2063 6572 6369 732e     two = cercis.
-00015a80: 7265 6164 5f63 6163 6865 2873 686f 7274  read_cache(short
-00015a90: 5f6d 6f64 6529 0a20 2020 2020 2020 2020  _mode).         
-00015aa0: 2020 2061 7373 6572 7420 7374 7228 7061     assert str(pa
-00015ab0: 7468 2920 6e6f 7420 696e 2074 776f 0a0a  th) not in two..
-00015ac0: 0a64 6566 2061 7373 6572 745f 636f 6c6c  .def assert_coll
-00015ad0: 6563 7465 645f 736f 7572 6365 7328 0a20  ected_sources(. 
-00015ae0: 2020 2020 2020 2073 7263 3a20 5365 7175         src: Sequ
-00015af0: 656e 6365 5b55 6e69 6f6e 5b73 7472 2c20  ence[Union[str, 
-00015b00: 5061 7468 5d5d 2c0a 2020 2020 2020 2020  Path]],.        
-00015b10: 6578 7065 6374 6564 3a20 5365 7175 656e  expected: Sequen
-00015b20: 6365 5b55 6e69 6f6e 5b73 7472 2c20 5061  ce[Union[str, Pa
-00015b30: 7468 5d5d 2c0a 2020 2020 2020 2020 2a2c  th]],.        *,
-00015b40: 0a20 2020 2020 2020 2063 7478 3a20 4f70  .        ctx: Op
-00015b50: 7469 6f6e 616c 5b46 616b 6543 6f6e 7465  tional[FakeConte
-00015b60: 7874 5d20 3d20 4e6f 6e65 2c0a 2020 2020  xt] = None,.    
-00015b70: 2020 2020 6578 636c 7564 653a 204f 7074      exclude: Opt
-00015b80: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
-00015b90: 652c 0a20 2020 2020 2020 2069 6e63 6c75  e,.        inclu
-00015ba0: 6465 3a20 4f70 7469 6f6e 616c 5b73 7472  de: Optional[str
-00015bb0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-00015bc0: 2020 6578 7465 6e64 5f65 7863 6c75 6465    extend_exclude
-00015bd0: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
-00015be0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00015bf0: 666f 7263 655f 6578 636c 7564 653a 204f  force_exclude: O
-00015c00: 7074 696f 6e61 6c5b 7374 725d 203d 204e  ptional[str] = N
-00015c10: 6f6e 652c 0a20 2020 2020 2020 2073 7464  one,.        std
-00015c20: 696e 5f66 696c 656e 616d 653a 204f 7074  in_filename: Opt
+00005270: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00005280: 706f 7274 3d72 6570 6f72 742c 0a20 2020  port=report,.   
+00005290: 2020 2020 2020 2020 2020 2020 2065 7874               ext
+000052a0: 656e 645f 6578 636c 7564 653d 4e6f 6e65  end_exclude=None
+000052b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000052c0: 2020 666f 7263 655f 6578 636c 7564 653d    force_exclude=
+000052d0: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
+000052e0: 2020 2020 2020 7374 6469 6e5f 6669 6c65        stdin_file
+000052f0: 6e61 6d65 3d4e 6f6e 652c 0a20 2020 2020  name=None,.     
+00005300: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00005310: 2061 7373 6572 7420 6e6f 7420 616e 7928   assert not any(
+00005320: 0a20 2020 2020 2020 2020 2020 206d 6f63  .            moc
+00005330: 6b5f 6172 6773 5b31 5d2e 7374 6172 7473  k_args[1].starts
+00005340: 7769 7468 2822 6973 2061 2073 796d 626f  with("is a symbo
+00005350: 6c69 6320 6c69 6e6b 2074 6861 7420 706f  lic link that po
+00005360: 696e 7473 206f 7574 7369 6465 2229 0a20  ints outside"). 
+00005370: 2020 2020 2020 2020 2020 2066 6f72 205f             for _
+00005380: 2c20 6d6f 636b 5f61 7267 732c 205f 2069  , mock_args, _ i
+00005390: 6e20 7265 706f 7274 2e70 6174 685f 6967  n report.path_ig
+000053a0: 6e6f 7265 642e 6d6f 636b 5f63 616c 6c73  nored.mock_calls
+000053b0: 0a20 2020 2020 2020 2029 2c20 2241 2073  .        ), "A s
+000053c0: 796d 626f 6c69 6320 6c69 6e6b 2077 6173  ymbolic link was
+000053d0: 2072 6570 6f72 7465 642e 220a 2020 2020   reported.".    
+000053e0: 2020 2020 7265 706f 7274 2e70 6174 685f      report.path_
+000053f0: 6967 6e6f 7265 642e 6173 7365 7274 5f63  ignored.assert_c
+00005400: 616c 6c65 645f 6f6e 6365 5f77 6974 6828  alled_once_with(
+00005410: 0a20 2020 2020 2020 2020 2020 2050 6174  .            Pat
+00005420: 6828 2272 6f6f 7422 2c20 2263 6869 6c64  h("root", "child
+00005430: 222c 2022 622e 7079 2229 2c20 226d 6174  ", "b.py"), "mat
+00005440: 6368 6573 2061 202e 6769 7469 676e 6f72  ches a .gitignor
+00005450: 6520 6669 6c65 2063 6f6e 7465 6e74 220a  e file content".
+00005460: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+00005470: 6566 2074 6573 745f 7265 706f 7274 5f76  ef test_report_v
+00005480: 6572 626f 7365 2873 656c 6629 202d 3e20  erbose(self) -> 
+00005490: 4e6f 6e65 3a0a 2020 2020 2020 2020 7265  None:.        re
+000054a0: 706f 7274 203d 2052 6570 6f72 7428 7665  port = Report(ve
+000054b0: 7262 6f73 653d 5472 7565 290a 2020 2020  rbose=True).    
+000054c0: 2020 2020 6f75 745f 6c69 6e65 7320 3d20      out_lines = 
+000054d0: 5b5d 0a20 2020 2020 2020 2065 7272 5f6c  [].        err_l
+000054e0: 696e 6573 203d 205b 5d0a 0a20 2020 2020  ines = []..     
+000054f0: 2020 2064 6566 206f 7574 286d 7367 3a20     def out(msg: 
+00005500: 7374 722c 202a 2a6b 7761 7267 733a 2041  str, **kwargs: A
+00005510: 6e79 2920 2d3e 204e 6f6e 653a 0a20 2020  ny) -> None:.   
+00005520: 2020 2020 2020 2020 206f 7574 5f6c 696e           out_lin
+00005530: 6573 2e61 7070 656e 6428 6d73 6729 0a0a  es.append(msg)..
+00005540: 2020 2020 2020 2020 6465 6620 6572 7228          def err(
+00005550: 6d73 673a 2073 7472 2c20 2a2a 6b77 6172  msg: str, **kwar
+00005560: 6773 3a20 416e 7929 202d 3e20 4e6f 6e65  gs: Any) -> None
+00005570: 3a0a 2020 2020 2020 2020 2020 2020 6572  :.            er
+00005580: 725f 6c69 6e65 732e 6170 7065 6e64 286d  r_lines.append(m
+00005590: 7367 290a 0a20 2020 2020 2020 2077 6974  sg)..        wit
+000055a0: 6820 7061 7463 6828 2263 6572 6369 732e  h patch("cercis.
+000055b0: 6f75 7470 7574 2e5f 6f75 7422 2c20 6f75  output._out", ou
+000055c0: 7429 2c20 7061 7463 6828 2263 6572 6369  t), patch("cerci
+000055d0: 732e 6f75 7470 7574 2e5f 6572 7222 2c20  s.output._err", 
+000055e0: 6572 7229 3a0a 2020 2020 2020 2020 2020  err):.          
+000055f0: 2020 7265 706f 7274 2e64 6f6e 6528 5061    report.done(Pa
+00005600: 7468 2822 6631 2229 2c20 6365 7263 6973  th("f1"), cercis
+00005610: 2e43 6861 6e67 6564 2e4e 4f29 0a20 2020  .Changed.NO).   
+00005620: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00005630: 7365 7274 4571 7561 6c28 6c65 6e28 6f75  sertEqual(len(ou
+00005640: 745f 6c69 6e65 7329 2c20 3129 0a20 2020  t_lines), 1).   
+00005650: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00005660: 7365 7274 4571 7561 6c28 6c65 6e28 6572  sertEqual(len(er
+00005670: 725f 6c69 6e65 7329 2c20 3029 0a20 2020  r_lines), 0).   
+00005680: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00005690: 7365 7274 4571 7561 6c28 6f75 745f 6c69  sertEqual(out_li
+000056a0: 6e65 735b 2d31 5d2c 2022 6631 2061 6c72  nes[-1], "f1 alr
+000056b0: 6561 6479 2077 656c 6c20 666f 726d 6174  eady well format
+000056c0: 7465 642c 2067 6f6f 6420 6a6f 622e 2229  ted, good job.")
+000056d0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000056e0: 662e 6173 7365 7274 4571 7561 6c28 756e  f.assertEqual(un
+000056f0: 7374 796c 6528 7374 7228 7265 706f 7274  style(str(report
+00005700: 2929 2c20 2231 2066 696c 6520 6c65 6674  )), "1 file left
+00005710: 2075 6e63 6861 6e67 6564 2e22 290a 2020   unchanged.").  
+00005720: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00005730: 7373 6572 7445 7175 616c 2872 6570 6f72  ssertEqual(repor
+00005740: 742e 7265 7475 726e 5f63 6f64 652c 2030  t.return_code, 0
+00005750: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+00005760: 706f 7274 2e64 6f6e 6528 5061 7468 2822  port.done(Path("
+00005770: 6632 2229 2c20 6365 7263 6973 2e43 6861  f2"), cercis.Cha
+00005780: 6e67 6564 2e59 4553 290a 2020 2020 2020  nged.YES).      
+00005790: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+000057a0: 7445 7175 616c 286c 656e 286f 7574 5f6c  tEqual(len(out_l
+000057b0: 696e 6573 292c 2032 290a 2020 2020 2020  ines), 2).      
+000057c0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+000057d0: 7445 7175 616c 286c 656e 2865 7272 5f6c  tEqual(len(err_l
+000057e0: 696e 6573 292c 2030 290a 2020 2020 2020  ines), 0).      
+000057f0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00005800: 7445 7175 616c 286f 7574 5f6c 696e 6573  tEqual(out_lines
+00005810: 5b2d 315d 2c20 2272 6566 6f72 6d61 7474  [-1], "reformatt
+00005820: 6564 2066 3222 290a 2020 2020 2020 2020  ed f2").        
+00005830: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00005840: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+00005850: 2020 2020 2020 756e 7374 796c 6528 7374        unstyle(st
+00005860: 7228 7265 706f 7274 2929 2c20 2231 2066  r(report)), "1 f
+00005870: 696c 6520 7265 666f 726d 6174 7465 642c  ile reformatted,
+00005880: 2031 2066 696c 6520 6c65 6674 2075 6e63   1 file left unc
+00005890: 6861 6e67 6564 2e22 0a20 2020 2020 2020  hanged.".       
+000058a0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+000058b0: 2020 2072 6570 6f72 742e 646f 6e65 2850     report.done(P
+000058c0: 6174 6828 2266 3322 292c 2063 6572 6369  ath("f3"), cerci
+000058d0: 732e 4368 616e 6765 642e 4341 4348 4544  s.Changed.CACHED
+000058e0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+000058f0: 6c66 2e61 7373 6572 7445 7175 616c 286c  lf.assertEqual(l
+00005900: 656e 286f 7574 5f6c 696e 6573 292c 2033  en(out_lines), 3
+00005910: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00005920: 6c66 2e61 7373 6572 7445 7175 616c 286c  lf.assertEqual(l
+00005930: 656e 2865 7272 5f6c 696e 6573 292c 2030  en(err_lines), 0
+00005940: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00005950: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+00005960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005970: 6f75 745f 6c69 6e65 735b 2d31 5d2c 2022  out_lines[-1], "
+00005980: 6633 2077 6173 6e27 7420 6d6f 6469 6669  f3 wasn't modifi
+00005990: 6564 206f 6e20 6469 736b 2073 696e 6365  ed on disk since
+000059a0: 206c 6173 7420 7275 6e2e 220a 2020 2020   last run.".    
+000059b0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000059c0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+000059d0: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
+000059e0: 2020 2020 2020 2020 756e 7374 796c 6528          unstyle(
+000059f0: 7374 7228 7265 706f 7274 2929 2c20 2231  str(report)), "1
+00005a00: 2066 696c 6520 7265 666f 726d 6174 7465   file reformatte
+00005a10: 642c 2032 2066 696c 6573 206c 6566 7420  d, 2 files left 
+00005a20: 756e 6368 616e 6765 642e 220a 2020 2020  unchanged.".    
+00005a30: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00005a40: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00005a50: 7445 7175 616c 2872 6570 6f72 742e 7265  tEqual(report.re
+00005a60: 7475 726e 5f63 6f64 652c 2030 290a 2020  turn_code, 0).  
+00005a70: 2020 2020 2020 2020 2020 7265 706f 7274            report
+00005a80: 2e63 6865 636b 203d 2054 7275 650a 2020  .check = True.  
+00005a90: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00005aa0: 7373 6572 7445 7175 616c 2872 6570 6f72  ssertEqual(repor
+00005ab0: 742e 7265 7475 726e 5f63 6f64 652c 2031  t.return_code, 1
+00005ac0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+00005ad0: 706f 7274 2e63 6865 636b 203d 2046 616c  port.check = Fal
+00005ae0: 7365 0a20 2020 2020 2020 2020 2020 2072  se.            r
+00005af0: 6570 6f72 742e 6661 696c 6564 2850 6174  eport.failed(Pat
+00005b00: 6828 2265 3122 292c 2022 626f 6f6d 2229  h("e1"), "boom")
+00005b10: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00005b20: 662e 6173 7365 7274 4571 7561 6c28 6c65  f.assertEqual(le
+00005b30: 6e28 6f75 745f 6c69 6e65 7329 2c20 3329  n(out_lines), 3)
+00005b40: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00005b50: 662e 6173 7365 7274 4571 7561 6c28 6c65  f.assertEqual(le
+00005b60: 6e28 6572 725f 6c69 6e65 7329 2c20 3129  n(err_lines), 1)
+00005b70: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00005b80: 662e 6173 7365 7274 4571 7561 6c28 6572  f.assertEqual(er
+00005b90: 725f 6c69 6e65 735b 2d31 5d2c 2022 6572  r_lines[-1], "er
+00005ba0: 726f 723a 2063 616e 6e6f 7420 666f 726d  ror: cannot form
+00005bb0: 6174 2065 313a 2062 6f6f 6d22 290a 2020  at e1: boom").  
+00005bc0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00005bd0: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
+00005be0: 2020 2020 2020 2020 2020 2020 756e 7374              unst
+00005bf0: 796c 6528 7374 7228 7265 706f 7274 2929  yle(str(report))
+00005c00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00005c10: 2020 2231 2066 696c 6520 7265 666f 726d    "1 file reform
+00005c20: 6174 7465 642c 2032 2066 696c 6573 206c  atted, 2 files l
+00005c30: 6566 7420 756e 6368 616e 6765 642c 2031  eft unchanged, 1
+00005c40: 2066 696c 6520 6661 696c 6564 2074 6f22   file failed to"
+00005c50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005c60: 2022 2072 6566 6f72 6d61 742e 222c 0a20   " reformat.",. 
+00005c70: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00005c80: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00005c90: 7365 7274 4571 7561 6c28 7265 706f 7274  sertEqual(report
+00005ca0: 2e72 6574 7572 6e5f 636f 6465 2c20 3132  .return_code, 12
+00005cb0: 3329 0a20 2020 2020 2020 2020 2020 2072  3).            r
+00005cc0: 6570 6f72 742e 646f 6e65 2850 6174 6828  eport.done(Path(
+00005cd0: 2266 3322 292c 2063 6572 6369 732e 4368  "f3"), cercis.Ch
+00005ce0: 616e 6765 642e 5945 5329 0a20 2020 2020  anged.YES).     
+00005cf0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00005d00: 7274 4571 7561 6c28 6c65 6e28 6f75 745f  rtEqual(len(out_
+00005d10: 6c69 6e65 7329 2c20 3429 0a20 2020 2020  lines), 4).     
+00005d20: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00005d30: 7274 4571 7561 6c28 6c65 6e28 6572 725f  rtEqual(len(err_
+00005d40: 6c69 6e65 7329 2c20 3129 0a20 2020 2020  lines), 1).     
+00005d50: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00005d60: 7274 4571 7561 6c28 6f75 745f 6c69 6e65  rtEqual(out_line
+00005d70: 735b 2d31 5d2c 2022 7265 666f 726d 6174  s[-1], "reformat
+00005d80: 7465 6420 6633 2229 0a20 2020 2020 2020  ted f3").       
+00005d90: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00005da0: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+00005db0: 2020 2020 2020 2075 6e73 7479 6c65 2873         unstyle(s
+00005dc0: 7472 2872 6570 6f72 7429 292c 0a20 2020  tr(report)),.   
+00005dd0: 2020 2020 2020 2020 2020 2020 2022 3220               "2 
+00005de0: 6669 6c65 7320 7265 666f 726d 6174 7465  files reformatte
+00005df0: 642c 2032 2066 696c 6573 206c 6566 7420  d, 2 files left 
+00005e00: 756e 6368 616e 6765 642c 2031 2066 696c  unchanged, 1 fil
+00005e10: 6520 6661 696c 6564 2074 6f22 0a20 2020  e failed to".   
+00005e20: 2020 2020 2020 2020 2020 2020 2022 2072               " r
+00005e30: 6566 6f72 6d61 742e 222c 0a20 2020 2020  eformat.",.     
+00005e40: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00005e50: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00005e60: 4571 7561 6c28 7265 706f 7274 2e72 6574  Equal(report.ret
+00005e70: 7572 6e5f 636f 6465 2c20 3132 3329 0a20  urn_code, 123). 
+00005e80: 2020 2020 2020 2020 2020 2072 6570 6f72             repor
+00005e90: 742e 6661 696c 6564 2850 6174 6828 2265  t.failed(Path("e
+00005ea0: 3222 292c 2022 626f 6f6d 2229 0a20 2020  2"), "boom").   
+00005eb0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00005ec0: 7365 7274 4571 7561 6c28 6c65 6e28 6f75  sertEqual(len(ou
+00005ed0: 745f 6c69 6e65 7329 2c20 3429 0a20 2020  t_lines), 4).   
+00005ee0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00005ef0: 7365 7274 4571 7561 6c28 6c65 6e28 6572  sertEqual(len(er
+00005f00: 725f 6c69 6e65 7329 2c20 3229 0a20 2020  r_lines), 2).   
+00005f10: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00005f20: 7365 7274 4571 7561 6c28 6572 725f 6c69  sertEqual(err_li
+00005f30: 6e65 735b 2d31 5d2c 2022 6572 726f 723a  nes[-1], "error:
+00005f40: 2063 616e 6e6f 7420 666f 726d 6174 2065   cannot format e
+00005f50: 323a 2062 6f6f 6d22 290a 2020 2020 2020  2: boom").      
+00005f60: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00005f70: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
+00005f80: 2020 2020 2020 2020 756e 7374 796c 6528          unstyle(
+00005f90: 7374 7228 7265 706f 7274 2929 2c0a 2020  str(report)),.  
+00005fa0: 2020 2020 2020 2020 2020 2020 2020 2232                "2
+00005fb0: 2066 696c 6573 2072 6566 6f72 6d61 7474   files reformatt
+00005fc0: 6564 2c20 3220 6669 6c65 7320 6c65 6674  ed, 2 files left
+00005fd0: 2075 6e63 6861 6e67 6564 2c20 3220 6669   unchanged, 2 fi
+00005fe0: 6c65 7320 6661 696c 6564 2074 6f22 0a20  les failed to". 
+00005ff0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00006000: 2072 6566 6f72 6d61 742e 222c 0a20 2020   reformat.",.   
+00006010: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00006020: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00006030: 7274 4571 7561 6c28 7265 706f 7274 2e72  rtEqual(report.r
+00006040: 6574 7572 6e5f 636f 6465 2c20 3132 3329  eturn_code, 123)
+00006050: 0a20 2020 2020 2020 2020 2020 2072 6570  .            rep
+00006060: 6f72 742e 7061 7468 5f69 676e 6f72 6564  ort.path_ignored
+00006070: 2850 6174 6828 2277 6174 2229 2c20 226e  (Path("wat"), "n
+00006080: 6f20 6d61 7463 6822 290a 2020 2020 2020  o match").      
+00006090: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+000060a0: 7445 7175 616c 286c 656e 286f 7574 5f6c  tEqual(len(out_l
+000060b0: 696e 6573 292c 2035 290a 2020 2020 2020  ines), 5).      
+000060c0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+000060d0: 7445 7175 616c 286c 656e 2865 7272 5f6c  tEqual(len(err_l
+000060e0: 696e 6573 292c 2032 290a 2020 2020 2020  ines), 2).      
+000060f0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00006100: 7445 7175 616c 286f 7574 5f6c 696e 6573  tEqual(out_lines
+00006110: 5b2d 315d 2c20 2277 6174 2069 676e 6f72  [-1], "wat ignor
+00006120: 6564 3a20 6e6f 206d 6174 6368 2229 0a20  ed: no match"). 
+00006130: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00006140: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+00006150: 2020 2020 2020 2020 2020 2020 2075 6e73               uns
+00006160: 7479 6c65 2873 7472 2872 6570 6f72 7429  tyle(str(report)
+00006170: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00006180: 2020 2022 3220 6669 6c65 7320 7265 666f     "2 files refo
+00006190: 726d 6174 7465 642c 2032 2066 696c 6573  rmatted, 2 files
+000061a0: 206c 6566 7420 756e 6368 616e 6765 642c   left unchanged,
+000061b0: 2032 2066 696c 6573 2066 6169 6c65 6420   2 files failed 
+000061c0: 746f 220a 2020 2020 2020 2020 2020 2020  to".            
+000061d0: 2020 2020 2220 7265 666f 726d 6174 2e22      " reformat."
+000061e0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+000061f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00006200: 2e61 7373 6572 7445 7175 616c 2872 6570  .assertEqual(rep
+00006210: 6f72 742e 7265 7475 726e 5f63 6f64 652c  ort.return_code,
+00006220: 2031 3233 290a 2020 2020 2020 2020 2020   123).          
+00006230: 2020 7265 706f 7274 2e64 6f6e 6528 5061    report.done(Pa
+00006240: 7468 2822 6634 2229 2c20 6365 7263 6973  th("f4"), cercis
+00006250: 2e43 6861 6e67 6564 2e4e 4f29 0a20 2020  .Changed.NO).   
+00006260: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00006270: 7365 7274 4571 7561 6c28 6c65 6e28 6f75  sertEqual(len(ou
+00006280: 745f 6c69 6e65 7329 2c20 3629 0a20 2020  t_lines), 6).   
+00006290: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+000062a0: 7365 7274 4571 7561 6c28 6c65 6e28 6572  sertEqual(len(er
+000062b0: 725f 6c69 6e65 7329 2c20 3229 0a20 2020  r_lines), 2).   
+000062c0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+000062d0: 7365 7274 4571 7561 6c28 6f75 745f 6c69  sertEqual(out_li
+000062e0: 6e65 735b 2d31 5d2c 2022 6634 2061 6c72  nes[-1], "f4 alr
+000062f0: 6561 6479 2077 656c 6c20 666f 726d 6174  eady well format
+00006300: 7465 642c 2067 6f6f 6420 6a6f 622e 2229  ted, good job.")
+00006310: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00006320: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
+00006330: 2020 2020 2020 2020 2020 2020 2020 2075                 u
+00006340: 6e73 7479 6c65 2873 7472 2872 6570 6f72  nstyle(str(repor
+00006350: 7429 292c 0a20 2020 2020 2020 2020 2020  t)),.           
+00006360: 2020 2020 2022 3220 6669 6c65 7320 7265       "2 files re
+00006370: 666f 726d 6174 7465 642c 2033 2066 696c  formatted, 3 fil
+00006380: 6573 206c 6566 7420 756e 6368 616e 6765  es left unchange
+00006390: 642c 2032 2066 696c 6573 2066 6169 6c65  d, 2 files faile
+000063a0: 6420 746f 220a 2020 2020 2020 2020 2020  d to".          
+000063b0: 2020 2020 2020 2220 7265 666f 726d 6174        " reformat
+000063c0: 2e22 2c0a 2020 2020 2020 2020 2020 2020  .",.            
+000063d0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+000063e0: 6c66 2e61 7373 6572 7445 7175 616c 2872  lf.assertEqual(r
+000063f0: 6570 6f72 742e 7265 7475 726e 5f63 6f64  eport.return_cod
+00006400: 652c 2031 3233 290a 2020 2020 2020 2020  e, 123).        
+00006410: 2020 2020 7265 706f 7274 2e63 6865 636b      report.check
+00006420: 203d 2054 7275 650a 2020 2020 2020 2020   = True.        
+00006430: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00006440: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+00006450: 2020 2020 2020 756e 7374 796c 6528 7374        unstyle(st
+00006460: 7228 7265 706f 7274 2929 2c0a 2020 2020  r(report)),.    
+00006470: 2020 2020 2020 2020 2020 2020 2232 2066              "2 f
+00006480: 696c 6573 2077 6f75 6c64 2062 6520 7265  iles would be re
+00006490: 666f 726d 6174 7465 642c 2033 2066 696c  formatted, 3 fil
+000064a0: 6573 2077 6f75 6c64 2062 6520 6c65 6674  es would be left
+000064b0: 2075 6e63 6861 6e67 6564 2c20 3222 0a20   unchanged, 2". 
+000064c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000064d0: 2066 696c 6573 2077 6f75 6c64 2066 6169   files would fai
+000064e0: 6c20 746f 2072 6566 6f72 6d61 742e 222c  l to reformat.",
+000064f0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00006500: 2020 2020 2020 2020 2020 2072 6570 6f72             repor
+00006510: 742e 6368 6563 6b20 3d20 4661 6c73 650a  t.check = False.
+00006520: 2020 2020 2020 2020 2020 2020 7265 706f              repo
+00006530: 7274 2e64 6966 6620 3d20 5472 7565 0a20  rt.diff = True. 
+00006540: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00006550: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+00006560: 2020 2020 2020 2020 2020 2020 2075 6e73               uns
+00006570: 7479 6c65 2873 7472 2872 6570 6f72 7429  tyle(str(report)
+00006580: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00006590: 2020 2022 3220 6669 6c65 7320 776f 756c     "2 files woul
+000065a0: 6420 6265 2072 6566 6f72 6d61 7474 6564  d be reformatted
+000065b0: 2c20 3320 6669 6c65 7320 776f 756c 6420  , 3 files would 
+000065c0: 6265 206c 6566 7420 756e 6368 616e 6765  be left unchange
+000065d0: 642c 2032 220a 2020 2020 2020 2020 2020  d, 2".          
+000065e0: 2020 2020 2020 2220 6669 6c65 7320 776f        " files wo
+000065f0: 756c 6420 6661 696c 2074 6f20 7265 666f  uld fail to refo
+00006600: 726d 6174 2e22 2c0a 2020 2020 2020 2020  rmat.",.        
+00006610: 2020 2020 290a 0a20 2020 2064 6566 2074      )..    def t
+00006620: 6573 745f 7265 706f 7274 5f71 7569 6574  est_report_quiet
+00006630: 2873 656c 6629 202d 3e20 4e6f 6e65 3a0a  (self) -> None:.
+00006640: 2020 2020 2020 2020 7265 706f 7274 203d          report =
+00006650: 2052 6570 6f72 7428 7175 6965 743d 5472   Report(quiet=Tr
+00006660: 7565 290a 2020 2020 2020 2020 6f75 745f  ue).        out_
+00006670: 6c69 6e65 7320 3d20 5b5d 0a20 2020 2020  lines = [].     
+00006680: 2020 2065 7272 5f6c 696e 6573 203d 205b     err_lines = [
+00006690: 5d0a 0a20 2020 2020 2020 2064 6566 206f  ]..        def o
+000066a0: 7574 286d 7367 3a20 7374 722c 202a 2a6b  ut(msg: str, **k
+000066b0: 7761 7267 733a 2041 6e79 2920 2d3e 204e  wargs: Any) -> N
+000066c0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+000066d0: 206f 7574 5f6c 696e 6573 2e61 7070 656e   out_lines.appen
+000066e0: 6428 6d73 6729 0a0a 2020 2020 2020 2020  d(msg)..        
+000066f0: 6465 6620 6572 7228 6d73 673a 2073 7472  def err(msg: str
+00006700: 2c20 2a2a 6b77 6172 6773 3a20 416e 7929  , **kwargs: Any)
+00006710: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00006720: 2020 2020 2020 6572 725f 6c69 6e65 732e        err_lines.
+00006730: 6170 7065 6e64 286d 7367 290a 0a20 2020  append(msg)..   
+00006740: 2020 2020 2077 6974 6820 7061 7463 6828       with patch(
+00006750: 2263 6572 6369 732e 6f75 7470 7574 2e5f  "cercis.output._
+00006760: 6f75 7422 2c20 6f75 7429 2c20 7061 7463  out", out), patc
+00006770: 6828 2263 6572 6369 732e 6f75 7470 7574  h("cercis.output
+00006780: 2e5f 6572 7222 2c20 6572 7229 3a0a 2020  ._err", err):.  
+00006790: 2020 2020 2020 2020 2020 7265 706f 7274            report
+000067a0: 2e64 6f6e 6528 5061 7468 2822 6631 2229  .done(Path("f1")
+000067b0: 2c20 6365 7263 6973 2e43 6861 6e67 6564  , cercis.Changed
+000067c0: 2e4e 4f29 0a20 2020 2020 2020 2020 2020  .NO).           
+000067d0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+000067e0: 6c28 6c65 6e28 6f75 745f 6c69 6e65 7329  l(len(out_lines)
+000067f0: 2c20 3029 0a20 2020 2020 2020 2020 2020  , 0).           
+00006800: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00006810: 6c28 6c65 6e28 6572 725f 6c69 6e65 7329  l(len(err_lines)
+00006820: 2c20 3029 0a20 2020 2020 2020 2020 2020  , 0).           
+00006830: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00006840: 6c28 756e 7374 796c 6528 7374 7228 7265  l(unstyle(str(re
+00006850: 706f 7274 2929 2c20 2231 2066 696c 6520  port)), "1 file 
+00006860: 6c65 6674 2075 6e63 6861 6e67 6564 2e22  left unchanged."
+00006870: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00006880: 6c66 2e61 7373 6572 7445 7175 616c 2872  lf.assertEqual(r
+00006890: 6570 6f72 742e 7265 7475 726e 5f63 6f64  eport.return_cod
+000068a0: 652c 2030 290a 2020 2020 2020 2020 2020  e, 0).          
+000068b0: 2020 7265 706f 7274 2e64 6f6e 6528 5061    report.done(Pa
+000068c0: 7468 2822 6632 2229 2c20 6365 7263 6973  th("f2"), cercis
+000068d0: 2e43 6861 6e67 6564 2e59 4553 290a 2020  .Changed.YES).  
+000068e0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+000068f0: 7373 6572 7445 7175 616c 286c 656e 286f  ssertEqual(len(o
+00006900: 7574 5f6c 696e 6573 292c 2030 290a 2020  ut_lines), 0).  
+00006910: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00006920: 7373 6572 7445 7175 616c 286c 656e 2865  ssertEqual(len(e
+00006930: 7272 5f6c 696e 6573 292c 2030 290a 2020  rr_lines), 0).  
+00006940: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00006950: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
+00006960: 2020 2020 2020 2020 2020 2020 756e 7374              unst
+00006970: 796c 6528 7374 7228 7265 706f 7274 2929  yle(str(report))
+00006980: 2c20 2231 2066 696c 6520 7265 666f 726d  , "1 file reform
+00006990: 6174 7465 642c 2031 2066 696c 6520 6c65  atted, 1 file le
+000069a0: 6674 2075 6e63 6861 6e67 6564 2e22 0a20  ft unchanged.". 
+000069b0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+000069c0: 2020 2020 2020 2020 2072 6570 6f72 742e           report.
+000069d0: 646f 6e65 2850 6174 6828 2266 3322 292c  done(Path("f3"),
+000069e0: 2063 6572 6369 732e 4368 616e 6765 642e   cercis.Changed.
+000069f0: 4341 4348 4544 290a 2020 2020 2020 2020  CACHED).        
+00006a00: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00006a10: 7175 616c 286c 656e 286f 7574 5f6c 696e  qual(len(out_lin
+00006a20: 6573 292c 2030 290a 2020 2020 2020 2020  es), 0).        
+00006a30: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00006a40: 7175 616c 286c 656e 2865 7272 5f6c 696e  qual(len(err_lin
+00006a50: 6573 292c 2030 290a 2020 2020 2020 2020  es), 0).        
+00006a60: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00006a70: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+00006a80: 2020 2020 2020 756e 7374 796c 6528 7374        unstyle(st
+00006a90: 7228 7265 706f 7274 2929 2c20 2231 2066  r(report)), "1 f
+00006aa0: 696c 6520 7265 666f 726d 6174 7465 642c  ile reformatted,
+00006ab0: 2032 2066 696c 6573 206c 6566 7420 756e   2 files left un
+00006ac0: 6368 616e 6765 642e 220a 2020 2020 2020  changed.".      
+00006ad0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00006ae0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00006af0: 7175 616c 2872 6570 6f72 742e 7265 7475  qual(report.retu
+00006b00: 726e 5f63 6f64 652c 2030 290a 2020 2020  rn_code, 0).    
+00006b10: 2020 2020 2020 2020 7265 706f 7274 2e63          report.c
+00006b20: 6865 636b 203d 2054 7275 650a 2020 2020  heck = True.    
+00006b30: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00006b40: 6572 7445 7175 616c 2872 6570 6f72 742e  ertEqual(report.
+00006b50: 7265 7475 726e 5f63 6f64 652c 2031 290a  return_code, 1).
+00006b60: 2020 2020 2020 2020 2020 2020 7265 706f              repo
+00006b70: 7274 2e63 6865 636b 203d 2046 616c 7365  rt.check = False
+00006b80: 0a20 2020 2020 2020 2020 2020 2072 6570  .            rep
+00006b90: 6f72 742e 6661 696c 6564 2850 6174 6828  ort.failed(Path(
+00006ba0: 2265 3122 292c 2022 626f 6f6d 2229 0a20  "e1"), "boom"). 
+00006bb0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00006bc0: 6173 7365 7274 4571 7561 6c28 6c65 6e28  assertEqual(len(
+00006bd0: 6f75 745f 6c69 6e65 7329 2c20 3029 0a20  out_lines), 0). 
+00006be0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00006bf0: 6173 7365 7274 4571 7561 6c28 6c65 6e28  assertEqual(len(
+00006c00: 6572 725f 6c69 6e65 7329 2c20 3129 0a20  err_lines), 1). 
+00006c10: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00006c20: 6173 7365 7274 4571 7561 6c28 6572 725f  assertEqual(err_
+00006c30: 6c69 6e65 735b 2d31 5d2c 2022 6572 726f  lines[-1], "erro
+00006c40: 723a 2063 616e 6e6f 7420 666f 726d 6174  r: cannot format
+00006c50: 2065 313a 2062 6f6f 6d22 290a 2020 2020   e1: boom").    
+00006c60: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00006c70: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+00006c80: 2020 2020 2020 2020 2020 756e 7374 796c            unstyl
+00006c90: 6528 7374 7228 7265 706f 7274 2929 2c0a  e(str(report)),.
+00006ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006cb0: 2231 2066 696c 6520 7265 666f 726d 6174  "1 file reformat
+00006cc0: 7465 642c 2032 2066 696c 6573 206c 6566  ted, 2 files lef
+00006cd0: 7420 756e 6368 616e 6765 642c 2031 2066  t unchanged, 1 f
+00006ce0: 696c 6520 6661 696c 6564 2074 6f22 0a20  ile failed to". 
+00006cf0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00006d00: 2072 6566 6f72 6d61 742e 222c 0a20 2020   reformat.",.   
+00006d10: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00006d20: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00006d30: 7274 4571 7561 6c28 7265 706f 7274 2e72  rtEqual(report.r
+00006d40: 6574 7572 6e5f 636f 6465 2c20 3132 3329  eturn_code, 123)
+00006d50: 0a20 2020 2020 2020 2020 2020 2072 6570  .            rep
+00006d60: 6f72 742e 646f 6e65 2850 6174 6828 2266  ort.done(Path("f
+00006d70: 3322 292c 2063 6572 6369 732e 4368 616e  3"), cercis.Chan
+00006d80: 6765 642e 5945 5329 0a20 2020 2020 2020  ged.YES).       
+00006d90: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00006da0: 4571 7561 6c28 6c65 6e28 6f75 745f 6c69  Equal(len(out_li
+00006db0: 6e65 7329 2c20 3029 0a20 2020 2020 2020  nes), 0).       
+00006dc0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00006dd0: 4571 7561 6c28 6c65 6e28 6572 725f 6c69  Equal(len(err_li
+00006de0: 6e65 7329 2c20 3129 0a20 2020 2020 2020  nes), 1).       
+00006df0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00006e00: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+00006e10: 2020 2020 2020 2075 6e73 7479 6c65 2873         unstyle(s
+00006e20: 7472 2872 6570 6f72 7429 292c 0a20 2020  tr(report)),.   
+00006e30: 2020 2020 2020 2020 2020 2020 2022 3220               "2 
+00006e40: 6669 6c65 7320 7265 666f 726d 6174 7465  files reformatte
+00006e50: 642c 2032 2066 696c 6573 206c 6566 7420  d, 2 files left 
+00006e60: 756e 6368 616e 6765 642c 2031 2066 696c  unchanged, 1 fil
+00006e70: 6520 6661 696c 6564 2074 6f22 0a20 2020  e failed to".   
+00006e80: 2020 2020 2020 2020 2020 2020 2022 2072               " r
+00006e90: 6566 6f72 6d61 742e 222c 0a20 2020 2020  eformat.",.     
+00006ea0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00006eb0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00006ec0: 4571 7561 6c28 7265 706f 7274 2e72 6574  Equal(report.ret
+00006ed0: 7572 6e5f 636f 6465 2c20 3132 3329 0a20  urn_code, 123). 
+00006ee0: 2020 2020 2020 2020 2020 2072 6570 6f72             repor
+00006ef0: 742e 6661 696c 6564 2850 6174 6828 2265  t.failed(Path("e
+00006f00: 3222 292c 2022 626f 6f6d 2229 0a20 2020  2"), "boom").   
+00006f10: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00006f20: 7365 7274 4571 7561 6c28 6c65 6e28 6f75  sertEqual(len(ou
+00006f30: 745f 6c69 6e65 7329 2c20 3029 0a20 2020  t_lines), 0).   
+00006f40: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00006f50: 7365 7274 4571 7561 6c28 6c65 6e28 6572  sertEqual(len(er
+00006f60: 725f 6c69 6e65 7329 2c20 3229 0a20 2020  r_lines), 2).   
+00006f70: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00006f80: 7365 7274 4571 7561 6c28 6572 725f 6c69  sertEqual(err_li
+00006f90: 6e65 735b 2d31 5d2c 2022 6572 726f 723a  nes[-1], "error:
+00006fa0: 2063 616e 6e6f 7420 666f 726d 6174 2065   cannot format e
+00006fb0: 323a 2062 6f6f 6d22 290a 2020 2020 2020  2: boom").      
+00006fc0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00006fd0: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
+00006fe0: 2020 2020 2020 2020 756e 7374 796c 6528          unstyle(
+00006ff0: 7374 7228 7265 706f 7274 2929 2c0a 2020  str(report)),.  
+00007000: 2020 2020 2020 2020 2020 2020 2020 2232                "2
+00007010: 2066 696c 6573 2072 6566 6f72 6d61 7474   files reformatt
+00007020: 6564 2c20 3220 6669 6c65 7320 6c65 6674  ed, 2 files left
+00007030: 2075 6e63 6861 6e67 6564 2c20 3220 6669   unchanged, 2 fi
+00007040: 6c65 7320 6661 696c 6564 2074 6f22 0a20  les failed to". 
+00007050: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00007060: 2072 6566 6f72 6d61 742e 222c 0a20 2020   reformat.",.   
+00007070: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00007080: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00007090: 7274 4571 7561 6c28 7265 706f 7274 2e72  rtEqual(report.r
+000070a0: 6574 7572 6e5f 636f 6465 2c20 3132 3329  eturn_code, 123)
+000070b0: 0a20 2020 2020 2020 2020 2020 2072 6570  .            rep
+000070c0: 6f72 742e 7061 7468 5f69 676e 6f72 6564  ort.path_ignored
+000070d0: 2850 6174 6828 2277 6174 2229 2c20 226e  (Path("wat"), "n
+000070e0: 6f20 6d61 7463 6822 290a 2020 2020 2020  o match").      
+000070f0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00007100: 7445 7175 616c 286c 656e 286f 7574 5f6c  tEqual(len(out_l
+00007110: 696e 6573 292c 2030 290a 2020 2020 2020  ines), 0).      
+00007120: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00007130: 7445 7175 616c 286c 656e 2865 7272 5f6c  tEqual(len(err_l
+00007140: 696e 6573 292c 2032 290a 2020 2020 2020  ines), 2).      
+00007150: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00007160: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
+00007170: 2020 2020 2020 2020 756e 7374 796c 6528          unstyle(
+00007180: 7374 7228 7265 706f 7274 2929 2c0a 2020  str(report)),.  
+00007190: 2020 2020 2020 2020 2020 2020 2020 2232                "2
+000071a0: 2066 696c 6573 2072 6566 6f72 6d61 7474   files reformatt
+000071b0: 6564 2c20 3220 6669 6c65 7320 6c65 6674  ed, 2 files left
+000071c0: 2075 6e63 6861 6e67 6564 2c20 3220 6669   unchanged, 2 fi
+000071d0: 6c65 7320 6661 696c 6564 2074 6f22 0a20  les failed to". 
+000071e0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000071f0: 2072 6566 6f72 6d61 742e 222c 0a20 2020   reformat.",.   
+00007200: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00007210: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00007220: 7274 4571 7561 6c28 7265 706f 7274 2e72  rtEqual(report.r
+00007230: 6574 7572 6e5f 636f 6465 2c20 3132 3329  eturn_code, 123)
+00007240: 0a20 2020 2020 2020 2020 2020 2072 6570  .            rep
+00007250: 6f72 742e 646f 6e65 2850 6174 6828 2266  ort.done(Path("f
+00007260: 3422 292c 2063 6572 6369 732e 4368 616e  4"), cercis.Chan
+00007270: 6765 642e 4e4f 290a 2020 2020 2020 2020  ged.NO).        
+00007280: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00007290: 7175 616c 286c 656e 286f 7574 5f6c 696e  qual(len(out_lin
+000072a0: 6573 292c 2030 290a 2020 2020 2020 2020  es), 0).        
+000072b0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+000072c0: 7175 616c 286c 656e 2865 7272 5f6c 696e  qual(len(err_lin
+000072d0: 6573 292c 2032 290a 2020 2020 2020 2020  es), 2).        
+000072e0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+000072f0: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+00007300: 2020 2020 2020 756e 7374 796c 6528 7374        unstyle(st
+00007310: 7228 7265 706f 7274 2929 2c0a 2020 2020  r(report)),.    
+00007320: 2020 2020 2020 2020 2020 2020 2232 2066              "2 f
+00007330: 696c 6573 2072 6566 6f72 6d61 7474 6564  iles reformatted
+00007340: 2c20 3320 6669 6c65 7320 6c65 6674 2075  , 3 files left u
+00007350: 6e63 6861 6e67 6564 2c20 3220 6669 6c65  nchanged, 2 file
+00007360: 7320 6661 696c 6564 2074 6f22 0a20 2020  s failed to".   
+00007370: 2020 2020 2020 2020 2020 2020 2022 2072               " r
+00007380: 6566 6f72 6d61 742e 222c 0a20 2020 2020  eformat.",.     
+00007390: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000073a0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+000073b0: 4571 7561 6c28 7265 706f 7274 2e72 6574  Equal(report.ret
+000073c0: 7572 6e5f 636f 6465 2c20 3132 3329 0a20  urn_code, 123). 
+000073d0: 2020 2020 2020 2020 2020 2072 6570 6f72             repor
+000073e0: 742e 6368 6563 6b20 3d20 5472 7565 0a20  t.check = True. 
+000073f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00007400: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+00007410: 2020 2020 2020 2020 2020 2020 2075 6e73               uns
+00007420: 7479 6c65 2873 7472 2872 6570 6f72 7429  tyle(str(report)
+00007430: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00007440: 2020 2022 3220 6669 6c65 7320 776f 756c     "2 files woul
+00007450: 6420 6265 2072 6566 6f72 6d61 7474 6564  d be reformatted
+00007460: 2c20 3320 6669 6c65 7320 776f 756c 6420  , 3 files would 
+00007470: 6265 206c 6566 7420 756e 6368 616e 6765  be left unchange
+00007480: 642c 2032 220a 2020 2020 2020 2020 2020  d, 2".          
+00007490: 2020 2020 2020 2220 6669 6c65 7320 776f        " files wo
+000074a0: 756c 6420 6661 696c 2074 6f20 7265 666f  uld fail to refo
+000074b0: 726d 6174 2e22 2c0a 2020 2020 2020 2020  rmat.",.        
+000074c0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+000074d0: 2020 7265 706f 7274 2e63 6865 636b 203d    report.check =
+000074e0: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
+000074f0: 2020 2072 6570 6f72 742e 6469 6666 203d     report.diff =
+00007500: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
+00007510: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00007520: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
+00007530: 2020 2020 756e 7374 796c 6528 7374 7228      unstyle(str(
+00007540: 7265 706f 7274 2929 2c0a 2020 2020 2020  report)),.      
+00007550: 2020 2020 2020 2020 2020 2232 2066 696c            "2 fil
+00007560: 6573 2077 6f75 6c64 2062 6520 7265 666f  es would be refo
+00007570: 726d 6174 7465 642c 2033 2066 696c 6573  rmatted, 3 files
+00007580: 2077 6f75 6c64 2062 6520 6c65 6674 2075   would be left u
+00007590: 6e63 6861 6e67 6564 2c20 3222 0a20 2020  nchanged, 2".   
+000075a0: 2020 2020 2020 2020 2020 2020 2022 2066               " f
+000075b0: 696c 6573 2077 6f75 6c64 2066 6169 6c20  iles would fail 
+000075c0: 746f 2072 6566 6f72 6d61 742e 222c 0a20  to reformat.",. 
+000075d0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+000075e0: 2020 6465 6620 7465 7374 5f72 6570 6f72    def test_repor
+000075f0: 745f 6e6f 726d 616c 2873 656c 6629 202d  t_normal(self) -
+00007600: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00007610: 7265 706f 7274 203d 2063 6572 6369 732e  report = cercis.
+00007620: 5265 706f 7274 2829 0a20 2020 2020 2020  Report().       
+00007630: 206f 7574 5f6c 696e 6573 203d 205b 5d0a   out_lines = [].
+00007640: 2020 2020 2020 2020 6572 725f 6c69 6e65          err_line
+00007650: 7320 3d20 5b5d 0a0a 2020 2020 2020 2020  s = []..        
+00007660: 6465 6620 6f75 7428 6d73 673a 2073 7472  def out(msg: str
+00007670: 2c20 2a2a 6b77 6172 6773 3a20 416e 7929  , **kwargs: Any)
+00007680: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00007690: 2020 2020 2020 6f75 745f 6c69 6e65 732e        out_lines.
+000076a0: 6170 7065 6e64 286d 7367 290a 0a20 2020  append(msg)..   
+000076b0: 2020 2020 2064 6566 2065 7272 286d 7367       def err(msg
+000076c0: 3a20 7374 722c 202a 2a6b 7761 7267 733a  : str, **kwargs:
+000076d0: 2041 6e79 2920 2d3e 204e 6f6e 653a 0a20   Any) -> None:. 
+000076e0: 2020 2020 2020 2020 2020 2065 7272 5f6c             err_l
+000076f0: 696e 6573 2e61 7070 656e 6428 6d73 6729  ines.append(msg)
+00007700: 0a0a 2020 2020 2020 2020 7769 7468 2070  ..        with p
+00007710: 6174 6368 2822 6365 7263 6973 2e6f 7574  atch("cercis.out
+00007720: 7075 742e 5f6f 7574 222c 206f 7574 292c  put._out", out),
+00007730: 2070 6174 6368 2822 6365 7263 6973 2e6f   patch("cercis.o
+00007740: 7574 7075 742e 5f65 7272 222c 2065 7272  utput._err", err
+00007750: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+00007760: 6570 6f72 742e 646f 6e65 2850 6174 6828  eport.done(Path(
+00007770: 2266 3122 292c 2063 6572 6369 732e 4368  "f1"), cercis.Ch
+00007780: 616e 6765 642e 4e4f 290a 2020 2020 2020  anged.NO).      
+00007790: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+000077a0: 7445 7175 616c 286c 656e 286f 7574 5f6c  tEqual(len(out_l
+000077b0: 696e 6573 292c 2030 290a 2020 2020 2020  ines), 0).      
+000077c0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+000077d0: 7445 7175 616c 286c 656e 2865 7272 5f6c  tEqual(len(err_l
+000077e0: 696e 6573 292c 2030 290a 2020 2020 2020  ines), 0).      
+000077f0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00007800: 7445 7175 616c 2875 6e73 7479 6c65 2873  tEqual(unstyle(s
+00007810: 7472 2872 6570 6f72 7429 292c 2022 3120  tr(report)), "1 
+00007820: 6669 6c65 206c 6566 7420 756e 6368 616e  file left unchan
+00007830: 6765 642e 2229 0a20 2020 2020 2020 2020  ged.").         
+00007840: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00007850: 7561 6c28 7265 706f 7274 2e72 6574 7572  ual(report.retur
+00007860: 6e5f 636f 6465 2c20 3029 0a20 2020 2020  n_code, 0).     
+00007870: 2020 2020 2020 2072 6570 6f72 742e 646f         report.do
+00007880: 6e65 2850 6174 6828 2266 3222 292c 2063  ne(Path("f2"), c
+00007890: 6572 6369 732e 4368 616e 6765 642e 5945  ercis.Changed.YE
+000078a0: 5329 0a20 2020 2020 2020 2020 2020 2073  S).            s
+000078b0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+000078c0: 6c65 6e28 6f75 745f 6c69 6e65 7329 2c20  len(out_lines), 
+000078d0: 3129 0a20 2020 2020 2020 2020 2020 2073  1).            s
+000078e0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+000078f0: 6c65 6e28 6572 725f 6c69 6e65 7329 2c20  len(err_lines), 
+00007900: 3029 0a20 2020 2020 2020 2020 2020 2073  0).            s
+00007910: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00007920: 6f75 745f 6c69 6e65 735b 2d31 5d2c 2022  out_lines[-1], "
+00007930: 7265 666f 726d 6174 7465 6420 6632 2229  reformatted f2")
+00007940: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00007950: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
+00007960: 2020 2020 2020 2020 2020 2020 2020 2075                 u
+00007970: 6e73 7479 6c65 2873 7472 2872 6570 6f72  nstyle(str(repor
+00007980: 7429 292c 2022 3120 6669 6c65 2072 6566  t)), "1 file ref
+00007990: 6f72 6d61 7474 6564 2c20 3120 6669 6c65  ormatted, 1 file
+000079a0: 206c 6566 7420 756e 6368 616e 6765 642e   left unchanged.
+000079b0: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
+000079c0: 2020 2020 2020 2020 2020 2020 7265 706f              repo
+000079d0: 7274 2e64 6f6e 6528 5061 7468 2822 6633  rt.done(Path("f3
+000079e0: 2229 2c20 6365 7263 6973 2e43 6861 6e67  "), cercis.Chang
+000079f0: 6564 2e43 4143 4845 4429 0a20 2020 2020  ed.CACHED).     
+00007a00: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00007a10: 7274 4571 7561 6c28 6c65 6e28 6f75 745f  rtEqual(len(out_
+00007a20: 6c69 6e65 7329 2c20 3129 0a20 2020 2020  lines), 1).     
+00007a30: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00007a40: 7274 4571 7561 6c28 6c65 6e28 6572 725f  rtEqual(len(err_
+00007a50: 6c69 6e65 7329 2c20 3029 0a20 2020 2020  lines), 0).     
+00007a60: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00007a70: 7274 4571 7561 6c28 6f75 745f 6c69 6e65  rtEqual(out_line
+00007a80: 735b 2d31 5d2c 2022 7265 666f 726d 6174  s[-1], "reformat
+00007a90: 7465 6420 6632 2229 0a20 2020 2020 2020  ted f2").       
+00007aa0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00007ab0: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+00007ac0: 2020 2020 2020 2075 6e73 7479 6c65 2873         unstyle(s
+00007ad0: 7472 2872 6570 6f72 7429 292c 2022 3120  tr(report)), "1 
+00007ae0: 6669 6c65 2072 6566 6f72 6d61 7474 6564  file reformatted
+00007af0: 2c20 3220 6669 6c65 7320 6c65 6674 2075  , 2 files left u
+00007b00: 6e63 6861 6e67 6564 2e22 0a20 2020 2020  nchanged.".     
+00007b10: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00007b20: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00007b30: 4571 7561 6c28 7265 706f 7274 2e72 6574  Equal(report.ret
+00007b40: 7572 6e5f 636f 6465 2c20 3029 0a20 2020  urn_code, 0).   
+00007b50: 2020 2020 2020 2020 2072 6570 6f72 742e           report.
+00007b60: 6368 6563 6b20 3d20 5472 7565 0a20 2020  check = True.   
+00007b70: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00007b80: 7365 7274 4571 7561 6c28 7265 706f 7274  sertEqual(report
+00007b90: 2e72 6574 7572 6e5f 636f 6465 2c20 3129  .return_code, 1)
+00007ba0: 0a20 2020 2020 2020 2020 2020 2072 6570  .            rep
+00007bb0: 6f72 742e 6368 6563 6b20 3d20 4661 6c73  ort.check = Fals
+00007bc0: 650a 2020 2020 2020 2020 2020 2020 7265  e.            re
+00007bd0: 706f 7274 2e66 6169 6c65 6428 5061 7468  port.failed(Path
+00007be0: 2822 6531 2229 2c20 2262 6f6f 6d22 290a  ("e1"), "boom").
+00007bf0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00007c00: 2e61 7373 6572 7445 7175 616c 286c 656e  .assertEqual(len
+00007c10: 286f 7574 5f6c 696e 6573 292c 2031 290a  (out_lines), 1).
+00007c20: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00007c30: 2e61 7373 6572 7445 7175 616c 286c 656e  .assertEqual(len
+00007c40: 2865 7272 5f6c 696e 6573 292c 2031 290a  (err_lines), 1).
+00007c50: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00007c60: 2e61 7373 6572 7445 7175 616c 2865 7272  .assertEqual(err
+00007c70: 5f6c 696e 6573 5b2d 315d 2c20 2265 7272  _lines[-1], "err
+00007c80: 6f72 3a20 6361 6e6e 6f74 2066 6f72 6d61  or: cannot forma
+00007c90: 7420 6531 3a20 626f 6f6d 2229 0a20 2020  t e1: boom").   
+00007ca0: 2020 2020 2020 2020 2073 656c 662e 6173           self.as
+00007cb0: 7365 7274 4571 7561 6c28 0a20 2020 2020  sertEqual(.     
+00007cc0: 2020 2020 2020 2020 2020 2075 6e73 7479             unsty
+00007cd0: 6c65 2873 7472 2872 6570 6f72 7429 292c  le(str(report)),
+00007ce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007cf0: 2022 3120 6669 6c65 2072 6566 6f72 6d61   "1 file reforma
+00007d00: 7474 6564 2c20 3220 6669 6c65 7320 6c65  tted, 2 files le
+00007d10: 6674 2075 6e63 6861 6e67 6564 2c20 3120  ft unchanged, 1 
+00007d20: 6669 6c65 2066 6169 6c65 6420 746f 220a  file failed to".
+00007d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007d40: 2220 7265 666f 726d 6174 2e22 2c0a 2020  " reformat.",.  
+00007d50: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00007d60: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00007d70: 6572 7445 7175 616c 2872 6570 6f72 742e  ertEqual(report.
+00007d80: 7265 7475 726e 5f63 6f64 652c 2031 3233  return_code, 123
+00007d90: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+00007da0: 706f 7274 2e64 6f6e 6528 5061 7468 2822  port.done(Path("
+00007db0: 6633 2229 2c20 6365 7263 6973 2e43 6861  f3"), cercis.Cha
+00007dc0: 6e67 6564 2e59 4553 290a 2020 2020 2020  nged.YES).      
+00007dd0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00007de0: 7445 7175 616c 286c 656e 286f 7574 5f6c  tEqual(len(out_l
+00007df0: 696e 6573 292c 2032 290a 2020 2020 2020  ines), 2).      
+00007e00: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00007e10: 7445 7175 616c 286c 656e 2865 7272 5f6c  tEqual(len(err_l
+00007e20: 696e 6573 292c 2031 290a 2020 2020 2020  ines), 1).      
+00007e30: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00007e40: 7445 7175 616c 286f 7574 5f6c 696e 6573  tEqual(out_lines
+00007e50: 5b2d 315d 2c20 2272 6566 6f72 6d61 7474  [-1], "reformatt
+00007e60: 6564 2066 3322 290a 2020 2020 2020 2020  ed f3").        
+00007e70: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00007e80: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+00007e90: 2020 2020 2020 756e 7374 796c 6528 7374        unstyle(st
+00007ea0: 7228 7265 706f 7274 2929 2c0a 2020 2020  r(report)),.    
+00007eb0: 2020 2020 2020 2020 2020 2020 2232 2066              "2 f
+00007ec0: 696c 6573 2072 6566 6f72 6d61 7474 6564  iles reformatted
+00007ed0: 2c20 3220 6669 6c65 7320 6c65 6674 2075  , 2 files left u
+00007ee0: 6e63 6861 6e67 6564 2c20 3120 6669 6c65  nchanged, 1 file
+00007ef0: 2066 6169 6c65 6420 746f 220a 2020 2020   failed to".    
+00007f00: 2020 2020 2020 2020 2020 2020 2220 7265              " re
+00007f10: 666f 726d 6174 2e22 2c0a 2020 2020 2020  format.",.      
+00007f20: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00007f30: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00007f40: 7175 616c 2872 6570 6f72 742e 7265 7475  qual(report.retu
+00007f50: 726e 5f63 6f64 652c 2031 3233 290a 2020  rn_code, 123).  
+00007f60: 2020 2020 2020 2020 2020 7265 706f 7274            report
+00007f70: 2e66 6169 6c65 6428 5061 7468 2822 6532  .failed(Path("e2
+00007f80: 2229 2c20 2262 6f6f 6d22 290a 2020 2020  "), "boom").    
+00007f90: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00007fa0: 6572 7445 7175 616c 286c 656e 286f 7574  ertEqual(len(out
+00007fb0: 5f6c 696e 6573 292c 2032 290a 2020 2020  _lines), 2).    
+00007fc0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00007fd0: 6572 7445 7175 616c 286c 656e 2865 7272  ertEqual(len(err
+00007fe0: 5f6c 696e 6573 292c 2032 290a 2020 2020  _lines), 2).    
+00007ff0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00008000: 6572 7445 7175 616c 2865 7272 5f6c 696e  ertEqual(err_lin
+00008010: 6573 5b2d 315d 2c20 2265 7272 6f72 3a20  es[-1], "error: 
+00008020: 6361 6e6e 6f74 2066 6f72 6d61 7420 6532  cannot format e2
+00008030: 3a20 626f 6f6d 2229 0a20 2020 2020 2020  : boom").       
+00008040: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00008050: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+00008060: 2020 2020 2020 2075 6e73 7479 6c65 2873         unstyle(s
+00008070: 7472 2872 6570 6f72 7429 292c 0a20 2020  tr(report)),.   
+00008080: 2020 2020 2020 2020 2020 2020 2022 3220               "2 
+00008090: 6669 6c65 7320 7265 666f 726d 6174 7465  files reformatte
+000080a0: 642c 2032 2066 696c 6573 206c 6566 7420  d, 2 files left 
+000080b0: 756e 6368 616e 6765 642c 2032 2066 696c  unchanged, 2 fil
+000080c0: 6573 2066 6169 6c65 6420 746f 220a 2020  es failed to".  
+000080d0: 2020 2020 2020 2020 2020 2020 2020 2220                " 
+000080e0: 7265 666f 726d 6174 2e22 2c0a 2020 2020  reformat.",.    
+000080f0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00008100: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00008110: 7445 7175 616c 2872 6570 6f72 742e 7265  tEqual(report.re
+00008120: 7475 726e 5f63 6f64 652c 2031 3233 290a  turn_code, 123).
+00008130: 2020 2020 2020 2020 2020 2020 7265 706f              repo
+00008140: 7274 2e70 6174 685f 6967 6e6f 7265 6428  rt.path_ignored(
+00008150: 5061 7468 2822 7761 7422 292c 2022 6e6f  Path("wat"), "no
+00008160: 206d 6174 6368 2229 0a20 2020 2020 2020   match").       
+00008170: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00008180: 4571 7561 6c28 6c65 6e28 6f75 745f 6c69  Equal(len(out_li
+00008190: 6e65 7329 2c20 3229 0a20 2020 2020 2020  nes), 2).       
+000081a0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+000081b0: 4571 7561 6c28 6c65 6e28 6572 725f 6c69  Equal(len(err_li
+000081c0: 6e65 7329 2c20 3229 0a20 2020 2020 2020  nes), 2).       
+000081d0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+000081e0: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+000081f0: 2020 2020 2020 2075 6e73 7479 6c65 2873         unstyle(s
+00008200: 7472 2872 6570 6f72 7429 292c 0a20 2020  tr(report)),.   
+00008210: 2020 2020 2020 2020 2020 2020 2022 3220               "2 
+00008220: 6669 6c65 7320 7265 666f 726d 6174 7465  files reformatte
+00008230: 642c 2032 2066 696c 6573 206c 6566 7420  d, 2 files left 
+00008240: 756e 6368 616e 6765 642c 2032 2066 696c  unchanged, 2 fil
+00008250: 6573 2066 6169 6c65 6420 746f 220a 2020  es failed to".  
+00008260: 2020 2020 2020 2020 2020 2020 2020 2220                " 
+00008270: 7265 666f 726d 6174 2e22 2c0a 2020 2020  reformat.",.    
+00008280: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00008290: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+000082a0: 7445 7175 616c 2872 6570 6f72 742e 7265  tEqual(report.re
+000082b0: 7475 726e 5f63 6f64 652c 2031 3233 290a  turn_code, 123).
+000082c0: 2020 2020 2020 2020 2020 2020 7265 706f              repo
+000082d0: 7274 2e64 6f6e 6528 5061 7468 2822 6634  rt.done(Path("f4
+000082e0: 2229 2c20 6365 7263 6973 2e43 6861 6e67  "), cercis.Chang
+000082f0: 6564 2e4e 4f29 0a20 2020 2020 2020 2020  ed.NO).         
+00008300: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00008310: 7561 6c28 6c65 6e28 6f75 745f 6c69 6e65  ual(len(out_line
+00008320: 7329 2c20 3229 0a20 2020 2020 2020 2020  s), 2).         
+00008330: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00008340: 7561 6c28 6c65 6e28 6572 725f 6c69 6e65  ual(len(err_line
+00008350: 7329 2c20 3229 0a20 2020 2020 2020 2020  s), 2).         
+00008360: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00008370: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+00008380: 2020 2020 2075 6e73 7479 6c65 2873 7472       unstyle(str
+00008390: 2872 6570 6f72 7429 292c 0a20 2020 2020  (report)),.     
+000083a0: 2020 2020 2020 2020 2020 2022 3220 6669             "2 fi
+000083b0: 6c65 7320 7265 666f 726d 6174 7465 642c  les reformatted,
+000083c0: 2033 2066 696c 6573 206c 6566 7420 756e   3 files left un
+000083d0: 6368 616e 6765 642c 2032 2066 696c 6573  changed, 2 files
+000083e0: 2066 6169 6c65 6420 746f 220a 2020 2020   failed to".    
+000083f0: 2020 2020 2020 2020 2020 2020 2220 7265              " re
+00008400: 666f 726d 6174 2e22 2c0a 2020 2020 2020  format.",.      
+00008410: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00008420: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00008430: 7175 616c 2872 6570 6f72 742e 7265 7475  qual(report.retu
+00008440: 726e 5f63 6f64 652c 2031 3233 290a 2020  rn_code, 123).  
+00008450: 2020 2020 2020 2020 2020 7265 706f 7274            report
+00008460: 2e63 6865 636b 203d 2054 7275 650a 2020  .check = True.  
+00008470: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00008480: 7373 6572 7445 7175 616c 280a 2020 2020  ssertEqual(.    
+00008490: 2020 2020 2020 2020 2020 2020 756e 7374              unst
+000084a0: 796c 6528 7374 7228 7265 706f 7274 2929  yle(str(report))
+000084b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000084c0: 2020 2232 2066 696c 6573 2077 6f75 6c64    "2 files would
+000084d0: 2062 6520 7265 666f 726d 6174 7465 642c   be reformatted,
+000084e0: 2033 2066 696c 6573 2077 6f75 6c64 2062   3 files would b
+000084f0: 6520 6c65 6674 2075 6e63 6861 6e67 6564  e left unchanged
+00008500: 2c20 3222 0a20 2020 2020 2020 2020 2020  , 2".           
+00008510: 2020 2020 2022 2066 696c 6573 2077 6f75       " files wou
+00008520: 6c64 2066 6169 6c20 746f 2072 6566 6f72  ld fail to refor
+00008530: 6d61 742e 222c 0a20 2020 2020 2020 2020  mat.",.         
+00008540: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00008550: 2072 6570 6f72 742e 6368 6563 6b20 3d20   report.check = 
+00008560: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
+00008570: 2020 7265 706f 7274 2e64 6966 6620 3d20    report.diff = 
+00008580: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
+00008590: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+000085a0: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
+000085b0: 2020 2075 6e73 7479 6c65 2873 7472 2872     unstyle(str(r
+000085c0: 6570 6f72 7429 292c 0a20 2020 2020 2020  eport)),.       
+000085d0: 2020 2020 2020 2020 2022 3220 6669 6c65           "2 file
+000085e0: 7320 776f 756c 6420 6265 2072 6566 6f72  s would be refor
+000085f0: 6d61 7474 6564 2c20 3320 6669 6c65 7320  matted, 3 files 
+00008600: 776f 756c 6420 6265 206c 6566 7420 756e  would be left un
+00008610: 6368 616e 6765 642c 2032 220a 2020 2020  changed, 2".    
+00008620: 2020 2020 2020 2020 2020 2020 2220 6669              " fi
+00008630: 6c65 7320 776f 756c 6420 6661 696c 2074  les would fail t
+00008640: 6f20 7265 666f 726d 6174 2e22 2c0a 2020  o reformat.",.  
+00008650: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00008660: 2064 6566 2074 6573 745f 6c69 6232 746f   def test_lib2to
+00008670: 335f 7061 7273 6528 7365 6c66 2920 2d3e  3_parse(self) ->
+00008680: 204e 6f6e 653a 0a20 2020 2020 2020 2077   None:.        w
+00008690: 6974 6820 7365 6c66 2e61 7373 6572 7452  ith self.assertR
+000086a0: 6169 7365 7328 6365 7263 6973 2e49 6e76  aises(cercis.Inv
+000086b0: 616c 6964 496e 7075 7429 3a0a 2020 2020  alidInput):.    
+000086c0: 2020 2020 2020 2020 6365 7263 6973 2e6c          cercis.l
+000086d0: 6962 3274 6f33 5f70 6172 7365 2822 696e  ib2to3_parse("in
+000086e0: 7661 6c69 6420 7379 6e74 6178 2229 0a0a  valid syntax")..
+000086f0: 2020 2020 2020 2020 7374 7261 6464 6c69          straddli
+00008700: 6e67 203d 2022 7820 2b20 7922 0a20 2020  ng = "x + y".   
+00008710: 2020 2020 2063 6572 6369 732e 6c69 6232       cercis.lib2
+00008720: 746f 335f 7061 7273 6528 7374 7261 6464  to3_parse(stradd
+00008730: 6c69 6e67 290a 2020 2020 2020 2020 6365  ling).        ce
+00008740: 7263 6973 2e6c 6962 3274 6f33 5f70 6172  rcis.lib2to3_par
+00008750: 7365 2873 7472 6164 646c 696e 672c 207b  se(straddling, {
+00008760: 5461 7267 6574 5665 7273 696f 6e2e 5059  TargetVersion.PY
+00008770: 3336 7d29 0a0a 2020 2020 2020 2020 7079  36})..        py
+00008780: 325f 6f6e 6c79 203d 2022 7072 696e 7420  2_only = "print 
+00008790: 7822 0a20 2020 2020 2020 2077 6974 6820  x".        with 
+000087a0: 7365 6c66 2e61 7373 6572 7452 6169 7365  self.assertRaise
+000087b0: 7328 6365 7263 6973 2e49 6e76 616c 6964  s(cercis.Invalid
+000087c0: 496e 7075 7429 3a0a 2020 2020 2020 2020  Input):.        
+000087d0: 2020 2020 6365 7263 6973 2e6c 6962 3274      cercis.lib2t
+000087e0: 6f33 5f70 6172 7365 2870 7932 5f6f 6e6c  o3_parse(py2_onl
+000087f0: 792c 207b 5461 7267 6574 5665 7273 696f  y, {TargetVersio
+00008800: 6e2e 5059 3336 7d29 0a0a 2020 2020 2020  n.PY36})..      
+00008810: 2020 7079 335f 6f6e 6c79 203d 2022 6578    py3_only = "ex
+00008820: 6563 2878 2c20 656e 643d 7929 220a 2020  ec(x, end=y)".  
+00008830: 2020 2020 2020 6365 7263 6973 2e6c 6962        cercis.lib
+00008840: 3274 6f33 5f70 6172 7365 2870 7933 5f6f  2to3_parse(py3_o
+00008850: 6e6c 7929 0a20 2020 2020 2020 2063 6572  nly).        cer
+00008860: 6369 732e 6c69 6232 746f 335f 7061 7273  cis.lib2to3_pars
+00008870: 6528 7079 335f 6f6e 6c79 2c20 7b54 6172  e(py3_only, {Tar
+00008880: 6765 7456 6572 7369 6f6e 2e50 5933 367d  getVersion.PY36}
+00008890: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
+000088a0: 6765 745f 6665 6174 7572 6573 5f75 7365  get_features_use
+000088b0: 645f 6465 636f 7261 746f 7228 7365 6c66  d_decorator(self
+000088c0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+000088d0: 2020 2023 2054 6573 7420 7468 6520 6665     # Test the fe
+000088e0: 6174 7572 6520 6465 7465 6374 696f 6e20  ature detection 
+000088f0: 6f66 206e 6577 2064 6563 6f72 6174 6f72  of new decorator
+00008900: 2073 796e 7461 780a 2020 2020 2020 2020   syntax.        
+00008910: 2320 7369 6e63 6520 7468 6973 206d 616b  # since this mak
+00008920: 6573 2073 6f6d 6520 7465 7374 2063 6173  es some test cas
+00008930: 6573 206f 6620 7465 7374 5f67 6574 5f66  es of test_get_f
+00008940: 6561 7475 7265 735f 7573 6564 2829 0a20  eatures_used(). 
+00008950: 2020 2020 2020 2023 2066 6169 6c73 2069         # fails i
+00008960: 6620 6974 2066 6169 6c73 2c20 7468 6973  f it fails, this
+00008970: 2069 7320 7465 7374 6564 2066 6972 7374   is tested first
+00008980: 2073 6f20 7468 6174 2061 2075 7365 6675   so that a usefu
+00008990: 6c20 6361 7365 0a20 2020 2020 2020 2023  l case.        #
+000089a0: 2069 7320 6964 656e 7469 6669 6564 0a20   is identified. 
+000089b0: 2020 2020 2020 2073 696d 706c 6573 2c20         simples, 
+000089c0: 7265 6c61 7865 6420 3d20 7265 6164 5f64  relaxed = read_d
+000089d0: 6174 6128 226d 6973 6365 6c6c 616e 656f  ata("miscellaneo
+000089e0: 7573 222c 2022 6465 636f 7261 746f 7273  us", "decorators
+000089f0: 2229 0a20 2020 2020 2020 2023 2073 6b69  ").        # ski
+00008a00: 7020 6578 706c 616e 6174 696f 6e20 636f  p explanation co
+00008a10: 6d6d 656e 7473 2061 7420 7468 6520 746f  mments at the to
+00008a20: 7020 6f66 2074 6865 2066 696c 650a 2020  p of the file.  
+00008a30: 2020 2020 2020 666f 7220 7369 6d70 6c65        for simple
+00008a40: 5f74 6573 7420 696e 2073 696d 706c 6573  _test in simples
+00008a50: 2e73 706c 6974 2822 2323 2229 5b31 3a5d  .split("##")[1:]
+00008a60: 3a0a 2020 2020 2020 2020 2020 2020 6e6f  :.            no
+00008a70: 6465 203d 2063 6572 6369 732e 6c69 6232  de = cercis.lib2
+00008a80: 746f 335f 7061 7273 6528 7369 6d70 6c65  to3_parse(simple
+00008a90: 5f74 6573 7429 0a20 2020 2020 2020 2020  _test).         
+00008aa0: 2020 2064 6563 6f72 6174 6f72 203d 2073     decorator = s
+00008ab0: 7472 286e 6f64 652e 6368 696c 6472 656e  tr(node.children
+00008ac0: 5b30 5d2e 6368 696c 6472 656e 5b30 5d29  [0].children[0])
+00008ad0: 2e73 7472 6970 2829 0a20 2020 2020 2020  .strip().       
+00008ae0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00008af0: 4e6f 7449 6e28 0a20 2020 2020 2020 2020  NotIn(.         
+00008b00: 2020 2020 2020 2046 6561 7475 7265 2e52         Feature.R
+00008b10: 454c 4158 4544 5f44 4543 4f52 4154 4f52  ELAXED_DECORATOR
+00008b20: 532c 0a20 2020 2020 2020 2020 2020 2020  S,.             
+00008b30: 2020 2063 6572 6369 732e 6765 745f 6665     cercis.get_fe
+00008b40: 6174 7572 6573 5f75 7365 6428 6e6f 6465  atures_used(node
+00008b50: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00008b60: 2020 206d 7367 3d28 0a20 2020 2020 2020     msg=(.       
+00008b70: 2020 2020 2020 2020 2020 2020 2066 2264               f"d
+00008b80: 6563 6f72 6174 6f72 2027 7b64 6563 6f72  ecorator '{decor
+00008b90: 6174 6f72 7d27 2066 6f6c 6c6f 7773 2070  ator}' follows p
+00008ba0: 7974 686f 6e3c 3d33 2e38 2073 796e 7461  ython<=3.8 synta
+00008bb0: 7822 0a20 2020 2020 2020 2020 2020 2020  x".             
+00008bc0: 2020 2020 2020 2022 6275 7420 6973 2064         "but is d
+00008bd0: 6574 6563 7465 6420 6173 2033 2e39 2b22  etected as 3.9+"
+00008be0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008bf0: 2020 2020 2023 2066 2254 6865 2066 756c       # f"The ful
+00008c00: 6c20 6e6f 6465 2069 735c 6e7b 6e6f 6465  l node is\n{node
+00008c10: 2172 7d22 0a20 2020 2020 2020 2020 2020  !r}".           
+00008c20: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
+00008c30: 2020 2020 290a 2020 2020 2020 2020 2320      ).        # 
+00008c40: 736b 6970 2074 6865 2027 2320 6f75 7470  skip the '# outp
+00008c50: 7574 2720 636f 6d6d 656e 7420 6174 2074  ut' comment at t
+00008c60: 6865 2074 6f70 206f 6620 7468 6520 6f75  he top of the ou
+00008c70: 7470 7574 2070 6172 740a 2020 2020 2020  tput part.      
+00008c80: 2020 666f 7220 7265 6c61 7865 645f 7465    for relaxed_te
+00008c90: 7374 2069 6e20 7265 6c61 7865 642e 7370  st in relaxed.sp
+00008ca0: 6c69 7428 2223 2322 295b 313a 5d3a 0a20  lit("##")[1:]:. 
+00008cb0: 2020 2020 2020 2020 2020 206e 6f64 6520             node 
+00008cc0: 3d20 6365 7263 6973 2e6c 6962 3274 6f33  = cercis.lib2to3
+00008cd0: 5f70 6172 7365 2872 656c 6178 6564 5f74  _parse(relaxed_t
+00008ce0: 6573 7429 0a20 2020 2020 2020 2020 2020  est).           
+00008cf0: 2064 6563 6f72 6174 6f72 203d 2073 7472   decorator = str
+00008d00: 286e 6f64 652e 6368 696c 6472 656e 5b30  (node.children[0
+00008d10: 5d2e 6368 696c 6472 656e 5b30 5d29 2e73  ].children[0]).s
+00008d20: 7472 6970 2829 0a20 2020 2020 2020 2020  trip().         
+00008d30: 2020 2073 656c 662e 6173 7365 7274 496e     self.assertIn
+00008d40: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00008d50: 2020 4665 6174 7572 652e 5245 4c41 5845    Feature.RELAXE
+00008d60: 445f 4445 434f 5241 544f 5253 2c0a 2020  D_DECORATORS,.  
+00008d70: 2020 2020 2020 2020 2020 2020 2020 6365                ce
+00008d80: 7263 6973 2e67 6574 5f66 6561 7475 7265  rcis.get_feature
+00008d90: 735f 7573 6564 286e 6f64 6529 2c0a 2020  s_used(node),.  
+00008da0: 2020 2020 2020 2020 2020 2020 2020 6d73                ms
+00008db0: 673d 280a 2020 2020 2020 2020 2020 2020  g=(.            
+00008dc0: 2020 2020 2020 2020 6622 6465 636f 7261          f"decora
+00008dd0: 746f 7220 277b 6465 636f 7261 746f 727d  tor '{decorator}
+00008de0: 2720 7573 6573 2070 7974 686f 6e33 2e39  ' uses python3.9
+00008df0: 2b20 7379 6e74 6178 220a 2020 2020 2020  + syntax".      
+00008e00: 2020 2020 2020 2020 2020 2020 2020 2262                "b
+00008e10: 7574 2069 7320 6465 7465 6374 6564 2061  ut is detected a
+00008e20: 7320 7079 7468 6f6e 3c3d 332e 3822 0a20  s python<=3.8". 
+00008e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008e40: 2020 2023 2066 2254 6865 2066 756c 6c20     # f"The full 
+00008e50: 6e6f 6465 2069 735c 6e7b 6e6f 6465 2172  node is\n{node!r
+00008e60: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
+00008e70: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
+00008e80: 2020 290a 0a20 2020 2064 6566 2074 6573    )..    def tes
+00008e90: 745f 6765 745f 6665 6174 7572 6573 5f75  t_get_features_u
+00008ea0: 7365 6428 7365 6c66 2920 2d3e 204e 6f6e  sed(self) -> Non
+00008eb0: 653a 0a20 2020 2020 2020 206e 6f64 6520  e:.        node 
+00008ec0: 3d20 6365 7263 6973 2e6c 6962 3274 6f33  = cercis.lib2to3
+00008ed0: 5f70 6172 7365 2822 6465 6620 6628 2a2c  _parse("def f(*,
+00008ee0: 2061 7267 293a 202e 2e2e 5c6e 2229 0a20   arg): ...\n"). 
+00008ef0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00008f00: 7274 4571 7561 6c28 6365 7263 6973 2e67  rtEqual(cercis.g
+00008f10: 6574 5f66 6561 7475 7265 735f 7573 6564  et_features_used
+00008f20: 286e 6f64 6529 2c20 7365 7428 2929 0a20  (node), set()). 
+00008f30: 2020 2020 2020 206e 6f64 6520 3d20 6365         node = ce
+00008f40: 7263 6973 2e6c 6962 3274 6f33 5f70 6172  rcis.lib2to3_par
+00008f50: 7365 2822 6465 6620 6628 2a2c 2061 7267  se("def f(*, arg
+00008f60: 2c29 3a20 2e2e 2e5c 6e22 290a 2020 2020  ,): ...\n").    
+00008f70: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00008f80: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+00008f90: 2020 6365 7263 6973 2e67 6574 5f66 6561    cercis.get_fea
+00008fa0: 7475 7265 735f 7573 6564 286e 6f64 6529  tures_used(node)
+00008fb0: 2c20 7b46 6561 7475 7265 2e54 5241 494c  , {Feature.TRAIL
+00008fc0: 494e 475f 434f 4d4d 415f 494e 5f44 4546  ING_COMMA_IN_DEF
+00008fd0: 7d0a 2020 2020 2020 2020 290a 2020 2020  }.        ).    
+00008fe0: 2020 2020 6e6f 6465 203d 2063 6572 6369      node = cerci
+00008ff0: 732e 6c69 6232 746f 335f 7061 7273 6528  s.lib2to3_parse(
+00009000: 2266 282a 6172 672c 295c 6e22 290a 2020  "f(*arg,)\n").  
+00009010: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00009020: 7445 7175 616c 280a 2020 2020 2020 2020  tEqual(.        
+00009030: 2020 2020 6365 7263 6973 2e67 6574 5f66      cercis.get_f
+00009040: 6561 7475 7265 735f 7573 6564 286e 6f64  eatures_used(nod
+00009050: 6529 2c20 7b46 6561 7475 7265 2e54 5241  e), {Feature.TRA
+00009060: 494c 494e 475f 434f 4d4d 415f 494e 5f43  ILING_COMMA_IN_C
+00009070: 414c 4c7d 0a20 2020 2020 2020 2029 0a20  ALL}.        ). 
+00009080: 2020 2020 2020 206e 6f64 6520 3d20 6365         node = ce
+00009090: 7263 6973 2e6c 6962 3274 6f33 5f70 6172  rcis.lib2to3_par
+000090a0: 7365 2822 6465 6620 6628 2a2c 2061 7267  se("def f(*, arg
+000090b0: 293a 2066 2773 7472 696e 6727 5c6e 2229  ): f'string'\n")
+000090c0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+000090d0: 7365 7274 4571 7561 6c28 6365 7263 6973  sertEqual(cercis
+000090e0: 2e67 6574 5f66 6561 7475 7265 735f 7573  .get_features_us
+000090f0: 6564 286e 6f64 6529 2c20 7b46 6561 7475  ed(node), {Featu
+00009100: 7265 2e46 5f53 5452 494e 4753 7d29 0a20  re.F_STRINGS}). 
+00009110: 2020 2020 2020 206e 6f64 6520 3d20 6365         node = ce
+00009120: 7263 6973 2e6c 6962 3274 6f33 5f70 6172  rcis.lib2to3_par
+00009130: 7365 2822 3132 335f 3435 365c 6e22 290a  se("123_456\n").
+00009140: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00009150: 6572 7445 7175 616c 2863 6572 6369 732e  ertEqual(cercis.
+00009160: 6765 745f 6665 6174 7572 6573 5f75 7365  get_features_use
+00009170: 6428 6e6f 6465 292c 207b 4665 6174 7572  d(node), {Featur
+00009180: 652e 4e55 4d45 5249 435f 554e 4445 5253  e.NUMERIC_UNDERS
+00009190: 434f 5245 537d 290a 2020 2020 2020 2020  CORES}).        
+000091a0: 6e6f 6465 203d 2063 6572 6369 732e 6c69  node = cercis.li
+000091b0: 6232 746f 335f 7061 7273 6528 2231 3233  b2to3_parse("123
+000091c0: 3435 365c 6e22 290a 2020 2020 2020 2020  456\n").        
+000091d0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+000091e0: 2863 6572 6369 732e 6765 745f 6665 6174  (cercis.get_feat
+000091f0: 7572 6573 5f75 7365 6428 6e6f 6465 292c  ures_used(node),
+00009200: 2073 6574 2829 290a 2020 2020 2020 2020   set()).        
+00009210: 736f 7572 6365 2c20 6578 7065 6374 6564  source, expected
+00009220: 203d 2072 6561 645f 6461 7461 2822 7369   = read_data("si
+00009230: 6d70 6c65 5f63 6173 6573 222c 2022 6675  mple_cases", "fu
+00009240: 6e63 7469 6f6e 2229 0a20 2020 2020 2020  nction").       
+00009250: 206e 6f64 6520 3d20 6365 7263 6973 2e6c   node = cercis.l
+00009260: 6962 3274 6f33 5f70 6172 7365 2873 6f75  ib2to3_parse(sou
+00009270: 7263 6529 0a20 2020 2020 2020 2065 7870  rce).        exp
+00009280: 6563 7465 645f 6665 6174 7572 6573 203d  ected_features =
+00009290: 207b 0a20 2020 2020 2020 2020 2020 2046   {.            F
+000092a0: 6561 7475 7265 2e54 5241 494c 494e 475f  eature.TRAILING_
+000092b0: 434f 4d4d 415f 494e 5f43 414c 4c2c 0a20  COMMA_IN_CALL,. 
+000092c0: 2020 2020 2020 2020 2020 2046 6561 7475             Featu
+000092d0: 7265 2e54 5241 494c 494e 475f 434f 4d4d  re.TRAILING_COMM
+000092e0: 415f 494e 5f44 4546 2c0a 2020 2020 2020  A_IN_DEF,.      
+000092f0: 2020 2020 2020 4665 6174 7572 652e 465f        Feature.F_
+00009300: 5354 5249 4e47 532c 0a20 2020 2020 2020  STRINGS,.       
+00009310: 207d 0a20 2020 2020 2020 2073 656c 662e   }.        self.
+00009320: 6173 7365 7274 4571 7561 6c28 6365 7263  assertEqual(cerc
+00009330: 6973 2e67 6574 5f66 6561 7475 7265 735f  is.get_features_
+00009340: 7573 6564 286e 6f64 6529 2c20 6578 7065  used(node), expe
+00009350: 6374 6564 5f66 6561 7475 7265 7329 0a20  cted_features). 
+00009360: 2020 2020 2020 206e 6f64 6520 3d20 6365         node = ce
+00009370: 7263 6973 2e6c 6962 3274 6f33 5f70 6172  rcis.lib2to3_par
+00009380: 7365 2865 7870 6563 7465 6429 0a20 2020  se(expected).   
+00009390: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+000093a0: 4571 7561 6c28 6365 7263 6973 2e67 6574  Equal(cercis.get
+000093b0: 5f66 6561 7475 7265 735f 7573 6564 286e  _features_used(n
+000093c0: 6f64 6529 2c20 6578 7065 6374 6564 5f66  ode), expected_f
+000093d0: 6561 7475 7265 7329 0a20 2020 2020 2020  eatures).       
+000093e0: 2073 6f75 7263 652c 2065 7870 6563 7465   source, expecte
+000093f0: 6420 3d20 7265 6164 5f64 6174 6128 2273  d = read_data("s
+00009400: 696d 706c 655f 6361 7365 7322 2c20 2265  imple_cases", "e
+00009410: 7870 7265 7373 696f 6e22 290a 2020 2020  xpression").    
+00009420: 2020 2020 6e6f 6465 203d 2063 6572 6369      node = cerci
+00009430: 732e 6c69 6232 746f 335f 7061 7273 6528  s.lib2to3_parse(
+00009440: 736f 7572 6365 290a 2020 2020 2020 2020  source).        
+00009450: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00009460: 2863 6572 6369 732e 6765 745f 6665 6174  (cercis.get_feat
+00009470: 7572 6573 5f75 7365 6428 6e6f 6465 292c  ures_used(node),
+00009480: 2073 6574 2829 290a 2020 2020 2020 2020   set()).        
+00009490: 6e6f 6465 203d 2063 6572 6369 732e 6c69  node = cercis.li
+000094a0: 6232 746f 335f 7061 7273 6528 6578 7065  b2to3_parse(expe
+000094b0: 6374 6564 290a 2020 2020 2020 2020 7365  cted).        se
+000094c0: 6c66 2e61 7373 6572 7445 7175 616c 2863  lf.assertEqual(c
+000094d0: 6572 6369 732e 6765 745f 6665 6174 7572  ercis.get_featur
+000094e0: 6573 5f75 7365 6428 6e6f 6465 292c 2073  es_used(node), s
+000094f0: 6574 2829 290a 2020 2020 2020 2020 6e6f  et()).        no
+00009500: 6465 203d 2063 6572 6369 732e 6c69 6232  de = cercis.lib2
+00009510: 746f 335f 7061 7273 6528 226c 616d 6264  to3_parse("lambd
+00009520: 6120 612c 202f 2c20 623a 202e 2e2e 2229  a a, /, b: ...")
+00009530: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00009540: 7365 7274 4571 7561 6c28 6365 7263 6973  sertEqual(cercis
+00009550: 2e67 6574 5f66 6561 7475 7265 735f 7573  .get_features_us
+00009560: 6564 286e 6f64 6529 2c20 7b46 6561 7475  ed(node), {Featu
+00009570: 7265 2e50 4f53 5f4f 4e4c 595f 4152 4755  re.POS_ONLY_ARGU
+00009580: 4d45 4e54 537d 290a 2020 2020 2020 2020  MENTS}).        
+00009590: 6e6f 6465 203d 2063 6572 6369 732e 6c69  node = cercis.li
+000095a0: 6232 746f 335f 7061 7273 6528 2264 6566  b2to3_parse("def
+000095b0: 2066 6e28 612c 202f 2c20 6229 3a20 2e2e   fn(a, /, b): ..
+000095c0: 2e22 290a 2020 2020 2020 2020 7365 6c66  .").        self
+000095d0: 2e61 7373 6572 7445 7175 616c 2863 6572  .assertEqual(cer
+000095e0: 6369 732e 6765 745f 6665 6174 7572 6573  cis.get_features
+000095f0: 5f75 7365 6428 6e6f 6465 292c 207b 4665  _used(node), {Fe
+00009600: 6174 7572 652e 504f 535f 4f4e 4c59 5f41  ature.POS_ONLY_A
+00009610: 5247 554d 454e 5453 7d29 0a20 2020 2020  RGUMENTS}).     
+00009620: 2020 206e 6f64 6520 3d20 6365 7263 6973     node = cercis
+00009630: 2e6c 6962 3274 6f33 5f70 6172 7365 2822  .lib2to3_parse("
+00009640: 6465 6620 666e 2829 3a20 7969 656c 6420  def fn(): yield 
+00009650: 612c 2062 2229 0a20 2020 2020 2020 2073  a, b").        s
+00009660: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00009670: 6365 7263 6973 2e67 6574 5f66 6561 7475  cercis.get_featu
+00009680: 7265 735f 7573 6564 286e 6f64 6529 2c20  res_used(node), 
+00009690: 7365 7428 2929 0a20 2020 2020 2020 206e  set()).        n
+000096a0: 6f64 6520 3d20 6365 7263 6973 2e6c 6962  ode = cercis.lib
+000096b0: 3274 6f33 5f70 6172 7365 2822 6465 6620  2to3_parse("def 
+000096c0: 666e 2829 3a20 7265 7475 726e 2061 2c20  fn(): return a, 
+000096d0: 6222 290a 2020 2020 2020 2020 7365 6c66  b").        self
+000096e0: 2e61 7373 6572 7445 7175 616c 2863 6572  .assertEqual(cer
+000096f0: 6369 732e 6765 745f 6665 6174 7572 6573  cis.get_features
+00009700: 5f75 7365 6428 6e6f 6465 292c 2073 6574  _used(node), set
+00009710: 2829 290a 2020 2020 2020 2020 6e6f 6465  ()).        node
+00009720: 203d 2063 6572 6369 732e 6c69 6232 746f   = cercis.lib2to
+00009730: 335f 7061 7273 6528 2264 6566 2066 6e28  3_parse("def fn(
+00009740: 293a 2079 6965 6c64 202a 622c 2063 2229  ): yield *b, c")
+00009750: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00009760: 7365 7274 4571 7561 6c28 6365 7263 6973  sertEqual(cercis
+00009770: 2e67 6574 5f66 6561 7475 7265 735f 7573  .get_features_us
+00009780: 6564 286e 6f64 6529 2c20 7b46 6561 7475  ed(node), {Featu
+00009790: 7265 2e55 4e50 4143 4b49 4e47 5f4f 4e5f  re.UNPACKING_ON_
+000097a0: 464c 4f57 7d29 0a20 2020 2020 2020 206e  FLOW}).        n
+000097b0: 6f64 6520 3d20 6365 7263 6973 2e6c 6962  ode = cercis.lib
+000097c0: 3274 6f33 5f70 6172 7365 2822 6465 6620  2to3_parse("def 
+000097d0: 666e 2829 3a20 7265 7475 726e 2061 2c20  fn(): return a, 
+000097e0: 2a62 2c20 6322 290a 2020 2020 2020 2020  *b, c").        
+000097f0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00009800: 2863 6572 6369 732e 6765 745f 6665 6174  (cercis.get_feat
+00009810: 7572 6573 5f75 7365 6428 6e6f 6465 292c  ures_used(node),
+00009820: 207b 4665 6174 7572 652e 554e 5041 434b   {Feature.UNPACK
+00009830: 494e 475f 4f4e 5f46 4c4f 577d 290a 2020  ING_ON_FLOW}).  
+00009840: 2020 2020 2020 6e6f 6465 203d 2063 6572        node = cer
+00009850: 6369 732e 6c69 6232 746f 335f 7061 7273  cis.lib2to3_pars
+00009860: 6528 2278 203d 2061 2c20 2a62 2c20 6322  e("x = a, *b, c"
+00009870: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+00009880: 7373 6572 7445 7175 616c 2863 6572 6369  ssertEqual(cerci
+00009890: 732e 6765 745f 6665 6174 7572 6573 5f75  s.get_features_u
+000098a0: 7365 6428 6e6f 6465 292c 2073 6574 2829  sed(node), set()
+000098b0: 290a 2020 2020 2020 2020 6e6f 6465 203d  ).        node =
+000098c0: 2063 6572 6369 732e 6c69 6232 746f 335f   cercis.lib2to3_
+000098d0: 7061 7273 6528 2278 3a20 416e 7920 3d20  parse("x: Any = 
+000098e0: 7265 6775 6c61 7222 290a 2020 2020 2020  regular").      
+000098f0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+00009900: 616c 2863 6572 6369 732e 6765 745f 6665  al(cercis.get_fe
+00009910: 6174 7572 6573 5f75 7365 6428 6e6f 6465  atures_used(node
+00009920: 292c 2073 6574 2829 290a 2020 2020 2020  ), set()).      
+00009930: 2020 6e6f 6465 203d 2063 6572 6369 732e    node = cercis.
+00009940: 6c69 6232 746f 335f 7061 7273 6528 2278  lib2to3_parse("x
+00009950: 3a20 416e 7920 3d20 2872 6567 756c 6172  : Any = (regular
+00009960: 2c20 7265 6775 6c61 7229 2229 0a20 2020  , regular)").   
+00009970: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00009980: 4571 7561 6c28 6365 7263 6973 2e67 6574  Equal(cercis.get
+00009990: 5f66 6561 7475 7265 735f 7573 6564 286e  _features_used(n
+000099a0: 6f64 6529 2c20 7365 7428 2929 0a20 2020  ode), set()).   
+000099b0: 2020 2020 206e 6f64 6520 3d20 6365 7263       node = cerc
+000099c0: 6973 2e6c 6962 3274 6f33 5f70 6172 7365  is.lib2to3_parse
+000099d0: 2822 783a 2041 6e79 203d 2043 6f6d 706c  ("x: Any = Compl
+000099e0: 6578 2854 7970 6528 3129 295b 736f 6d65  ex(Type(1))[some
+000099f0: 7468 696e 675d 2229 0a20 2020 2020 2020  thing]").       
+00009a00: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00009a10: 6c28 6365 7263 6973 2e67 6574 5f66 6561  l(cercis.get_fea
+00009a20: 7475 7265 735f 7573 6564 286e 6f64 6529  tures_used(node)
+00009a30: 2c20 7365 7428 2929 0a20 2020 2020 2020  , set()).       
+00009a40: 206e 6f64 6520 3d20 6365 7263 6973 2e6c   node = cercis.l
+00009a50: 6962 3274 6f33 5f70 6172 7365 2822 783a  ib2to3_parse("x:
+00009a60: 2054 7570 6c65 5b69 6e74 2c20 2e2e 2e5d   Tuple[int, ...]
+00009a70: 203d 2061 2c20 622c 2063 2229 0a20 2020   = a, b, c").   
+00009a80: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+00009a90: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+00009aa0: 2020 2063 6572 6369 732e 6765 745f 6665     cercis.get_fe
+00009ab0: 6174 7572 6573 5f75 7365 6428 6e6f 6465  atures_used(node
+00009ac0: 292c 207b 4665 6174 7572 652e 414e 4e5f  ), {Feature.ANN_
+00009ad0: 4153 5349 474e 5f45 5854 454e 4445 445f  ASSIGN_EXTENDED_
+00009ae0: 5248 537d 0a20 2020 2020 2020 2029 0a20  RHS}.        ). 
+00009af0: 2020 2020 2020 206e 6f64 6520 3d20 6365         node = ce
+00009b00: 7263 6973 2e6c 6962 3274 6f33 5f70 6172  rcis.lib2to3_par
+00009b10: 7365 2822 7472 793a 2070 6173 735c 6e65  se("try: pass\ne
+00009b20: 7863 6570 7420 536f 6d65 7468 696e 673a  xcept Something:
+00009b30: 2070 6173 7322 290a 2020 2020 2020 2020   pass").        
+00009b40: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00009b50: 2863 6572 6369 732e 6765 745f 6665 6174  (cercis.get_feat
+00009b60: 7572 6573 5f75 7365 6428 6e6f 6465 292c  ures_used(node),
+00009b70: 2073 6574 2829 290a 2020 2020 2020 2020   set()).        
+00009b80: 6e6f 6465 203d 2063 6572 6369 732e 6c69  node = cercis.li
+00009b90: 6232 746f 335f 7061 7273 6528 2274 7279  b2to3_parse("try
+00009ba0: 3a20 7061 7373 5c6e 6578 6365 7074 2028  : pass\nexcept (
+00009bb0: 2a53 6f6d 6574 6869 6e67 2c29 3a20 7061  *Something,): pa
+00009bc0: 7373 2229 0a20 2020 2020 2020 2073 656c  ss").        sel
+00009bd0: 662e 6173 7365 7274 4571 7561 6c28 6365  f.assertEqual(ce
+00009be0: 7263 6973 2e67 6574 5f66 6561 7475 7265  rcis.get_feature
+00009bf0: 735f 7573 6564 286e 6f64 6529 2c20 7365  s_used(node), se
+00009c00: 7428 2929 0a20 2020 2020 2020 206e 6f64  t()).        nod
+00009c10: 6520 3d20 6365 7263 6973 2e6c 6962 3274  e = cercis.lib2t
+00009c20: 6f33 5f70 6172 7365 2822 7472 793a 2070  o3_parse("try: p
+00009c30: 6173 735c 6e65 7863 6570 7420 2a47 726f  ass\nexcept *Gro
+00009c40: 7570 3a20 7061 7373 2229 0a20 2020 2020  up: pass").     
+00009c50: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00009c60: 7561 6c28 6365 7263 6973 2e67 6574 5f66  ual(cercis.get_f
+00009c70: 6561 7475 7265 735f 7573 6564 286e 6f64  eatures_used(nod
+00009c80: 6529 2c20 7b46 6561 7475 7265 2e45 5843  e), {Feature.EXC
+00009c90: 4550 545f 5354 4152 7d29 0a20 2020 2020  EPT_STAR}).     
+00009ca0: 2020 206e 6f64 6520 3d20 6365 7263 6973     node = cercis
+00009cb0: 2e6c 6962 3274 6f33 5f70 6172 7365 2822  .lib2to3_parse("
+00009cc0: 615b 2a62 5d22 290a 2020 2020 2020 2020  a[*b]").        
+00009cd0: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00009ce0: 2863 6572 6369 732e 6765 745f 6665 6174  (cercis.get_feat
+00009cf0: 7572 6573 5f75 7365 6428 6e6f 6465 292c  ures_used(node),
+00009d00: 207b 4665 6174 7572 652e 5641 5249 4144   {Feature.VARIAD
+00009d10: 4943 5f47 454e 4552 4943 537d 290a 2020  IC_GENERICS}).  
+00009d20: 2020 2020 2020 6e6f 6465 203d 2063 6572        node = cer
+00009d30: 6369 732e 6c69 6232 746f 335f 7061 7273  cis.lib2to3_pars
+00009d40: 6528 2261 5b78 2c20 2a79 2829 2c20 7a5d  e("a[x, *y(), z]
+00009d50: 203d 2074 2229 0a20 2020 2020 2020 2073   = t").        s
+00009d60: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00009d70: 6365 7263 6973 2e67 6574 5f66 6561 7475  cercis.get_featu
+00009d80: 7265 735f 7573 6564 286e 6f64 6529 2c20  res_used(node), 
+00009d90: 7b46 6561 7475 7265 2e56 4152 4941 4449  {Feature.VARIADI
+00009da0: 435f 4745 4e45 5249 4353 7d29 0a20 2020  C_GENERICS}).   
+00009db0: 2020 2020 206e 6f64 6520 3d20 6365 7263       node = cerc
+00009dc0: 6973 2e6c 6962 3274 6f33 5f70 6172 7365  is.lib2to3_parse
+00009dd0: 2822 6465 6620 666e 282a 6172 6773 3a20  ("def fn(*args: 
+00009de0: 2a54 293a 2070 6173 7322 290a 2020 2020  *T): pass").    
+00009df0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00009e00: 7175 616c 2863 6572 6369 732e 6765 745f  qual(cercis.get_
+00009e10: 6665 6174 7572 6573 5f75 7365 6428 6e6f  features_used(no
+00009e20: 6465 292c 207b 4665 6174 7572 652e 5641  de), {Feature.VA
+00009e30: 5249 4144 4943 5f47 454e 4552 4943 537d  RIADIC_GENERICS}
+00009e40: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
+00009e50: 6765 745f 6665 6174 7572 6573 5f75 7365  get_features_use
+00009e60: 645f 666f 725f 6675 7475 7265 5f66 6c61  d_for_future_fla
+00009e70: 6773 2873 656c 6629 202d 3e20 4e6f 6e65  gs(self) -> None
+00009e80: 3a0a 2020 2020 2020 2020 666f 7220 7372  :.        for sr
+00009e90: 632c 2066 6561 7475 7265 7320 696e 205b  c, features in [
+00009ea0: 0a20 2020 2020 2020 2020 2020 2028 2266  .            ("f
+00009eb0: 726f 6d20 5f5f 6675 7475 7265 5f5f 2069  rom __future__ i
+00009ec0: 6d70 6f72 7420 616e 6e6f 7461 7469 6f6e  mport annotation
+00009ed0: 7322 2c20 7b46 6561 7475 7265 2e46 5554  s", {Feature.FUT
+00009ee0: 5552 455f 414e 4e4f 5441 5449 4f4e 537d  URE_ANNOTATIONS}
+00009ef0: 292c 0a20 2020 2020 2020 2020 2020 2028  ),.            (
+00009f00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009f10: 2022 6672 6f6d 205f 5f66 7574 7572 655f   "from __future_
+00009f20: 5f20 696d 706f 7274 2028 6f74 6865 722c  _ import (other,
+00009f30: 2061 6e6e 6f74 6174 696f 6e73 2922 2c0a   annotations)",.
+00009f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009f50: 7b46 6561 7475 7265 2e46 5554 5552 455f  {Feature.FUTURE_
+00009f60: 414e 4e4f 5441 5449 4f4e 537d 2c0a 2020  ANNOTATIONS},.  
+00009f70: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
+00009f80: 2020 2020 2020 2020 2028 2261 203d 2031           ("a = 1
+00009f90: 202b 2032 5c6e 6672 6f6d 2073 6f6d 6574   + 2\nfrom somet
+00009fa0: 6869 6e67 2069 6d70 6f72 7420 616e 6e6f  hing import anno
+00009fb0: 7461 7469 6f6e 7322 2c20 7365 7428 2929  tations", set())
+00009fc0: 2c0a 2020 2020 2020 2020 2020 2020 2822  ,.            ("
+00009fd0: 6672 6f6d 205f 5f66 7574 7572 655f 5f20  from __future__ 
+00009fe0: 696d 706f 7274 2078 2c20 7922 2c20 7365  import x, y", se
+00009ff0: 7428 2929 2c0a 2020 2020 2020 2020 5d3a  t()),.        ]:
+0000a000: 0a20 2020 2020 2020 2020 2020 2077 6974  .            wit
+0000a010: 6820 7365 6c66 2e73 7562 5465 7374 2873  h self.subTest(s
+0000a020: 7263 3d73 7263 2c20 6665 6174 7572 6573  rc=src, features
+0000a030: 3d66 6561 7475 7265 7329 3a0a 2020 2020  =features):.    
+0000a040: 2020 2020 2020 2020 2020 2020 6e6f 6465              node
+0000a050: 203d 2063 6572 6369 732e 6c69 6232 746f   = cercis.lib2to
+0000a060: 335f 7061 7273 6528 7372 6329 0a20 2020  3_parse(src).   
+0000a070: 2020 2020 2020 2020 2020 2020 2066 7574               fut
+0000a080: 7572 655f 696d 706f 7274 7320 3d20 6365  ure_imports = ce
+0000a090: 7263 6973 2e67 6574 5f66 7574 7572 655f  rcis.get_future_
+0000a0a0: 696d 706f 7274 7328 6e6f 6465 290a 2020  imports(node).  
+0000a0b0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0000a0c0: 6c66 2e61 7373 6572 7445 7175 616c 280a  lf.assertEqual(.
+0000a0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a0e0: 2020 2020 6365 7263 6973 2e67 6574 5f66      cercis.get_f
+0000a0f0: 6561 7475 7265 735f 7573 6564 286e 6f64  eatures_used(nod
+0000a100: 652c 2066 7574 7572 655f 696d 706f 7274  e, future_import
+0000a110: 733d 6675 7475 7265 5f69 6d70 6f72 7473  s=future_imports
+0000a120: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+0000a130: 2020 2020 2020 2066 6561 7475 7265 732c         features,
+0000a140: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a150: 2029 0a0a 2020 2020 6465 6620 7465 7374   )..    def test
+0000a160: 5f67 6574 5f66 7574 7572 655f 696d 706f  _get_future_impo
+0000a170: 7274 7328 7365 6c66 2920 2d3e 204e 6f6e  rts(self) -> Non
+0000a180: 653a 0a20 2020 2020 2020 206e 6f64 6520  e:.        node 
+0000a190: 3d20 6365 7263 6973 2e6c 6962 3274 6f33  = cercis.lib2to3
+0000a1a0: 5f70 6172 7365 2822 5c6e 2229 0a20 2020  _parse("\n").   
+0000a1b0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0000a1c0: 4571 7561 6c28 7365 7428 292c 2063 6572  Equal(set(), cer
+0000a1d0: 6369 732e 6765 745f 6675 7475 7265 5f69  cis.get_future_i
+0000a1e0: 6d70 6f72 7473 286e 6f64 6529 290a 2020  mports(node)).  
+0000a1f0: 2020 2020 2020 6e6f 6465 203d 2063 6572        node = cer
+0000a200: 6369 732e 6c69 6232 746f 335f 7061 7273  cis.lib2to3_pars
+0000a210: 6528 2266 726f 6d20 5f5f 6675 7475 7265  e("from __future
+0000a220: 5f5f 2069 6d70 6f72 7420 6365 7263 6973  __ import cercis
+0000a230: 5c6e 2229 0a20 2020 2020 2020 2073 656c  \n").        sel
+0000a240: 662e 6173 7365 7274 4571 7561 6c28 7b22  f.assertEqual({"
+0000a250: 6365 7263 6973 227d 2c20 6365 7263 6973  cercis"}, cercis
+0000a260: 2e67 6574 5f66 7574 7572 655f 696d 706f  .get_future_impo
+0000a270: 7274 7328 6e6f 6465 2929 0a20 2020 2020  rts(node)).     
+0000a280: 2020 206e 6f64 6520 3d20 6365 7263 6973     node = cercis
+0000a290: 2e6c 6962 3274 6f33 5f70 6172 7365 2822  .lib2to3_parse("
+0000a2a0: 6672 6f6d 205f 5f66 7574 7572 655f 5f20  from __future__ 
+0000a2b0: 696d 706f 7274 206d 756c 7469 706c 652c  import multiple,
+0000a2c0: 2069 6d70 6f72 7473 5c6e 2229 0a20 2020   imports\n").   
+0000a2d0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0000a2e0: 4571 7561 6c28 7b22 6d75 6c74 6970 6c65  Equal({"multiple
+0000a2f0: 222c 2022 696d 706f 7274 7322 7d2c 2063  ", "imports"}, c
+0000a300: 6572 6369 732e 6765 745f 6675 7475 7265  ercis.get_future
+0000a310: 5f69 6d70 6f72 7473 286e 6f64 6529 290a  _imports(node)).
+0000a320: 2020 2020 2020 2020 6e6f 6465 203d 2063          node = c
+0000a330: 6572 6369 732e 6c69 6232 746f 335f 7061  ercis.lib2to3_pa
+0000a340: 7273 6528 2266 726f 6d20 5f5f 6675 7475  rse("from __futu
+0000a350: 7265 5f5f 2069 6d70 6f72 7420 2870 6172  re__ import (par
+0000a360: 656e 7468 6573 697a 6564 2c20 696d 706f  enthesized, impo
+0000a370: 7274 7329 5c6e 2229 0a20 2020 2020 2020  rts)\n").       
+0000a380: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+0000a390: 6c28 7b22 7061 7265 6e74 6865 7369 7a65  l({"parenthesize
+0000a3a0: 6422 2c20 2269 6d70 6f72 7473 227d 2c20  d", "imports"}, 
+0000a3b0: 6365 7263 6973 2e67 6574 5f66 7574 7572  cercis.get_futur
+0000a3c0: 655f 696d 706f 7274 7328 6e6f 6465 2929  e_imports(node))
+0000a3d0: 0a20 2020 2020 2020 206e 6f64 6520 3d20  .        node = 
+0000a3e0: 6365 7263 6973 2e6c 6962 3274 6f33 5f70  cercis.lib2to3_p
+0000a3f0: 6172 7365 280a 2020 2020 2020 2020 2020  arse(.          
+0000a400: 2020 2266 726f 6d20 5f5f 6675 7475 7265    "from __future
+0000a410: 5f5f 2069 6d70 6f72 7420 6d75 6c74 6970  __ import multip
+0000a420: 6c65 5c6e 6672 6f6d 205f 5f66 7574 7572  le\nfrom __futur
+0000a430: 655f 5f20 696d 706f 7274 2069 6d70 6f72  e__ import impor
+0000a440: 7473 5c6e 220a 2020 2020 2020 2020 290a  ts\n".        ).
+0000a450: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0000a460: 6572 7445 7175 616c 287b 226d 756c 7469  ertEqual({"multi
+0000a470: 706c 6522 2c20 2269 6d70 6f72 7473 227d  ple", "imports"}
+0000a480: 2c20 6365 7263 6973 2e67 6574 5f66 7574  , cercis.get_fut
+0000a490: 7572 655f 696d 706f 7274 7328 6e6f 6465  ure_imports(node
+0000a4a0: 2929 0a20 2020 2020 2020 206e 6f64 6520  )).        node 
+0000a4b0: 3d20 6365 7263 6973 2e6c 6962 3274 6f33  = cercis.lib2to3
+0000a4c0: 5f70 6172 7365 2822 2320 636f 6d6d 656e  _parse("# commen
+0000a4d0: 745c 6e66 726f 6d20 5f5f 6675 7475 7265  t\nfrom __future
+0000a4e0: 5f5f 2069 6d70 6f72 7420 6365 7263 6973  __ import cercis
+0000a4f0: 5c6e 2229 0a20 2020 2020 2020 2073 656c  \n").        sel
+0000a500: 662e 6173 7365 7274 4571 7561 6c28 7b22  f.assertEqual({"
+0000a510: 6365 7263 6973 227d 2c20 6365 7263 6973  cercis"}, cercis
+0000a520: 2e67 6574 5f66 7574 7572 655f 696d 706f  .get_future_impo
+0000a530: 7274 7328 6e6f 6465 2929 0a20 2020 2020  rts(node)).     
+0000a540: 2020 206e 6f64 6520 3d20 6365 7263 6973     node = cercis
+0000a550: 2e6c 6962 3274 6f33 5f70 6172 7365 2827  .lib2to3_parse('
+0000a560: 2222 2264 6f63 7374 7269 6e67 2222 225c  """docstring"""\
+0000a570: 6e66 726f 6d20 5f5f 6675 7475 7265 5f5f  nfrom __future__
+0000a580: 2069 6d70 6f72 7420 6365 7263 6973 5c6e   import cercis\n
+0000a590: 2729 0a20 2020 2020 2020 2073 656c 662e  ').        self.
+0000a5a0: 6173 7365 7274 4571 7561 6c28 7b22 6365  assertEqual({"ce
+0000a5b0: 7263 6973 227d 2c20 6365 7263 6973 2e67  rcis"}, cercis.g
+0000a5c0: 6574 5f66 7574 7572 655f 696d 706f 7274  et_future_import
+0000a5d0: 7328 6e6f 6465 2929 0a20 2020 2020 2020  s(node)).       
+0000a5e0: 206e 6f64 6520 3d20 6365 7263 6973 2e6c   node = cercis.l
+0000a5f0: 6962 3274 6f33 5f70 6172 7365 280a 2020  ib2to3_parse(.  
+0000a600: 2020 2020 2020 2020 2020 2273 6f6d 6528            "some(
+0000a610: 6f74 6865 722c 2063 6f64 6529 5c6e 6672  other, code)\nfr
+0000a620: 6f6d 205f 5f66 7574 7572 655f 5f20 696d  om __future__ im
+0000a630: 706f 7274 2063 6572 6369 735c 6e22 0a20  port cercis\n". 
+0000a640: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0000a650: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+0000a660: 6c28 7365 7428 292c 2063 6572 6369 732e  l(set(), cercis.
+0000a670: 6765 745f 6675 7475 7265 5f69 6d70 6f72  get_future_impor
+0000a680: 7473 286e 6f64 6529 290a 2020 2020 2020  ts(node)).      
+0000a690: 2020 6e6f 6465 203d 2063 6572 6369 732e    node = cercis.
+0000a6a0: 6c69 6232 746f 335f 7061 7273 6528 2266  lib2to3_parse("f
+0000a6b0: 726f 6d20 736f 6d65 2e6d 6f64 756c 6520  rom some.module 
+0000a6c0: 696d 706f 7274 2063 6572 6369 735c 6e22  import cercis\n"
+0000a6d0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+0000a6e0: 7373 6572 7445 7175 616c 2873 6574 2829  ssertEqual(set()
+0000a6f0: 2c20 6365 7263 6973 2e67 6574 5f66 7574  , cercis.get_fut
+0000a700: 7572 655f 696d 706f 7274 7328 6e6f 6465  ure_imports(node
+0000a710: 2929 0a20 2020 2020 2020 206e 6f64 6520  )).        node 
+0000a720: 3d20 6365 7263 6973 2e6c 6962 3274 6f33  = cercis.lib2to3
+0000a730: 5f70 6172 7365 280a 2020 2020 2020 2020  _parse(.        
+0000a740: 2020 2020 2266 726f 6d20 5f5f 6675 7475      "from __futu
+0000a750: 7265 5f5f 2069 6d70 6f72 7420 756e 6963  re__ import unic
+0000a760: 6f64 655f 6c69 7465 7261 6c73 2061 7320  ode_literals as 
+0000a770: 5f75 6e69 636f 6465 5f6c 6974 6572 616c  _unicode_literal
+0000a780: 7322 0a20 2020 2020 2020 2029 0a20 2020  s".        ).   
+0000a790: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+0000a7a0: 4571 7561 6c28 7b22 756e 6963 6f64 655f  Equal({"unicode_
+0000a7b0: 6c69 7465 7261 6c73 227d 2c20 6365 7263  literals"}, cerc
+0000a7c0: 6973 2e67 6574 5f66 7574 7572 655f 696d  is.get_future_im
+0000a7d0: 706f 7274 7328 6e6f 6465 2929 0a20 2020  ports(node)).   
+0000a7e0: 2020 2020 206e 6f64 6520 3d20 6365 7263       node = cerc
+0000a7f0: 6973 2e6c 6962 3274 6f33 5f70 6172 7365  is.lib2to3_parse
+0000a800: 280a 2020 2020 2020 2020 2020 2020 2266  (.            "f
+0000a810: 726f 6d20 5f5f 6675 7475 7265 5f5f 2069  rom __future__ i
+0000a820: 6d70 6f72 7420 756e 6963 6f64 655f 6c69  mport unicode_li
+0000a830: 7465 7261 6c73 2061 7320 5f6c 6f6c 2c20  terals as _lol, 
+0000a840: 7072 696e 7422 0a20 2020 2020 2020 2029  print".        )
+0000a850: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+0000a860: 7365 7274 4571 7561 6c28 7b22 756e 6963  sertEqual({"unic
+0000a870: 6f64 655f 6c69 7465 7261 6c73 222c 2022  ode_literals", "
+0000a880: 7072 696e 7422 7d2c 2063 6572 6369 732e  print"}, cercis.
+0000a890: 6765 745f 6675 7475 7265 5f69 6d70 6f72  get_future_impor
+0000a8a0: 7473 286e 6f64 6529 290a 0a20 2020 2040  ts(node))..    @
+0000a8b0: 7079 7465 7374 2e6d 6172 6b2e 696e 636f  pytest.mark.inco
+0000a8c0: 6d70 6174 6962 6c65 5f77 6974 685f 6d79  mpatible_with_my
+0000a8d0: 7079 630a 2020 2020 6465 6620 7465 7374  pyc.    def test
+0000a8e0: 5f64 6562 7567 5f76 6973 6974 6f72 2873  _debug_visitor(s
+0000a8f0: 656c 6629 202d 3e20 4e6f 6e65 3a0a 2020  elf) -> None:.  
+0000a900: 2020 2020 2020 736f 7572 6365 2c20 5f20        source, _ 
+0000a910: 3d20 7265 6164 5f64 6174 6128 226d 6973  = read_data("mis
+0000a920: 6365 6c6c 616e 656f 7573 222c 2022 6465  cellaneous", "de
+0000a930: 6275 675f 7669 7369 746f 7222 290a 2020  bug_visitor").  
+0000a940: 2020 2020 2020 6578 7065 6374 6564 2c20        expected, 
+0000a950: 5f20 3d20 7265 6164 5f64 6174 6128 226d  _ = read_data("m
+0000a960: 6973 6365 6c6c 616e 656f 7573 222c 2022  iscellaneous", "
+0000a970: 6465 6275 675f 7669 7369 746f 722e 6f75  debug_visitor.ou
+0000a980: 7422 290a 2020 2020 2020 2020 6f75 745f  t").        out_
+0000a990: 6c69 6e65 7320 3d20 5b5d 0a20 2020 2020  lines = [].     
+0000a9a0: 2020 2065 7272 5f6c 696e 6573 203d 205b     err_lines = [
+0000a9b0: 5d0a 0a20 2020 2020 2020 2064 6566 206f  ]..        def o
+0000a9c0: 7574 286d 7367 3a20 7374 722c 202a 2a6b  ut(msg: str, **k
+0000a9d0: 7761 7267 733a 2041 6e79 2920 2d3e 204e  wargs: Any) -> N
+0000a9e0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+0000a9f0: 206f 7574 5f6c 696e 6573 2e61 7070 656e   out_lines.appen
+0000aa00: 6428 6d73 6729 0a0a 2020 2020 2020 2020  d(msg)..        
+0000aa10: 6465 6620 6572 7228 6d73 673a 2073 7472  def err(msg: str
+0000aa20: 2c20 2a2a 6b77 6172 6773 3a20 416e 7929  , **kwargs: Any)
+0000aa30: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+0000aa40: 2020 2020 2020 6572 725f 6c69 6e65 732e        err_lines.
+0000aa50: 6170 7065 6e64 286d 7367 290a 0a20 2020  append(msg)..   
+0000aa60: 2020 2020 2077 6974 6820 7061 7463 6828       with patch(
+0000aa70: 2263 6572 6369 732e 6465 6275 672e 6f75  "cercis.debug.ou
+0000aa80: 7422 2c20 6f75 7429 3a0a 2020 2020 2020  t", out):.      
+0000aa90: 2020 2020 2020 4465 6275 6756 6973 6974        DebugVisit
+0000aaa0: 6f72 2e73 686f 7728 736f 7572 6365 290a  or.show(source).
+0000aab0: 2020 2020 2020 2020 6163 7475 616c 203d          actual =
+0000aac0: 2022 5c6e 222e 6a6f 696e 286f 7574 5f6c   "\n".join(out_l
+0000aad0: 696e 6573 2920 2b20 225c 6e22 0a20 2020  ines) + "\n".   
+0000aae0: 2020 2020 206c 6f67 5f6e 616d 6520 3d20       log_name = 
+0000aaf0: 2222 0a20 2020 2020 2020 2069 6620 6578  "".        if ex
+0000ab00: 7065 6374 6564 2021 3d20 6163 7475 616c  pected != actual
+0000ab10: 3a0a 2020 2020 2020 2020 2020 2020 6c6f  :.            lo
+0000ab20: 675f 6e61 6d65 203d 2063 6572 6369 732e  g_name = cercis.
+0000ab30: 6475 6d70 5f74 6f5f 6669 6c65 282a 6f75  dump_to_file(*ou
+0000ab40: 745f 6c69 6e65 7329 0a20 2020 2020 2020  t_lines).       
+0000ab50: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+0000ab60: 6c28 0a20 2020 2020 2020 2020 2020 2065  l(.            e
+0000ab70: 7870 6563 7465 642c 0a20 2020 2020 2020  xpected,.       
+0000ab80: 2020 2020 2061 6374 7561 6c2c 0a20 2020       actual,.   
+0000ab90: 2020 2020 2020 2020 2066 2241 5354 2070           f"AST p
+0000aba0: 7269 6e74 206f 7574 2069 7320 6469 6666  rint out is diff
+0000abb0: 6572 656e 742e 2041 6374 7561 6c20 7665  erent. Actual ve
+0000abc0: 7273 696f 6e20 6475 6d70 6564 2074 6f20  rsion dumped to 
+0000abd0: 7b6c 6f67 5f6e 616d 657d 222c 0a20 2020  {log_name}",.   
+0000abe0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+0000abf0: 7465 7374 5f66 6f72 6d61 745f 6669 6c65  test_format_file
+0000ac00: 5f63 6f6e 7465 6e74 7328 7365 6c66 2920  _contents(self) 
+0000ac10: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+0000ac20: 206d 6f64 6520 3d20 4445 4641 554c 545f   mode = DEFAULT_
+0000ac30: 4d4f 4445 0a20 2020 2020 2020 2065 6d70  MODE.        emp
+0000ac40: 7479 203d 2022 220a 2020 2020 2020 2020  ty = "".        
+0000ac50: 7769 7468 2073 656c 662e 6173 7365 7274  with self.assert
+0000ac60: 5261 6973 6573 2863 6572 6369 732e 4e6f  Raises(cercis.No
+0000ac70: 7468 696e 6743 6861 6e67 6564 293a 0a20  thingChanged):. 
+0000ac80: 2020 2020 2020 2020 2020 2063 6572 6369             cerci
+0000ac90: 732e 666f 726d 6174 5f66 696c 655f 636f  s.format_file_co
+0000aca0: 6e74 656e 7473 2865 6d70 7479 2c20 6d6f  ntents(empty, mo
+0000acb0: 6465 3d6d 6f64 652c 2066 6173 743d 4661  de=mode, fast=Fa
+0000acc0: 6c73 6529 0a20 2020 2020 2020 206a 7573  lse).        jus
+0000acd0: 745f 6e6c 203d 2022 5c6e 220a 2020 2020  t_nl = "\n".    
+0000ace0: 2020 2020 7769 7468 2073 656c 662e 6173      with self.as
+0000acf0: 7365 7274 5261 6973 6573 2863 6572 6369  sertRaises(cerci
+0000ad00: 732e 4e6f 7468 696e 6743 6861 6e67 6564  s.NothingChanged
+0000ad10: 293a 0a20 2020 2020 2020 2020 2020 2063  ):.            c
+0000ad20: 6572 6369 732e 666f 726d 6174 5f66 696c  ercis.format_fil
+0000ad30: 655f 636f 6e74 656e 7473 286a 7573 745f  e_contents(just_
+0000ad40: 6e6c 2c20 6d6f 6465 3d6d 6f64 652c 2066  nl, mode=mode, f
+0000ad50: 6173 743d 4661 6c73 6529 0a20 2020 2020  ast=False).     
+0000ad60: 2020 2073 616d 6520 3d20 226a 203d 205b     same = "j = [
+0000ad70: 312c 2032 2c20 335d 5c6e 220a 2020 2020  1, 2, 3]\n".    
+0000ad80: 2020 2020 7769 7468 2073 656c 662e 6173      with self.as
+0000ad90: 7365 7274 5261 6973 6573 2863 6572 6369  sertRaises(cerci
+0000ada0: 732e 4e6f 7468 696e 6743 6861 6e67 6564  s.NothingChanged
+0000adb0: 293a 0a20 2020 2020 2020 2020 2020 2063  ):.            c
+0000adc0: 6572 6369 732e 666f 726d 6174 5f66 696c  ercis.format_fil
+0000add0: 655f 636f 6e74 656e 7473 2873 616d 652c  e_contents(same,
+0000ade0: 206d 6f64 653d 6d6f 6465 2c20 6661 7374   mode=mode, fast
+0000adf0: 3d46 616c 7365 290a 2020 2020 2020 2020  =False).        
+0000ae00: 6469 6666 6572 656e 7420 3d20 226a 203d  different = "j =
+0000ae10: 205b 312c 322c 335d 220a 2020 2020 2020   [1,2,3]".      
+0000ae20: 2020 6578 7065 6374 6564 203d 2073 616d    expected = sam
+0000ae30: 650a 2020 2020 2020 2020 6163 7475 616c  e.        actual
+0000ae40: 203d 2063 6572 6369 732e 666f 726d 6174   = cercis.format
+0000ae50: 5f66 696c 655f 636f 6e74 656e 7473 2864  _file_contents(d
+0000ae60: 6966 6665 7265 6e74 2c20 6d6f 6465 3d6d  ifferent, mode=m
+0000ae70: 6f64 652c 2066 6173 743d 4661 6c73 6529  ode, fast=False)
+0000ae80: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+0000ae90: 7365 7274 4571 7561 6c28 6578 7065 6374  sertEqual(expect
+0000aea0: 6564 2c20 6163 7475 616c 290a 2020 2020  ed, actual).    
+0000aeb0: 2020 2020 696e 7661 6c69 6420 3d20 2272      invalid = "r
+0000aec0: 6574 7572 6e20 6966 2079 6f75 2063 616e  eturn if you can
+0000aed0: 220a 2020 2020 2020 2020 7769 7468 2073  ".        with s
+0000aee0: 656c 662e 6173 7365 7274 5261 6973 6573  elf.assertRaises
+0000aef0: 2863 6572 6369 732e 496e 7661 6c69 6449  (cercis.InvalidI
+0000af00: 6e70 7574 2920 6173 2065 3a0a 2020 2020  nput) as e:.    
+0000af10: 2020 2020 2020 2020 6365 7263 6973 2e66          cercis.f
+0000af20: 6f72 6d61 745f 6669 6c65 5f63 6f6e 7465  ormat_file_conte
+0000af30: 6e74 7328 696e 7661 6c69 642c 206d 6f64  nts(invalid, mod
+0000af40: 653d 6d6f 6465 2c20 6661 7374 3d46 616c  e=mode, fast=Fal
+0000af50: 7365 290a 2020 2020 2020 2020 7365 6c66  se).        self
+0000af60: 2e61 7373 6572 7445 7175 616c 2873 7472  .assertEqual(str
+0000af70: 2865 2e65 7863 6570 7469 6f6e 292c 2022  (e.exception), "
+0000af80: 4361 6e6e 6f74 2070 6172 7365 3a20 313a  Cannot parse: 1:
+0000af90: 373a 2072 6574 7572 6e20 6966 2079 6f75  7: return if you
+0000afa0: 2063 616e 2229 0a0a 2020 2020 2020 2020   can")..        
+0000afb0: 6d6f 6465 203d 2063 6572 6369 732e 4d6f  mode = cercis.Mo
+0000afc0: 6465 2870 7265 7669 6577 3d54 7275 6529  de(preview=True)
+0000afd0: 0a20 2020 2020 2020 206a 7573 745f 6372  .        just_cr
+0000afe0: 6c66 203d 2022 5c72 5c6e 220a 2020 2020  lf = "\r\n".    
+0000aff0: 2020 2020 7769 7468 2073 656c 662e 6173      with self.as
+0000b000: 7365 7274 5261 6973 6573 2863 6572 6369  sertRaises(cerci
+0000b010: 732e 4e6f 7468 696e 6743 6861 6e67 6564  s.NothingChanged
+0000b020: 293a 0a20 2020 2020 2020 2020 2020 2063  ):.            c
+0000b030: 6572 6369 732e 666f 726d 6174 5f66 696c  ercis.format_fil
+0000b040: 655f 636f 6e74 656e 7473 286a 7573 745f  e_contents(just_
+0000b050: 6372 6c66 2c20 6d6f 6465 3d6d 6f64 652c  crlf, mode=mode,
+0000b060: 2066 6173 743d 4661 6c73 6529 0a20 2020   fast=False).   
+0000b070: 2020 2020 206a 7573 745f 7768 6974 6573       just_whites
+0000b080: 7061 6365 5f6e 6c20 3d20 225c 6e5c 745c  pace_nl = "\n\t\
+0000b090: 6e20 5c6e 5c74 205c 6e20 5c74 5c6e 5c6e  n \n\t \n \t\n\n
+0000b0a0: 220a 2020 2020 2020 2020 6163 7475 616c  ".        actual
+0000b0b0: 203d 2063 6572 6369 732e 666f 726d 6174   = cercis.format
+0000b0c0: 5f66 696c 655f 636f 6e74 656e 7473 286a  _file_contents(j
+0000b0d0: 7573 745f 7768 6974 6573 7061 6365 5f6e  ust_whitespace_n
+0000b0e0: 6c2c 206d 6f64 653d 6d6f 6465 2c20 6661  l, mode=mode, fa
+0000b0f0: 7374 3d46 616c 7365 290a 2020 2020 2020  st=False).      
+0000b100: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+0000b110: 616c 2822 5c6e 222c 2061 6374 7561 6c29  al("\n", actual)
+0000b120: 0a20 2020 2020 2020 206a 7573 745f 7768  .        just_wh
+0000b130: 6974 6573 7061 6365 5f63 726c 6620 3d20  itespace_crlf = 
+0000b140: 225c 725c 6e5c 745c 725c 6e20 5c72 5c6e  "\r\n\t\r\n \r\n
+0000b150: 5c74 205c 725c 6e20 5c74 5c72 5c6e 5c72  \t \r\n \t\r\n\r
+0000b160: 5c6e 220a 2020 2020 2020 2020 6163 7475  \n".        actu
+0000b170: 616c 203d 2063 6572 6369 732e 666f 726d  al = cercis.form
+0000b180: 6174 5f66 696c 655f 636f 6e74 656e 7473  at_file_contents
+0000b190: 280a 2020 2020 2020 2020 2020 2020 6a75  (.            ju
+0000b1a0: 7374 5f77 6869 7465 7370 6163 655f 6372  st_whitespace_cr
+0000b1b0: 6c66 2c20 6d6f 6465 3d6d 6f64 652c 2066  lf, mode=mode, f
+0000b1c0: 6173 743d 4661 6c73 650a 2020 2020 2020  ast=False.      
+0000b1d0: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+0000b1e0: 2e61 7373 6572 7445 7175 616c 2822 5c72  .assertEqual("\r
+0000b1f0: 5c6e 222c 2061 6374 7561 6c29 0a0a 2020  \n", actual)..  
+0000b200: 2020 6465 6620 7465 7374 5f65 6e64 6d61    def test_endma
+0000b210: 726b 6572 2873 656c 6629 202d 3e20 4e6f  rker(self) -> No
+0000b220: 6e65 3a0a 2020 2020 2020 2020 6e20 3d20  ne:.        n = 
+0000b230: 6365 7263 6973 2e6c 6962 3274 6f33 5f70  cercis.lib2to3_p
+0000b240: 6172 7365 2822 5c6e 2229 0a20 2020 2020  arse("\n").     
+0000b250: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+0000b260: 7561 6c28 6e2e 7479 7065 2c20 6365 7263  ual(n.type, cerc
+0000b270: 6973 2e73 796d 732e 6669 6c65 5f69 6e70  is.syms.file_inp
+0000b280: 7574 290a 2020 2020 2020 2020 7365 6c66  ut).        self
+0000b290: 2e61 7373 6572 7445 7175 616c 286c 656e  .assertEqual(len
+0000b2a0: 286e 2e63 6869 6c64 7265 6e29 2c20 3129  (n.children), 1)
+0000b2b0: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+0000b2c0: 7365 7274 4571 7561 6c28 6e2e 6368 696c  sertEqual(n.chil
+0000b2d0: 6472 656e 5b30 5d2e 7479 7065 2c20 6365  dren[0].type, ce
+0000b2e0: 7263 6973 2e74 6f6b 656e 2e45 4e44 4d41  rcis.token.ENDMA
+0000b2f0: 524b 4552 290a 0a20 2020 2040 7079 7465  RKER)..    @pyte
+0000b300: 7374 2e6d 6172 6b2e 696e 636f 6d70 6174  st.mark.incompat
+0000b310: 6962 6c65 5f77 6974 685f 6d79 7079 630a  ible_with_mypyc.
+0000b320: 2020 2020 4075 6e69 7474 6573 742e 736b      @unittest.sk
+0000b330: 6970 4966 286f 732e 656e 7669 726f 6e2e  ipIf(os.environ.
+0000b340: 6765 7428 2253 4b49 505f 4153 545f 5052  get("SKIP_AST_PR
+0000b350: 494e 5422 292c 2022 7573 6572 2073 6574  INT"), "user set
+0000b360: 2053 4b49 505f 4153 545f 5052 494e 5422   SKIP_AST_PRINT"
+0000b370: 290a 2020 2020 6465 6620 7465 7374 5f61  ).    def test_a
+0000b380: 7373 6572 7446 6f72 6d61 7445 7175 616c  ssertFormatEqual
+0000b390: 2873 656c 6629 202d 3e20 4e6f 6e65 3a0a  (self) -> None:.
+0000b3a0: 2020 2020 2020 2020 6f75 745f 6c69 6e65          out_line
+0000b3b0: 7320 3d20 5b5d 0a20 2020 2020 2020 2065  s = [].        e
+0000b3c0: 7272 5f6c 696e 6573 203d 205b 5d0a 0a20  rr_lines = [].. 
+0000b3d0: 2020 2020 2020 2064 6566 206f 7574 286d         def out(m
+0000b3e0: 7367 3a20 7374 722c 202a 2a6b 7761 7267  sg: str, **kwarg
+0000b3f0: 733a 2041 6e79 2920 2d3e 204e 6f6e 653a  s: Any) -> None:
+0000b400: 0a20 2020 2020 2020 2020 2020 206f 7574  .            out
+0000b410: 5f6c 696e 6573 2e61 7070 656e 6428 6d73  _lines.append(ms
+0000b420: 6729 0a0a 2020 2020 2020 2020 6465 6620  g)..        def 
+0000b430: 6572 7228 6d73 673a 2073 7472 2c20 2a2a  err(msg: str, **
+0000b440: 6b77 6172 6773 3a20 416e 7929 202d 3e20  kwargs: Any) -> 
+0000b450: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0000b460: 2020 6572 725f 6c69 6e65 732e 6170 7065    err_lines.appe
+0000b470: 6e64 286d 7367 290a 0a20 2020 2020 2020  nd(msg)..       
+0000b480: 2077 6974 6820 7061 7463 6828 2263 6572   with patch("cer
+0000b490: 6369 732e 6f75 7470 7574 2e5f 6f75 7422  cis.output._out"
+0000b4a0: 2c20 6f75 7429 2c20 7061 7463 6828 2263  , out), patch("c
+0000b4b0: 6572 6369 732e 6f75 7470 7574 2e5f 6572  ercis.output._er
+0000b4c0: 7222 2c20 6572 7229 3a0a 2020 2020 2020  r", err):.      
+0000b4d0: 2020 2020 2020 7769 7468 2073 656c 662e        with self.
+0000b4e0: 6173 7365 7274 5261 6973 6573 2841 7373  assertRaises(Ass
+0000b4f0: 6572 7469 6f6e 4572 726f 7229 3a0a 2020  ertionError):.  
+0000b500: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0000b510: 6c66 2e61 7373 6572 7446 6f72 6d61 7445  lf.assertFormatE
+0000b520: 7175 616c 2822 6a20 3d20 5b31 2c20 322c  qual("j = [1, 2,
+0000b530: 2033 5d22 2c20 226a 203d 205b 312c 2032   3]", "j = [1, 2
+0000b540: 2c20 332c 5d22 290a 0a20 2020 2020 2020  , 3,]")..       
+0000b550: 206f 7574 5f73 7472 203d 2022 222e 6a6f   out_str = "".jo
+0000b560: 696e 286f 7574 5f6c 696e 6573 290a 2020  in(out_lines).  
+0000b570: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0000b580: 7449 6e28 2245 7870 6563 7465 6420 7472  tIn("Expected tr
+0000b590: 6565 3a22 2c20 6f75 745f 7374 7229 0a20  ee:", out_str). 
+0000b5a0: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0000b5b0: 7274 496e 2822 4163 7475 616c 2074 7265  rtIn("Actual tre
+0000b5c0: 653a 222c 206f 7574 5f73 7472 290a 2020  e:", out_str).  
+0000b5d0: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0000b5e0: 7445 7175 616c 2822 222e 6a6f 696e 2865  tEqual("".join(e
+0000b5f0: 7272 5f6c 696e 6573 292c 2022 2229 0a0a  rr_lines), "")..
+0000b600: 2020 2020 4065 7665 6e74 5f6c 6f6f 7028      @event_loop(
+0000b610: 290a 2020 2020 4070 6174 6368 2822 636f  ).    @patch("co
+0000b620: 6e63 7572 7265 6e74 2e66 7574 7572 6573  ncurrent.futures
+0000b630: 2e50 726f 6365 7373 506f 6f6c 4578 6563  .ProcessPoolExec
+0000b640: 7574 6f72 222c 204d 6167 6963 4d6f 636b  utor", MagicMock
+0000b650: 2873 6964 655f 6566 6665 6374 3d4f 5345  (side_effect=OSE
+0000b660: 7272 6f72 2929 0a20 2020 2064 6566 2074  rror)).    def t
+0000b670: 6573 745f 776f 726b 735f 696e 5f6d 6f6e  est_works_in_mon
+0000b680: 6f5f 7072 6f63 6573 735f 6f6e 6c79 5f65  o_process_only_e
+0000b690: 6e76 6972 6f6e 6d65 6e74 2873 656c 6629  nvironment(self)
+0000b6a0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+0000b6b0: 2020 7769 7468 2063 6163 6865 5f64 6972    with cache_dir
+0000b6c0: 2829 2061 7320 776f 726b 7370 6163 653a  () as workspace:
+0000b6d0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0000b6e0: 2066 2069 6e20 5b0a 2020 2020 2020 2020   f in [.        
+0000b6f0: 2020 2020 2020 2020 2877 6f72 6b73 7061          (workspa
+0000b700: 6365 202f 2022 6f6e 652e 7079 2229 2e72  ce / "one.py").r
+0000b710: 6573 6f6c 7665 2829 2c0a 2020 2020 2020  esolve(),.      
+0000b720: 2020 2020 2020 2020 2020 2877 6f72 6b73            (works
+0000b730: 7061 6365 202f 2022 7477 6f2e 7079 2229  pace / "two.py")
+0000b740: 2e72 6573 6f6c 7665 2829 2c0a 2020 2020  .resolve(),.    
+0000b750: 2020 2020 2020 2020 5d3a 0a20 2020 2020          ]:.     
+0000b760: 2020 2020 2020 2020 2020 2066 2e77 7269             f.wri
+0000b770: 7465 5f74 6578 7428 2770 7269 6e74 2822  te_text('print("
+0000b780: 6865 6c6c 6f22 295c 6e27 2c20 656e 636f  hello")\n', enco
+0000b790: 6469 6e67 3d22 7574 662d 3822 290a 2020  ding="utf-8").  
+0000b7a0: 2020 2020 2020 2020 2020 7365 6c66 2e69            self.i
+0000b7b0: 6e76 6f6b 6542 6c61 636b 285b 7374 7228  nvokeBlack([str(
+0000b7c0: 776f 726b 7370 6163 6529 5d29 0a0a 2020  workspace)])..  
+0000b7d0: 2020 4065 7665 6e74 5f6c 6f6f 7028 290a    @event_loop().
+0000b7e0: 2020 2020 6465 6620 7465 7374 5f63 6865      def test_che
+0000b7f0: 636b 5f64 6966 665f 7573 655f 746f 6765  ck_diff_use_toge
+0000b800: 7468 6572 2873 656c 6629 202d 3e20 4e6f  ther(self) -> No
+0000b810: 6e65 3a0a 2020 2020 2020 2020 7371 203d  ne:.        sq =
+0000b820: 2022 2d2d 7369 6e67 6c65 2d71 756f 7465   "--single-quote
+0000b830: 3d46 616c 7365 220a 2020 2020 2020 2020  =False".        
+0000b840: 6c6c 203d 2022 2d2d 6c69 6e65 2d6c 656e  ll = "--line-len
+0000b850: 6774 683d 3838 220a 2020 2020 2020 2020  gth=88".        
+0000b860: 7769 7468 2063 6163 6865 5f64 6972 2829  with cache_dir()
+0000b870: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+0000b880: 4669 6c65 7320 7768 6963 6820 7769 6c6c  Files which will
+0000b890: 2062 6520 7265 666f 726d 6174 7465 642e   be reformatted.
+0000b8a0: 0a20 2020 2020 2020 2020 2020 2073 7263  .            src
+0000b8b0: 3120 3d20 6765 745f 6361 7365 5f70 6174  1 = get_case_pat
+0000b8c0: 6828 226d 6973 6365 6c6c 616e 656f 7573  h("miscellaneous
+0000b8d0: 222c 2022 7374 7269 6e67 5f71 756f 7465  ", "string_quote
+0000b8e0: 7322 290a 2020 2020 2020 2020 2020 2020  s").            
+0000b8f0: 7365 6c66 2e69 6e76 6f6b 6542 6c61 636b  self.invokeBlack
+0000b900: 285b 7374 7228 7372 6331 292c 2022 2d2d  ([str(src1), "--
+0000b910: 6469 6666 222c 2022 2d2d 6368 6563 6b22  diff", "--check"
+0000b920: 2c20 7371 2c20 6c6c 5d2c 2065 7869 745f  , sq, ll], exit_
+0000b930: 636f 6465 3d31 290a 2020 2020 2020 2020  code=1).        
+0000b940: 2020 2020 2320 4669 6c65 7320 7768 6963      # Files whic
+0000b950: 6820 7769 6c6c 206e 6f74 2062 6520 7265  h will not be re
+0000b960: 666f 726d 6174 7465 642e 0a20 2020 2020  formatted..     
+0000b970: 2020 2020 2020 2073 7263 3220 3d20 6765         src2 = ge
+0000b980: 745f 6361 7365 5f70 6174 6828 2273 696d  t_case_path("sim
+0000b990: 706c 655f 6361 7365 7322 2c20 2263 6f6d  ple_cases", "com
+0000b9a0: 706f 7369 7469 6f6e 2229 0a20 2020 2020  position").     
+0000b9b0: 2020 2020 2020 2073 656c 662e 696e 766f         self.invo
+0000b9c0: 6b65 426c 6163 6b28 5b73 7472 2873 7263  keBlack([str(src
+0000b9d0: 3229 2c20 222d 2d64 6966 6622 2c20 222d  2), "--diff", "-
+0000b9e0: 2d63 6865 636b 222c 2073 712c 206c 6c5d  -check", sq, ll]
+0000b9f0: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
+0000ba00: 4d75 6c74 6920 6669 6c65 2063 6f6d 6d61  Multi file comma
+0000ba10: 6e64 2e0a 2020 2020 2020 2020 2020 2020  nd..            
+0000ba20: 7365 6c66 2e69 6e76 6f6b 6542 6c61 636b  self.invokeBlack
+0000ba30: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000ba40: 2020 5b73 7472 2873 7263 3129 2c20 7374    [str(src1), st
+0000ba50: 7228 7372 6332 292c 2022 2d2d 6469 6666  r(src2), "--diff
+0000ba60: 222c 2022 2d2d 6368 6563 6b22 2c20 7371  ", "--check", sq
+0000ba70: 2c20 6c6c 5d2c 0a20 2020 2020 2020 2020  , ll],.         
+0000ba80: 2020 2020 2020 2065 7869 745f 636f 6465         exit_code
+0000ba90: 3d31 2c0a 2020 2020 2020 2020 2020 2020  =1,.            
+0000baa0: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
+0000bab0: 6e6f 5f73 7263 5f66 6169 6c73 2873 656c  no_src_fails(sel
+0000bac0: 6629 202d 3e20 4e6f 6e65 3a0a 2020 2020  f) -> None:.    
+0000bad0: 2020 2020 7769 7468 2063 6163 6865 5f64      with cache_d
+0000bae0: 6972 2829 3a0a 2020 2020 2020 2020 2020  ir():.          
+0000baf0: 2020 7365 6c66 2e69 6e76 6f6b 6542 6c61    self.invokeBla
+0000bb00: 636b 285b 5d2c 2065 7869 745f 636f 6465  ck([], exit_code
+0000bb10: 3d31 290a 0a20 2020 2064 6566 2074 6573  =1)..    def tes
+0000bb20: 745f 7372 635f 616e 645f 636f 6465 5f66  t_src_and_code_f
+0000bb30: 6169 6c73 2873 656c 6629 202d 3e20 4e6f  ails(self) -> No
+0000bb40: 6e65 3a0a 2020 2020 2020 2020 7769 7468  ne:.        with
+0000bb50: 2063 6163 6865 5f64 6972 2829 3a0a 2020   cache_dir():.  
+0000bb60: 2020 2020 2020 2020 2020 7365 6c66 2e69            self.i
+0000bb70: 6e76 6f6b 6542 6c61 636b 285b 222e 222c  nvokeBlack([".",
+0000bb80: 2022 2d63 222c 2022 3022 5d2c 2065 7869   "-c", "0"], exi
+0000bb90: 745f 636f 6465 3d31 290a 0a20 2020 2064  t_code=1)..    d
+0000bba0: 6566 2074 6573 745f 6272 6f6b 656e 5f73  ef test_broken_s
+0000bbb0: 796d 6c69 6e6b 2873 656c 6629 202d 3e20  ymlink(self) -> 
+0000bbc0: 4e6f 6e65 3a0a 2020 2020 2020 2020 7769  None:.        wi
+0000bbd0: 7468 2063 6163 6865 5f64 6972 2829 2061  th cache_dir() a
+0000bbe0: 7320 776f 726b 7370 6163 653a 0a20 2020  s workspace:.   
+0000bbf0: 2020 2020 2020 2020 2073 796d 6c69 6e6b           symlink
+0000bc00: 203d 2077 6f72 6b73 7061 6365 202f 2022   = workspace / "
+0000bc10: 6272 6f6b 656e 5f6c 696e 6b2e 7079 220a  broken_link.py".
+0000bc20: 2020 2020 2020 2020 2020 2020 7472 793a              try:
+0000bc30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000bc40: 2073 796d 6c69 6e6b 2e73 796d 6c69 6e6b   symlink.symlink
+0000bc50: 5f74 6f28 226e 6f6e 6578 6973 7465 6e74  _to("nonexistent
+0000bc60: 2e70 7922 290a 2020 2020 2020 2020 2020  .py").          
+0000bc70: 2020 6578 6365 7074 2028 4f53 4572 726f    except (OSErro
+0000bc80: 722c 204e 6f74 496d 706c 656d 656e 7465  r, NotImplemente
+0000bc90: 6445 7272 6f72 2920 6173 2065 3a0a 2020  dError) as e:.  
+0000bca0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0000bcb0: 6c66 2e73 6b69 7054 6573 7428 6622 4361  lf.skipTest(f"Ca
+0000bcc0: 6e27 7420 6372 6561 7465 2073 796d 6c69  n't create symli
+0000bcd0: 6e6b 733a 207b 657d 2229 0a20 2020 2020  nks: {e}").     
+0000bce0: 2020 2020 2020 2073 656c 662e 696e 766f         self.invo
+0000bcf0: 6b65 426c 6163 6b28 5b73 7472 2877 6f72  keBlack([str(wor
+0000bd00: 6b73 7061 6365 2e72 6573 6f6c 7665 2829  kspace.resolve()
+0000bd10: 295d 290a 0a20 2020 2064 6566 2074 6573  )])..    def tes
+0000bd20: 745f 7369 6e67 6c65 5f66 696c 655f 666f  t_single_file_fo
+0000bd30: 7263 655f 7079 6928 7365 6c66 2920 2d3e  rce_pyi(self) ->
+0000bd40: 204e 6f6e 653a 0a20 2020 2020 2020 2070   None:.        p
+0000bd50: 7969 5f6d 6f64 6520 3d20 7265 706c 6163  yi_mode = replac
+0000bd60: 6528 4445 4641 554c 545f 4d4f 4445 2c20  e(DEFAULT_MODE, 
+0000bd70: 6973 5f70 7969 3d54 7275 6529 0a20 2020  is_pyi=True).   
+0000bd80: 2020 2020 2063 6f6e 7465 6e74 732c 2065       contents, e
+0000bd90: 7870 6563 7465 6420 3d20 7265 6164 5f64  xpected = read_d
+0000bda0: 6174 6128 226d 6973 6365 6c6c 616e 656f  ata("miscellaneo
+0000bdb0: 7573 222c 2022 666f 7263 655f 7079 6922  us", "force_pyi"
+0000bdc0: 290a 2020 2020 2020 2020 7769 7468 2063  ).        with c
+0000bdd0: 6163 6865 5f64 6972 2829 2061 7320 776f  ache_dir() as wo
+0000bde0: 726b 7370 6163 653a 0a20 2020 2020 2020  rkspace:.       
+0000bdf0: 2020 2020 2070 6174 6820 3d20 2877 6f72       path = (wor
+0000be00: 6b73 7061 6365 202f 2022 6669 6c65 2e70  kspace / "file.p
+0000be10: 7922 292e 7265 736f 6c76 6528 290a 2020  y").resolve().  
+0000be20: 2020 2020 2020 2020 2020 7061 7468 2e77            path.w
+0000be30: 7269 7465 5f74 6578 7428 636f 6e74 656e  rite_text(conten
+0000be40: 7473 2c20 656e 636f 6469 6e67 3d22 7574  ts, encoding="ut
+0000be50: 662d 3822 290a 2020 2020 2020 2020 2020  f-8").          
+0000be60: 2020 7365 6c66 2e69 6e76 6f6b 6542 6c61    self.invokeBla
+0000be70: 636b 285b 7374 7228 7061 7468 292c 2022  ck([str(path), "
+0000be80: 2d2d 7079 6922 5d29 0a20 2020 2020 2020  --pyi"]).       
+0000be90: 2020 2020 2061 6374 7561 6c20 3d20 7061       actual = pa
+0000bea0: 7468 2e72 6561 645f 7465 7874 2865 6e63  th.read_text(enc
+0000beb0: 6f64 696e 673d 2275 7466 2d38 2229 0a20  oding="utf-8"). 
+0000bec0: 2020 2020 2020 2020 2020 2023 2076 6572             # ver
+0000bed0: 6966 7920 6361 6368 6520 7769 7468 202d  ify cache with -
+0000bee0: 2d70 7969 2069 7320 7365 7061 7261 7465  -pyi is separate
+0000bef0: 0a20 2020 2020 2020 2020 2020 2070 7969  .            pyi
+0000bf00: 5f63 6163 6865 203d 2063 6572 6369 732e  _cache = cercis.
+0000bf10: 7265 6164 5f63 6163 6865 2870 7969 5f6d  read_cache(pyi_m
+0000bf20: 6f64 6529 0a20 2020 2020 2020 2020 2020  ode).           
+0000bf30: 2073 656c 662e 6173 7365 7274 496e 2873   self.assertIn(s
+0000bf40: 7472 2870 6174 6829 2c20 7079 695f 6361  tr(path), pyi_ca
+0000bf50: 6368 6529 0a20 2020 2020 2020 2020 2020  che).           
+0000bf60: 206e 6f72 6d61 6c5f 6361 6368 6520 3d20   normal_cache = 
+0000bf70: 6365 7263 6973 2e72 6561 645f 6361 6368  cercis.read_cach
+0000bf80: 6528 4445 4641 554c 545f 4d4f 4445 290a  e(DEFAULT_MODE).
+0000bf90: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000bfa0: 2e61 7373 6572 744e 6f74 496e 2873 7472  .assertNotIn(str
+0000bfb0: 2870 6174 6829 2c20 6e6f 726d 616c 5f63  (path), normal_c
+0000bfc0: 6163 6865 290a 2020 2020 2020 2020 7365  ache).        se
+0000bfd0: 6c66 2e61 7373 6572 7446 6f72 6d61 7445  lf.assertFormatE
+0000bfe0: 7175 616c 2865 7870 6563 7465 642c 2061  qual(expected, a
+0000bff0: 6374 7561 6c29 0a20 2020 2020 2020 2063  ctual).        c
+0000c000: 6572 6369 732e 6173 7365 7274 5f65 7175  ercis.assert_equ
+0000c010: 6976 616c 656e 7428 636f 6e74 656e 7473  ivalent(contents
+0000c020: 2c20 6163 7475 616c 290a 2020 2020 2020  , actual).      
+0000c030: 2020 6365 7263 6973 2e61 7373 6572 745f    cercis.assert_
+0000c040: 7374 6162 6c65 2863 6f6e 7465 6e74 732c  stable(contents,
+0000c050: 2061 6374 7561 6c2c 2070 7969 5f6d 6f64   actual, pyi_mod
+0000c060: 6529 0a0a 2020 2020 4065 7665 6e74 5f6c  e)..    @event_l
+0000c070: 6f6f 7028 290a 2020 2020 6465 6620 7465  oop().    def te
+0000c080: 7374 5f6d 756c 7469 5f66 696c 655f 666f  st_multi_file_fo
+0000c090: 7263 655f 7079 6928 7365 6c66 2920 2d3e  rce_pyi(self) ->
+0000c0a0: 204e 6f6e 653a 0a20 2020 2020 2020 2072   None:.        r
+0000c0b0: 6567 5f6d 6f64 6520 3d20 4445 4641 554c  eg_mode = DEFAUL
+0000c0c0: 545f 4d4f 4445 0a20 2020 2020 2020 2070  T_MODE.        p
+0000c0d0: 7969 5f6d 6f64 6520 3d20 7265 706c 6163  yi_mode = replac
+0000c0e0: 6528 4445 4641 554c 545f 4d4f 4445 2c20  e(DEFAULT_MODE, 
+0000c0f0: 6973 5f70 7969 3d54 7275 6529 0a20 2020  is_pyi=True).   
+0000c100: 2020 2020 2063 6f6e 7465 6e74 732c 2065       contents, e
+0000c110: 7870 6563 7465 6420 3d20 7265 6164 5f64  xpected = read_d
+0000c120: 6174 6128 226d 6973 6365 6c6c 616e 656f  ata("miscellaneo
+0000c130: 7573 222c 2022 666f 7263 655f 7079 6922  us", "force_pyi"
+0000c140: 290a 2020 2020 2020 2020 7769 7468 2063  ).        with c
+0000c150: 6163 6865 5f64 6972 2829 2061 7320 776f  ache_dir() as wo
+0000c160: 726b 7370 6163 653a 0a20 2020 2020 2020  rkspace:.       
+0000c170: 2020 2020 2070 6174 6873 203d 205b 0a20       paths = [. 
+0000c180: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+0000c190: 776f 726b 7370 6163 6520 2f20 2266 696c  workspace / "fil
+0000c1a0: 6531 2e70 7922 292e 7265 736f 6c76 6528  e1.py").resolve(
+0000c1b0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+0000c1c0: 2020 2028 776f 726b 7370 6163 6520 2f20     (workspace / 
+0000c1d0: 2266 696c 6532 2e70 7922 292e 7265 736f  "file2.py").reso
+0000c1e0: 6c76 6528 292c 0a20 2020 2020 2020 2020  lve(),.         
+0000c1f0: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
+0000c200: 2066 6f72 2070 6174 6820 696e 2070 6174   for path in pat
+0000c210: 6873 3a0a 2020 2020 2020 2020 2020 2020  hs:.            
+0000c220: 2020 2020 7061 7468 2e77 7269 7465 5f74      path.write_t
+0000c230: 6578 7428 636f 6e74 656e 7473 2c20 656e  ext(contents, en
+0000c240: 636f 6469 6e67 3d22 7574 662d 3822 290a  coding="utf-8").
+0000c250: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000c260: 2e69 6e76 6f6b 6542 6c61 636b 285b 7374  .invokeBlack([st
+0000c270: 7228 7029 2066 6f72 2070 2069 6e20 7061  r(p) for p in pa
+0000c280: 7468 735d 202b 205b 222d 2d70 7969 225d  ths] + ["--pyi"]
+0000c290: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
+0000c2a0: 7220 7061 7468 2069 6e20 7061 7468 733a  r path in paths:
+0000c2b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c2c0: 2061 6374 7561 6c20 3d20 7061 7468 2e72   actual = path.r
+0000c2d0: 6561 645f 7465 7874 2865 6e63 6f64 696e  ead_text(encodin
+0000c2e0: 673d 2275 7466 2d38 2229 0a20 2020 2020  g="utf-8").     
+0000c2f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000c300: 6173 7365 7274 4571 7561 6c28 6163 7475  assertEqual(actu
+0000c310: 616c 2c20 6578 7065 6374 6564 290a 2020  al, expected).  
+0000c320: 2020 2020 2020 2020 2020 2320 7665 7269            # veri
+0000c330: 6679 2063 6163 6865 2077 6974 6820 2d2d  fy cache with --
+0000c340: 7079 6920 6973 2073 6570 6172 6174 650a  pyi is separate.
+0000c350: 2020 2020 2020 2020 2020 2020 7079 695f              pyi_
+0000c360: 6361 6368 6520 3d20 6365 7263 6973 2e72  cache = cercis.r
+0000c370: 6561 645f 6361 6368 6528 7079 695f 6d6f  ead_cache(pyi_mo
+0000c380: 6465 290a 2020 2020 2020 2020 2020 2020  de).            
+0000c390: 6e6f 726d 616c 5f63 6163 6865 203d 2063  normal_cache = c
+0000c3a0: 6572 6369 732e 7265 6164 5f63 6163 6865  ercis.read_cache
+0000c3b0: 2872 6567 5f6d 6f64 6529 0a20 2020 2020  (reg_mode).     
+0000c3c0: 2020 2020 2020 2066 6f72 2070 6174 6820         for path 
+0000c3d0: 696e 2070 6174 6873 3a0a 2020 2020 2020  in paths:.      
+0000c3e0: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+0000c3f0: 7373 6572 7449 6e28 7374 7228 7061 7468  ssertIn(str(path
+0000c400: 292c 2070 7969 5f63 6163 6865 290a 2020  ), pyi_cache).  
+0000c410: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0000c420: 6c66 2e61 7373 6572 744e 6f74 496e 2873  lf.assertNotIn(s
+0000c430: 7472 2870 6174 6829 2c20 6e6f 726d 616c  tr(path), normal
+0000c440: 5f63 6163 6865 290a 0a20 2020 2064 6566  _cache)..    def
+0000c450: 2074 6573 745f 7069 7065 5f66 6f72 6365   test_pipe_force
+0000c460: 5f70 7969 2873 656c 6629 202d 3e20 4e6f  _pyi(self) -> No
+0000c470: 6e65 3a0a 2020 2020 2020 2020 736f 7572  ne:.        sour
+0000c480: 6365 2c20 6578 7065 6374 6564 203d 2072  ce, expected = r
+0000c490: 6561 645f 6461 7461 2822 6d69 7363 656c  ead_data("miscel
+0000c4a0: 6c61 6e65 6f75 7322 2c20 2266 6f72 6365  laneous", "force
+0000c4b0: 5f70 7969 2229 0a20 2020 2020 2020 2072  _pyi").        r
+0000c4c0: 6573 756c 7420 3d20 436c 6952 756e 6e65  esult = CliRunne
+0000c4d0: 7228 292e 696e 766f 6b65 280a 2020 2020  r().invoke(.    
+0000c4e0: 2020 2020 2020 2020 6365 7263 6973 2e6d          cercis.m
+0000c4f0: 6169 6e2c 205b 222d 222c 2022 2d71 222c  ain, ["-", "-q",
+0000c500: 2022 2d2d 7079 6922 5d2c 2069 6e70 7574   "--pyi"], input
+0000c510: 3d42 7974 6573 494f 2873 6f75 7263 652e  =BytesIO(source.
+0000c520: 656e 636f 6465 2822 7574 662d 3822 2929  encode("utf-8"))
+0000c530: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+0000c540: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+0000c550: 7561 6c28 7265 7375 6c74 2e65 7869 745f  ual(result.exit_
+0000c560: 636f 6465 2c20 3029 0a20 2020 2020 2020  code, 0).       
+0000c570: 2061 6374 7561 6c20 3d20 7265 7375 6c74   actual = result
+0000c580: 2e6f 7574 7075 740a 2020 2020 2020 2020  .output.        
+0000c590: 7365 6c66 2e61 7373 6572 7446 6f72 6d61  self.assertForma
+0000c5a0: 7445 7175 616c 2861 6374 7561 6c2c 2065  tEqual(actual, e
+0000c5b0: 7870 6563 7465 6429 0a0a 2020 2020 6465  xpected)..    de
+0000c5c0: 6620 7465 7374 5f73 696e 676c 655f 6669  f test_single_fi
+0000c5d0: 6c65 5f66 6f72 6365 5f70 7933 3628 7365  le_force_py36(se
+0000c5e0: 6c66 2920 2d3e 204e 6f6e 653a 0a20 2020  lf) -> None:.   
+0000c5f0: 2020 2020 2072 6567 5f6d 6f64 6520 3d20       reg_mode = 
+0000c600: 4445 4641 554c 545f 4d4f 4445 0a20 2020  DEFAULT_MODE.   
+0000c610: 2020 2020 2070 7933 365f 6d6f 6465 203d       py36_mode =
+0000c620: 2072 6570 6c61 6365 2844 4546 4155 4c54   replace(DEFAULT
+0000c630: 5f4d 4f44 452c 2074 6172 6765 745f 7665  _MODE, target_ve
+0000c640: 7273 696f 6e73 3d50 5933 365f 5645 5253  rsions=PY36_VERS
+0000c650: 494f 4e53 290a 2020 2020 2020 2020 736f  IONS).        so
+0000c660: 7572 6365 2c20 6578 7065 6374 6564 203d  urce, expected =
+0000c670: 2072 6561 645f 6461 7461 2822 6d69 7363   read_data("misc
+0000c680: 656c 6c61 6e65 6f75 7322 2c20 2266 6f72  ellaneous", "for
+0000c690: 6365 5f70 7933 3622 290a 2020 2020 2020  ce_py36").      
+0000c6a0: 2020 7769 7468 2063 6163 6865 5f64 6972    with cache_dir
+0000c6b0: 2829 2061 7320 776f 726b 7370 6163 653a  () as workspace:
+0000c6c0: 0a20 2020 2020 2020 2020 2020 2070 6174  .            pat
+0000c6d0: 6820 3d20 2877 6f72 6b73 7061 6365 202f  h = (workspace /
+0000c6e0: 2022 6669 6c65 2e70 7922 292e 7265 736f   "file.py").reso
+0000c6f0: 6c76 6528 290a 2020 2020 2020 2020 2020  lve().          
+0000c700: 2020 7061 7468 2e77 7269 7465 5f74 6578    path.write_tex
+0000c710: 7428 736f 7572 6365 2c20 656e 636f 6469  t(source, encodi
+0000c720: 6e67 3d22 7574 662d 3822 290a 2020 2020  ng="utf-8").    
+0000c730: 2020 2020 2020 2020 7365 6c66 2e69 6e76          self.inv
+0000c740: 6f6b 6542 6c61 636b 285b 7374 7228 7061  okeBlack([str(pa
+0000c750: 7468 292c 202a 5059 3336 5f41 5247 535d  th), *PY36_ARGS]
+0000c760: 290a 2020 2020 2020 2020 2020 2020 6163  ).            ac
+0000c770: 7475 616c 203d 2070 6174 682e 7265 6164  tual = path.read
+0000c780: 5f74 6578 7428 656e 636f 6469 6e67 3d22  _text(encoding="
+0000c790: 7574 662d 3822 290a 2020 2020 2020 2020  utf-8").        
+0000c7a0: 2020 2020 2320 7665 7269 6679 2063 6163      # verify cac
+0000c7b0: 6865 2077 6974 6820 2d2d 7461 7267 6574  he with --target
+0000c7c0: 2d76 6572 7369 6f6e 2069 7320 7365 7061  -version is sepa
+0000c7d0: 7261 7465 0a20 2020 2020 2020 2020 2020  rate.           
+0000c7e0: 2070 7933 365f 6361 6368 6520 3d20 6365   py36_cache = ce
+0000c7f0: 7263 6973 2e72 6561 645f 6361 6368 6528  rcis.read_cache(
+0000c800: 7079 3336 5f6d 6f64 6529 0a20 2020 2020  py36_mode).     
+0000c810: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+0000c820: 7274 496e 2873 7472 2870 6174 6829 2c20  rtIn(str(path), 
+0000c830: 7079 3336 5f63 6163 6865 290a 2020 2020  py36_cache).    
+0000c840: 2020 2020 2020 2020 6e6f 726d 616c 5f63          normal_c
+0000c850: 6163 6865 203d 2063 6572 6369 732e 7265  ache = cercis.re
+0000c860: 6164 5f63 6163 6865 2872 6567 5f6d 6f64  ad_cache(reg_mod
+0000c870: 6529 0a20 2020 2020 2020 2020 2020 2073  e).            s
+0000c880: 656c 662e 6173 7365 7274 4e6f 7449 6e28  elf.assertNotIn(
+0000c890: 7374 7228 7061 7468 292c 206e 6f72 6d61  str(path), norma
+0000c8a0: 6c5f 6361 6368 6529 0a20 2020 2020 2020  l_cache).       
+0000c8b0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+0000c8c0: 6c28 6163 7475 616c 2c20 6578 7065 6374  l(actual, expect
+0000c8d0: 6564 290a 0a20 2020 2040 6576 656e 745f  ed)..    @event_
+0000c8e0: 6c6f 6f70 2829 0a20 2020 2064 6566 2074  loop().    def t
+0000c8f0: 6573 745f 6d75 6c74 695f 6669 6c65 5f66  est_multi_file_f
+0000c900: 6f72 6365 5f70 7933 3628 7365 6c66 2920  orce_py36(self) 
+0000c910: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+0000c920: 2072 6567 5f6d 6f64 6520 3d20 4445 4641   reg_mode = DEFA
+0000c930: 554c 545f 4d4f 4445 0a20 2020 2020 2020  ULT_MODE.       
+0000c940: 2070 7933 365f 6d6f 6465 203d 2072 6570   py36_mode = rep
+0000c950: 6c61 6365 2844 4546 4155 4c54 5f4d 4f44  lace(DEFAULT_MOD
+0000c960: 452c 2074 6172 6765 745f 7665 7273 696f  E, target_versio
+0000c970: 6e73 3d50 5933 365f 5645 5253 494f 4e53  ns=PY36_VERSIONS
+0000c980: 290a 2020 2020 2020 2020 736f 7572 6365  ).        source
+0000c990: 2c20 6578 7065 6374 6564 203d 2072 6561  , expected = rea
+0000c9a0: 645f 6461 7461 2822 6d69 7363 656c 6c61  d_data("miscella
+0000c9b0: 6e65 6f75 7322 2c20 2266 6f72 6365 5f70  neous", "force_p
+0000c9c0: 7933 3622 290a 2020 2020 2020 2020 7769  y36").        wi
+0000c9d0: 7468 2063 6163 6865 5f64 6972 2829 2061  th cache_dir() a
+0000c9e0: 7320 776f 726b 7370 6163 653a 0a20 2020  s workspace:.   
+0000c9f0: 2020 2020 2020 2020 2070 6174 6873 203d           paths =
+0000ca00: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
+0000ca10: 2020 2028 776f 726b 7370 6163 6520 2f20     (workspace / 
+0000ca20: 2266 696c 6531 2e70 7922 292e 7265 736f  "file1.py").reso
+0000ca30: 6c76 6528 292c 0a20 2020 2020 2020 2020  lve(),.         
+0000ca40: 2020 2020 2020 2028 776f 726b 7370 6163         (workspac
+0000ca50: 6520 2f20 2266 696c 6532 2e70 7922 292e  e / "file2.py").
+0000ca60: 7265 736f 6c76 6528 292c 0a20 2020 2020  resolve(),.     
+0000ca70: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
+0000ca80: 2020 2020 2066 6f72 2070 6174 6820 696e       for path in
+0000ca90: 2070 6174 6873 3a0a 2020 2020 2020 2020   paths:.        
+0000caa0: 2020 2020 2020 2020 7061 7468 2e77 7269          path.wri
+0000cab0: 7465 5f74 6578 7428 736f 7572 6365 2c20  te_text(source, 
+0000cac0: 656e 636f 6469 6e67 3d22 7574 662d 3822  encoding="utf-8"
+0000cad0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+0000cae0: 6c66 2e69 6e76 6f6b 6542 6c61 636b 285b  lf.invokeBlack([
+0000caf0: 7374 7228 7029 2066 6f72 2070 2069 6e20  str(p) for p in 
+0000cb00: 7061 7468 735d 202b 2050 5933 365f 4152  paths] + PY36_AR
+0000cb10: 4753 290a 2020 2020 2020 2020 2020 2020  GS).            
+0000cb20: 666f 7220 7061 7468 2069 6e20 7061 7468  for path in path
+0000cb30: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+0000cb40: 2020 2061 6374 7561 6c20 3d20 7061 7468     actual = path
+0000cb50: 2e72 6561 645f 7465 7874 2865 6e63 6f64  .read_text(encod
+0000cb60: 696e 673d 2275 7466 2d38 2229 0a20 2020  ing="utf-8").   
+0000cb70: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0000cb80: 662e 6173 7365 7274 4571 7561 6c28 6163  f.assertEqual(ac
+0000cb90: 7475 616c 2c20 6578 7065 6374 6564 290a  tual, expected).
+0000cba0: 2020 2020 2020 2020 2020 2020 2320 7665              # ve
+0000cbb0: 7269 6679 2063 6163 6865 2077 6974 6820  rify cache with 
+0000cbc0: 2d2d 7461 7267 6574 2d76 6572 7369 6f6e  --target-version
+0000cbd0: 2069 7320 7365 7061 7261 7465 0a20 2020   is separate.   
+0000cbe0: 2020 2020 2020 2020 2070 7969 5f63 6163           pyi_cac
+0000cbf0: 6865 203d 2063 6572 6369 732e 7265 6164  he = cercis.read
+0000cc00: 5f63 6163 6865 2870 7933 365f 6d6f 6465  _cache(py36_mode
+0000cc10: 290a 2020 2020 2020 2020 2020 2020 6e6f  ).            no
+0000cc20: 726d 616c 5f63 6163 6865 203d 2063 6572  rmal_cache = cer
+0000cc30: 6369 732e 7265 6164 5f63 6163 6865 2872  cis.read_cache(r
+0000cc40: 6567 5f6d 6f64 6529 0a20 2020 2020 2020  eg_mode).       
+0000cc50: 2020 2020 2066 6f72 2070 6174 6820 696e       for path in
+0000cc60: 2070 6174 6873 3a0a 2020 2020 2020 2020   paths:.        
+0000cc70: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+0000cc80: 6572 7449 6e28 7374 7228 7061 7468 292c  ertIn(str(path),
+0000cc90: 2070 7969 5f63 6163 6865 290a 2020 2020   pyi_cache).    
+0000cca0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000ccb0: 2e61 7373 6572 744e 6f74 496e 2873 7472  .assertNotIn(str
+0000ccc0: 2870 6174 6829 2c20 6e6f 726d 616c 5f63  (path), normal_c
+0000ccd0: 6163 6865 290a 0a20 2020 2064 6566 2074  ache)..    def t
+0000cce0: 6573 745f 7069 7065 5f66 6f72 6365 5f70  est_pipe_force_p
+0000ccf0: 7933 3628 7365 6c66 2920 2d3e 204e 6f6e  y36(self) -> Non
+0000cd00: 653a 0a20 2020 2020 2020 2073 6f75 7263  e:.        sourc
+0000cd10: 652c 2065 7870 6563 7465 6420 3d20 7265  e, expected = re
+0000cd20: 6164 5f64 6174 6128 226d 6973 6365 6c6c  ad_data("miscell
+0000cd30: 616e 656f 7573 222c 2022 666f 7263 655f  aneous", "force_
+0000cd40: 7079 3336 2229 0a20 2020 2020 2020 2072  py36").        r
+0000cd50: 6573 756c 7420 3d20 436c 6952 756e 6e65  esult = CliRunne
+0000cd60: 7228 292e 696e 766f 6b65 280a 2020 2020  r().invoke(.    
+0000cd70: 2020 2020 2020 2020 6365 7263 6973 2e6d          cercis.m
+0000cd80: 6169 6e2c 0a20 2020 2020 2020 2020 2020  ain,.           
+0000cd90: 205b 222d 222c 2022 2d71 222c 2022 2d2d   ["-", "-q", "--
+0000cda0: 7461 7267 6574 2d76 6572 7369 6f6e 3d70  target-version=p
+0000cdb0: 7933 3622 5d2c 0a20 2020 2020 2020 2020  y36"],.         
+0000cdc0: 2020 2069 6e70 7574 3d42 7974 6573 494f     input=BytesIO
+0000cdd0: 2873 6f75 7263 652e 656e 636f 6465 2822  (source.encode("
+0000cde0: 7574 662d 3822 2929 2c0a 2020 2020 2020  utf-8")),.      
+0000cdf0: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+0000ce00: 2e61 7373 6572 7445 7175 616c 2872 6573  .assertEqual(res
+0000ce10: 756c 742e 6578 6974 5f63 6f64 652c 2030  ult.exit_code, 0
+0000ce20: 290a 2020 2020 2020 2020 6163 7475 616c  ).        actual
+0000ce30: 203d 2072 6573 756c 742e 6f75 7470 7574   = result.output
+0000ce40: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+0000ce50: 7365 7274 466f 726d 6174 4571 7561 6c28  sertFormatEqual(
+0000ce60: 6163 7475 616c 2c20 6578 7065 6374 6564  actual, expected
+0000ce70: 290a 0a20 2020 2040 7079 7465 7374 2e6d  )..    @pytest.m
+0000ce80: 6172 6b2e 696e 636f 6d70 6174 6962 6c65  ark.incompatible
+0000ce90: 5f77 6974 685f 6d79 7079 630a 2020 2020  _with_mypyc.    
+0000cea0: 6465 6620 7465 7374 5f72 6566 6f72 6d61  def test_reforma
+0000ceb0: 745f 6f6e 655f 7769 7468 5f73 7464 696e  t_one_with_stdin
+0000cec0: 2873 656c 6629 202d 3e20 4e6f 6e65 3a0a  (self) -> None:.
+0000ced0: 2020 2020 2020 2020 7769 7468 2070 6174          with pat
+0000cee0: 6368 280a 2020 2020 2020 2020 2020 2020  ch(.            
+0000cef0: 2263 6572 6369 732e 666f 726d 6174 5f73  "cercis.format_s
+0000cf00: 7464 696e 5f74 6f5f 7374 646f 7574 222c  tdin_to_stdout",
+0000cf10: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0000cf20: 7572 6e5f 7661 6c75 653d 6c61 6d62 6461  urn_value=lambda
+0000cf30: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
+0000cf40: 3a20 6365 7263 6973 2e43 6861 6e67 6564  : cercis.Changed
+0000cf50: 2e59 4553 2c0a 2020 2020 2020 2020 2920  .YES,.        ) 
+0000cf60: 6173 2066 7374 733a 0a20 2020 2020 2020  as fsts:.       
+0000cf70: 2020 2020 2072 6570 6f72 7420 3d20 4d61       report = Ma
+0000cf80: 6769 634d 6f63 6b28 290a 2020 2020 2020  gicMock().      
+0000cf90: 2020 2020 2020 7061 7468 203d 2050 6174        path = Pat
+0000cfa0: 6828 222d 2229 0a20 2020 2020 2020 2020  h("-").         
+0000cfb0: 2020 2063 6572 6369 732e 7265 666f 726d     cercis.reform
+0000cfc0: 6174 5f6f 6e65 280a 2020 2020 2020 2020  at_one(.        
+0000cfd0: 2020 2020 2020 2020 7061 7468 2c0a 2020          path,.  
+0000cfe0: 2020 2020 2020 2020 2020 2020 2020 6661                fa
+0000cff0: 7374 3d54 7275 652c 0a20 2020 2020 2020  st=True,.       
+0000d000: 2020 2020 2020 2020 2077 7269 7465 5f62           write_b
+0000d010: 6163 6b3d 6365 7263 6973 2e57 7269 7465  ack=cercis.Write
+0000d020: 4261 636b 2e59 4553 2c0a 2020 2020 2020  Back.YES,.      
+0000d030: 2020 2020 2020 2020 2020 6d6f 6465 3d44            mode=D
+0000d040: 4546 4155 4c54 5f4d 4f44 452c 0a20 2020  EFAULT_MODE,.   
+0000d050: 2020 2020 2020 2020 2020 2020 2072 6570               rep
+0000d060: 6f72 743d 7265 706f 7274 2c0a 2020 2020  ort=report,.    
+0000d070: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000d080: 2020 2020 2020 6673 7473 2e61 7373 6572        fsts.asser
+0000d090: 745f 6361 6c6c 6564 5f6f 6e63 6528 290a  t_called_once().
+0000d0a0: 2020 2020 2020 2020 2020 2020 7265 706f              repo
+0000d0b0: 7274 2e64 6f6e 652e 6173 7365 7274 5f63  rt.done.assert_c
+0000d0c0: 616c 6c65 645f 7769 7468 2870 6174 682c  alled_with(path,
+0000d0d0: 2063 6572 6369 732e 4368 616e 6765 642e   cercis.Changed.
+0000d0e0: 5945 5329 0a0a 2020 2020 4070 7974 6573  YES)..    @pytes
+0000d0f0: 742e 6d61 726b 2e69 6e63 6f6d 7061 7469  t.mark.incompati
+0000d100: 626c 655f 7769 7468 5f6d 7970 7963 0a20  ble_with_mypyc. 
+0000d110: 2020 2064 6566 2074 6573 745f 7265 666f     def test_refo
+0000d120: 726d 6174 5f6f 6e65 5f77 6974 685f 7374  rmat_one_with_st
+0000d130: 6469 6e5f 6669 6c65 6e61 6d65 2873 656c  din_filename(sel
+0000d140: 6629 202d 3e20 4e6f 6e65 3a0a 2020 2020  f) -> None:.    
+0000d150: 2020 2020 7769 7468 2070 6174 6368 280a      with patch(.
+0000d160: 2020 2020 2020 2020 2020 2020 2263 6572              "cer
+0000d170: 6369 732e 666f 726d 6174 5f73 7464 696e  cis.format_stdin
+0000d180: 5f74 6f5f 7374 646f 7574 222c 0a20 2020  _to_stdout",.   
+0000d190: 2020 2020 2020 2020 2072 6574 7572 6e5f           return_
+0000d1a0: 7661 6c75 653d 6c61 6d62 6461 202a 6172  value=lambda *ar
+0000d1b0: 6773 2c20 2a2a 6b77 6172 6773 3a20 6365  gs, **kwargs: ce
+0000d1c0: 7263 6973 2e43 6861 6e67 6564 2e59 4553  rcis.Changed.YES
+0000d1d0: 2c0a 2020 2020 2020 2020 2920 6173 2066  ,.        ) as f
+0000d1e0: 7374 733a 0a20 2020 2020 2020 2020 2020  sts:.           
+0000d1f0: 2072 6570 6f72 7420 3d20 4d61 6769 634d   report = MagicM
+0000d200: 6f63 6b28 290a 2020 2020 2020 2020 2020  ock().          
+0000d210: 2020 7020 3d20 2266 6f6f 2e70 7922 0a20    p = "foo.py". 
+0000d220: 2020 2020 2020 2020 2020 2070 6174 6820             path 
+0000d230: 3d20 5061 7468 2866 225f 5f42 4c41 434b  = Path(f"__BLACK
+0000d240: 5f53 5444 494e 5f46 494c 454e 414d 455f  _STDIN_FILENAME_
+0000d250: 5f7b 707d 2229 0a20 2020 2020 2020 2020  _{p}").         
+0000d260: 2020 2065 7870 6563 7465 6420 3d20 5061     expected = Pa
+0000d270: 7468 2870 290a 2020 2020 2020 2020 2020  th(p).          
+0000d280: 2020 6365 7263 6973 2e72 6566 6f72 6d61    cercis.reforma
+0000d290: 745f 6f6e 6528 0a20 2020 2020 2020 2020  t_one(.         
+0000d2a0: 2020 2020 2020 2070 6174 682c 0a20 2020         path,.   
+0000d2b0: 2020 2020 2020 2020 2020 2020 2066 6173               fas
+0000d2c0: 743d 5472 7565 2c0a 2020 2020 2020 2020  t=True,.        
+0000d2d0: 2020 2020 2020 2020 7772 6974 655f 6261          write_ba
+0000d2e0: 636b 3d63 6572 6369 732e 5772 6974 6542  ck=cercis.WriteB
+0000d2f0: 6163 6b2e 5945 532c 0a20 2020 2020 2020  ack.YES,.       
+0000d300: 2020 2020 2020 2020 206d 6f64 653d 4445           mode=DE
+0000d310: 4641 554c 545f 4d4f 4445 2c0a 2020 2020  FAULT_MODE,.    
+0000d320: 2020 2020 2020 2020 2020 2020 7265 706f              repo
+0000d330: 7274 3d72 6570 6f72 742c 0a20 2020 2020  rt=report,.     
+0000d340: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0000d350: 2020 2020 2066 7374 732e 6173 7365 7274       fsts.assert
+0000d360: 5f63 616c 6c65 645f 6f6e 6365 5f77 6974  _called_once_wit
+0000d370: 6828 0a20 2020 2020 2020 2020 2020 2020  h(.             
+0000d380: 2020 2066 6173 743d 5472 7565 2c20 7772     fast=True, wr
+0000d390: 6974 655f 6261 636b 3d63 6572 6369 732e  ite_back=cercis.
+0000d3a0: 5772 6974 6542 6163 6b2e 5945 532c 206d  WriteBack.YES, m
+0000d3b0: 6f64 653d 4445 4641 554c 545f 4d4f 4445  ode=DEFAULT_MODE
+0000d3c0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0000d3d0: 2020 2020 2020 2020 2020 2023 205f 5f42             # __B
+0000d3e0: 4c41 434b 5f53 5444 494e 5f46 494c 454e  LACK_STDIN_FILEN
+0000d3f0: 414d 455f 5f20 7368 6f75 6c64 2068 6176  AME__ should hav
+0000d400: 6520 6265 656e 2073 7472 6970 7065 640a  e been stripped.
+0000d410: 2020 2020 2020 2020 2020 2020 7265 706f              repo
+0000d420: 7274 2e64 6f6e 652e 6173 7365 7274 5f63  rt.done.assert_c
+0000d430: 616c 6c65 645f 7769 7468 2865 7870 6563  alled_with(expec
+0000d440: 7465 642c 2063 6572 6369 732e 4368 616e  ted, cercis.Chan
+0000d450: 6765 642e 5945 5329 0a0a 2020 2020 4070  ged.YES)..    @p
+0000d460: 7974 6573 742e 6d61 726b 2e69 6e63 6f6d  ytest.mark.incom
+0000d470: 7061 7469 626c 655f 7769 7468 5f6d 7970  patible_with_myp
+0000d480: 7963 0a20 2020 2064 6566 2074 6573 745f  yc.    def test_
+0000d490: 7265 666f 726d 6174 5f6f 6e65 5f77 6974  reformat_one_wit
+0000d4a0: 685f 7374 6469 6e5f 6669 6c65 6e61 6d65  h_stdin_filename
+0000d4b0: 5f70 7969 2873 656c 6629 202d 3e20 4e6f  _pyi(self) -> No
+0000d4c0: 6e65 3a0a 2020 2020 2020 2020 7769 7468  ne:.        with
+0000d4d0: 2070 6174 6368 280a 2020 2020 2020 2020   patch(.        
+0000d4e0: 2020 2020 2263 6572 6369 732e 666f 726d      "cercis.form
+0000d4f0: 6174 5f73 7464 696e 5f74 6f5f 7374 646f  at_stdin_to_stdo
+0000d500: 7574 222c 0a20 2020 2020 2020 2020 2020  ut",.           
+0000d510: 2072 6574 7572 6e5f 7661 6c75 653d 6c61   return_value=la
+0000d520: 6d62 6461 202a 6172 6773 2c20 2a2a 6b77  mbda *args, **kw
+0000d530: 6172 6773 3a20 6365 7263 6973 2e43 6861  args: cercis.Cha
+0000d540: 6e67 6564 2e59 4553 2c0a 2020 2020 2020  nged.YES,.      
+0000d550: 2020 2920 6173 2066 7374 733a 0a20 2020    ) as fsts:.   
+0000d560: 2020 2020 2020 2020 2072 6570 6f72 7420           report 
+0000d570: 3d20 4d61 6769 634d 6f63 6b28 290a 2020  = MagicMock().  
+0000d580: 2020 2020 2020 2020 2020 7020 3d20 2266            p = "f
+0000d590: 6f6f 2e70 7969 220a 2020 2020 2020 2020  oo.pyi".        
+0000d5a0: 2020 2020 7061 7468 203d 2050 6174 6828      path = Path(
+0000d5b0: 6622 5f5f 424c 4143 4b5f 5354 4449 4e5f  f"__BLACK_STDIN_
+0000d5c0: 4649 4c45 4e41 4d45 5f5f 7b70 7d22 290a  FILENAME__{p}").
+0000d5d0: 2020 2020 2020 2020 2020 2020 6578 7065              expe
+0000d5e0: 6374 6564 203d 2050 6174 6828 7029 0a20  cted = Path(p). 
+0000d5f0: 2020 2020 2020 2020 2020 2063 6572 6369             cerci
+0000d600: 732e 7265 666f 726d 6174 5f6f 6e65 280a  s.reformat_one(.
+0000d610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d620: 7061 7468 2c0a 2020 2020 2020 2020 2020  path,.          
+0000d630: 2020 2020 2020 6661 7374 3d54 7275 652c        fast=True,
+0000d640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d650: 2077 7269 7465 5f62 6163 6b3d 6365 7263   write_back=cerc
+0000d660: 6973 2e57 7269 7465 4261 636b 2e59 4553  is.WriteBack.YES
+0000d670: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000d680: 2020 6d6f 6465 3d44 4546 4155 4c54 5f4d    mode=DEFAULT_M
+0000d690: 4f44 452c 0a20 2020 2020 2020 2020 2020  ODE,.           
+0000d6a0: 2020 2020 2072 6570 6f72 743d 7265 706f       report=repo
+0000d6b0: 7274 2c0a 2020 2020 2020 2020 2020 2020  rt,.            
+0000d6c0: 290a 2020 2020 2020 2020 2020 2020 6673  ).            fs
+0000d6d0: 7473 2e61 7373 6572 745f 6361 6c6c 6564  ts.assert_called
+0000d6e0: 5f6f 6e63 655f 7769 7468 280a 2020 2020  _once_with(.    
+0000d6f0: 2020 2020 2020 2020 2020 2020 6661 7374              fast
+0000d700: 3d54 7275 652c 0a20 2020 2020 2020 2020  =True,.         
+0000d710: 2020 2020 2020 2077 7269 7465 5f62 6163         write_bac
+0000d720: 6b3d 6365 7263 6973 2e57 7269 7465 4261  k=cercis.WriteBa
+0000d730: 636b 2e59 4553 2c0a 2020 2020 2020 2020  ck.YES,.        
+0000d740: 2020 2020 2020 2020 6d6f 6465 3d72 6570          mode=rep
+0000d750: 6c61 6365 2844 4546 4155 4c54 5f4d 4f44  lace(DEFAULT_MOD
+0000d760: 452c 2069 735f 7079 693d 5472 7565 292c  E, is_pyi=True),
+0000d770: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0000d780: 2020 2020 2020 2020 2020 2023 205f 5f42             # __B
+0000d790: 4c41 434b 5f53 5444 494e 5f46 494c 454e  LACK_STDIN_FILEN
+0000d7a0: 414d 455f 5f20 7368 6f75 6c64 2068 6176  AME__ should hav
+0000d7b0: 6520 6265 656e 2073 7472 6970 7065 640a  e been stripped.
+0000d7c0: 2020 2020 2020 2020 2020 2020 7265 706f              repo
+0000d7d0: 7274 2e64 6f6e 652e 6173 7365 7274 5f63  rt.done.assert_c
+0000d7e0: 616c 6c65 645f 7769 7468 2865 7870 6563  alled_with(expec
+0000d7f0: 7465 642c 2063 6572 6369 732e 4368 616e  ted, cercis.Chan
+0000d800: 6765 642e 5945 5329 0a0a 2020 2020 4070  ged.YES)..    @p
+0000d810: 7974 6573 742e 6d61 726b 2e69 6e63 6f6d  ytest.mark.incom
+0000d820: 7061 7469 626c 655f 7769 7468 5f6d 7970  patible_with_myp
+0000d830: 7963 0a20 2020 2064 6566 2074 6573 745f  yc.    def test_
+0000d840: 7265 666f 726d 6174 5f6f 6e65 5f77 6974  reformat_one_wit
+0000d850: 685f 7374 6469 6e5f 6669 6c65 6e61 6d65  h_stdin_filename
+0000d860: 5f69 7079 6e62 2873 656c 6629 202d 3e20  _ipynb(self) -> 
+0000d870: 4e6f 6e65 3a0a 2020 2020 2020 2020 7769  None:.        wi
+0000d880: 7468 2070 6174 6368 280a 2020 2020 2020  th patch(.      
+0000d890: 2020 2020 2020 2263 6572 6369 732e 666f        "cercis.fo
+0000d8a0: 726d 6174 5f73 7464 696e 5f74 6f5f 7374  rmat_stdin_to_st
+0000d8b0: 646f 7574 222c 0a20 2020 2020 2020 2020  dout",.         
+0000d8c0: 2020 2072 6574 7572 6e5f 7661 6c75 653d     return_value=
+0000d8d0: 6c61 6d62 6461 202a 6172 6773 2c20 2a2a  lambda *args, **
+0000d8e0: 6b77 6172 6773 3a20 6365 7263 6973 2e43  kwargs: cercis.C
+0000d8f0: 6861 6e67 6564 2e59 4553 2c0a 2020 2020  hanged.YES,.    
+0000d900: 2020 2020 2920 6173 2066 7374 733a 0a20      ) as fsts:. 
+0000d910: 2020 2020 2020 2020 2020 2072 6570 6f72             repor
+0000d920: 7420 3d20 4d61 6769 634d 6f63 6b28 290a  t = MagicMock().
+0000d930: 2020 2020 2020 2020 2020 2020 7020 3d20              p = 
+0000d940: 2266 6f6f 2e69 7079 6e62 220a 2020 2020  "foo.ipynb".    
+0000d950: 2020 2020 2020 2020 7061 7468 203d 2050          path = P
+0000d960: 6174 6828 6622 5f5f 424c 4143 4b5f 5354  ath(f"__BLACK_ST
+0000d970: 4449 4e5f 4649 4c45 4e41 4d45 5f5f 7b70  DIN_FILENAME__{p
+0000d980: 7d22 290a 2020 2020 2020 2020 2020 2020  }").            
+0000d990: 6578 7065 6374 6564 203d 2050 6174 6828  expected = Path(
+0000d9a0: 7029 0a20 2020 2020 2020 2020 2020 2063  p).            c
+0000d9b0: 6572 6369 732e 7265 666f 726d 6174 5f6f  ercis.reformat_o
+0000d9c0: 6e65 280a 2020 2020 2020 2020 2020 2020  ne(.            
+0000d9d0: 2020 2020 7061 7468 2c0a 2020 2020 2020      path,.      
+0000d9e0: 2020 2020 2020 2020 2020 6661 7374 3d54            fast=T
+0000d9f0: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
+0000da00: 2020 2020 2077 7269 7465 5f62 6163 6b3d       write_back=
+0000da10: 6365 7263 6973 2e57 7269 7465 4261 636b  cercis.WriteBack
+0000da20: 2e59 4553 2c0a 2020 2020 2020 2020 2020  .YES,.          
+0000da30: 2020 2020 2020 6d6f 6465 3d44 4546 4155        mode=DEFAU
+0000da40: 4c54 5f4d 4f44 452c 0a20 2020 2020 2020  LT_MODE,.       
+0000da50: 2020 2020 2020 2020 2072 6570 6f72 743d           report=
+0000da60: 7265 706f 7274 2c0a 2020 2020 2020 2020  report,.        
+0000da70: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0000da80: 2020 6673 7473 2e61 7373 6572 745f 6361    fsts.assert_ca
+0000da90: 6c6c 6564 5f6f 6e63 655f 7769 7468 280a  lled_once_with(.
+0000daa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dab0: 6661 7374 3d54 7275 652c 0a20 2020 2020  fast=True,.     
+0000dac0: 2020 2020 2020 2020 2020 2077 7269 7465             write
+0000dad0: 5f62 6163 6b3d 6365 7263 6973 2e57 7269  _back=cercis.Wri
+0000dae0: 7465 4261 636b 2e59 4553 2c0a 2020 2020  teBack.YES,.    
+0000daf0: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+0000db00: 3d72 6570 6c61 6365 2844 4546 4155 4c54  =replace(DEFAULT
+0000db10: 5f4d 4f44 452c 2069 735f 6970 796e 623d  _MODE, is_ipynb=
+0000db20: 5472 7565 292c 0a20 2020 2020 2020 2020  True),.         
+0000db30: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0000db40: 2023 205f 5f42 4c41 434b 5f53 5444 494e   # __BLACK_STDIN
+0000db50: 5f46 494c 454e 414d 455f 5f20 7368 6f75  _FILENAME__ shou
+0000db60: 6c64 2068 6176 6520 6265 656e 2073 7472  ld have been str
+0000db70: 6970 7065 640a 2020 2020 2020 2020 2020  ipped.          
+0000db80: 2020 7265 706f 7274 2e64 6f6e 652e 6173    report.done.as
+0000db90: 7365 7274 5f63 616c 6c65 645f 7769 7468  sert_called_with
+0000dba0: 2865 7870 6563 7465 642c 2063 6572 6369  (expected, cerci
+0000dbb0: 732e 4368 616e 6765 642e 5945 5329 0a0a  s.Changed.YES)..
+0000dbc0: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
+0000dbd0: 2e69 6e63 6f6d 7061 7469 626c 655f 7769  .incompatible_wi
+0000dbe0: 7468 5f6d 7970 7963 0a20 2020 2064 6566  th_mypyc.    def
+0000dbf0: 2074 6573 745f 7265 666f 726d 6174 5f6f   test_reformat_o
+0000dc00: 6e65 5f77 6974 685f 7374 6469 6e5f 616e  ne_with_stdin_an
+0000dc10: 645f 6578 6973 7469 6e67 5f70 6174 6828  d_existing_path(
+0000dc20: 7365 6c66 2920 2d3e 204e 6f6e 653a 0a20  self) -> None:. 
+0000dc30: 2020 2020 2020 2077 6974 6820 7061 7463         with patc
+0000dc40: 6828 0a20 2020 2020 2020 2020 2020 2022  h(.            "
+0000dc50: 6365 7263 6973 2e66 6f72 6d61 745f 7374  cercis.format_st
+0000dc60: 6469 6e5f 746f 5f73 7464 6f75 7422 2c0a  din_to_stdout",.
+0000dc70: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000dc80: 726e 5f76 616c 7565 3d6c 616d 6264 6120  rn_value=lambda 
+0000dc90: 2a61 7267 732c 202a 2a6b 7761 7267 733a  *args, **kwargs:
+0000dca0: 2063 6572 6369 732e 4368 616e 6765 642e   cercis.Changed.
+0000dcb0: 5945 532c 0a20 2020 2020 2020 2029 2061  YES,.        ) a
+0000dcc0: 7320 6673 7473 3a0a 2020 2020 2020 2020  s fsts:.        
+0000dcd0: 2020 2020 7265 706f 7274 203d 204d 6167      report = Mag
+0000dce0: 6963 4d6f 636b 2829 0a20 2020 2020 2020  icMock().       
+0000dcf0: 2020 2020 2023 2045 7665 6e20 7769 7468       # Even with
+0000dd00: 2061 6e20 6578 6973 7469 6e67 2066 696c   an existing fil
+0000dd10: 652c 2073 696e 6365 2077 6520 6172 6520  e, since we are 
+0000dd20: 666f 7263 696e 6720 7374 6469 6e2c 2063  forcing stdin, c
+0000dd30: 6572 6369 730a 2020 2020 2020 2020 2020  ercis.          
+0000dd40: 2020 2320 7368 6f75 6c64 206f 7574 7075    # should outpu
+0000dd50: 7420 746f 2073 7464 6f75 7420 616e 6420  t to stdout and 
+0000dd60: 6e6f 7420 6d6f 6469 6679 2074 6865 2066  not modify the f
+0000dd70: 696c 6520 696e 706c 6163 650a 2020 2020  ile inplace.    
+0000dd80: 2020 2020 2020 2020 7020 3d20 5448 4953          p = THIS
+0000dd90: 5f44 4952 202f 2022 6461 7461 2220 2f20  _DIR / "data" / 
+0000dda0: 2273 696d 706c 655f 6361 7365 7322 202f  "simple_cases" /
+0000ddb0: 2022 636f 6c6c 6563 7469 6f6e 732e 7079   "collections.py
+0000ddc0: 220a 2020 2020 2020 2020 2020 2020 2320  ".            # 
+0000ddd0: 4d61 6b65 2073 7572 6520 6973 5f66 696c  Make sure is_fil
+0000dde0: 6520 6163 7475 616c 6c79 2072 6574 7572  e actually retur
+0000ddf0: 6e73 2054 7275 650a 2020 2020 2020 2020  ns True.        
+0000de00: 2020 2020 7365 6c66 2e61 7373 6572 7454      self.assertT
+0000de10: 7275 6528 702e 6973 5f66 696c 6528 2929  rue(p.is_file())
+0000de20: 0a20 2020 2020 2020 2020 2020 2070 6174  .            pat
+0000de30: 6820 3d20 5061 7468 2866 225f 5f42 4c41  h = Path(f"__BLA
+0000de40: 434b 5f53 5444 494e 5f46 494c 454e 414d  CK_STDIN_FILENAM
+0000de50: 455f 5f7b 707d 2229 0a20 2020 2020 2020  E__{p}").       
+0000de60: 2020 2020 2065 7870 6563 7465 6420 3d20       expected = 
+0000de70: 5061 7468 2870 290a 2020 2020 2020 2020  Path(p).        
+0000de80: 2020 2020 6365 7263 6973 2e72 6566 6f72      cercis.refor
+0000de90: 6d61 745f 6f6e 6528 0a20 2020 2020 2020  mat_one(.       
+0000dea0: 2020 2020 2020 2020 2070 6174 682c 0a20           path,. 
+0000deb0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000dec0: 6173 743d 5472 7565 2c0a 2020 2020 2020  ast=True,.      
+0000ded0: 2020 2020 2020 2020 2020 7772 6974 655f            write_
+0000dee0: 6261 636b 3d63 6572 6369 732e 5772 6974  back=cercis.Writ
+0000def0: 6542 6163 6b2e 5945 532c 0a20 2020 2020  eBack.YES,.     
+0000df00: 2020 2020 2020 2020 2020 206d 6f64 653d             mode=
+0000df10: 4445 4641 554c 545f 4d4f 4445 2c0a 2020  DEFAULT_MODE,.  
+0000df20: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0000df30: 706f 7274 3d72 6570 6f72 742c 0a20 2020  port=report,.   
+0000df40: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0000df50: 2020 2020 2020 2066 7374 732e 6173 7365         fsts.asse
+0000df60: 7274 5f63 616c 6c65 645f 6f6e 6365 2829  rt_called_once()
+0000df70: 0a20 2020 2020 2020 2020 2020 2023 205f  .            # _
+0000df80: 5f42 4c41 434b 5f53 5444 494e 5f46 494c  _BLACK_STDIN_FIL
+0000df90: 454e 414d 455f 5f20 7368 6f75 6c64 2068  ENAME__ should h
+0000dfa0: 6176 6520 6265 656e 2073 7472 6970 7065  ave been strippe
+0000dfb0: 640a 2020 2020 2020 2020 2020 2020 7265  d.            re
+0000dfc0: 706f 7274 2e64 6f6e 652e 6173 7365 7274  port.done.assert
+0000dfd0: 5f63 616c 6c65 645f 7769 7468 2865 7870  _called_with(exp
+0000dfe0: 6563 7465 642c 2063 6572 6369 732e 4368  ected, cercis.Ch
+0000dff0: 616e 6765 642e 5945 5329 0a0a 2020 2020  anged.YES)..    
+0000e000: 6465 6620 7465 7374 5f72 6566 6f72 6d61  def test_reforma
+0000e010: 745f 6f6e 655f 7769 7468 5f73 7464 696e  t_one_with_stdin
+0000e020: 5f65 6d70 7479 2873 656c 6629 202d 3e20  _empty(self) -> 
+0000e030: 4e6f 6e65 3a0a 2020 2020 2020 2020 6361  None:.        ca
+0000e040: 7365 7320 3d20 5b0a 2020 2020 2020 2020  ses = [.        
+0000e050: 2020 2020 2822 222c 2022 2229 2c0a 2020      ("", ""),.  
+0000e060: 2020 2020 2020 2020 2020 2822 5c6e 222c            ("\n",
+0000e070: 2022 5c6e 2229 2c0a 2020 2020 2020 2020   "\n"),.        
+0000e080: 2020 2020 2822 5c72 5c6e 222c 2022 5c72      ("\r\n", "\r
+0000e090: 5c6e 2229 2c0a 2020 2020 2020 2020 2020  \n"),.          
+0000e0a0: 2020 2822 205c 7422 2c20 2222 292c 0a20    (" \t", ""),. 
+0000e0b0: 2020 2020 2020 2020 2020 2028 2220 5c74             (" \t
+0000e0c0: 5c6e 5c74 2022 2c20 225c 6e22 292c 0a20  \n\t ", "\n"),. 
+0000e0d0: 2020 2020 2020 2020 2020 2028 2220 5c74             (" \t
+0000e0e0: 5c72 5c6e 5c74 2022 2c20 225c 725c 6e22  \r\n\t ", "\r\n"
+0000e0f0: 292c 0a20 2020 2020 2020 205d 0a0a 2020  ),.        ]..  
+0000e100: 2020 2020 2020 6465 6620 5f6e 6577 5f77        def _new_w
+0000e110: 7261 7070 6572 280a 2020 2020 2020 2020  rapper(.        
+0000e120: 2020 2020 2020 2020 6f75 7470 7574 3a20          output: 
+0000e130: 696f 2e53 7472 696e 6749 4f2c 2069 6f5f  io.StringIO, io_
+0000e140: 5465 7874 494f 5772 6170 7065 723a 2054  TextIOWrapper: T
+0000e150: 7970 655b 696f 2e54 6578 7449 4f57 7261  ype[io.TextIOWra
+0000e160: 7070 6572 5d0a 2020 2020 2020 2020 2920  pper].        ) 
+0000e170: 2d3e 2043 616c 6c61 626c 655b 5b41 6e79  -> Callable[[Any
+0000e180: 2c20 416e 795d 2c20 696f 2e54 6578 7449  , Any], io.TextI
+0000e190: 4f57 7261 7070 6572 5d3a 0a20 2020 2020  OWrapper]:.     
+0000e1a0: 2020 2020 2020 2064 6566 2067 6574 5f6f         def get_o
+0000e1b0: 7574 7075 7428 2a61 7267 733a 2041 6e79  utput(*args: Any
+0000e1c0: 2c20 2a2a 6b77 6172 6773 3a20 416e 7929  , **kwargs: Any)
+0000e1d0: 202d 3e20 696f 2e54 6578 7449 4f57 7261   -> io.TextIOWra
+0000e1e0: 7070 6572 3a0a 2020 2020 2020 2020 2020  pper:.          
+0000e1f0: 2020 2020 2020 6966 2061 7267 7320 3d3d        if args ==
+0000e200: 2028 7379 732e 7374 646f 7574 2e62 7566   (sys.stdout.buf
+0000e210: 6665 722c 293a 0a20 2020 2020 2020 2020  fer,):.         
+0000e220: 2020 2020 2020 2020 2020 2023 2049 7427             # It'
+0000e230: 7320 6066 6f72 6d61 745f 7374 6469 6e5f  s `format_stdin_
+0000e240: 746f 5f73 7464 6f75 7428 2960 2063 616c  to_stdout()` cal
+0000e250: 6c69 6e67 2060 696f 2e54 6578 7449 4f57  ling `io.TextIOW
+0000e260: 7261 7070 6572 2829 602c 0a20 2020 2020  rapper()`,.     
+0000e270: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0000e280: 2072 6574 7572 6e20 6f75 7220 6d6f 636b   return our mock
+0000e290: 206f 626a 6563 742e 0a20 2020 2020 2020   object..       
+0000e2a0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+0000e2b0: 7572 6e20 6f75 7470 7574 0a20 2020 2020  urn output.     
+0000e2c0: 2020 2020 2020 2020 2020 2023 2049 7427             # It'
+0000e2d0: 7320 736f 6d65 7468 696e 6720 656c 7365  s something else
+0000e2e0: 2028 692e 652e 2060 6465 636f 6465 5f62   (i.e. `decode_b
+0000e2f0: 7974 6573 2829 6029 2063 616c 6c69 6e67  ytes()`) calling
+0000e300: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e310: 2023 2060 696f 2e54 6578 7449 4f57 7261   # `io.TextIOWra
+0000e320: 7070 6572 2829 602c 2070 6173 7320 7468  pper()`, pass th
+0000e330: 726f 7567 6820 746f 2074 6865 206f 7269  rough to the ori
+0000e340: 6769 6e61 6c20 696d 706c 656d 656e 7461  ginal implementa
+0000e350: 7469 6f6e 2e0a 2020 2020 2020 2020 2020  tion..          
+0000e360: 2020 2020 2020 2320 5365 6520 6469 7363        # See disc
+0000e370: 7573 7369 6f6e 2069 6e20 6874 7470 733a  ussion in https:
+0000e380: 2f2f 6769 7468 7562 2e63 6f6d 2f70 7366  //github.com/psf
+0000e390: 2f62 6c61 636b 2f70 756c 6c2f 3234 3839  /black/pull/2489
+0000e3a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e3b0: 2072 6574 7572 6e20 696f 5f54 6578 7449   return io_TextI
+0000e3c0: 4f57 7261 7070 6572 282a 6172 6773 2c20  OWrapper(*args, 
+0000e3d0: 2a2a 6b77 6172 6773 290a 0a20 2020 2020  **kwargs)..     
+0000e3e0: 2020 2020 2020 2072 6574 7572 6e20 6765         return ge
+0000e3f0: 745f 6f75 7470 7574 0a0a 2020 2020 2020  t_output..      
+0000e400: 2020 6d6f 6465 203d 2063 6572 6369 732e    mode = cercis.
+0000e410: 4d6f 6465 2870 7265 7669 6577 3d54 7275  Mode(preview=Tru
+0000e420: 6529 0a20 2020 2020 2020 2066 6f72 2063  e).        for c
+0000e430: 6f6e 7465 6e74 2c20 6578 7065 6374 6564  ontent, expected
+0000e440: 2069 6e20 6361 7365 733a 0a20 2020 2020   in cases:.     
+0000e450: 2020 2020 2020 206f 7574 7075 7420 3d20         output = 
+0000e460: 696f 2e53 7472 696e 6749 4f28 290a 2020  io.StringIO().  
+0000e470: 2020 2020 2020 2020 2020 696f 5f54 6578            io_Tex
+0000e480: 7449 4f57 7261 7070 6572 203d 2069 6f2e  tIOWrapper = io.
+0000e490: 5465 7874 494f 5772 6170 7065 720a 0a20  TextIOWrapper.. 
+0000e4a0: 2020 2020 2020 2020 2020 2077 6974 6820             with 
+0000e4b0: 7061 7463 6828 2269 6f2e 5465 7874 494f  patch("io.TextIO
+0000e4c0: 5772 6170 7065 7222 2c20 5f6e 6577 5f77  Wrapper", _new_w
+0000e4d0: 7261 7070 6572 286f 7574 7075 742c 2069  rapper(output, i
+0000e4e0: 6f5f 5465 7874 494f 5772 6170 7065 7229  o_TextIOWrapper)
+0000e4f0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0000e500: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+0000e510: 2020 2020 2020 2020 2020 2020 6365 7263              cerc
+0000e520: 6973 2e66 6f72 6d61 745f 7374 6469 6e5f  is.format_stdin_
+0000e530: 746f 5f73 7464 6f75 7428 0a20 2020 2020  to_stdout(.     
+0000e540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e550: 2020 2066 6173 743d 5472 7565 2c0a 2020     fast=True,.  
+0000e560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e570: 2020 2020 2020 636f 6e74 656e 743d 636f        content=co
+0000e580: 6e74 656e 742c 0a20 2020 2020 2020 2020  ntent,.         
+0000e590: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+0000e5a0: 7269 7465 5f62 6163 6b3d 6365 7263 6973  rite_back=cercis
+0000e5b0: 2e57 7269 7465 4261 636b 2e59 4553 2c0a  .WriteBack.YES,.
+0000e5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e5d0: 2020 2020 2020 2020 6d6f 6465 3d6d 6f64          mode=mod
+0000e5e0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0000e5f0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0000e600: 2020 2020 2020 2020 2065 7863 6570 7420           except 
+0000e610: 696f 2e55 6e73 7570 706f 7274 6564 4f70  io.UnsupportedOp
+0000e620: 6572 6174 696f 6e3a 0a20 2020 2020 2020  eration:.       
+0000e630: 2020 2020 2020 2020 2020 2020 2070 6173               pas
+0000e640: 7320 2023 2053 7472 696e 6749 4f20 646f  s  # StringIO do
+0000e650: 6573 206e 6f74 2073 7570 706f 7274 2064  es not support d
+0000e660: 6574 6163 680a 2020 2020 2020 2020 2020  etach.          
+0000e670: 2020 2020 2020 6173 7365 7274 206f 7574        assert out
+0000e680: 7075 742e 6765 7476 616c 7565 2829 203d  put.getvalue() =
+0000e690: 3d20 6578 7065 6374 6564 0a0a 2020 2020  = expected..    
+0000e6a0: 2020 2020 2320 416e 2065 6d70 7479 2073      # An empty s
+0000e6b0: 7472 696e 6720 6973 2074 6865 206f 6e6c  tring is the onl
+0000e6c0: 7920 7465 7374 2063 6173 6520 666f 7220  y test case for 
+0000e6d0: 6070 7265 7669 6577 3d46 616c 7365 600a  `preview=False`.
+0000e6e0: 2020 2020 2020 2020 6f75 7470 7574 203d          output =
+0000e6f0: 2069 6f2e 5374 7269 6e67 494f 2829 0a20   io.StringIO(). 
+0000e700: 2020 2020 2020 2069 6f5f 5465 7874 494f         io_TextIO
+0000e710: 5772 6170 7065 7220 3d20 696f 2e54 6578  Wrapper = io.Tex
+0000e720: 7449 4f57 7261 7070 6572 0a20 2020 2020  tIOWrapper.     
+0000e730: 2020 2077 6974 6820 7061 7463 6828 2269     with patch("i
+0000e740: 6f2e 5465 7874 494f 5772 6170 7065 7222  o.TextIOWrapper"
+0000e750: 2c20 5f6e 6577 5f77 7261 7070 6572 286f  , _new_wrapper(o
+0000e760: 7574 7075 742c 2069 6f5f 5465 7874 494f  utput, io_TextIO
+0000e770: 5772 6170 7065 7229 293a 0a20 2020 2020  Wrapper)):.     
+0000e780: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+0000e790: 2020 2020 2020 2020 2020 2020 6365 7263              cerc
+0000e7a0: 6973 2e66 6f72 6d61 745f 7374 6469 6e5f  is.format_stdin_
+0000e7b0: 746f 5f73 7464 6f75 7428 0a20 2020 2020  to_stdout(.     
+0000e7c0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000e7d0: 6173 743d 5472 7565 2c0a 2020 2020 2020  ast=True,.      
+0000e7e0: 2020 2020 2020 2020 2020 2020 2020 636f                co
+0000e7f0: 6e74 656e 743d 2222 2c0a 2020 2020 2020  ntent="",.      
+0000e800: 2020 2020 2020 2020 2020 2020 2020 7772                wr
+0000e810: 6974 655f 6261 636b 3d63 6572 6369 732e  ite_back=cercis.
+0000e820: 5772 6974 6542 6163 6b2e 5945 532c 0a20  WriteBack.YES,. 
+0000e830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e840: 2020 206d 6f64 653d 4445 4641 554c 545f     mode=DEFAULT_
+0000e850: 4d4f 4445 2c0a 2020 2020 2020 2020 2020  MODE,.          
+0000e860: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0000e870: 2020 2020 6578 6365 7074 2069 6f2e 556e      except io.Un
+0000e880: 7375 7070 6f72 7465 644f 7065 7261 7469  supportedOperati
+0000e890: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
+0000e8a0: 2020 2020 7061 7373 2020 2320 5374 7269      pass  # Stri
+0000e8b0: 6e67 494f 2064 6f65 7320 6e6f 7420 7375  ngIO does not su
+0000e8c0: 7070 6f72 7420 6465 7461 6368 0a20 2020  pport detach.   
+0000e8d0: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+0000e8e0: 6f75 7470 7574 2e67 6574 7661 6c75 6528  output.getvalue(
+0000e8f0: 2920 3d3d 2022 220a 0a20 2020 2064 6566  ) == ""..    def
+0000e900: 2074 6573 745f 696e 7661 6c69 645f 636c   test_invalid_cl
+0000e910: 695f 7265 6765 7828 7365 6c66 2920 2d3e  i_regex(self) ->
+0000e920: 204e 6f6e 653a 0a20 2020 2020 2020 2066   None:.        f
+0000e930: 6f72 206f 7074 696f 6e20 696e 205b 222d  or option in ["-
+0000e940: 2d69 6e63 6c75 6465 222c 2022 2d2d 6578  -include", "--ex
+0000e950: 636c 7564 6522 2c20 222d 2d65 7874 656e  clude", "--exten
+0000e960: 642d 6578 636c 7564 6522 2c20 222d 2d66  d-exclude", "--f
+0000e970: 6f72 6365 2d65 7863 6c75 6465 225d 3a0a  orce-exclude"]:.
+0000e980: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000e990: 2e69 6e76 6f6b 6542 6c61 636b 285b 222d  .invokeBlack(["-
+0000e9a0: 222c 206f 7074 696f 6e2c 2022 2a2a 2829  ", option, "**()
+0000e9b0: 2821 212a 2922 5d2c 2065 7869 745f 636f  (!!*)"], exit_co
+0000e9c0: 6465 3d32 290a 0a20 2020 2064 6566 2074  de=2)..    def t
+0000e9d0: 6573 745f 7265 7175 6972 6564 5f76 6572  est_required_ver
+0000e9e0: 7369 6f6e 5f6d 6174 6368 6573 5f76 6572  sion_matches_ver
+0000e9f0: 7369 6f6e 2873 656c 6629 202d 3e20 4e6f  sion(self) -> No
+0000ea00: 6e65 3a0a 2020 2020 2020 2020 7365 6c66  ne:.        self
+0000ea10: 2e69 6e76 6f6b 6542 6c61 636b 280a 2020  .invokeBlack(.  
+0000ea20: 2020 2020 2020 2020 2020 5b22 2d2d 7265            ["--re
+0000ea30: 7175 6972 6564 2d76 6572 7369 6f6e 222c  quired-version",
+0000ea40: 2063 6572 6369 732e 5f5f 7665 7273 696f   cercis.__versio
+0000ea50: 6e5f 5f2c 2022 2d63 222c 2022 3022 5d2c  n__, "-c", "0"],
+0000ea60: 0a20 2020 2020 2020 2020 2020 2065 7869  .            exi
+0000ea70: 745f 636f 6465 3d30 2c0a 2020 2020 2020  t_code=0,.      
+0000ea80: 2020 2020 2020 6967 6e6f 7265 5f63 6f6e        ignore_con
+0000ea90: 6669 673d 5472 7565 2c0a 2020 2020 2020  fig=True,.      
+0000eaa0: 2020 290a 0a20 2020 2064 6566 2074 6573    )..    def tes
+0000eab0: 745f 7265 7175 6972 6564 5f76 6572 7369  t_required_versi
+0000eac0: 6f6e 5f6d 6174 6368 6573 5f70 6172 7469  on_matches_parti
+0000ead0: 616c 5f76 6572 7369 6f6e 2873 656c 6629  al_version(self)
+0000eae0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+0000eaf0: 2020 7365 6c66 2e69 6e76 6f6b 6542 6c61    self.invokeBla
+0000eb00: 636b 280a 2020 2020 2020 2020 2020 2020  ck(.            
+0000eb10: 5b22 2d2d 7265 7175 6972 6564 2d76 6572  ["--required-ver
+0000eb20: 7369 6f6e 222c 2063 6572 6369 732e 5f5f  sion", cercis.__
+0000eb30: 7665 7273 696f 6e5f 5f2e 7370 6c69 7428  version__.split(
+0000eb40: 222e 2229 5b30 5d2c 2022 2d63 222c 2022  ".")[0], "-c", "
+0000eb50: 3022 5d2c 0a20 2020 2020 2020 2020 2020  0"],.           
+0000eb60: 2065 7869 745f 636f 6465 3d30 2c0a 2020   exit_code=0,.  
+0000eb70: 2020 2020 2020 2020 2020 6967 6e6f 7265            ignore
+0000eb80: 5f63 6f6e 6669 673d 5472 7565 2c0a 2020  _config=True,.  
+0000eb90: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
+0000eba0: 2074 6573 745f 7265 7175 6972 6564 5f76   test_required_v
+0000ebb0: 6572 7369 6f6e 5f64 6f65 735f 6e6f 745f  ersion_does_not_
+0000ebc0: 6d61 7463 685f 6f6e 5f6d 696e 6f72 5f76  match_on_minor_v
+0000ebd0: 6572 7369 6f6e 2873 656c 6629 202d 3e20  ersion(self) -> 
+0000ebe0: 4e6f 6e65 3a0a 2020 2020 2020 2020 7365  None:.        se
+0000ebf0: 6c66 2e69 6e76 6f6b 6542 6c61 636b 280a  lf.invokeBlack(.
+0000ec00: 2020 2020 2020 2020 2020 2020 5b0a 2020              [.  
+0000ec10: 2020 2020 2020 2020 2020 2020 2020 222d                "-
+0000ec20: 2d72 6571 7569 7265 642d 7665 7273 696f  -required-versio
+0000ec30: 6e22 2c0a 2020 2020 2020 2020 2020 2020  n",.            
+0000ec40: 2020 2020 6365 7263 6973 2e5f 5f76 6572      cercis.__ver
+0000ec50: 7369 6f6e 5f5f 2e73 706c 6974 2822 2e22  sion__.split("."
+0000ec60: 295b 305d 202b 2022 2e39 3939 222c 0a20  )[0] + ".999",. 
+0000ec70: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0000ec80: 2d63 222c 0a20 2020 2020 2020 2020 2020  -c",.           
+0000ec90: 2020 2020 2022 3022 2c0a 2020 2020 2020       "0",.      
+0000eca0: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
+0000ecb0: 2020 2020 2065 7869 745f 636f 6465 3d31       exit_code=1
+0000ecc0: 2c0a 2020 2020 2020 2020 2020 2020 6967  ,.            ig
+0000ecd0: 6e6f 7265 5f63 6f6e 6669 673d 5472 7565  nore_config=True
+0000ece0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+0000ecf0: 2064 6566 2074 6573 745f 7265 7175 6972   def test_requir
+0000ed00: 6564 5f76 6572 7369 6f6e 5f64 6f65 735f  ed_version_does_
+0000ed10: 6e6f 745f 6d61 7463 685f 7665 7273 696f  not_match_versio
+0000ed20: 6e28 7365 6c66 2920 2d3e 204e 6f6e 653a  n(self) -> None:
+0000ed30: 0a20 2020 2020 2020 2072 6573 756c 7420  .        result 
+0000ed40: 3d20 426c 6163 6b52 756e 6e65 7228 292e  = BlackRunner().
+0000ed50: 696e 766f 6b65 280a 2020 2020 2020 2020  invoke(.        
+0000ed60: 2020 2020 6365 7263 6973 2e6d 6169 6e2c      cercis.main,
+0000ed70: 0a20 2020 2020 2020 2020 2020 205b 222d  .            ["-
+0000ed80: 2d72 6571 7569 7265 642d 7665 7273 696f  -required-versio
+0000ed90: 6e22 2c20 2232 302e 3939 6222 2c20 222d  n", "20.99b", "-
+0000eda0: 6322 2c20 2230 225d 2c0a 2020 2020 2020  c", "0"],.      
+0000edb0: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
+0000edc0: 2e61 7373 6572 7445 7175 616c 2872 6573  .assertEqual(res
+0000edd0: 756c 742e 6578 6974 5f63 6f64 652c 2031  ult.exit_code, 1
+0000ede0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+0000edf0: 7373 6572 7449 6e28 2272 6571 7569 7265  ssertIn("require
+0000ee00: 6420 7665 7273 696f 6e22 2c20 7265 7375  d version", resu
+0000ee10: 6c74 2e73 7464 6572 7229 0a0a 2020 2020  lt.stderr)..    
+0000ee20: 6465 6620 7465 7374 5f70 7265 7365 7276  def test_preserv
+0000ee30: 6573 5f6c 696e 655f 656e 6469 6e67 7328  es_line_endings(
+0000ee40: 7365 6c66 2920 2d3e 204e 6f6e 653a 0a20  self) -> None:. 
+0000ee50: 2020 2020 2020 2077 6974 6820 5465 6d70         with Temp
+0000ee60: 6f72 6172 7944 6972 6563 746f 7279 2829  oraryDirectory()
+0000ee70: 2061 7320 776f 726b 7370 6163 653a 0a20   as workspace:. 
+0000ee80: 2020 2020 2020 2020 2020 2074 6573 745f             test_
+0000ee90: 6669 6c65 203d 2050 6174 6828 776f 726b  file = Path(work
+0000eea0: 7370 6163 6529 202f 2022 7465 7374 2e70  space) / "test.p
+0000eeb0: 7922 0a20 2020 2020 2020 2020 2020 2066  y".            f
+0000eec0: 6f72 206e 6c20 696e 205b 225c 6e22 2c20  or nl in ["\n", 
+0000eed0: 225c 725c 6e22 5d3a 0a20 2020 2020 2020  "\r\n"]:.       
+0000eee0: 2020 2020 2020 2020 2063 6f6e 7465 6e74           content
+0000eef0: 7320 3d20 6e6c 2e6a 6f69 6e28 5b22 6465  s = nl.join(["de
+0000ef00: 6620 6628 2020 293a 222c 2022 2020 2020  f f(  ):", "    
+0000ef10: 7061 7373 225d 290a 2020 2020 2020 2020  pass"]).        
+0000ef20: 2020 2020 2020 2020 7465 7374 5f66 696c          test_fil
+0000ef30: 652e 7772 6974 655f 6279 7465 7328 636f  e.write_bytes(co
+0000ef40: 6e74 656e 7473 2e65 6e63 6f64 6528 2929  ntents.encode())
+0000ef50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ef60: 2066 6628 7465 7374 5f66 696c 652c 2077   ff(test_file, w
+0000ef70: 7269 7465 5f62 6163 6b3d 6365 7263 6973  rite_back=cercis
+0000ef80: 2e57 7269 7465 4261 636b 2e59 4553 290a  .WriteBack.YES).
+0000ef90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000efa0: 7570 6461 7465 645f 636f 6e74 656e 7473  updated_contents
+0000efb0: 3a20 6279 7465 7320 3d20 7465 7374 5f66  : bytes = test_f
+0000efc0: 696c 652e 7265 6164 5f62 7974 6573 2829  ile.read_bytes()
+0000efd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000efe0: 2073 656c 662e 6173 7365 7274 496e 286e   self.assertIn(n
+0000eff0: 6c2e 656e 636f 6465 2829 2c20 7570 6461  l.encode(), upda
+0000f000: 7465 645f 636f 6e74 656e 7473 290a 2020  ted_contents).  
+0000f010: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0000f020: 206e 6c20 3d3d 2022 5c6e 223a 0a20 2020   nl == "\n":.   
+0000f030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f040: 2073 656c 662e 6173 7365 7274 4e6f 7449   self.assertNotI
+0000f050: 6e28 6222 5c72 5c6e 222c 2075 7064 6174  n(b"\r\n", updat
+0000f060: 6564 5f63 6f6e 7465 6e74 7329 0a0a 2020  ed_contents)..  
+0000f070: 2020 6465 6620 7465 7374 5f70 7265 7365    def test_prese
+0000f080: 7276 6573 5f6c 696e 655f 656e 6469 6e67  rves_line_ending
+0000f090: 735f 7669 615f 7374 6469 6e28 7365 6c66  s_via_stdin(self
+0000f0a0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+0000f0b0: 2020 2066 6f72 206e 6c20 696e 205b 225c     for nl in ["\
+0000f0c0: 6e22 2c20 225c 725c 6e22 5d3a 0a20 2020  n", "\r\n"]:.   
+0000f0d0: 2020 2020 2020 2020 2063 6f6e 7465 6e74           content
+0000f0e0: 7320 3d20 6e6c 2e6a 6f69 6e28 5b22 6465  s = nl.join(["de
+0000f0f0: 6620 6628 2020 293a 222c 2022 2020 2020  f f(  ):", "    
+0000f100: 7061 7373 225d 290a 2020 2020 2020 2020  pass"]).        
+0000f110: 2020 2020 7275 6e6e 6572 203d 2042 6c61      runner = Bla
+0000f120: 636b 5275 6e6e 6572 2829 0a20 2020 2020  ckRunner().     
+0000f130: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+0000f140: 7275 6e6e 6572 2e69 6e76 6f6b 6528 0a20  runner.invoke(. 
+0000f150: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0000f160: 6572 6369 732e 6d61 696e 2c20 5b22 2d22  ercis.main, ["-"
+0000f170: 2c20 222d 2d66 6173 7422 5d2c 2069 6e70  , "--fast"], inp
+0000f180: 7574 3d42 7974 6573 494f 2863 6f6e 7465  ut=BytesIO(conte
+0000f190: 6e74 732e 656e 636f 6465 2822 7574 662d  nts.encode("utf-
+0000f1a0: 3822 2929 0a20 2020 2020 2020 2020 2020  8")).           
+0000f1b0: 2029 0a20 2020 2020 2020 2020 2020 2073   ).            s
+0000f1c0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+0000f1d0: 7265 7375 6c74 2e65 7869 745f 636f 6465  result.exit_code
+0000f1e0: 2c20 3029 0a20 2020 2020 2020 2020 2020  , 0).           
+0000f1f0: 206f 7574 7075 7420 3d20 7265 7375 6c74   output = result
+0000f200: 2e73 7464 6f75 745f 6279 7465 730a 2020  .stdout_bytes.  
+0000f210: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+0000f220: 7373 6572 7449 6e28 6e6c 2e65 6e63 6f64  ssertIn(nl.encod
+0000f230: 6528 2275 7466 2d38 2229 2c20 6f75 7470  e("utf-8"), outp
+0000f240: 7574 290a 2020 2020 2020 2020 2020 2020  ut).            
+0000f250: 6966 206e 6c20 3d3d 2022 5c6e 223a 0a20  if nl == "\n":. 
+0000f260: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000f270: 656c 662e 6173 7365 7274 4e6f 7449 6e28  elf.assertNotIn(
+0000f280: 6222 5c72 5c6e 222c 206f 7574 7075 7429  b"\r\n", output)
+0000f290: 0a0a 2020 2020 6465 6620 7465 7374 5f6e  ..    def test_n
+0000f2a0: 6f72 6d61 6c69 7a65 5f6c 696e 655f 656e  ormalize_line_en
+0000f2b0: 6469 6e67 7328 7365 6c66 2920 2d3e 204e  dings(self) -> N
+0000f2c0: 6f6e 653a 0a20 2020 2020 2020 2077 6974  one:.        wit
+0000f2d0: 6820 5465 6d70 6f72 6172 7944 6972 6563  h TemporaryDirec
+0000f2e0: 746f 7279 2829 2061 7320 776f 726b 7370  tory() as worksp
+0000f2f0: 6163 653a 0a20 2020 2020 2020 2020 2020  ace:.           
+0000f300: 2074 6573 745f 6669 6c65 203d 2050 6174   test_file = Pat
+0000f310: 6828 776f 726b 7370 6163 6529 202f 2022  h(workspace) / "
+0000f320: 7465 7374 2e70 7922 0a20 2020 2020 2020  test.py".       
+0000f330: 2020 2020 2066 6f72 2064 6174 612c 2065       for data, e
+0000f340: 7870 6563 7465 6420 696e 2028 0a20 2020  xpected in (.   
+0000f350: 2020 2020 2020 2020 2020 2020 2028 6222               (b"
+0000f360: 635c 725c 6e63 5c6e 2022 2c20 6222 635c  c\r\nc\n ", b"c\
+0000f370: 725c 6e63 5c72 5c6e 2229 2c0a 2020 2020  r\nc\r\n"),.    
+0000f380: 2020 2020 2020 2020 2020 2020 2862 226c              (b"l
+0000f390: 5c6e 6c5c 725c 6e20 222c 2062 226c 5c6e  \nl\r\n ", b"l\n
+0000f3a0: 6c5c 6e22 292c 0a20 2020 2020 2020 2020  l\n"),.         
+0000f3b0: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+0000f3c0: 2020 2020 2020 7465 7374 5f66 696c 652e        test_file.
+0000f3d0: 7772 6974 655f 6279 7465 7328 6461 7461  write_bytes(data
+0000f3e0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000f3f0: 2020 6666 2874 6573 745f 6669 6c65 2c20    ff(test_file, 
+0000f400: 7772 6974 655f 6261 636b 3d63 6572 6369  write_back=cerci
+0000f410: 732e 5772 6974 6542 6163 6b2e 5945 5329  s.WriteBack.YES)
+0000f420: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f430: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+0000f440: 6c28 7465 7374 5f66 696c 652e 7265 6164  l(test_file.read
+0000f450: 5f62 7974 6573 2829 2c20 6578 7065 6374  _bytes(), expect
+0000f460: 6564 290a 0a20 2020 2064 6566 2074 6573  ed)..    def tes
+0000f470: 745f 6173 7365 7274 5f65 7175 6976 616c  t_assert_equival
+0000f480: 656e 745f 6469 6666 6572 656e 745f 6173  ent_different_as
+0000f490: 7473 2873 656c 6629 202d 3e20 4e6f 6e65  ts(self) -> None
+0000f4a0: 3a0a 2020 2020 2020 2020 7769 7468 2073  :.        with s
+0000f4b0: 656c 662e 6173 7365 7274 5261 6973 6573  elf.assertRaises
+0000f4c0: 2841 7373 6572 7469 6f6e 4572 726f 7229  (AssertionError)
+0000f4d0: 3a0a 2020 2020 2020 2020 2020 2020 6365  :.            ce
+0000f4e0: 7263 6973 2e61 7373 6572 745f 6571 7569  rcis.assert_equi
+0000f4f0: 7661 6c65 6e74 2822 7b7d 222c 2022 4e6f  valent("{}", "No
+0000f500: 6e65 2229 0a0a 2020 2020 6465 6620 7465  ne")..    def te
+0000f510: 7374 5f72 6f6f 745f 6c6f 6767 6572 5f6e  st_root_logger_n
+0000f520: 6f74 5f75 7365 645f 6469 7265 6374 6c79  ot_used_directly
+0000f530: 2873 656c 6629 202d 3e20 4e6f 6e65 3a0a  (self) -> None:.
+0000f540: 2020 2020 2020 2020 6465 6620 6661 696c          def fail
+0000f550: 282a 6172 6773 3a20 416e 792c 202a 2a6b  (*args: Any, **k
+0000f560: 7761 7267 733a 2041 6e79 2920 2d3e 204e  wargs: Any) -> N
+0000f570: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+0000f580: 2073 656c 662e 6661 696c 2822 5265 636f   self.fail("Reco
+0000f590: 7264 2063 7265 6174 6564 2077 6974 6820  rd created with 
+0000f5a0: 726f 6f74 206c 6f67 6765 7222 290a 0a20  root logger").. 
+0000f5b0: 2020 2020 2020 2077 6974 6820 7061 7463         with patc
+0000f5c0: 682e 6d75 6c74 6970 6c65 280a 2020 2020  h.multiple(.    
+0000f5d0: 2020 2020 2020 2020 6c6f 6767 696e 672e          logging.
+0000f5e0: 726f 6f74 2c0a 2020 2020 2020 2020 2020  root,.          
+0000f5f0: 2020 6465 6275 673d 6661 696c 2c0a 2020    debug=fail,.  
+0000f600: 2020 2020 2020 2020 2020 696e 666f 3d66            info=f
+0000f610: 6169 6c2c 0a20 2020 2020 2020 2020 2020  ail,.           
+0000f620: 2077 6172 6e69 6e67 3d66 6169 6c2c 0a20   warning=fail,. 
+0000f630: 2020 2020 2020 2020 2020 2065 7272 6f72             error
+0000f640: 3d66 6169 6c2c 0a20 2020 2020 2020 2020  =fail,.         
+0000f650: 2020 2063 7269 7469 6361 6c3d 6661 696c     critical=fail
+0000f660: 2c0a 2020 2020 2020 2020 2020 2020 6c6f  ,.            lo
+0000f670: 673d 6661 696c 2c0a 2020 2020 2020 2020  g=fail,.        
+0000f680: 293a 0a20 2020 2020 2020 2020 2020 2066  ):.            f
+0000f690: 6628 5448 4953 5f44 4952 202f 2022 7574  f(THIS_DIR / "ut
+0000f6a0: 696c 2e70 7922 290a 0a20 2020 2064 6566  il.py")..    def
+0000f6b0: 2074 6573 745f 696e 7661 6c69 645f 636f   test_invalid_co
+0000f6c0: 6e66 6967 5f72 6574 7572 6e5f 636f 6465  nfig_return_code
+0000f6d0: 2873 656c 6629 202d 3e20 4e6f 6e65 3a0a  (self) -> None:.
+0000f6e0: 2020 2020 2020 2020 746d 705f 6669 6c65          tmp_file
+0000f6f0: 203d 2050 6174 6828 6365 7263 6973 2e64   = Path(cercis.d
+0000f700: 756d 705f 746f 5f66 696c 6528 2929 0a20  ump_to_file()). 
+0000f710: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+0000f720: 2020 2020 2020 2020 746d 705f 636f 6e66          tmp_conf
+0000f730: 6967 203d 2050 6174 6828 6365 7263 6973  ig = Path(cercis
+0000f740: 2e64 756d 705f 746f 5f66 696c 6528 2929  .dump_to_file())
+0000f750: 0a20 2020 2020 2020 2020 2020 2074 6d70  .            tmp
+0000f760: 5f63 6f6e 6669 672e 756e 6c69 6e6b 2829  _config.unlink()
+0000f770: 0a20 2020 2020 2020 2020 2020 2061 7267  .            arg
+0000f780: 7320 3d20 5b22 2d2d 636f 6e66 6967 222c  s = ["--config",
+0000f790: 2073 7472 2874 6d70 5f63 6f6e 6669 6729   str(tmp_config)
+0000f7a0: 2c20 7374 7228 746d 705f 6669 6c65 295d  , str(tmp_file)]
+0000f7b0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000f7c0: 662e 696e 766f 6b65 426c 6163 6b28 6172  f.invokeBlack(ar
+0000f7d0: 6773 2c20 6578 6974 5f63 6f64 653d 322c  gs, exit_code=2,
+0000f7e0: 2069 676e 6f72 655f 636f 6e66 6967 3d46   ignore_config=F
+0000f7f0: 616c 7365 290a 2020 2020 2020 2020 6669  alse).        fi
+0000f800: 6e61 6c6c 793a 0a20 2020 2020 2020 2020  nally:.         
+0000f810: 2020 2074 6d70 5f66 696c 652e 756e 6c69     tmp_file.unli
+0000f820: 6e6b 2829 0a0a 2020 2020 6465 6620 7465  nk()..    def te
+0000f830: 7374 5f70 6172 7365 5f70 7970 726f 6a65  st_parse_pyproje
+0000f840: 6374 5f74 6f6d 6c28 7365 6c66 2920 2d3e  ct_toml(self) ->
+0000f850: 204e 6f6e 653a 0a20 2020 2020 2020 2074   None:.        t
+0000f860: 6573 745f 746f 6d6c 5f66 696c 6520 3d20  est_toml_file = 
+0000f870: 5448 4953 5f44 4952 202f 2022 7465 7374  THIS_DIR / "test
+0000f880: 2e74 6f6d 6c22 0a20 2020 2020 2020 2063  .toml".        c
+0000f890: 6f6e 6669 6720 3d20 6365 7263 6973 2e70  onfig = cercis.p
+0000f8a0: 6172 7365 5f70 7970 726f 6a65 6374 5f74  arse_pyproject_t
+0000f8b0: 6f6d 6c28 7374 7228 7465 7374 5f74 6f6d  oml(str(test_tom
+0000f8c0: 6c5f 6669 6c65 2929 0a20 2020 2020 2020  l_file)).       
+0000f8d0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+0000f8e0: 6c28 636f 6e66 6967 5b22 7665 7262 6f73  l(config["verbos
+0000f8f0: 6522 5d2c 2031 290a 2020 2020 2020 2020  e"], 1).        
+0000f900: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+0000f910: 2863 6f6e 6669 675b 2263 6865 636b 225d  (config["check"]
+0000f920: 2c20 226e 6f22 290a 2020 2020 2020 2020  , "no").        
+0000f930: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+0000f940: 2863 6f6e 6669 675b 2264 6966 6622 5d2c  (config["diff"],
+0000f950: 2022 7922 290a 2020 2020 2020 2020 7365   "y").        se
+0000f960: 6c66 2e61 7373 6572 7445 7175 616c 2863  lf.assertEqual(c
+0000f970: 6f6e 6669 675b 2263 6f6c 6f72 225d 2c20  onfig["color"], 
+0000f980: 5472 7565 290a 2020 2020 2020 2020 7365  True).        se
+0000f990: 6c66 2e61 7373 6572 7445 7175 616c 2863  lf.assertEqual(c
+0000f9a0: 6f6e 6669 675b 226c 696e 655f 6c65 6e67  onfig["line_leng
+0000f9b0: 7468 225d 2c20 3739 290a 2020 2020 2020  th"], 79).      
+0000f9c0: 2020 7365 6c66 2e61 7373 6572 7445 7175    self.assertEqu
+0000f9d0: 616c 2863 6f6e 6669 675b 2274 6172 6765  al(config["targe
+0000f9e0: 745f 7665 7273 696f 6e22 5d2c 205b 2270  t_version"], ["p
+0000f9f0: 7933 3622 2c20 2270 7933 3722 2c20 2270  y36", "py37", "p
+0000fa00: 7933 3822 5d29 0a20 2020 2020 2020 2073  y38"]).        s
+0000fa10: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+0000fa20: 636f 6e66 6967 5b22 7079 7468 6f6e 5f63  config["python_c
+0000fa30: 656c 6c5f 6d61 6769 6373 225d 2c20 5b22  ell_magics"], ["
+0000fa40: 6375 7374 6f6d 3122 2c20 2263 7573 746f  custom1", "custo
+0000fa50: 6d32 225d 290a 2020 2020 2020 2020 7365  m2"]).        se
+0000fa60: 6c66 2e61 7373 6572 7445 7175 616c 2863  lf.assertEqual(c
+0000fa70: 6f6e 6669 675b 2265 7863 6c75 6465 225d  onfig["exclude"]
+0000fa80: 2c20 7222 5c2e 7079 693f 2422 290a 2020  , r"\.pyi?$").  
+0000fa90: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+0000faa0: 7445 7175 616c 2863 6f6e 6669 675b 2269  tEqual(config["i
+0000fab0: 6e63 6c75 6465 225d 2c20 7222 5c2e 7079  nclude"], r"\.py
+0000fac0: 3f24 2229 0a0a 2020 2020 6465 6620 7465  ?$")..    def te
+0000fad0: 7374 5f70 6172 7365 5f70 7970 726f 6a65  st_parse_pyproje
+0000fae0: 6374 5f74 6f6d 6c5f 7072 6f6a 6563 745f  ct_toml_project_
+0000faf0: 6d65 7461 6461 7461 2873 656c 6629 202d  metadata(self) -
+0000fb00: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+0000fb10: 666f 7220 7465 7374 5f74 6f6d 6c2c 2065  for test_toml, e
+0000fb20: 7870 6563 7465 6420 696e 205b 0a20 2020  xpected in [.   
+0000fb30: 2020 2020 2020 2020 2028 226f 6e6c 795f           ("only_
+0000fb40: 626c 6163 6b5f 7079 7072 6f6a 6563 742e  black_pyproject.
+0000fb50: 746f 6d6c 222c 205b 2270 7933 3130 225d  toml", ["py310"]
+0000fb60: 292c 0a20 2020 2020 2020 2020 2020 2028  ),.            (
+0000fb70: 226f 6e6c 795f 6d65 7461 6461 7461 5f70  "only_metadata_p
+0000fb80: 7970 726f 6a65 6374 2e74 6f6d 6c22 2c20  yproject.toml", 
+0000fb90: 5b22 7079 3337 222c 2022 7079 3338 222c  ["py37", "py38",
+0000fba0: 2022 7079 3339 222c 2022 7079 3331 3022   "py39", "py310"
+0000fbb0: 5d29 2c0a 2020 2020 2020 2020 2020 2020  ]),.            
+0000fbc0: 2822 6e65 6974 6865 725f 7079 7072 6f6a  ("neither_pyproj
+0000fbd0: 6563 742e 746f 6d6c 222c 204e 6f6e 6529  ect.toml", None)
+0000fbe0: 2c0a 2020 2020 2020 2020 2020 2020 2822  ,.            ("
+0000fbf0: 626f 7468 5f70 7970 726f 6a65 6374 2e74  both_pyproject.t
+0000fc00: 6f6d 6c22 2c20 5b22 7079 3331 3022 5d29  oml", ["py310"])
+0000fc10: 2c0a 2020 2020 2020 2020 5d3a 0a20 2020  ,.        ]:.   
+0000fc20: 2020 2020 2020 2020 2074 6573 745f 746f           test_to
+0000fc30: 6d6c 5f66 696c 6520 3d20 5448 4953 5f44  ml_file = THIS_D
+0000fc40: 4952 202f 2022 6461 7461 2220 2f20 2270  IR / "data" / "p
+0000fc50: 726f 6a65 6374 5f6d 6574 6164 6174 6122  roject_metadata"
+0000fc60: 202f 2074 6573 745f 746f 6d6c 0a20 2020   / test_toml.   
+0000fc70: 2020 2020 2020 2020 2063 6f6e 6669 6720           config 
+0000fc80: 3d20 6365 7263 6973 2e70 6172 7365 5f70  = cercis.parse_p
+0000fc90: 7970 726f 6a65 6374 5f74 6f6d 6c28 7374  yproject_toml(st
+0000fca0: 7228 7465 7374 5f74 6f6d 6c5f 6669 6c65  r(test_toml_file
+0000fcb0: 2929 0a20 2020 2020 2020 2020 2020 2073  )).            s
+0000fcc0: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+0000fcd0: 636f 6e66 6967 2e67 6574 2822 7461 7267  config.get("targ
+0000fce0: 6574 5f76 6572 7369 6f6e 2229 2c20 6578  et_version"), ex
+0000fcf0: 7065 6374 6564 290a 0a20 2020 2064 6566  pected)..    def
+0000fd00: 2074 6573 745f 696e 6665 725f 7461 7267   test_infer_targ
+0000fd10: 6574 5f76 6572 7369 6f6e 2873 656c 6629  et_version(self)
+0000fd20: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+0000fd30: 2020 666f 7220 7665 7273 696f 6e2c 2065    for version, e
+0000fd40: 7870 6563 7465 6420 696e 205b 0a20 2020  xpected in [.   
+0000fd50: 2020 2020 2020 2020 2028 2233 2e36 222c           ("3.6",
+0000fd60: 205b 5461 7267 6574 5665 7273 696f 6e2e   [TargetVersion.
+0000fd70: 5059 3336 5d29 2c0a 2020 2020 2020 2020  PY36]),.        
+0000fd80: 2020 2020 2822 332e 3131 2e30 7263 3122      ("3.11.0rc1"
+0000fd90: 2c20 5b54 6172 6765 7456 6572 7369 6f6e  , [TargetVersion
+0000fda0: 2e50 5933 3131 5d29 2c0a 2020 2020 2020  .PY311]),.      
+0000fdb0: 2020 2020 2020 2822 3e3d 332e 3130 222c        (">=3.10",
+0000fdc0: 205b 5461 7267 6574 5665 7273 696f 6e2e   [TargetVersion.
+0000fdd0: 5059 3331 302c 2054 6172 6765 7456 6572  PY310, TargetVer
+0000fde0: 7369 6f6e 2e50 5933 3131 2c20 5461 7267  sion.PY311, Targ
+0000fdf0: 6574 5665 7273 696f 6e2e 5059 3331 325d  etVersion.PY312]
+0000fe00: 292c 0a20 2020 2020 2020 2020 2020 2028  ),.            (
+0000fe10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000fe20: 2022 3e3d 332e 3130 2e36 222c 0a20 2020   ">=3.10.6",.   
+0000fe30: 2020 2020 2020 2020 2020 2020 205b 5461               [Ta
+0000fe40: 7267 6574 5665 7273 696f 6e2e 5059 3331  rgetVersion.PY31
+0000fe50: 302c 2054 6172 6765 7456 6572 7369 6f6e  0, TargetVersion
+0000fe60: 2e50 5933 3131 2c20 5461 7267 6574 5665  .PY311, TargetVe
+0000fe70: 7273 696f 6e2e 5059 3331 325d 2c0a 2020  rsion.PY312],.  
+0000fe80: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
+0000fe90: 2020 2020 2020 2020 2028 223c 332e 3622           ("<3.6"
+0000fea0: 2c20 5b54 6172 6765 7456 6572 7369 6f6e  , [TargetVersion
+0000feb0: 2e50 5933 332c 2054 6172 6765 7456 6572  .PY33, TargetVer
+0000fec0: 7369 6f6e 2e50 5933 342c 2054 6172 6765  sion.PY34, Targe
+0000fed0: 7456 6572 7369 6f6e 2e50 5933 355d 292c  tVersion.PY35]),
+0000fee0: 0a20 2020 2020 2020 2020 2020 2028 223e  .            (">
+0000fef0: 332e 372c 3c33 2e31 3022 2c20 5b54 6172  3.7,<3.10", [Tar
+0000ff00: 6765 7456 6572 7369 6f6e 2e50 5933 382c  getVersion.PY38,
+0000ff10: 2054 6172 6765 7456 6572 7369 6f6e 2e50   TargetVersion.P
+0000ff20: 5933 395d 292c 0a20 2020 2020 2020 2020  Y39]),.         
+0000ff30: 2020 2028 0a20 2020 2020 2020 2020 2020     (.           
+0000ff40: 2020 2020 2022 3e33 2e37 2c21 3d33 2e38       ">3.7,!=3.8
+0000ff50: 2c21 3d33 2e39 222c 0a20 2020 2020 2020  ,!=3.9",.       
+0000ff60: 2020 2020 2020 2020 205b 5461 7267 6574           [Target
+0000ff70: 5665 7273 696f 6e2e 5059 3331 302c 2054  Version.PY310, T
+0000ff80: 6172 6765 7456 6572 7369 6f6e 2e50 5933  argetVersion.PY3
+0000ff90: 3131 2c20 5461 7267 6574 5665 7273 696f  11, TargetVersio
+0000ffa0: 6e2e 5059 3331 325d 2c0a 2020 2020 2020  n.PY312],.      
+0000ffb0: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
+0000ffc0: 2020 2020 2028 0a20 2020 2020 2020 2020       (.         
+0000ffd0: 2020 2020 2020 2022 3e20 332e 392e 342c         "> 3.9.4,
+0000ffe0: 2021 3d20 332e 3130 2e33 222c 0a20 2020   != 3.10.3",.   
+0000fff0: 2020 2020 2020 2020 2020 2020 205b 0a20               [. 
+00010000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010010: 2020 2054 6172 6765 7456 6572 7369 6f6e     TargetVersion
+00010020: 2e50 5933 392c 0a20 2020 2020 2020 2020  .PY39,.         
+00010030: 2020 2020 2020 2020 2020 2054 6172 6765             Targe
+00010040: 7456 6572 7369 6f6e 2e50 5933 3130 2c0a  tVersion.PY310,.
+00010050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010060: 2020 2020 5461 7267 6574 5665 7273 696f      TargetVersio
+00010070: 6e2e 5059 3331 312c 0a20 2020 2020 2020  n.PY311,.       
+00010080: 2020 2020 2020 2020 2020 2020 2054 6172               Tar
+00010090: 6765 7456 6572 7369 6f6e 2e50 5933 3132  getVersion.PY312
+000100a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000100b0: 2020 5d2c 0a20 2020 2020 2020 2020 2020    ],.           
+000100c0: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
+000100d0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000100e0: 2020 2221 3d33 2e33 2c21 3d33 2e34 222c    "!=3.3,!=3.4",
+000100f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010100: 205b 0a20 2020 2020 2020 2020 2020 2020   [.             
+00010110: 2020 2020 2020 2054 6172 6765 7456 6572         TargetVer
+00010120: 7369 6f6e 2e50 5933 352c 0a20 2020 2020  sion.PY35,.     
+00010130: 2020 2020 2020 2020 2020 2020 2020 2054                 T
+00010140: 6172 6765 7456 6572 7369 6f6e 2e50 5933  argetVersion.PY3
+00010150: 362c 0a20 2020 2020 2020 2020 2020 2020  6,.             
+00010160: 2020 2020 2020 2054 6172 6765 7456 6572         TargetVer
+00010170: 7369 6f6e 2e50 5933 372c 0a20 2020 2020  sion.PY37,.     
+00010180: 2020 2020 2020 2020 2020 2020 2020 2054                 T
+00010190: 6172 6765 7456 6572 7369 6f6e 2e50 5933  argetVersion.PY3
+000101a0: 382c 0a20 2020 2020 2020 2020 2020 2020  8,.             
+000101b0: 2020 2020 2020 2054 6172 6765 7456 6572         TargetVer
+000101c0: 7369 6f6e 2e50 5933 392c 0a20 2020 2020  sion.PY39,.     
+000101d0: 2020 2020 2020 2020 2020 2020 2020 2054                 T
+000101e0: 6172 6765 7456 6572 7369 6f6e 2e50 5933  argetVersion.PY3
+000101f0: 3130 2c0a 2020 2020 2020 2020 2020 2020  10,.            
+00010200: 2020 2020 2020 2020 5461 7267 6574 5665          TargetVe
+00010210: 7273 696f 6e2e 5059 3331 312c 0a20 2020  rsion.PY311,.   
+00010220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010230: 2054 6172 6765 7456 6572 7369 6f6e 2e50   TargetVersion.P
+00010240: 5933 3132 2c0a 2020 2020 2020 2020 2020  Y312,.          
+00010250: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
+00010260: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
+00010270: 2020 2020 280a 2020 2020 2020 2020 2020      (.          
+00010280: 2020 2020 2020 223d 3d33 2e2a 222c 0a20        "==3.*",. 
+00010290: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+000102a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000102b0: 2020 2020 2054 6172 6765 7456 6572 7369       TargetVersi
+000102c0: 6f6e 2e50 5933 332c 0a20 2020 2020 2020  on.PY33,.       
+000102d0: 2020 2020 2020 2020 2020 2020 2054 6172               Tar
+000102e0: 6765 7456 6572 7369 6f6e 2e50 5933 342c  getVersion.PY34,
+000102f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010300: 2020 2020 2054 6172 6765 7456 6572 7369       TargetVersi
+00010310: 6f6e 2e50 5933 352c 0a20 2020 2020 2020  on.PY35,.       
+00010320: 2020 2020 2020 2020 2020 2020 2054 6172               Tar
+00010330: 6765 7456 6572 7369 6f6e 2e50 5933 362c  getVersion.PY36,
+00010340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010350: 2020 2020 2054 6172 6765 7456 6572 7369       TargetVersi
+00010360: 6f6e 2e50 5933 372c 0a20 2020 2020 2020  on.PY37,.       
+00010370: 2020 2020 2020 2020 2020 2020 2054 6172               Tar
+00010380: 6765 7456 6572 7369 6f6e 2e50 5933 382c  getVersion.PY38,
+00010390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000103a0: 2020 2020 2054 6172 6765 7456 6572 7369       TargetVersi
+000103b0: 6f6e 2e50 5933 392c 0a20 2020 2020 2020  on.PY39,.       
+000103c0: 2020 2020 2020 2020 2020 2020 2054 6172               Tar
+000103d0: 6765 7456 6572 7369 6f6e 2e50 5933 3130  getVersion.PY310
+000103e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000103f0: 2020 2020 2020 5461 7267 6574 5665 7273        TargetVers
+00010400: 696f 6e2e 5059 3331 312c 0a20 2020 2020  ion.PY311,.     
+00010410: 2020 2020 2020 2020 2020 2020 2020 2054                 T
+00010420: 6172 6765 7456 6572 7369 6f6e 2e50 5933  argetVersion.PY3
+00010430: 3132 2c0a 2020 2020 2020 2020 2020 2020  12,.            
+00010440: 2020 2020 5d2c 0a20 2020 2020 2020 2020      ],.         
+00010450: 2020 2029 2c0a 2020 2020 2020 2020 2020     ),.          
+00010460: 2020 2822 3d3d 332e 382e 2a22 2c20 5b54    ("==3.8.*", [T
+00010470: 6172 6765 7456 6572 7369 6f6e 2e50 5933  argetVersion.PY3
+00010480: 385d 292c 0a20 2020 2020 2020 2020 2020  8]),.           
+00010490: 2028 4e6f 6e65 2c20 4e6f 6e65 292c 0a20   (None, None),. 
+000104a0: 2020 2020 2020 2020 2020 2028 2222 2c20             ("", 
+000104b0: 4e6f 6e65 292c 0a20 2020 2020 2020 2020  None),.         
+000104c0: 2020 2028 2269 6e76 616c 6964 222c 204e     ("invalid", N
+000104d0: 6f6e 6529 2c0a 2020 2020 2020 2020 2020  one),.          
+000104e0: 2020 2822 3d3d 696e 7661 6c69 6422 2c20    ("==invalid", 
+000104f0: 4e6f 6e65 292c 0a20 2020 2020 2020 2020  None),.         
+00010500: 2020 2028 223e 332e 392c 213d 696e 7661     (">3.9,!=inva
+00010510: 6c69 6422 2c20 4e6f 6e65 292c 0a20 2020  lid", None),.   
+00010520: 2020 2020 2020 2020 2028 2233 222c 204e           ("3", N
+00010530: 6f6e 6529 2c0a 2020 2020 2020 2020 2020  one),.          
+00010540: 2020 2822 332e 3222 2c20 4e6f 6e65 292c    ("3.2", None),
+00010550: 0a20 2020 2020 2020 2020 2020 2028 2232  .            ("2
+00010560: 2e37 2e31 3822 2c20 4e6f 6e65 292c 0a20  .7.18", None),. 
+00010570: 2020 2020 2020 2020 2020 2028 223d 3d32             ("==2
+00010580: 2e37 222c 204e 6f6e 6529 2c0a 2020 2020  .7", None),.    
+00010590: 2020 2020 2020 2020 2822 3e33 2e31 302c          (">3.10,
+000105a0: 3c33 2e31 3122 2c20 4e6f 6e65 292c 0a20  <3.11", None),. 
+000105b0: 2020 2020 2020 205d 3a0a 2020 2020 2020         ]:.      
+000105c0: 2020 2020 2020 7465 7374 5f74 6f6d 6c20        test_toml 
+000105d0: 3d20 7b22 7072 6f6a 6563 7422 3a20 7b22  = {"project": {"
+000105e0: 7265 7175 6972 6573 2d70 7974 686f 6e22  requires-python"
+000105f0: 3a20 7665 7273 696f 6e7d 7d0a 2020 2020  : version}}.    
+00010600: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
+00010610: 2063 6572 6369 732e 6669 6c65 732e 696e   cercis.files.in
+00010620: 6665 725f 7461 7267 6574 5f76 6572 7369  fer_target_versi
+00010630: 6f6e 2874 6573 745f 746f 6d6c 290a 2020  on(test_toml).  
+00010640: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00010650: 7373 6572 7445 7175 616c 2872 6573 756c  ssertEqual(resul
+00010660: 742c 2065 7870 6563 7465 6429 0a0a 2020  t, expected)..  
+00010670: 2020 6465 6620 7465 7374 5f72 6561 645f    def test_read_
+00010680: 7079 7072 6f6a 6563 745f 746f 6d6c 2873  pyproject_toml(s
+00010690: 656c 6629 202d 3e20 4e6f 6e65 3a0a 2020  elf) -> None:.  
+000106a0: 2020 2020 2020 7465 7374 5f74 6f6d 6c5f        test_toml_
+000106b0: 6669 6c65 203d 2054 4849 535f 4449 5220  file = THIS_DIR 
+000106c0: 2f20 2274 6573 742e 746f 6d6c 220a 2020  / "test.toml".  
+000106d0: 2020 2020 2020 6661 6b65 5f63 7478 203d        fake_ctx =
+000106e0: 2046 616b 6543 6f6e 7465 7874 2829 0a20   FakeContext(). 
+000106f0: 2020 2020 2020 2063 6572 6369 732e 7265         cercis.re
+00010700: 6164 5f70 7970 726f 6a65 6374 5f74 6f6d  ad_pyproject_tom
+00010710: 6c28 6661 6b65 5f63 7478 2c20 4661 6b65  l(fake_ctx, Fake
+00010720: 5061 7261 6d65 7465 7228 292c 2073 7472  Parameter(), str
+00010730: 2874 6573 745f 746f 6d6c 5f66 696c 6529  (test_toml_file)
+00010740: 290a 2020 2020 2020 2020 636f 6e66 6967  ).        config
+00010750: 203d 2066 616b 655f 6374 782e 6465 6661   = fake_ctx.defa
+00010760: 756c 745f 6d61 700a 2020 2020 2020 2020  ult_map.        
+00010770: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00010780: 2863 6f6e 6669 675b 2276 6572 626f 7365  (config["verbose
+00010790: 225d 2c20 2231 2229 0a20 2020 2020 2020  "], "1").       
+000107a0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+000107b0: 6c28 636f 6e66 6967 5b22 6368 6563 6b22  l(config["check"
+000107c0: 5d2c 2022 6e6f 2229 0a20 2020 2020 2020  ], "no").       
+000107d0: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+000107e0: 6c28 636f 6e66 6967 5b22 6469 6666 225d  l(config["diff"]
+000107f0: 2c20 2279 2229 0a20 2020 2020 2020 2073  , "y").        s
+00010800: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00010810: 636f 6e66 6967 5b22 636f 6c6f 7222 5d2c  config["color"],
+00010820: 2022 5472 7565 2229 0a20 2020 2020 2020   "True").       
+00010830: 2073 656c 662e 6173 7365 7274 4571 7561   self.assertEqua
+00010840: 6c28 636f 6e66 6967 5b22 6c69 6e65 5f6c  l(config["line_l
+00010850: 656e 6774 6822 5d2c 2022 3739 2229 0a20  ength"], "79"). 
+00010860: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00010870: 7274 4571 7561 6c28 636f 6e66 6967 5b22  rtEqual(config["
+00010880: 7461 7267 6574 5f76 6572 7369 6f6e 225d  target_version"]
+00010890: 2c20 5b22 7079 3336 222c 2022 7079 3337  , ["py36", "py37
+000108a0: 222c 2022 7079 3338 225d 290a 2020 2020  ", "py38"]).    
+000108b0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+000108c0: 7175 616c 2863 6f6e 6669 675b 2265 7863  qual(config["exc
+000108d0: 6c75 6465 225d 2c20 7222 5c2e 7079 693f  lude"], r"\.pyi?
+000108e0: 2422 290a 2020 2020 2020 2020 7365 6c66  $").        self
+000108f0: 2e61 7373 6572 7445 7175 616c 2863 6f6e  .assertEqual(con
+00010900: 6669 675b 2269 6e63 6c75 6465 225d 2c20  fig["include"], 
+00010910: 7222 5c2e 7079 3f24 2229 0a0a 2020 2020  r"\.py?$")..    
+00010920: 6465 6620 7465 7374 5f72 6561 645f 7079  def test_read_py
+00010930: 7072 6f6a 6563 745f 746f 6d6c 5f66 726f  project_toml_fro
+00010940: 6d5f 7374 6469 6e28 7365 6c66 2920 2d3e  m_stdin(self) ->
+00010950: 204e 6f6e 653a 0a20 2020 2020 2020 2077   None:.        w
+00010960: 6974 6820 5465 6d70 6f72 6172 7944 6972  ith TemporaryDir
+00010970: 6563 746f 7279 2829 2061 7320 776f 726b  ectory() as work
+00010980: 7370 6163 653a 0a20 2020 2020 2020 2020  space:.         
+00010990: 2020 2072 6f6f 7420 3d20 5061 7468 2877     root = Path(w
+000109a0: 6f72 6b73 7061 6365 290a 0a20 2020 2020  orkspace)..     
+000109b0: 2020 2020 2020 2073 7263 5f64 6972 203d         src_dir =
+000109c0: 2072 6f6f 7420 2f20 2273 7263 220a 2020   root / "src".  
+000109d0: 2020 2020 2020 2020 2020 7372 635f 6469            src_di
+000109e0: 722e 6d6b 6469 7228 290a 0a20 2020 2020  r.mkdir()..     
+000109f0: 2020 2020 2020 2073 7263 5f70 7970 726f         src_pypro
+00010a00: 6a65 6374 203d 2073 7263 5f64 6972 202f  ject = src_dir /
+00010a10: 2022 7079 7072 6f6a 6563 742e 746f 6d6c   "pyproject.toml
+00010a20: 220a 2020 2020 2020 2020 2020 2020 7372  ".            sr
+00010a30: 635f 7079 7072 6f6a 6563 742e 746f 7563  c_pyproject.touc
+00010a40: 6828 290a 0a20 2020 2020 2020 2020 2020  h()..           
+00010a50: 2074 6573 745f 746f 6d6c 5f63 6f6e 7465   test_toml_conte
+00010a60: 6e74 203d 2028 5448 4953 5f44 4952 202f  nt = (THIS_DIR /
+00010a70: 2022 7465 7374 2e74 6f6d 6c22 292e 7265   "test.toml").re
+00010a80: 6164 5f74 6578 7428 656e 636f 6469 6e67  ad_text(encoding
+00010a90: 3d22 7574 662d 3822 290a 2020 2020 2020  ="utf-8").      
+00010aa0: 2020 2020 2020 7372 635f 7079 7072 6f6a        src_pyproj
+00010ab0: 6563 742e 7772 6974 655f 7465 7874 2874  ect.write_text(t
+00010ac0: 6573 745f 746f 6d6c 5f63 6f6e 7465 6e74  est_toml_content
+00010ad0: 2c20 656e 636f 6469 6e67 3d22 7574 662d  , encoding="utf-
+00010ae0: 3822 290a 0a20 2020 2020 2020 2020 2020  8")..           
+00010af0: 2073 7263 5f70 7974 686f 6e20 3d20 7372   src_python = sr
+00010b00: 635f 6469 7220 2f20 2266 6f6f 2e70 7922  c_dir / "foo.py"
+00010b10: 0a20 2020 2020 2020 2020 2020 2073 7263  .            src
+00010b20: 5f70 7974 686f 6e2e 746f 7563 6828 290a  _python.touch().
+00010b30: 0a20 2020 2020 2020 2020 2020 2066 616b  .            fak
+00010b40: 655f 6374 7820 3d20 4661 6b65 436f 6e74  e_ctx = FakeCont
+00010b50: 6578 7428 290a 2020 2020 2020 2020 2020  ext().          
+00010b60: 2020 6661 6b65 5f63 7478 2e70 6172 616d    fake_ctx.param
+00010b70: 735b 2273 7263 225d 203d 2028 222d 222c  s["src"] = ("-",
+00010b80: 290a 2020 2020 2020 2020 2020 2020 6661  ).            fa
+00010b90: 6b65 5f63 7478 2e70 6172 616d 735b 2273  ke_ctx.params["s
+00010ba0: 7464 696e 5f66 696c 656e 616d 6522 5d20  tdin_filename"] 
+00010bb0: 3d20 7374 7228 7372 635f 7079 7468 6f6e  = str(src_python
+00010bc0: 290a 0a20 2020 2020 2020 2020 2020 2077  )..            w
+00010bd0: 6974 6820 6368 616e 6765 5f64 6972 6563  ith change_direc
+00010be0: 746f 7279 2872 6f6f 7429 3a0a 2020 2020  tory(root):.    
+00010bf0: 2020 2020 2020 2020 2020 2020 6365 7263              cerc
+00010c00: 6973 2e72 6561 645f 7079 7072 6f6a 6563  is.read_pyprojec
+00010c10: 745f 746f 6d6c 2866 616b 655f 6374 782c  t_toml(fake_ctx,
+00010c20: 2046 616b 6550 6172 616d 6574 6572 2829   FakeParameter()
+00010c30: 2c20 4e6f 6e65 290a 0a20 2020 2020 2020  , None)..       
+00010c40: 2020 2020 2063 6f6e 6669 6720 3d20 6661       config = fa
+00010c50: 6b65 5f63 7478 2e64 6566 6175 6c74 5f6d  ke_ctx.default_m
+00010c60: 6170 0a20 2020 2020 2020 2020 2020 2073  ap.            s
+00010c70: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00010c80: 636f 6e66 6967 5b22 7665 7262 6f73 6522  config["verbose"
+00010c90: 5d2c 2022 3122 290a 2020 2020 2020 2020  ], "1").        
+00010ca0: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00010cb0: 7175 616c 2863 6f6e 6669 675b 2263 6865  qual(config["che
+00010cc0: 636b 225d 2c20 226e 6f22 290a 2020 2020  ck"], "no").    
+00010cd0: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00010ce0: 6572 7445 7175 616c 2863 6f6e 6669 675b  ertEqual(config[
+00010cf0: 2264 6966 6622 5d2c 2022 7922 290a 2020  "diff"], "y").  
+00010d00: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00010d10: 7373 6572 7445 7175 616c 2863 6f6e 6669  ssertEqual(confi
+00010d20: 675b 2263 6f6c 6f72 225d 2c20 2254 7275  g["color"], "Tru
+00010d30: 6522 290a 2020 2020 2020 2020 2020 2020  e").            
+00010d40: 7365 6c66 2e61 7373 6572 7445 7175 616c  self.assertEqual
+00010d50: 2863 6f6e 6669 675b 226c 696e 655f 6c65  (config["line_le
+00010d60: 6e67 7468 225d 2c20 2237 3922 290a 2020  ngth"], "79").  
+00010d70: 2020 2020 2020 2020 2020 7365 6c66 2e61            self.a
+00010d80: 7373 6572 7445 7175 616c 2863 6f6e 6669  ssertEqual(confi
+00010d90: 675b 2274 6172 6765 745f 7665 7273 696f  g["target_versio
+00010da0: 6e22 5d2c 205b 2270 7933 3622 2c20 2270  n"], ["py36", "p
+00010db0: 7933 3722 2c20 2270 7933 3822 5d29 0a20  y37", "py38"]). 
+00010dc0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00010dd0: 6173 7365 7274 4571 7561 6c28 636f 6e66  assertEqual(conf
+00010de0: 6967 5b22 6578 636c 7564 6522 5d2c 2072  ig["exclude"], r
+00010df0: 225c 2e70 7969 3f24 2229 0a20 2020 2020  "\.pyi?$").     
+00010e00: 2020 2020 2020 2073 656c 662e 6173 7365         self.asse
+00010e10: 7274 4571 7561 6c28 636f 6e66 6967 5b22  rtEqual(config["
+00010e20: 696e 636c 7564 6522 5d2c 2072 225c 2e70  include"], r"\.p
+00010e30: 793f 2422 290a 0a20 2020 2040 7079 7465  y?$")..    @pyte
+00010e40: 7374 2e6d 6172 6b2e 696e 636f 6d70 6174  st.mark.incompat
+00010e50: 6962 6c65 5f77 6974 685f 6d79 7079 630a  ible_with_mypyc.
+00010e60: 2020 2020 6465 6620 7465 7374 5f66 696e      def test_fin
+00010e70: 645f 7072 6f6a 6563 745f 726f 6f74 2873  d_project_root(s
+00010e80: 656c 6629 202d 3e20 4e6f 6e65 3a0a 2020  elf) -> None:.  
+00010e90: 2020 2020 2020 7769 7468 2054 656d 706f        with Tempo
+00010ea0: 7261 7279 4469 7265 6374 6f72 7928 2920  raryDirectory() 
+00010eb0: 6173 2077 6f72 6b73 7061 6365 3a0a 2020  as workspace:.  
+00010ec0: 2020 2020 2020 2020 2020 726f 6f74 203d            root =
+00010ed0: 2050 6174 6828 776f 726b 7370 6163 6529   Path(workspace)
+00010ee0: 0a20 2020 2020 2020 2020 2020 2074 6573  .            tes
+00010ef0: 745f 6469 7220 3d20 726f 6f74 202f 2022  t_dir = root / "
+00010f00: 7465 7374 220a 2020 2020 2020 2020 2020  test".          
+00010f10: 2020 7465 7374 5f64 6972 2e6d 6b64 6972    test_dir.mkdir
+00010f20: 2829 0a0a 2020 2020 2020 2020 2020 2020  ()..            
+00010f30: 7372 635f 6469 7220 3d20 726f 6f74 202f  src_dir = root /
+00010f40: 2022 7372 6322 0a20 2020 2020 2020 2020   "src".         
+00010f50: 2020 2073 7263 5f64 6972 2e6d 6b64 6972     src_dir.mkdir
+00010f60: 2829 0a0a 2020 2020 2020 2020 2020 2020  ()..            
+00010f70: 726f 6f74 5f70 7970 726f 6a65 6374 203d  root_pyproject =
+00010f80: 2072 6f6f 7420 2f20 2270 7970 726f 6a65   root / "pyproje
+00010f90: 6374 2e74 6f6d 6c22 0a20 2020 2020 2020  ct.toml".       
+00010fa0: 2020 2020 2072 6f6f 745f 7079 7072 6f6a       root_pyproj
+00010fb0: 6563 742e 746f 7563 6828 290a 2020 2020  ect.touch().    
+00010fc0: 2020 2020 2020 2020 7372 635f 7079 7072          src_pypr
+00010fd0: 6f6a 6563 7420 3d20 7372 635f 6469 7220  oject = src_dir 
+00010fe0: 2f20 2270 7970 726f 6a65 6374 2e74 6f6d  / "pyproject.tom
+00010ff0: 6c22 0a20 2020 2020 2020 2020 2020 2073  l".            s
+00011000: 7263 5f70 7970 726f 6a65 6374 2e74 6f75  rc_pyproject.tou
+00011010: 6368 2829 0a20 2020 2020 2020 2020 2020  ch().           
+00011020: 2073 7263 5f70 7974 686f 6e20 3d20 7372   src_python = sr
+00011030: 635f 6469 7220 2f20 2266 6f6f 2e70 7922  c_dir / "foo.py"
+00011040: 0a20 2020 2020 2020 2020 2020 2073 7263  .            src
+00011050: 5f70 7974 686f 6e2e 746f 7563 6828 290a  _python.touch().
+00011060: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00011070: 662e 6173 7365 7274 4571 7561 6c28 0a20  f.assertEqual(. 
+00011080: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00011090: 6572 6369 732e 6669 6e64 5f70 726f 6a65  ercis.find_proje
+000110a0: 6374 5f72 6f6f 7428 2873 7263 5f64 6972  ct_root((src_dir
+000110b0: 2c20 7465 7374 5f64 6972 2929 2c0a 2020  , test_dir)),.  
+000110c0: 2020 2020 2020 2020 2020 2020 2020 2872                (r
+000110d0: 6f6f 742e 7265 736f 6c76 6528 292c 2022  oot.resolve(), "
+000110e0: 7079 7072 6f6a 6563 742e 746f 6d6c 2229  pyproject.toml")
+000110f0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+00011100: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00011110: 2e61 7373 6572 7445 7175 616c 280a 2020  .assertEqual(.  
+00011120: 2020 2020 2020 2020 2020 2020 2020 6365                ce
+00011130: 7263 6973 2e66 696e 645f 7072 6f6a 6563  rcis.find_projec
+00011140: 745f 726f 6f74 2828 7372 635f 6469 722c  t_root((src_dir,
+00011150: 2929 2c0a 2020 2020 2020 2020 2020 2020  )),.            
+00011160: 2020 2020 2873 7263 5f64 6972 2e72 6573      (src_dir.res
+00011170: 6f6c 7665 2829 2c20 2270 7970 726f 6a65  olve(), "pyproje
+00011180: 6374 2e74 6f6d 6c22 292c 0a20 2020 2020  ct.toml"),.     
+00011190: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000111a0: 2020 2020 2073 656c 662e 6173 7365 7274       self.assert
+000111b0: 4571 7561 6c28 0a20 2020 2020 2020 2020  Equal(.         
+000111c0: 2020 2020 2020 2063 6572 6369 732e 6669         cercis.fi
+000111d0: 6e64 5f70 726f 6a65 6374 5f72 6f6f 7428  nd_project_root(
+000111e0: 2873 7263 5f70 7974 686f 6e2c 2929 2c0a  (src_python,)),.
+000111f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011200: 2873 7263 5f64 6972 2e72 6573 6f6c 7665  (src_dir.resolve
+00011210: 2829 2c20 2270 7970 726f 6a65 6374 2e74  (), "pyproject.t
+00011220: 6f6d 6c22 292c 0a20 2020 2020 2020 2020  oml"),.         
+00011230: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
+00011240: 2020 7769 7468 2063 6861 6e67 655f 6469    with change_di
+00011250: 7265 6374 6f72 7928 7465 7374 5f64 6972  rectory(test_dir
+00011260: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00011270: 2020 2073 656c 662e 6173 7365 7274 4571     self.assertEq
+00011280: 7561 6c28 0a20 2020 2020 2020 2020 2020  ual(.           
+00011290: 2020 2020 2020 2020 2063 6572 6369 732e           cercis.
+000112a0: 6669 6e64 5f70 726f 6a65 6374 5f72 6f6f  find_project_roo
+000112b0: 7428 2822 2d22 2c29 2c20 7374 6469 6e5f  t(("-",), stdin_
+000112c0: 6669 6c65 6e61 6d65 3d22 2e2e 2f73 7263  filename="../src
+000112d0: 2f61 2e70 7922 292c 0a20 2020 2020 2020  /a.py"),.       
+000112e0: 2020 2020 2020 2020 2020 2020 2028 7372               (sr
+000112f0: 635f 6469 722e 7265 736f 6c76 6528 292c  c_dir.resolve(),
+00011300: 2022 7079 7072 6f6a 6563 742e 746f 6d6c   "pyproject.toml
+00011310: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
+00011320: 2020 2020 290a 0a20 2020 2040 7061 7463      )..    @patc
+00011330: 6828 0a20 2020 2020 2020 2022 6365 7263  h(.        "cerc
+00011340: 6973 2e66 696c 6573 2e66 696e 645f 7573  is.files.find_us
+00011350: 6572 5f70 7970 726f 6a65 6374 5f74 6f6d  er_pyproject_tom
+00011360: 6c22 2c0a 2020 2020 290a 2020 2020 6465  l",.    ).    de
+00011370: 6620 7465 7374 5f66 696e 645f 7079 7072  f test_find_pypr
+00011380: 6f6a 6563 745f 746f 6d6c 2873 656c 662c  oject_toml(self,
+00011390: 2066 696e 645f 7573 6572 5f70 7970 726f   find_user_pypro
+000113a0: 6a65 6374 5f74 6f6d 6c3a 204d 6167 6963  ject_toml: Magic
+000113b0: 4d6f 636b 2920 2d3e 204e 6f6e 653a 0a20  Mock) -> None:. 
+000113c0: 2020 2020 2020 2066 696e 645f 7573 6572         find_user
+000113d0: 5f70 7970 726f 6a65 6374 5f74 6f6d 6c2e  _pyproject_toml.
+000113e0: 7369 6465 5f65 6666 6563 7420 3d20 5275  side_effect = Ru
+000113f0: 6e74 696d 6545 7272 6f72 2829 0a0a 2020  ntimeError()..  
+00011400: 2020 2020 2020 7769 7468 2072 6564 6972        with redir
+00011410: 6563 745f 7374 6465 7272 2869 6f2e 5374  ect_stderr(io.St
+00011420: 7269 6e67 494f 2829 2920 6173 2073 7464  ringIO()) as std
+00011430: 6572 723a 0a20 2020 2020 2020 2020 2020  err:.           
+00011440: 2072 6573 756c 7420 3d20 6365 7263 6973   result = cercis
+00011450: 2e66 696c 6573 2e66 696e 645f 7079 7072  .files.find_pypr
+00011460: 6f6a 6563 745f 746f 6d6c 280a 2020 2020  oject_toml(.    
+00011470: 2020 2020 2020 2020 2020 2020 7061 7468              path
+00011480: 5f73 6561 7263 685f 7374 6172 743d 2873  _search_start=(s
+00011490: 7472 2850 6174 682e 6377 6428 292e 726f  tr(Path.cwd().ro
+000114a0: 6f74 292c 290a 2020 2020 2020 2020 2020  ot),).          
+000114b0: 2020 290a 0a20 2020 2020 2020 2061 7373    )..        ass
+000114c0: 6572 7420 7265 7375 6c74 2069 7320 4e6f  ert result is No
+000114d0: 6e65 0a20 2020 2020 2020 2065 7272 203d  ne.        err =
+000114e0: 2073 7464 6572 722e 6765 7476 616c 7565   stderr.getvalue
+000114f0: 2829 0a20 2020 2020 2020 2061 7373 6572  ().        asser
+00011500: 7420 2249 676e 6f72 696e 6720 7573 6572  t "Ignoring user
+00011510: 2063 6f6e 6669 6775 7261 7469 6f6e 2220   configuration" 
+00011520: 696e 2065 7272 0a0a 2020 2020 4070 6174  in err..    @pat
+00011530: 6368 280a 2020 2020 2020 2020 2263 6572  ch(.        "cer
+00011540: 6369 732e 6669 6c65 732e 6669 6e64 5f75  cis.files.find_u
+00011550: 7365 725f 7079 7072 6f6a 6563 745f 746f  ser_pyproject_to
+00011560: 6d6c 222c 0a20 2020 2020 2020 2063 6572  ml",.        cer
+00011570: 6369 732e 6669 6c65 732e 6669 6e64 5f75  cis.files.find_u
+00011580: 7365 725f 7079 7072 6f6a 6563 745f 746f  ser_pyproject_to
+00011590: 6d6c 2e5f 5f77 7261 7070 6564 5f5f 2c0a  ml.__wrapped__,.
+000115a0: 2020 2020 290a 2020 2020 6465 6620 7465      ).    def te
+000115b0: 7374 5f66 696e 645f 7573 6572 5f70 7970  st_find_user_pyp
+000115c0: 726f 6a65 6374 5f74 6f6d 6c5f 6c69 6e75  roject_toml_linu
+000115d0: 7828 7365 6c66 2920 2d3e 204e 6f6e 653a  x(self) -> None:
+000115e0: 0a20 2020 2020 2020 2069 6620 7379 7374  .        if syst
+000115f0: 656d 2829 203d 3d20 2257 696e 646f 7773  em() == "Windows
+00011600: 223a 0a20 2020 2020 2020 2020 2020 2072  ":.            r
+00011610: 6574 7572 6e0a 0a20 2020 2020 2020 2023  eturn..        #
+00011620: 2054 6573 7420 6966 2058 4447 5f43 4f4e   Test if XDG_CON
+00011630: 4649 475f 484f 4d45 2069 7320 6368 6563  FIG_HOME is chec
+00011640: 6b65 640a 2020 2020 2020 2020 7769 7468  ked.        with
+00011650: 2054 656d 706f 7261 7279 4469 7265 6374   TemporaryDirect
+00011660: 6f72 7928 2920 6173 2077 6f72 6b73 7061  ory() as workspa
+00011670: 6365 3a0a 2020 2020 2020 2020 2020 2020  ce:.            
+00011680: 746d 705f 7573 6572 5f63 6f6e 6669 6720  tmp_user_config 
+00011690: 3d20 5061 7468 2877 6f72 6b73 7061 6365  = Path(workspace
+000116a0: 2920 2f20 2263 6572 6369 7322 0a20 2020  ) / "cercis".   
+000116b0: 2020 2020 2020 2020 2077 6974 6820 7061           with pa
+000116c0: 7463 682e 6469 6374 2822 6f73 2e65 6e76  tch.dict("os.env
+000116d0: 6972 6f6e 222c 207b 2258 4447 5f43 4f4e  iron", {"XDG_CON
+000116e0: 4649 475f 484f 4d45 223a 2077 6f72 6b73  FIG_HOME": works
+000116f0: 7061 6365 7d29 3a0a 2020 2020 2020 2020  pace}):.        
+00011700: 2020 2020 2020 2020 7365 6c66 2e61 7373          self.ass
+00011710: 6572 7445 7175 616c 280a 2020 2020 2020  ertEqual(.      
+00011720: 2020 2020 2020 2020 2020 2020 2020 6365                ce
+00011730: 7263 6973 2e66 696c 6573 2e66 696e 645f  rcis.files.find_
+00011740: 7573 6572 5f70 7970 726f 6a65 6374 5f74  user_pyproject_t
+00011750: 6f6d 6c28 292c 2074 6d70 5f75 7365 725f  oml(), tmp_user_
+00011760: 636f 6e66 6967 2e72 6573 6f6c 7665 2829  config.resolve()
+00011770: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011780: 2029 0a0a 2020 2020 2020 2020 2320 5465   )..        # Te
+00011790: 7374 2066 616c 6c62 6163 6b20 666f 7220  st fallback for 
+000117a0: 5844 475f 434f 4e46 4947 5f48 4f4d 450a  XDG_CONFIG_HOME.
+000117b0: 2020 2020 2020 2020 7769 7468 2070 6174          with pat
+000117c0: 6368 2e64 6963 7428 226f 732e 656e 7669  ch.dict("os.envi
+000117d0: 726f 6e22 293a 0a20 2020 2020 2020 2020  ron"):.         
+000117e0: 2020 206f 732e 656e 7669 726f 6e2e 706f     os.environ.po
+000117f0: 7028 2258 4447 5f43 4f4e 4649 475f 484f  p("XDG_CONFIG_HO
+00011800: 4d45 222c 204e 6f6e 6529 0a20 2020 2020  ME", None).     
+00011810: 2020 2020 2020 2066 616c 6c62 6163 6b5f         fallback_
+00011820: 7573 6572 5f63 6f6e 6669 6720 3d20 5061  user_config = Pa
+00011830: 7468 2822 7e2f 2e63 6f6e 6669 6722 292e  th("~/.config").
+00011840: 6578 7061 6e64 7573 6572 2829 202f 2022  expanduser() / "
+00011850: 6365 7263 6973 220a 2020 2020 2020 2020  cercis".        
+00011860: 2020 2020 7365 6c66 2e61 7373 6572 7445      self.assertE
+00011870: 7175 616c 280a 2020 2020 2020 2020 2020  qual(.          
+00011880: 2020 2020 2020 6365 7263 6973 2e66 696c        cercis.fil
+00011890: 6573 2e66 696e 645f 7573 6572 5f70 7970  es.find_user_pyp
+000118a0: 726f 6a65 6374 5f74 6f6d 6c28 292c 2066  roject_toml(), f
+000118b0: 616c 6c62 6163 6b5f 7573 6572 5f63 6f6e  allback_user_con
+000118c0: 6669 672e 7265 736f 6c76 6528 290a 2020  fig.resolve().  
+000118d0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+000118e0: 2064 6566 2074 6573 745f 6669 6e64 5f75   def test_find_u
+000118f0: 7365 725f 7079 7072 6f6a 6563 745f 746f  ser_pyproject_to
+00011900: 6d6c 5f77 696e 646f 7773 2873 656c 6629  ml_windows(self)
+00011910: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00011920: 2020 6966 2073 7973 7465 6d28 2920 213d    if system() !=
+00011930: 2022 5769 6e64 6f77 7322 3a0a 2020 2020   "Windows":.    
+00011940: 2020 2020 2020 2020 7265 7475 726e 0a0a          return..
+00011950: 2020 2020 2020 2020 7573 6572 5f63 6f6e          user_con
+00011960: 6669 675f 7061 7468 203d 2050 6174 682e  fig_path = Path.
+00011970: 686f 6d65 2829 202f 2022 2e63 6572 6369  home() / ".cerci
+00011980: 7322 0a20 2020 2020 2020 2073 656c 662e  s".        self.
+00011990: 6173 7365 7274 4571 7561 6c28 0a20 2020  assertEqual(.   
+000119a0: 2020 2020 2020 2020 2063 6572 6369 732e           cercis.
+000119b0: 6669 6c65 732e 6669 6e64 5f75 7365 725f  files.find_user_
+000119c0: 7079 7072 6f6a 6563 745f 746f 6d6c 2829  pyproject_toml()
+000119d0: 2c20 7573 6572 5f63 6f6e 6669 675f 7061  , user_config_pa
+000119e0: 7468 2e72 6573 6f6c 7665 2829 0a20 2020  th.resolve().   
+000119f0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+00011a00: 7465 7374 5f62 706f 5f33 3336 3630 5f77  test_bpo_33660_w
+00011a10: 6f72 6b61 726f 756e 6428 7365 6c66 2920  orkaround(self) 
+00011a20: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00011a30: 2069 6620 7379 7374 656d 2829 203d 3d20   if system() == 
+00011a40: 2257 696e 646f 7773 223a 0a20 2020 2020  "Windows":.     
+00011a50: 2020 2020 2020 2072 6574 7572 6e0a 0a20         return.. 
+00011a60: 2020 2020 2020 2023 2068 7474 7073 3a2f         # https:/
+00011a70: 2f62 7567 732e 7079 7468 6f6e 2e6f 7267  /bugs.python.org
+00011a80: 2f69 7373 7565 3333 3636 300a 2020 2020  /issue33660.    
+00011a90: 2020 2020 726f 6f74 203d 2050 6174 6828      root = Path(
+00011aa0: 222f 2229 0a20 2020 2020 2020 2077 6974  "/").        wit
+00011ab0: 6820 6368 616e 6765 5f64 6972 6563 746f  h change_directo
+00011ac0: 7279 2872 6f6f 7429 3a0a 2020 2020 2020  ry(root):.      
+00011ad0: 2020 2020 2020 7061 7468 203d 2050 6174        path = Pat
+00011ae0: 6828 2277 6f72 6b73 7061 6365 2229 202f  h("workspace") /
+00011af0: 2022 7072 6f6a 6563 7422 0a20 2020 2020   "project".     
+00011b00: 2020 2020 2020 2072 6570 6f72 7420 3d20         report = 
+00011b10: 6365 7263 6973 2e52 6570 6f72 7428 7665  cercis.Report(ve
+00011b20: 7262 6f73 653d 5472 7565 290a 2020 2020  rbose=True).    
+00011b30: 2020 2020 2020 2020 6e6f 726d 616c 697a          normaliz
+00011b40: 6564 5f70 6174 6820 3d20 6365 7263 6973  ed_path = cercis
+00011b50: 2e6e 6f72 6d61 6c69 7a65 5f70 6174 685f  .normalize_path_
+00011b60: 6d61 7962 655f 6967 6e6f 7265 2870 6174  maybe_ignore(pat
+00011b70: 682c 2072 6f6f 742c 2072 6570 6f72 7429  h, root, report)
+00011b80: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00011b90: 662e 6173 7365 7274 4571 7561 6c28 6e6f  f.assertEqual(no
+00011ba0: 726d 616c 697a 6564 5f70 6174 682c 2022  rmalized_path, "
+00011bb0: 776f 726b 7370 6163 652f 7072 6f6a 6563  workspace/projec
+00011bc0: 7422 290a 0a20 2020 2064 6566 2074 6573  t")..    def tes
+00011bd0: 745f 6e6f 726d 616c 697a 655f 7061 7468  t_normalize_path
+00011be0: 5f69 676e 6f72 655f 7769 6e64 6f77 735f  _ignore_windows_
+00011bf0: 6a75 6e63 7469 6f6e 735f 6f75 7473 6964  junctions_outsid
+00011c00: 655f 6f66 5f72 6f6f 7428 7365 6c66 2920  e_of_root(self) 
+00011c10: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00011c20: 2069 6620 7379 7374 656d 2829 2021 3d20   if system() != 
+00011c30: 2257 696e 646f 7773 223a 0a20 2020 2020  "Windows":.     
+00011c40: 2020 2020 2020 2072 6574 7572 6e0a 0a20         return.. 
+00011c50: 2020 2020 2020 2077 6974 6820 5465 6d70         with Temp
+00011c60: 6f72 6172 7944 6972 6563 746f 7279 2829  oraryDirectory()
+00011c70: 2061 7320 776f 726b 7370 6163 653a 0a20   as workspace:. 
+00011c80: 2020 2020 2020 2020 2020 2072 6f6f 7420             root 
+00011c90: 3d20 5061 7468 2877 6f72 6b73 7061 6365  = Path(workspace
+00011ca0: 290a 2020 2020 2020 2020 2020 2020 6a75  ).            ju
+00011cb0: 6e63 7469 6f6e 5f64 6972 203d 2072 6f6f  nction_dir = roo
+00011cc0: 7420 2f20 226a 756e 6374 696f 6e22 0a20  t / "junction". 
+00011cd0: 2020 2020 2020 2020 2020 206a 756e 6374             junct
+00011ce0: 696f 6e5f 7461 7267 6574 5f6f 7574 7369  ion_target_outsi
+00011cf0: 6465 5f6f 665f 726f 6f74 203d 2072 6f6f  de_of_root = roo
+00011d00: 7420 2f20 222e 2e22 0a20 2020 2020 2020  t / "..".       
+00011d10: 2020 2020 206f 732e 7379 7374 656d 2866       os.system(f
+00011d20: 226d 6b6c 696e 6b20 2f4a 207b 6a75 6e63  "mklink /J {junc
+00011d30: 7469 6f6e 5f64 6972 7d20 7b6a 756e 6374  tion_dir} {junct
+00011d40: 696f 6e5f 7461 7267 6574 5f6f 7574 7369  ion_target_outsi
+00011d50: 6465 5f6f 665f 726f 6f74 7d22 290a 0a20  de_of_root}").. 
+00011d60: 2020 2020 2020 2020 2020 2072 6570 6f72             repor
+00011d70: 7420 3d20 6365 7263 6973 2e52 6570 6f72  t = cercis.Repor
+00011d80: 7428 7665 7262 6f73 653d 5472 7565 290a  t(verbose=True).
+00011d90: 2020 2020 2020 2020 2020 2020 6e6f 726d              norm
+00011da0: 616c 697a 6564 5f70 6174 6820 3d20 6365  alized_path = ce
+00011db0: 7263 6973 2e6e 6f72 6d61 6c69 7a65 5f70  rcis.normalize_p
+00011dc0: 6174 685f 6d61 7962 655f 6967 6e6f 7265  ath_maybe_ignore
+00011dd0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00011de0: 2020 6a75 6e63 7469 6f6e 5f64 6972 2c20    junction_dir, 
+00011df0: 726f 6f74 2c20 7265 706f 7274 0a20 2020  root, report.   
+00011e00: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00011e10: 2020 2020 2020 2023 204d 616e 7561 6c6c         # Manuall
+00011e20: 7920 6465 6c65 7465 2066 6f72 2050 7974  y delete for Pyt
+00011e30: 686f 6e20 3c20 332e 380a 2020 2020 2020  hon < 3.8.      
+00011e40: 2020 2020 2020 6f73 2e73 7973 7465 6d28        os.system(
+00011e50: 6622 726d 6469 7220 7b6a 756e 6374 696f  f"rmdir {junctio
+00011e60: 6e5f 6469 727d 2229 0a0a 2020 2020 2020  n_dir}")..      
+00011e70: 2020 2020 2020 7365 6c66 2e61 7373 6572        self.asser
+00011e80: 7445 7175 616c 286e 6f72 6d61 6c69 7a65  tEqual(normalize
+00011e90: 645f 7061 7468 2c20 4e6f 6e65 290a 0a20  d_path, None).. 
+00011ea0: 2020 2064 6566 2074 6573 745f 6e65 776c     def test_newl
+00011eb0: 696e 655f 636f 6d6d 656e 745f 696e 7465  ine_comment_inte
+00011ec0: 7261 6374 696f 6e28 7365 6c66 2920 2d3e  raction(self) ->
+00011ed0: 204e 6f6e 653a 0a20 2020 2020 2020 2073   None:.        s
+00011ee0: 6f75 7263 6520 3d20 2263 6c61 7373 2041  ource = "class A
+00011ef0: 3a5c 5c5c 725c 6e23 2074 7970 653a 2069  :\\\r\n# type: i
+00011f00: 676e 6f72 655c 6e20 7061 7373 5c6e 220a  gnore\n pass\n".
+00011f10: 2020 2020 2020 2020 6f75 7470 7574 203d          output =
+00011f20: 2063 6572 6369 732e 666f 726d 6174 5f73   cercis.format_s
+00011f30: 7472 2873 6f75 7263 652c 206d 6f64 653d  tr(source, mode=
+00011f40: 4445 4641 554c 545f 4d4f 4445 290a 2020  DEFAULT_MODE).  
+00011f50: 2020 2020 2020 6365 7263 6973 2e61 7373        cercis.ass
+00011f60: 6572 745f 7374 6162 6c65 2873 6f75 7263  ert_stable(sourc
+00011f70: 652c 206f 7574 7075 742c 206d 6f64 653d  e, output, mode=
+00011f80: 4445 4641 554c 545f 4d4f 4445 290a 0a20  DEFAULT_MODE).. 
+00011f90: 2020 2064 6566 2074 6573 745f 6270 6f5f     def test_bpo_
+00011fa0: 3231 3432 5f77 6f72 6b61 726f 756e 6428  2142_workaround(
+00011fb0: 7365 6c66 2920 2d3e 204e 6f6e 653a 0a20  self) -> None:. 
+00011fc0: 2020 2020 2020 2023 2068 7474 7073 3a2f         # https:/
+00011fd0: 2f62 7567 732e 7079 7468 6f6e 2e6f 7267  /bugs.python.org
+00011fe0: 2f69 7373 7565 3231 3432 0a0a 2020 2020  /issue2142..    
+00011ff0: 2020 2020 736f 7572 6365 2c20 5f20 3d20      source, _ = 
+00012000: 7265 6164 5f64 6174 6128 226d 6973 6365  read_data("misce
+00012010: 6c6c 616e 656f 7573 222c 2022 6d69 7373  llaneous", "miss
+00012020: 696e 675f 6669 6e61 6c5f 6e65 776c 696e  ing_final_newlin
+00012030: 6522 290a 2020 2020 2020 2020 2320 7265  e").        # re
+00012040: 6164 5f64 6174 6120 6164 6473 2061 2074  ad_data adds a t
+00012050: 7261 696c 696e 6720 6e65 776c 696e 650a  railing newline.
+00012060: 2020 2020 2020 2020 736f 7572 6365 203d          source =
+00012070: 2073 6f75 7263 652e 7273 7472 6970 2829   source.rstrip()
+00012080: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
+00012090: 642c 205f 203d 2072 6561 645f 6461 7461  d, _ = read_data
+000120a0: 2822 6d69 7363 656c 6c61 6e65 6f75 7322  ("miscellaneous"
+000120b0: 2c20 226d 6973 7369 6e67 5f66 696e 616c  , "missing_final
+000120c0: 5f6e 6577 6c69 6e65 2e64 6966 6622 290a  _newline.diff").
+000120d0: 2020 2020 2020 2020 746d 705f 6669 6c65          tmp_file
+000120e0: 203d 2050 6174 6828 6365 7263 6973 2e64   = Path(cercis.d
+000120f0: 756d 705f 746f 5f66 696c 6528 736f 7572  ump_to_file(sour
+00012100: 6365 2c20 656e 7375 7265 5f66 696e 616c  ce, ensure_final
+00012110: 5f6e 6577 6c69 6e65 3d46 616c 7365 2929  _newline=False))
+00012120: 0a20 2020 2020 2020 2064 6966 665f 6865  .        diff_he
+00012130: 6164 6572 203d 2072 652e 636f 6d70 696c  ader = re.compil
+00012140: 6528 0a20 2020 2020 2020 2020 2020 2072  e(.            r
+00012150: 6622 7b72 652e 6573 6361 7065 2873 7472  f"{re.escape(str
+00012160: 2874 6d70 5f66 696c 6529 297d 5c74 5c64  (tmp_file))}\t\d
+00012170: 5c64 5c64 5c64 2d5c 645c 642d 5c64 5c64  \d\d\d-\d\d-\d\d
+00012180: 2022 0a20 2020 2020 2020 2020 2020 2072   ".            r
+00012190: 225c 645c 643a 5c64 5c64 3a5c 645c 645c  "\d\d:\d\d:\d\d\
+000121a0: 2e5c 645c 645c 645c 645c 645c 645c 2b5c  .\d\d\d\d\d\d\+\
+000121b0: 645c 643a 5c64 5c64 220a 2020 2020 2020  d\d:\d\d".      
+000121c0: 2020 290a 2020 2020 2020 2020 7472 793a    ).        try:
+000121d0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+000121e0: 756c 7420 3d20 426c 6163 6b52 756e 6e65  ult = BlackRunne
+000121f0: 7228 292e 696e 766f 6b65 2863 6572 6369  r().invoke(cerci
+00012200: 732e 6d61 696e 2c20 5b22 2d2d 6469 6666  s.main, ["--diff
+00012210: 222c 2073 7472 2874 6d70 5f66 696c 6529  ", str(tmp_file)
+00012220: 5d29 0a20 2020 2020 2020 2020 2020 2073  ]).            s
+00012230: 656c 662e 6173 7365 7274 4571 7561 6c28  elf.assertEqual(
+00012240: 7265 7375 6c74 2e65 7869 745f 636f 6465  result.exit_code
+00012250: 2c20 3029 0a20 2020 2020 2020 2066 696e  , 0).        fin
+00012260: 616c 6c79 3a0a 2020 2020 2020 2020 2020  ally:.          
+00012270: 2020 6f73 2e75 6e6c 696e 6b28 746d 705f    os.unlink(tmp_
+00012280: 6669 6c65 290a 2020 2020 2020 2020 6163  file).        ac
+00012290: 7475 616c 203d 2072 6573 756c 742e 6f75  tual = result.ou
+000122a0: 7470 7574 0a20 2020 2020 2020 2061 6374  tput.        act
+000122b0: 7561 6c20 3d20 6469 6666 5f68 6561 6465  ual = diff_heade
+000122c0: 722e 7375 6228 4445 5445 524d 494e 4953  r.sub(DETERMINIS
+000122d0: 5449 435f 4845 4144 4552 2c20 6163 7475  TIC_HEADER, actu
+000122e0: 616c 290a 2020 2020 2020 2020 7365 6c66  al).        self
+000122f0: 2e61 7373 6572 7445 7175 616c 2861 6374  .assertEqual(act
+00012300: 7561 6c2c 2065 7870 6563 7465 6429 0a0a  ual, expected)..
+00012310: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
+00012320: 640a 2020 2020 6465 6620 636f 6d70 6172  d.    def compar
+00012330: 655f 7265 7375 6c74 7328 0a20 2020 2020  e_results(.     
+00012340: 2020 2020 2020 2072 6573 756c 743a 2063         result: c
+00012350: 6c69 636b 2e74 6573 7469 6e67 2e52 6573  lick.testing.Res
+00012360: 756c 742c 2065 7870 6563 7465 645f 7661  ult, expected_va
+00012370: 6c75 653a 2073 7472 2c20 6578 7065 6374  lue: str, expect
+00012380: 6564 5f65 7869 745f 636f 6465 3a20 696e  ed_exit_code: in
+00012390: 740a 2020 2020 2920 2d3e 204e 6f6e 653a  t.    ) -> None:
+000123a0: 0a20 2020 2020 2020 2022 2222 4865 6c70  .        """Help
+000123b0: 6572 206d 6574 686f 6420 746f 2074 6573  er method to tes
+000123c0: 7420 7468 6520 7661 6c75 6520 616e 6420  t the value and 
+000123d0: 6578 6974 2063 6f64 6520 6f66 2061 2063  exit code of a c
+000123e0: 6c69 636b 2052 6573 756c 742e 2222 220a  lick Result.""".
+000123f0: 2020 2020 2020 2020 6173 7365 7274 2028          assert (
+00012400: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+00012410: 756c 742e 6f75 7470 7574 203d 3d20 6578  ult.output == ex
+00012420: 7065 6374 6564 5f76 616c 7565 0a20 2020  pected_value.   
+00012430: 2020 2020 2029 2c20 2254 6865 206f 7574       ), "The out
+00012440: 7075 7420 6469 6420 6e6f 7420 6d61 7463  put did not matc
+00012450: 6820 7468 6520 6578 7065 6374 6564 2076  h the expected v
+00012460: 616c 7565 2e22 0a20 2020 2020 2020 2061  alue.".        a
+00012470: 7373 6572 7420 7265 7375 6c74 2e65 7869  ssert result.exi
+00012480: 745f 636f 6465 203d 3d20 6578 7065 6374  t_code == expect
+00012490: 6564 5f65 7869 745f 636f 6465 2c20 2254  ed_exit_code, "T
+000124a0: 6865 2065 7869 7420 636f 6465 2069 7320  he exit code is 
+000124b0: 696e 636f 7272 6563 742e 220a 0a20 2020  incorrect."..   
+000124c0: 2064 6566 2074 6573 745f 636f 6465 5f6f   def test_code_o
+000124d0: 7074 696f 6e28 7365 6c66 2920 2d3e 204e  ption(self) -> N
+000124e0: 6f6e 653a 0a20 2020 2020 2020 2022 2222  one:.        """
+000124f0: 5465 7374 2074 6865 2063 6f64 6520 6f70  Test the code op
+00012500: 7469 6f6e 2077 6974 6820 6e6f 2063 6861  tion with no cha
+00012510: 6e67 6573 2e22 2222 0a20 2020 2020 2020  nges.""".       
+00012520: 2063 6f64 6520 3d20 2270 7269 6e74 2827   code = "print('
+00012530: 4865 6c6c 6f20 776f 726c 6427 295c 6e22  Hello world')\n"
+00012540: 0a20 2020 2020 2020 2061 7267 7320 3d20  .        args = 
+00012550: 5b22 2d2d 636f 6465 222c 2063 6f64 652c  ["--code", code,
+00012560: 2022 2d2d 7369 6e67 6c65 2d71 756f 7465   "--single-quote
+00012570: 3d54 7275 6522 5d0a 2020 2020 2020 2020  =True"].        
+00012580: 7265 7375 6c74 203d 2043 6c69 5275 6e6e  result = CliRunn
+00012590: 6572 2829 2e69 6e76 6f6b 6528 6365 7263  er().invoke(cerc
+000125a0: 6973 2e6d 6169 6e2c 2061 7267 7329 0a0a  is.main, args)..
+000125b0: 2020 2020 2020 2020 7365 6c66 2e63 6f6d          self.com
+000125c0: 7061 7265 5f72 6573 756c 7473 2872 6573  pare_results(res
+000125d0: 756c 742c 2063 6f64 652c 2030 290a 0a20  ult, code, 0).. 
+000125e0: 2020 2064 6566 2074 6573 745f 636f 6465     def test_code
+000125f0: 5f6f 7074 696f 6e5f 6368 616e 6765 6428  _option_changed(
+00012600: 7365 6c66 2920 2d3e 204e 6f6e 653a 0a20  self) -> None:. 
+00012610: 2020 2020 2020 2022 2222 5465 7374 2074         """Test t
+00012620: 6865 2063 6f64 6520 6f70 7469 6f6e 2077  he code option w
+00012630: 6865 6e20 6368 616e 6765 7320 6172 6520  hen changes are 
+00012640: 7265 7175 6972 6564 2e22 2222 0a20 2020  required.""".   
+00012650: 2020 2020 2063 6f64 6520 3d20 2770 7269       code = 'pri
+00012660: 6e74 2822 6865 6c6c 6f20 776f 726c 6422  nt("hello world"
+00012670: 2927 0a20 2020 2020 2020 2066 6f72 6d61  )'.        forma
+00012680: 7474 6564 203d 2063 6572 6369 732e 666f  tted = cercis.fo
+00012690: 726d 6174 5f73 7472 2863 6f64 652c 206d  rmat_str(code, m
+000126a0: 6f64 653d 4445 4641 554c 545f 4d4f 4445  ode=DEFAULT_MODE
+000126b0: 290a 0a20 2020 2020 2020 2061 7267 7320  )..        args 
+000126c0: 3d20 5b22 2d2d 636f 6465 222c 2063 6f64  = ["--code", cod
+000126d0: 652c 2022 2d2d 7369 6e67 6c65 2d71 756f  e, "--single-quo
+000126e0: 7465 3d54 7275 6522 5d0a 2020 2020 2020  te=True"].      
+000126f0: 2020 7265 7375 6c74 203d 2043 6c69 5275    result = CliRu
+00012700: 6e6e 6572 2829 2e69 6e76 6f6b 6528 6365  nner().invoke(ce
+00012710: 7263 6973 2e6d 6169 6e2c 2061 7267 7329  rcis.main, args)
+00012720: 0a0a 2020 2020 2020 2020 7365 6c66 2e63  ..        self.c
+00012730: 6f6d 7061 7265 5f72 6573 756c 7473 2872  ompare_results(r
+00012740: 6573 756c 742c 2066 6f72 6d61 7474 6564  esult, formatted
+00012750: 2c20 3029 0a0a 2020 2020 6465 6620 7465  , 0)..    def te
+00012760: 7374 5f63 6f64 655f 6f70 7469 6f6e 5f63  st_code_option_c
+00012770: 6865 636b 2873 656c 6629 202d 3e20 4e6f  heck(self) -> No
+00012780: 6e65 3a0a 2020 2020 2020 2020 2222 2254  ne:.        """T
+00012790: 6573 7420 7468 6520 636f 6465 206f 7074  est the code opt
+000127a0: 696f 6e20 7768 656e 2063 6865 636b 2069  ion when check i
+000127b0: 7320 7061 7373 6564 2e22 2222 0a20 2020  s passed.""".   
+000127c0: 2020 2020 2061 7267 7320 3d20 5b22 2d2d       args = ["--
+000127d0: 6368 6563 6b22 2c20 222d 2d63 6f64 6522  check", "--code"
+000127e0: 2c20 2770 7269 6e74 2822 4865 6c6c 6f20  , 'print("Hello 
+000127f0: 776f 726c 6422 295c 6e27 5d0a 2020 2020  world")\n'].    
+00012800: 2020 2020 7265 7375 6c74 203d 2043 6c69      result = Cli
+00012810: 5275 6e6e 6572 2829 2e69 6e76 6f6b 6528  Runner().invoke(
+00012820: 6365 7263 6973 2e6d 6169 6e2c 2061 7267  cercis.main, arg
+00012830: 7329 0a20 2020 2020 2020 2073 656c 662e  s).        self.
+00012840: 636f 6d70 6172 655f 7265 7375 6c74 7328  compare_results(
+00012850: 7265 7375 6c74 2c20 2222 2c20 3029 0a0a  result, "", 0)..
+00012860: 2020 2020 6465 6620 7465 7374 5f63 6f64      def test_cod
+00012870: 655f 6f70 7469 6f6e 5f63 6865 636b 5f63  e_option_check_c
+00012880: 6861 6e67 6564 2873 656c 6629 202d 3e20  hanged(self) -> 
+00012890: 4e6f 6e65 3a0a 2020 2020 2020 2020 2222  None:.        ""
+000128a0: 2254 6573 7420 7468 6520 636f 6465 206f  "Test the code o
+000128b0: 7074 696f 6e20 7768 656e 2063 6861 6e67  ption when chang
+000128c0: 6573 2061 7265 2072 6571 7569 7265 642c  es are required,
+000128d0: 2061 6e64 2063 6865 636b 2069 7320 7061   and check is pa
+000128e0: 7373 6564 2e22 2222 0a20 2020 2020 2020  ssed.""".       
+000128f0: 2061 7267 7320 3d20 5b22 2d2d 6368 6563   args = ["--chec
+00012900: 6b22 2c20 222d 2d63 6f64 6522 2c20 2270  k", "--code", "p
+00012910: 7269 6e74 2827 6865 6c6c 6f20 776f 726c  rint('hello worl
+00012920: 6427 2922 5d0a 2020 2020 2020 2020 7265  d')"].        re
+00012930: 7375 6c74 203d 2043 6c69 5275 6e6e 6572  sult = CliRunner
+00012940: 2829 2e69 6e76 6f6b 6528 6365 7263 6973  ().invoke(cercis
+00012950: 2e6d 6169 6e2c 2061 7267 7329 0a20 2020  .main, args).   
+00012960: 2020 2020 2073 656c 662e 636f 6d70 6172       self.compar
+00012970: 655f 7265 7375 6c74 7328 7265 7375 6c74  e_results(result
+00012980: 2c20 2222 2c20 3129 0a0a 2020 2020 6465  , "", 1)..    de
+00012990: 6620 7465 7374 5f63 6f64 655f 6f70 7469  f test_code_opti
+000129a0: 6f6e 5f64 6966 6628 7365 6c66 2920 2d3e  on_diff(self) ->
+000129b0: 204e 6f6e 653a 0a20 2020 2020 2020 2022   None:.        "
+000129c0: 2222 5465 7374 2074 6865 2063 6f64 6520  ""Test the code 
+000129d0: 6f70 7469 6f6e 2077 6865 6e20 6469 6666  option when diff
+000129e0: 2069 7320 7061 7373 6564 2e22 2222 0a20   is passed.""". 
+000129f0: 2020 2020 2020 2063 6f64 6520 3d20 2770         code = 'p
+00012a00: 7269 6e74 2822 6865 6c6c 6f20 776f 726c  rint("hello worl
+00012a10: 6422 2927 0a20 2020 2020 2020 2066 6f72  d")'.        for
+00012a20: 6d61 7474 6564 203d 2063 6572 6369 732e  matted = cercis.
+00012a30: 666f 726d 6174 5f73 7472 2863 6f64 652c  format_str(code,
+00012a40: 206d 6f64 653d 4445 4641 554c 545f 4d4f   mode=DEFAULT_MO
+00012a50: 4445 290a 2020 2020 2020 2020 7265 7375  DE).        resu
+00012a60: 6c74 5f64 6966 6620 3d20 6469 6666 2863  lt_diff = diff(c
+00012a70: 6f64 652c 2066 6f72 6d61 7474 6564 2c20  ode, formatted, 
+00012a80: 2253 5444 494e 222c 2022 5354 444f 5554  "STDIN", "STDOUT
+00012a90: 2229 0a0a 2020 2020 2020 2020 6172 6773  ")..        args
+00012aa0: 203d 205b 222d 2d64 6966 6622 2c20 222d   = ["--diff", "-
+00012ab0: 2d63 6f64 6522 2c20 636f 6465 2c20 222d  -code", code, "-
+00012ac0: 2d73 696e 676c 652d 7175 6f74 653d 5472  -single-quote=Tr
+00012ad0: 7565 225d 0a20 2020 2020 2020 2072 6573  ue"].        res
+00012ae0: 756c 7420 3d20 436c 6952 756e 6e65 7228  ult = CliRunner(
+00012af0: 292e 696e 766f 6b65 2863 6572 6369 732e  ).invoke(cercis.
+00012b00: 6d61 696e 2c20 6172 6773 290a 0a20 2020  main, args)..   
+00012b10: 2020 2020 2023 2052 656d 6f76 6520 7469       # Remove ti
+00012b20: 6d65 2066 726f 6d20 6469 6666 0a20 2020  me from diff.   
+00012b30: 2020 2020 206f 7574 7075 7420 3d20 4449       output = DI
+00012b40: 4646 5f54 494d 452e 7375 6228 2222 2c20  FF_TIME.sub("", 
+00012b50: 7265 7375 6c74 2e6f 7574 7075 7429 0a0a  result.output)..
+00012b60: 2020 2020 2020 2020 6173 7365 7274 206f          assert o
+00012b70: 7574 7075 7420 3d3d 2072 6573 756c 745f  utput == result_
+00012b80: 6469 6666 2c20 2254 6865 206f 7574 7075  diff, "The outpu
+00012b90: 7420 6469 6420 6e6f 7420 6d61 7463 6820  t did not match 
+00012ba0: 7468 6520 6578 7065 6374 6564 2076 616c  the expected val
+00012bb0: 7565 2e22 0a20 2020 2020 2020 2061 7373  ue.".        ass
+00012bc0: 6572 7420 7265 7375 6c74 2e65 7869 745f  ert result.exit_
+00012bd0: 636f 6465 203d 3d20 302c 2022 5468 6520  code == 0, "The 
+00012be0: 6578 6974 2063 6f64 6520 6973 2069 6e63  exit code is inc
+00012bf0: 6f72 7265 6374 2e22 0a0a 2020 2020 6465  orrect."..    de
+00012c00: 6620 7465 7374 5f63 6f64 655f 6f70 7469  f test_code_opti
+00012c10: 6f6e 5f63 6f6c 6f72 5f64 6966 6628 7365  on_color_diff(se
+00012c20: 6c66 2920 2d3e 204e 6f6e 653a 0a20 2020  lf) -> None:.   
+00012c30: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
+00012c40: 2063 6f64 6520 6f70 7469 6f6e 2077 6865   code option whe
+00012c50: 6e20 636f 6c6f 7220 616e 6420 6469 6666  n color and diff
+00012c60: 2061 7265 2070 6173 7365 642e 2222 220a   are passed.""".
+00012c70: 2020 2020 2020 2020 636f 6465 203d 2027          code = '
+00012c80: 7072 696e 7428 2268 656c 6c6f 2077 6f72  print("hello wor
+00012c90: 6c64 2229 270a 2020 2020 2020 2020 666f  ld")'.        fo
+00012ca0: 726d 6174 7465 6420 3d20 6365 7263 6973  rmatted = cercis
+00012cb0: 2e66 6f72 6d61 745f 7374 7228 636f 6465  .format_str(code
+00012cc0: 2c20 6d6f 6465 3d44 4546 4155 4c54 5f4d  , mode=DEFAULT_M
+00012cd0: 4f44 4529 0a0a 2020 2020 2020 2020 7265  ODE)..        re
+00012ce0: 7375 6c74 5f64 6966 6620 3d20 6469 6666  sult_diff = diff
+00012cf0: 2863 6f64 652c 2066 6f72 6d61 7474 6564  (code, formatted
+00012d00: 2c20 2253 5444 494e 222c 2022 5354 444f  , "STDIN", "STDO
+00012d10: 5554 2229 0a20 2020 2020 2020 2072 6573  UT").        res
+00012d20: 756c 745f 6469 6666 203d 2063 6f6c 6f72  ult_diff = color
+00012d30: 5f64 6966 6628 7265 7375 6c74 5f64 6966  _diff(result_dif
+00012d40: 6629 0a0a 2020 2020 2020 2020 6172 6773  f)..        args
+00012d50: 203d 205b 222d 2d64 6966 6622 2c20 222d   = ["--diff", "-
+00012d60: 2d63 6f6c 6f72 222c 2022 2d2d 636f 6465  -color", "--code
+00012d70: 222c 2063 6f64 652c 2022 2d2d 7369 6e67  ", code, "--sing
+00012d80: 6c65 2d71 756f 7465 3d54 7275 6522 5d0a  le-quote=True"].
+00012d90: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
+00012da0: 2043 6c69 5275 6e6e 6572 2829 2e69 6e76   CliRunner().inv
+00012db0: 6f6b 6528 6365 7263 6973 2e6d 6169 6e2c  oke(cercis.main,
+00012dc0: 2061 7267 7329 0a0a 2020 2020 2020 2020   args)..        
+00012dd0: 2320 5265 6d6f 7665 2074 696d 6520 6672  # Remove time fr
+00012de0: 6f6d 2064 6966 660a 2020 2020 2020 2020  om diff.        
+00012df0: 6f75 7470 7574 203d 2044 4946 465f 5449  output = DIFF_TI
+00012e00: 4d45 2e73 7562 2822 222c 2072 6573 756c  ME.sub("", resul
+00012e10: 742e 6f75 7470 7574 290a 0a20 2020 2020  t.output)..     
+00012e20: 2020 2061 7373 6572 7420 6f75 7470 7574     assert output
+00012e30: 203d 3d20 7265 7375 6c74 5f64 6966 662c   == result_diff,
+00012e40: 2022 5468 6520 6f75 7470 7574 2064 6964   "The output did
+00012e50: 206e 6f74 206d 6174 6368 2074 6865 2065   not match the e
+00012e60: 7870 6563 7465 6420 7661 6c75 652e 220a  xpected value.".
+00012e70: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
+00012e80: 6573 756c 742e 6578 6974 5f63 6f64 6520  esult.exit_code 
+00012e90: 3d3d 2030 2c20 2254 6865 2065 7869 7420  == 0, "The exit 
+00012ea0: 636f 6465 2069 7320 696e 636f 7272 6563  code is incorrec
+00012eb0: 742e 220a 0a20 2020 2040 7079 7465 7374  t."..    @pytest
+00012ec0: 2e6d 6172 6b2e 696e 636f 6d70 6174 6962  .mark.incompatib
+00012ed0: 6c65 5f77 6974 685f 6d79 7079 630a 2020  le_with_mypyc.  
+00012ee0: 2020 6465 6620 7465 7374 5f63 6f64 655f    def test_code_
+00012ef0: 6f70 7469 6f6e 5f73 6166 6528 7365 6c66  option_safe(self
+00012f00: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00012f10: 2020 2022 2222 5465 7374 2074 6861 7420     """Test that 
+00012f20: 7468 6520 636f 6465 206f 7074 696f 6e20  the code option 
+00012f30: 7468 726f 7773 2061 6e20 6572 726f 7220  throws an error 
+00012f40: 7768 656e 2074 6865 2073 616e 6974 7920  when the sanity 
+00012f50: 6368 6563 6b73 2066 6169 6c2e 2222 220a  checks fail.""".
+00012f60: 2020 2020 2020 2020 2320 5061 7463 6820          # Patch 
+00012f70: 6365 7263 6973 2e61 7373 6572 745f 6571  cercis.assert_eq
+00012f80: 7569 7661 6c65 6e74 2074 6f20 656e 7375  uivalent to ensu
+00012f90: 7265 2074 6865 2073 616e 6974 7920 6368  re the sanity ch
+00012fa0: 6563 6b73 2066 6169 6c0a 2020 2020 2020  ecks fail.      
+00012fb0: 2020 7769 7468 2070 6174 6368 2e6f 626a    with patch.obj
+00012fc0: 6563 7428 6365 7263 6973 2c20 2261 7373  ect(cercis, "ass
+00012fd0: 6572 745f 6571 7569 7661 6c65 6e74 222c  ert_equivalent",
+00012fe0: 2073 6964 655f 6566 6665 6374 3d41 7373   side_effect=Ass
+00012ff0: 6572 7469 6f6e 4572 726f 7229 3a0a 2020  ertionError):.  
+00013000: 2020 2020 2020 2020 2020 636f 6465 203d            code =
+00013010: 2027 7072 696e 7428 2248 656c 6c6f 2077   'print("Hello w
+00013020: 6f72 6c64 2229 270a 2020 2020 2020 2020  orld")'.        
+00013030: 2020 2020 6572 726f 725f 6d73 6720 3d20      error_msg = 
+00013040: 6622 7b63 6f64 657d 5c6e 6572 726f 723a  f"{code}\nerror:
+00013050: 2063 616e 6e6f 7420 666f 726d 6174 203c   cannot format <
+00013060: 7374 7269 6e67 3e3a 205c 6e22 0a0a 2020  string>: \n"..  
+00013070: 2020 2020 2020 2020 2020 6172 6773 203d            args =
+00013080: 205b 222d 2d73 6166 6522 2c20 222d 2d63   ["--safe", "--c
+00013090: 6f64 6522 2c20 636f 6465 5d0a 2020 2020  ode", code].    
+000130a0: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
+000130b0: 2043 6c69 5275 6e6e 6572 2829 2e69 6e76   CliRunner().inv
+000130c0: 6f6b 6528 6365 7263 6973 2e6d 6169 6e2c  oke(cercis.main,
+000130d0: 2061 7267 7329 0a0a 2020 2020 2020 2020   args)..        
+000130e0: 2020 2020 7365 6c66 2e63 6f6d 7061 7265      self.compare
+000130f0: 5f72 6573 756c 7473 2872 6573 756c 742c  _results(result,
+00013100: 2065 7272 6f72 5f6d 7367 2c20 3132 3329   error_msg, 123)
+00013110: 0a0a 2020 2020 6465 6620 7465 7374 5f63  ..    def test_c
+00013120: 6f64 655f 6f70 7469 6f6e 5f66 6173 7428  ode_option_fast(
+00013130: 7365 6c66 2920 2d3e 204e 6f6e 653a 0a20  self) -> None:. 
+00013140: 2020 2020 2020 2022 2222 5465 7374 2074         """Test t
+00013150: 6861 7420 7468 6520 636f 6465 206f 7074  hat the code opt
+00013160: 696f 6e20 6967 6e6f 7265 7320 6572 726f  ion ignores erro
+00013170: 7273 2077 6865 6e20 7468 6520 7361 6e69  rs when the sani
+00013180: 7479 2063 6865 636b 7320 6661 696c 2e22  ty checks fail."
+00013190: 2222 0a20 2020 2020 2020 2023 2050 6174  "".        # Pat
+000131a0: 6368 2063 6572 6369 732e 6173 7365 7274  ch cercis.assert
+000131b0: 5f65 7175 6976 616c 656e 7420 746f 2065  _equivalent to e
+000131c0: 6e73 7572 6520 7468 6520 7361 6e69 7479  nsure the sanity
+000131d0: 2063 6865 636b 7320 6661 696c 0a20 2020   checks fail.   
+000131e0: 2020 2020 2077 6974 6820 7061 7463 682e       with patch.
+000131f0: 6f62 6a65 6374 2863 6572 6369 732c 2022  object(cercis, "
+00013200: 6173 7365 7274 5f65 7175 6976 616c 656e  assert_equivalen
+00013210: 7422 2c20 7369 6465 5f65 6666 6563 743d  t", side_effect=
+00013220: 4173 7365 7274 696f 6e45 7272 6f72 293a  AssertionError):
+00013230: 0a20 2020 2020 2020 2020 2020 2063 6f64  .            cod
+00013240: 6520 3d20 2270 7269 6e74 2827 4865 6c6c  e = "print('Hell
+00013250: 6f20 776f 726c 6427 2922 0a20 2020 2020  o world')".     
+00013260: 2020 2020 2020 2066 6f72 6d61 7474 6564         formatted
+00013270: 203d 2063 6572 6369 732e 666f 726d 6174   = cercis.format
+00013280: 5f73 7472 2863 6f64 652c 206d 6f64 653d  _str(code, mode=
+00013290: 4445 4641 554c 545f 4d4f 4445 290a 0a20  DEFAULT_MODE).. 
+000132a0: 2020 2020 2020 2020 2020 2061 7267 7320             args 
+000132b0: 3d20 5b22 2d2d 6661 7374 222c 2022 2d2d  = ["--fast", "--
+000132c0: 636f 6465 222c 2063 6f64 652c 2022 2d2d  code", code, "--
+000132d0: 7369 6e67 6c65 2d71 756f 7465 3d54 7275  single-quote=Tru
+000132e0: 6522 5d0a 2020 2020 2020 2020 2020 2020  e"].            
+000132f0: 7265 7375 6c74 203d 2043 6c69 5275 6e6e  result = CliRunn
+00013300: 6572 2829 2e69 6e76 6f6b 6528 6365 7263  er().invoke(cerc
+00013310: 6973 2e6d 6169 6e2c 2061 7267 7329 0a0a  is.main, args)..
+00013320: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00013330: 2e63 6f6d 7061 7265 5f72 6573 756c 7473  .compare_results
+00013340: 2872 6573 756c 742c 2066 6f72 6d61 7474  (result, formatt
+00013350: 6564 2c20 3029 0a0a 2020 2020 4070 7974  ed, 0)..    @pyt
+00013360: 6573 742e 6d61 726b 2e69 6e63 6f6d 7061  est.mark.incompa
+00013370: 7469 626c 655f 7769 7468 5f6d 7970 7963  tible_with_mypyc
+00013380: 0a20 2020 2064 6566 2074 6573 745f 636f  .    def test_co
+00013390: 6465 5f6f 7074 696f 6e5f 636f 6e66 6967  de_option_config
+000133a0: 2873 656c 6629 202d 3e20 4e6f 6e65 3a0a  (self) -> None:.
+000133b0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000133c0: 2020 2020 5465 7374 2074 6861 7420 7468      Test that th
+000133d0: 6520 636f 6465 206f 7074 696f 6e20 6669  e code option fi
+000133e0: 6e64 7320 7468 6520 7079 7072 6f6a 6563  nds the pyprojec
+000133f0: 742e 746f 6d6c 2069 6e20 7468 6520 6375  t.toml in the cu
+00013400: 7272 656e 7420 6469 7265 6374 6f72 792e  rrent directory.
+00013410: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00013420: 2020 2020 2077 6974 6820 7061 7463 682e       with patch.
+00013430: 6f62 6a65 6374 2863 6572 6369 732c 2022  object(cercis, "
+00013440: 7061 7273 655f 7079 7072 6f6a 6563 745f  parse_pyproject_
+00013450: 746f 6d6c 222c 2072 6574 7572 6e5f 7661  toml", return_va
+00013460: 6c75 653d 7b7d 2920 6173 2070 6172 7365  lue={}) as parse
+00013470: 3a0a 2020 2020 2020 2020 2020 2020 6172  :.            ar
+00013480: 6773 203d 205b 222d 2d63 6f64 6522 2c20  gs = ["--code", 
+00013490: 2270 7269 6e74 225d 0a20 2020 2020 2020  "print"].       
+000134a0: 2020 2020 2023 2054 6869 7320 6973 2074       # This is t
+000134b0: 6865 206f 6e6c 7920 6469 7265 6374 6f72  he only director
+000134c0: 7920 6b6e 6f77 6e20 746f 2063 6f6e 7461  y known to conta
+000134d0: 696e 2061 2070 7970 726f 6a65 6374 2e74  in a pyproject.t
+000134e0: 6f6d 6c0a 2020 2020 2020 2020 2020 2020  oml.            
+000134f0: 7769 7468 2063 6861 6e67 655f 6469 7265  with change_dire
+00013500: 6374 6f72 7928 5052 4f4a 4543 545f 524f  ctory(PROJECT_RO
+00013510: 4f54 293a 0a20 2020 2020 2020 2020 2020  OT):.           
+00013520: 2020 2020 2043 6c69 5275 6e6e 6572 2829       CliRunner()
+00013530: 2e69 6e76 6f6b 6528 6365 7263 6973 2e6d  .invoke(cercis.m
+00013540: 6169 6e2c 2061 7267 7329 0a20 2020 2020  ain, args).     
+00013550: 2020 2020 2020 2020 2020 2070 7970 726f             pypro
+00013560: 6a65 6374 5f70 6174 6820 3d20 5061 7468  ject_path = Path
+00013570: 2850 6174 682e 6377 6428 292c 2022 7079  (Path.cwd(), "py
+00013580: 7072 6f6a 6563 742e 746f 6d6c 2229 2e72  project.toml").r
+00013590: 6573 6f6c 7665 2829 0a0a 2020 2020 2020  esolve()..      
+000135a0: 2020 2020 2020 6173 7365 7274 2028 0a20        assert (. 
+000135b0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+000135c0: 656e 2870 6172 7365 2e6d 6f63 6b5f 6361  en(parse.mock_ca
+000135d0: 6c6c 7329 203e 3d20 310a 2020 2020 2020  lls) >= 1.      
+000135e0: 2020 2020 2020 292c 2022 4578 7065 6374        ), "Expect
+000135f0: 6564 2063 6f6e 6669 6720 7061 7273 6520  ed config parse 
+00013600: 746f 2062 6520 6361 6c6c 6564 2077 6974  to be called wit
+00013610: 6820 7468 6520 6375 7272 656e 7420 6469  h the current di
+00013620: 7265 6374 6f72 792e 220a 0a20 2020 2020  rectory."..     
+00013630: 2020 2020 2020 205f 2c20 6361 6c6c 5f61         _, call_a
+00013640: 7267 732c 205f 203d 2070 6172 7365 2e6d  rgs, _ = parse.m
+00013650: 6f63 6b5f 6361 6c6c 735b 305d 0a20 2020  ock_calls[0].   
+00013660: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+00013670: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00013680: 2020 6361 6c6c 5f61 7267 735b 305d 2e6c    call_args[0].l
+00013690: 6f77 6572 2829 203d 3d20 7374 7228 7079  ower() == str(py
+000136a0: 7072 6f6a 6563 745f 7061 7468 292e 6c6f  project_path).lo
+000136b0: 7765 7228 290a 2020 2020 2020 2020 2020  wer().          
+000136c0: 2020 292c 2022 496e 636f 7272 6563 7420    ), "Incorrect 
+000136d0: 636f 6e66 6967 206c 6f61 6465 642e 220a  config loaded.".
+000136e0: 0a20 2020 2040 7079 7465 7374 2e6d 6172  .    @pytest.mar
+000136f0: 6b2e 696e 636f 6d70 6174 6962 6c65 5f77  k.incompatible_w
+00013700: 6974 685f 6d79 7079 630a 2020 2020 6465  ith_mypyc.    de
+00013710: 6620 7465 7374 5f63 6f64 655f 6f70 7469  f test_code_opti
+00013720: 6f6e 5f70 6172 656e 745f 636f 6e66 6967  on_parent_config
+00013730: 2873 656c 6629 202d 3e20 4e6f 6e65 3a0a  (self) -> None:.
+00013740: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00013750: 2020 2020 5465 7374 2074 6861 7420 7468      Test that th
+00013760: 6520 636f 6465 206f 7074 696f 6e20 6669  e code option fi
+00013770: 6e64 7320 7468 6520 7079 7072 6f6a 6563  nds the pyprojec
+00013780: 742e 746f 6d6c 2069 6e20 7468 6520 7061  t.toml in the pa
+00013790: 7265 6e74 2064 6972 6563 746f 7279 2e0a  rent directory..
+000137a0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000137b0: 2020 2020 7769 7468 2070 6174 6368 2e6f      with patch.o
+000137c0: 626a 6563 7428 6365 7263 6973 2c20 2270  bject(cercis, "p
+000137d0: 6172 7365 5f70 7970 726f 6a65 6374 5f74  arse_pyproject_t
+000137e0: 6f6d 6c22 2c20 7265 7475 726e 5f76 616c  oml", return_val
+000137f0: 7565 3d7b 7d29 2061 7320 7061 7273 653a  ue={}) as parse:
+00013800: 0a20 2020 2020 2020 2020 2020 2077 6974  .            wit
+00013810: 6820 6368 616e 6765 5f64 6972 6563 746f  h change_directo
+00013820: 7279 2854 4849 535f 4449 5229 3a0a 2020  ry(THIS_DIR):.  
+00013830: 2020 2020 2020 2020 2020 2020 2020 6172                ar
+00013840: 6773 203d 205b 222d 2d63 6f64 6522 2c20  gs = ["--code", 
+00013850: 2270 7269 6e74 225d 0a20 2020 2020 2020  "print"].       
+00013860: 2020 2020 2020 2020 2043 6c69 5275 6e6e           CliRunn
+00013870: 6572 2829 2e69 6e76 6f6b 6528 6365 7263  er().invoke(cerc
+00013880: 6973 2e6d 6169 6e2c 2061 7267 7329 0a0a  is.main, args)..
+00013890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000138a0: 7079 7072 6f6a 6563 745f 7061 7468 203d  pyproject_path =
+000138b0: 2050 6174 6828 5061 7468 2829 2e63 7764   Path(Path().cwd
+000138c0: 2829 2e70 6172 656e 742c 2022 7079 7072  ().parent, "pypr
+000138d0: 6f6a 6563 742e 746f 6d6c 2229 2e72 6573  oject.toml").res
+000138e0: 6f6c 7665 2829 0a20 2020 2020 2020 2020  olve().         
+000138f0: 2020 2020 2020 2061 7373 6572 7420 280a         assert (.
+00013900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013910: 2020 2020 6c65 6e28 7061 7273 652e 6d6f      len(parse.mo
+00013920: 636b 5f63 616c 6c73 2920 3e3d 2031 0a20  ck_calls) >= 1. 
+00013930: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00013940: 2c20 2245 7870 6563 7465 6420 636f 6e66  , "Expected conf
+00013950: 6967 2070 6172 7365 2074 6f20 6265 2063  ig parse to be c
+00013960: 616c 6c65 6420 7769 7468 2074 6865 2063  alled with the c
+00013970: 7572 7265 6e74 2064 6972 6563 746f 7279  urrent directory
+00013980: 2e22 0a0a 2020 2020 2020 2020 2020 2020  ."..            
+00013990: 2020 2020 5f2c 2063 616c 6c5f 6172 6773      _, call_args
+000139a0: 2c20 5f20 3d20 7061 7273 652e 6d6f 636b  , _ = parse.mock
+000139b0: 5f63 616c 6c73 5b30 5d0a 2020 2020 2020  _calls[0].      
+000139c0: 2020 2020 2020 2020 2020 6173 7365 7274            assert
+000139d0: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+000139e0: 2020 2020 2020 2063 616c 6c5f 6172 6773         call_args
+000139f0: 5b30 5d2e 6c6f 7765 7228 2920 3d3d 2073  [0].lower() == s
+00013a00: 7472 2870 7970 726f 6a65 6374 5f70 6174  tr(pyproject_pat
+00013a10: 6829 2e6c 6f77 6572 2829 0a20 2020 2020  h).lower().     
+00013a20: 2020 2020 2020 2020 2020 2029 2c20 2249             ), "I
+00013a30: 6e63 6f72 7265 6374 2063 6f6e 6669 6720  ncorrect config 
+00013a40: 6c6f 6164 6564 2e22 0a0a 2020 2020 6465  loaded."..    de
+00013a50: 6620 7465 7374 5f66 6f72 5f68 616e 646c  f test_for_handl
+00013a60: 6564 5f75 6e65 7870 6563 7465 645f 656f  ed_unexpected_eo
+00013a70: 665f 6572 726f 7228 7365 6c66 2920 2d3e  f_error(self) ->
+00013a80: 204e 6f6e 653a 0a20 2020 2020 2020 2022   None:.        "
+00013a90: 2222 0a20 2020 2020 2020 2054 6573 7420  "".        Test 
+00013aa0: 7468 6174 2061 6e20 756e 6578 7065 6374  that an unexpect
+00013ab0: 6564 2045 4f46 2053 796e 7461 7845 7272  ed EOF SyntaxErr
+00013ac0: 6f72 2069 7320 6e69 6365 6c79 2070 7265  or is nicely pre
+00013ad0: 7365 6e74 6564 2e0a 2020 2020 2020 2020  sented..        
+00013ae0: 2222 220a 2020 2020 2020 2020 7769 7468  """.        with
+00013af0: 2070 7974 6573 742e 7261 6973 6573 2863   pytest.raises(c
+00013b00: 6572 6369 732e 7061 7273 696e 672e 496e  ercis.parsing.In
+00013b10: 7661 6c69 6449 6e70 7574 2920 6173 2065  validInput) as e
+00013b20: 7863 5f69 6e66 6f3a 0a20 2020 2020 2020  xc_info:.       
+00013b30: 2020 2020 2063 6572 6369 732e 6c69 6232       cercis.lib2
+00013b40: 746f 335f 7061 7273 6528 2270 7269 6e74  to3_parse("print
+00013b50: 2822 2c20 7b7d 290a 0a20 2020 2020 2020  (", {})..       
+00013b60: 2065 7863 5f69 6e66 6f2e 6d61 7463 6828   exc_info.match(
+00013b70: 2243 616e 6e6f 7420 7061 7273 653a 2032  "Cannot parse: 2
+00013b80: 3a30 3a20 454f 4620 696e 206d 756c 7469  :0: EOF in multi
+00013b90: 2d6c 696e 6520 7374 6174 656d 656e 7422  -line statement"
+00013ba0: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
+00013bb0: 6571 7569 7661 6c65 6e63 795f 6173 745f  equivalency_ast_
+00013bc0: 7061 7273 655f 6661 696c 7572 655f 696e  parse_failure_in
+00013bd0: 636c 7564 6573 5f65 7272 6f72 2873 656c  cludes_error(sel
+00013be0: 6629 202d 3e20 4e6f 6e65 3a0a 2020 2020  f) -> None:.    
+00013bf0: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
+00013c00: 7261 6973 6573 2841 7373 6572 7469 6f6e  raises(Assertion
+00013c10: 4572 726f 7229 2061 7320 6572 723a 0a20  Error) as err:. 
+00013c20: 2020 2020 2020 2020 2020 2063 6572 6369             cerci
+00013c30: 732e 6173 7365 7274 5f65 7175 6976 616c  s.assert_equival
+00013c40: 656e 7428 2261 c2ab c2bb 6120 203d 2031  ent("a....a  = 1
+00013c50: 222c 2022 61c2 abc2 bb61 2020 3d20 3122  ", "a....a  = 1"
+00013c60: 290a 0a20 2020 2020 2020 2065 7272 2e6d  )..        err.m
+00013c70: 6174 6368 2822 2d2d 7361 6665 2229 0a20  atch("--safe"). 
+00013c80: 2020 2020 2020 2023 2055 6e66 6f72 7475         # Unfortu
+00013c90: 6e61 7465 6c79 2074 6865 2053 796e 7461  nately the Synta
+00013ca0: 7845 7272 6f72 206d 6573 7361 6765 2068  xError message h
+00013cb0: 6173 2063 6861 6e67 6564 2069 6e20 6e65  as changed in ne
+00013cc0: 7765 7220 7665 7273 696f 6e73 2073 6f20  wer versions so 
+00013cd0: 7765 0a20 2020 2020 2020 2023 2063 616e  we.        # can
+00013ce0: 2774 206d 6174 6368 2069 7420 6469 7265  't match it dire
+00013cf0: 6374 6c79 2e0a 2020 2020 2020 2020 6572  ctly..        er
+00013d00: 722e 6d61 7463 6828 2269 6e76 616c 6964  r.match("invalid
+00013d10: 2063 6861 7261 6374 6572 2229 0a20 2020   character").   
+00013d20: 2020 2020 2065 7272 2e6d 6174 6368 2872       err.match(r
+00013d30: 225c 283c 756e 6b6e 6f77 6e3e 2c20 6c69  "\(<unknown>, li
+00013d40: 6e65 2031 5c29 2229 0a0a 0a63 6c61 7373  ne 1\)")...class
+00013d50: 2054 6573 7443 6163 6869 6e67 3a0a 2020   TestCaching:.  
+00013d60: 2020 6465 6620 7465 7374 5f67 6574 5f63    def test_get_c
+00013d70: 6163 6865 5f64 6972 280a 2020 2020 2020  ache_dir(.      
+00013d80: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00013d90: 2020 2020 2020 2020 746d 705f 7061 7468          tmp_path
+00013da0: 3a20 5061 7468 2c0a 2020 2020 2020 2020  : Path,.        
+00013db0: 2020 2020 6d6f 6e6b 6579 7061 7463 683a      monkeypatch:
+00013dc0: 2070 7974 6573 742e 4d6f 6e6b 6579 5061   pytest.MonkeyPa
+00013dd0: 7463 682c 0a20 2020 2029 202d 3e20 4e6f  tch,.    ) -> No
+00013de0: 6e65 3a0a 2020 2020 2020 2020 2320 4372  ne:.        # Cr
+00013df0: 6561 7465 206d 756c 7469 706c 6520 6361  eate multiple ca
+00013e00: 6368 6520 6469 7265 6374 6f72 6965 730a  che directories.
+00013e10: 2020 2020 2020 2020 776f 726b 7370 6163          workspac
+00013e20: 6531 203d 2074 6d70 5f70 6174 6820 2f20  e1 = tmp_path / 
+00013e30: 2277 7331 220a 2020 2020 2020 2020 776f  "ws1".        wo
+00013e40: 726b 7370 6163 6531 2e6d 6b64 6972 2829  rkspace1.mkdir()
+00013e50: 0a20 2020 2020 2020 2077 6f72 6b73 7061  .        workspa
+00013e60: 6365 3220 3d20 746d 705f 7061 7468 202f  ce2 = tmp_path /
+00013e70: 2022 7773 3222 0a20 2020 2020 2020 2077   "ws2".        w
+00013e80: 6f72 6b73 7061 6365 322e 6d6b 6469 7228  orkspace2.mkdir(
+00013e90: 290a 0a20 2020 2020 2020 2023 2046 6f72  )..        # For
+00013ea0: 6365 2075 7365 725f 6361 6368 655f 6469  ce user_cache_di
+00013eb0: 7220 746f 2075 7365 2074 6865 2074 656d  r to use the tem
+00013ec0: 706f 7261 7279 2064 6972 6563 746f 7279  porary directory
+00013ed0: 2066 6f72 2065 6173 6965 7220 6173 7365   for easier asse
+00013ee0: 7274 696f 6e73 0a20 2020 2020 2020 2070  rtions.        p
+00013ef0: 6174 6368 5f75 7365 725f 6361 6368 655f  atch_user_cache_
+00013f00: 6469 7220 3d20 7061 7463 6828 0a20 2020  dir = patch(.   
+00013f10: 2020 2020 2020 2020 2074 6172 6765 743d           target=
+00013f20: 2263 6572 6369 732e 6361 6368 652e 7573  "cercis.cache.us
+00013f30: 6572 5f63 6163 6865 5f64 6972 222c 0a20  er_cache_dir",. 
+00013f40: 2020 2020 2020 2020 2020 2061 7574 6f73             autos
+00013f50: 7065 633d 5472 7565 2c0a 2020 2020 2020  pec=True,.      
+00013f60: 2020 2020 2020 7265 7475 726e 5f76 616c        return_val
+00013f70: 7565 3d73 7472 2877 6f72 6b73 7061 6365  ue=str(workspace
+00013f80: 3129 2c0a 2020 2020 2020 2020 290a 0a20  1),.        ).. 
+00013f90: 2020 2020 2020 2023 2049 6620 424c 4143         # If BLAC
+00013fa0: 4b5f 4341 4348 455f 4449 5220 6973 206e  K_CACHE_DIR is n
+00013fb0: 6f74 2073 6574 2c20 7573 6520 7573 6572  ot set, use user
+00013fc0: 5f63 6163 6865 5f64 6972 0a20 2020 2020  _cache_dir.     
+00013fd0: 2020 206d 6f6e 6b65 7970 6174 6368 2e64     monkeypatch.d
+00013fe0: 656c 656e 7628 2242 4c41 434b 5f43 4143  elenv("BLACK_CAC
+00013ff0: 4845 5f44 4952 222c 2072 6169 7369 6e67  HE_DIR", raising
+00014000: 3d46 616c 7365 290a 2020 2020 2020 2020  =False).        
+00014010: 7769 7468 2070 6174 6368 5f75 7365 725f  with patch_user_
+00014020: 6361 6368 655f 6469 723a 0a20 2020 2020  cache_dir:.     
+00014030: 2020 2020 2020 2061 7373 6572 7420 6765         assert ge
+00014040: 745f 6361 6368 655f 6469 7228 2920 3d3d  t_cache_dir() ==
+00014050: 2077 6f72 6b73 7061 6365 310a 0a20 2020   workspace1..   
+00014060: 2020 2020 2023 2049 6620 6974 2069 7320       # If it is 
+00014070: 7365 742c 2075 7365 2074 6865 2070 6174  set, use the pat
+00014080: 6820 7072 6f76 6964 6564 2069 6e20 7468  h provided in th
+00014090: 6520 656e 7620 7661 722e 0a20 2020 2020  e env var..     
+000140a0: 2020 206d 6f6e 6b65 7970 6174 6368 2e73     monkeypatch.s
+000140b0: 6574 656e 7628 2242 4c41 434b 5f43 4143  etenv("BLACK_CAC
+000140c0: 4845 5f44 4952 222c 2073 7472 2877 6f72  HE_DIR", str(wor
+000140d0: 6b73 7061 6365 3229 290a 2020 2020 2020  kspace2)).      
+000140e0: 2020 6173 7365 7274 2067 6574 5f63 6163    assert get_cac
+000140f0: 6865 5f64 6972 2829 203d 3d20 776f 726b  he_dir() == work
+00014100: 7370 6163 6532 0a0a 2020 2020 6465 6620  space2..    def 
+00014110: 7465 7374 5f63 6163 6865 5f62 726f 6b65  test_cache_broke
+00014120: 6e5f 6669 6c65 2873 656c 6629 202d 3e20  n_file(self) -> 
+00014130: 4e6f 6e65 3a0a 2020 2020 2020 2020 6d6f  None:.        mo
+00014140: 6465 203d 2044 4546 4155 4c54 5f4d 4f44  de = DEFAULT_MOD
+00014150: 450a 2020 2020 2020 2020 7769 7468 2063  E.        with c
+00014160: 6163 6865 5f64 6972 2829 2061 7320 776f  ache_dir() as wo
+00014170: 726b 7370 6163 653a 0a20 2020 2020 2020  rkspace:.       
+00014180: 2020 2020 2063 6163 6865 5f66 696c 6520       cache_file 
+00014190: 3d20 6765 745f 6361 6368 655f 6669 6c65  = get_cache_file
+000141a0: 286d 6f64 6529 0a20 2020 2020 2020 2020  (mode).         
+000141b0: 2020 2063 6163 6865 5f66 696c 652e 7772     cache_file.wr
+000141c0: 6974 655f 7465 7874 2822 7468 6973 2069  ite_text("this i
+000141d0: 7320 6e6f 7420 6120 7069 636b 6c65 222c  s not a pickle",
+000141e0: 2065 6e63 6f64 696e 673d 2275 7466 2d38   encoding="utf-8
+000141f0: 2229 0a20 2020 2020 2020 2020 2020 2061  ").            a
+00014200: 7373 6572 7420 6365 7263 6973 2e72 6561  ssert cercis.rea
+00014210: 645f 6361 6368 6528 6d6f 6465 2920 3d3d  d_cache(mode) ==
+00014220: 207b 7d0a 2020 2020 2020 2020 2020 2020   {}.            
+00014230: 7372 6320 3d20 2877 6f72 6b73 7061 6365  src = (workspace
+00014240: 202f 2022 7465 7374 2e70 7922 292e 7265   / "test.py").re
+00014250: 736f 6c76 6528 290a 2020 2020 2020 2020  solve().        
+00014260: 2020 2020 7372 632e 7772 6974 655f 7465      src.write_te
+00014270: 7874 2822 7072 696e 7428 2768 656c 6c6f  xt("print('hello
+00014280: 2729 222c 2065 6e63 6f64 696e 673d 2275  ')", encoding="u
+00014290: 7466 2d38 2229 0a20 2020 2020 2020 2020  tf-8").         
+000142a0: 2020 2069 6e76 6f6b 6542 6c61 636b 285b     invokeBlack([
+000142b0: 7374 7228 7372 6329 5d29 0a20 2020 2020  str(src)]).     
+000142c0: 2020 2020 2020 2063 6163 6865 203d 2063         cache = c
+000142d0: 6572 6369 732e 7265 6164 5f63 6163 6865  ercis.read_cache
+000142e0: 286d 6f64 6529 0a20 2020 2020 2020 2020  (mode).         
+000142f0: 2020 2061 7373 6572 7420 7374 7228 7372     assert str(sr
+00014300: 6329 2069 6e20 6361 6368 650a 0a20 2020  c) in cache..   
+00014310: 2064 6566 2074 6573 745f 6361 6368 655f   def test_cache_
+00014320: 7369 6e67 6c65 5f66 696c 655f 616c 7265  single_file_alre
+00014330: 6164 795f 6361 6368 6564 2873 656c 6629  ady_cached(self)
+00014340: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00014350: 2020 6d6f 6465 203d 2044 4546 4155 4c54    mode = DEFAULT
+00014360: 5f4d 4f44 450a 2020 2020 2020 2020 7769  _MODE.        wi
+00014370: 7468 2063 6163 6865 5f64 6972 2829 2061  th cache_dir() a
+00014380: 7320 776f 726b 7370 6163 653a 0a20 2020  s workspace:.   
+00014390: 2020 2020 2020 2020 2073 7263 203d 2028           src = (
+000143a0: 776f 726b 7370 6163 6520 2f20 2274 6573  workspace / "tes
+000143b0: 742e 7079 2229 2e72 6573 6f6c 7665 2829  t.py").resolve()
+000143c0: 0a20 2020 2020 2020 2020 2020 2073 7263  .            src
+000143d0: 2e77 7269 7465 5f74 6578 7428 2270 7269  .write_text("pri
+000143e0: 6e74 2827 6865 6c6c 6f27 2922 2c20 656e  nt('hello')", en
+000143f0: 636f 6469 6e67 3d22 7574 662d 3822 290a  coding="utf-8").
+00014400: 2020 2020 2020 2020 2020 2020 6365 7263              cerc
+00014410: 6973 2e77 7269 7465 5f63 6163 6865 287b  is.write_cache({
+00014420: 7d2c 205b 7372 635d 2c20 6d6f 6465 290a  }, [src], mode).
+00014430: 2020 2020 2020 2020 2020 2020 696e 766f              invo
+00014440: 6b65 426c 6163 6b28 5b73 7472 2873 7263  keBlack([str(src
+00014450: 295d 290a 2020 2020 2020 2020 2020 2020  )]).            
+00014460: 6173 7365 7274 2073 7263 2e72 6561 645f  assert src.read_
+00014470: 7465 7874 2865 6e63 6f64 696e 673d 2275  text(encoding="u
+00014480: 7466 2d38 2229 203d 3d20 2270 7269 6e74  tf-8") == "print
+00014490: 2827 6865 6c6c 6f27 2922 0a0a 2020 2020  ('hello')"..    
+000144a0: 4065 7665 6e74 5f6c 6f6f 7028 290a 2020  @event_loop().  
+000144b0: 2020 6465 6620 7465 7374 5f63 6163 6865    def test_cache
+000144c0: 5f6d 756c 7469 706c 655f 6669 6c65 7328  _multiple_files(
+000144d0: 7365 6c66 2920 2d3e 204e 6f6e 653a 0a20  self) -> None:. 
+000144e0: 2020 2020 2020 206d 6f64 6520 3d20 4445         mode = DE
+000144f0: 4641 554c 545f 4d4f 4445 0a20 2020 2020  FAULT_MODE.     
+00014500: 2020 2077 6974 6820 6361 6368 655f 6469     with cache_di
+00014510: 7228 2920 6173 2077 6f72 6b73 7061 6365  r() as workspace
+00014520: 2c20 7061 7463 6828 0a20 2020 2020 2020  , patch(.       
+00014530: 2020 2020 2022 636f 6e63 7572 7265 6e74       "concurrent
+00014540: 2e66 7574 7572 6573 2e50 726f 6365 7373  .futures.Process
+00014550: 506f 6f6c 4578 6563 7574 6f72 222c 206e  PoolExecutor", n
+00014560: 6577 3d54 6872 6561 6450 6f6f 6c45 7865  ew=ThreadPoolExe
+00014570: 6375 746f 720a 2020 2020 2020 2020 293a  cutor.        ):
+00014580: 0a20 2020 2020 2020 2020 2020 206f 6e65  .            one
+00014590: 203d 2028 776f 726b 7370 6163 6520 2f20   = (workspace / 
+000145a0: 226f 6e65 2e70 7922 292e 7265 736f 6c76  "one.py").resolv
+000145b0: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
+000145c0: 6f6e 652e 7772 6974 655f 7465 7874 2822  one.write_text("
+000145d0: 7072 696e 7428 2768 656c 6c6f 2729 222c  print('hello')",
+000145e0: 2065 6e63 6f64 696e 673d 2275 7466 2d38   encoding="utf-8
+000145f0: 2229 0a20 2020 2020 2020 2020 2020 2074  ").            t
+00014600: 776f 203d 2028 776f 726b 7370 6163 6520  wo = (workspace 
+00014610: 2f20 2274 776f 2e70 7922 292e 7265 736f  / "two.py").reso
+00014620: 6c76 6528 290a 2020 2020 2020 2020 2020  lve().          
+00014630: 2020 7477 6f2e 7772 6974 655f 7465 7874    two.write_text
+00014640: 2822 7072 696e 7428 2768 656c 6c6f 2729  ("print('hello')
+00014650: 222c 2065 6e63 6f64 696e 673d 2275 7466  ", encoding="utf
+00014660: 2d38 2229 0a20 2020 2020 2020 2020 2020  -8").           
+00014670: 2063 6572 6369 732e 7772 6974 655f 6361   cercis.write_ca
+00014680: 6368 6528 7b7d 2c20 5b6f 6e65 5d2c 206d  che({}, [one], m
+00014690: 6f64 6529 0a20 2020 2020 2020 2020 2020  ode).           
+000146a0: 2069 6e76 6f6b 6542 6c61 636b 285b 7374   invokeBlack([st
+000146b0: 7228 776f 726b 7370 6163 6529 2c20 222d  r(workspace), "-
+000146c0: 2d73 696e 676c 652d 7175 6f74 653d 4661  -single-quote=Fa
+000146d0: 6c73 6522 5d29 0a20 2020 2020 2020 2020  lse"]).         
+000146e0: 2020 2061 7373 6572 7420 6f6e 652e 7265     assert one.re
+000146f0: 6164 5f74 6578 7428 656e 636f 6469 6e67  ad_text(encoding
+00014700: 3d22 7574 662d 3822 2920 3d3d 2022 7072  ="utf-8") == "pr
+00014710: 696e 7428 2768 656c 6c6f 2729 220a 2020  int('hello')".  
+00014720: 2020 2020 2020 2020 2020 6173 7365 7274            assert
+00014730: 2074 776f 2e72 6561 645f 7465 7874 2865   two.read_text(e
+00014740: 6e63 6f64 696e 673d 2275 7466 2d38 2229  ncoding="utf-8")
+00014750: 203d 3d20 2770 7269 6e74 2822 6865 6c6c   == 'print("hell
+00014760: 6f22 295c 6e27 0a20 2020 2020 2020 2020  o")\n'.         
+00014770: 2020 2063 6163 6865 203d 2063 6572 6369     cache = cerci
+00014780: 732e 7265 6164 5f63 6163 6865 286d 6f64  s.read_cache(mod
+00014790: 6529 0a20 2020 2020 2020 2020 2020 2061  e).            a
+000147a0: 7373 6572 7420 7374 7228 6f6e 6529 2069  ssert str(one) i
+000147b0: 6e20 6361 6368 650a 2020 2020 2020 2020  n cache.        
+000147c0: 2020 2020 6173 7365 7274 2073 7472 2874      assert str(t
+000147d0: 776f 2920 696e 2063 6163 6865 0a0a 2020  wo) in cache..  
+000147e0: 2020 4070 7974 6573 742e 6d61 726b 2e70    @pytest.mark.p
+000147f0: 6172 616d 6574 7269 7a65 2822 636f 6c6f  arametrize("colo
+00014800: 7222 2c20 5b46 616c 7365 2c20 5472 7565  r", [False, True
+00014810: 5d2c 2069 6473 3d5b 226e 6f2d 636f 6c6f  ], ids=["no-colo
+00014820: 7222 2c20 2277 6974 682d 636f 6c6f 7222  r", "with-color"
+00014830: 5d29 0a20 2020 2064 6566 2074 6573 745f  ]).    def test_
+00014840: 6e6f 5f63 6163 6865 5f77 6865 6e5f 7772  no_cache_when_wr
+00014850: 6974 6562 6163 6b5f 6469 6666 2873 656c  iteback_diff(sel
+00014860: 662c 2063 6f6c 6f72 3a20 626f 6f6c 2920  f, color: bool) 
+00014870: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00014880: 206d 6f64 6520 3d20 4445 4641 554c 545f   mode = DEFAULT_
+00014890: 4d4f 4445 0a20 2020 2020 2020 2077 6974  MODE.        wit
+000148a0: 6820 6361 6368 655f 6469 7228 2920 6173  h cache_dir() as
+000148b0: 2077 6f72 6b73 7061 6365 3a0a 2020 2020   workspace:.    
+000148c0: 2020 2020 2020 2020 7372 6320 3d20 2877          src = (w
+000148d0: 6f72 6b73 7061 6365 202f 2022 7465 7374  orkspace / "test
+000148e0: 2e70 7922 292e 7265 736f 6c76 6528 290a  .py").resolve().
+000148f0: 2020 2020 2020 2020 2020 2020 7372 632e              src.
+00014900: 7772 6974 655f 7465 7874 2822 7072 696e  write_text("prin
+00014910: 7428 2768 656c 6c6f 2729 222c 2065 6e63  t('hello')", enc
+00014920: 6f64 696e 673d 2275 7466 2d38 2229 0a20  oding="utf-8"). 
+00014930: 2020 2020 2020 2020 2020 2077 6974 6820             with 
+00014940: 7061 7463 6828 2263 6572 6369 732e 7265  patch("cercis.re
+00014950: 6164 5f63 6163 6865 2229 2061 7320 7265  ad_cache") as re
+00014960: 6164 5f63 6163 6865 2c20 7061 7463 6828  ad_cache, patch(
+00014970: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014980: 2022 6365 7263 6973 2e77 7269 7465 5f63   "cercis.write_c
+00014990: 6163 6865 220a 2020 2020 2020 2020 2020  ache".          
+000149a0: 2020 2920 6173 2077 7269 7465 5f63 6163    ) as write_cac
+000149b0: 6865 3a0a 2020 2020 2020 2020 2020 2020  he:.            
+000149c0: 2020 2020 636d 6420 3d20 5b73 7472 2873      cmd = [str(s
+000149d0: 7263 292c 2022 2d2d 6469 6666 225d 0a20  rc), "--diff"]. 
+000149e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000149f0: 6620 636f 6c6f 723a 0a20 2020 2020 2020  f color:.       
+00014a00: 2020 2020 2020 2020 2020 2020 2063 6d64               cmd
+00014a10: 2e61 7070 656e 6428 222d 2d63 6f6c 6f72  .append("--color
+00014a20: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+00014a30: 2020 2069 6e76 6f6b 6542 6c61 636b 2863     invokeBlack(c
+00014a40: 6d64 290a 2020 2020 2020 2020 2020 2020  md).            
+00014a50: 2020 2020 6361 6368 655f 6669 6c65 203d      cache_file =
+00014a60: 2067 6574 5f63 6163 6865 5f66 696c 6528   get_cache_file(
+00014a70: 6d6f 6465 290a 2020 2020 2020 2020 2020  mode).          
+00014a80: 2020 2020 2020 6173 7365 7274 2063 6163        assert cac
+00014a90: 6865 5f66 696c 652e 6578 6973 7473 2829  he_file.exists()
+00014aa0: 2069 7320 4661 6c73 650a 2020 2020 2020   is False.      
+00014ab0: 2020 2020 2020 2020 2020 7772 6974 655f            write_
+00014ac0: 6361 6368 652e 6173 7365 7274 5f6e 6f74  cache.assert_not
+00014ad0: 5f63 616c 6c65 6428 290a 2020 2020 2020  _called().      
+00014ae0: 2020 2020 2020 2020 2020 7265 6164 5f63            read_c
+00014af0: 6163 6865 2e61 7373 6572 745f 6e6f 745f  ache.assert_not_
+00014b00: 6361 6c6c 6564 2829 0a0a 2020 2020 4070  called()..    @p
+00014b10: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
+00014b20: 6574 7269 7a65 2822 636f 6c6f 7222 2c20  etrize("color", 
+00014b30: 5b46 616c 7365 2c20 5472 7565 5d2c 2069  [False, True], i
+00014b40: 6473 3d5b 226e 6f2d 636f 6c6f 7222 2c20  ds=["no-color", 
+00014b50: 2277 6974 682d 636f 6c6f 7222 5d29 0a20  "with-color"]). 
+00014b60: 2020 2040 6576 656e 745f 6c6f 6f70 2829     @event_loop()
+00014b70: 0a20 2020 2064 6566 2074 6573 745f 6f75  .    def test_ou
+00014b80: 7470 7574 5f6c 6f63 6b69 6e67 5f77 6865  tput_locking_whe
+00014b90: 6e5f 7772 6974 6562 6163 6b5f 6469 6666  n_writeback_diff
+00014ba0: 2873 656c 662c 2063 6f6c 6f72 3a20 626f  (self, color: bo
+00014bb0: 6f6c 2920 2d3e 204e 6f6e 653a 0a20 2020  ol) -> None:.   
+00014bc0: 2020 2020 2077 6974 6820 6361 6368 655f       with cache_
+00014bd0: 6469 7228 2920 6173 2077 6f72 6b73 7061  dir() as workspa
+00014be0: 6365 3a0a 2020 2020 2020 2020 2020 2020  ce:.            
+00014bf0: 666f 7220 7461 6720 696e 2072 616e 6765  for tag in range
+00014c00: 2830 2c20 3429 3a0a 2020 2020 2020 2020  (0, 4):.        
+00014c10: 2020 2020 2020 2020 7372 6320 3d20 2877          src = (w
+00014c20: 6f72 6b73 7061 6365 202f 2066 2274 6573  orkspace / f"tes
+00014c30: 747b 7461 677d 2e70 7922 292e 7265 736f  t{tag}.py").reso
+00014c40: 6c76 6528 290a 2020 2020 2020 2020 2020  lve().          
+00014c50: 2020 2020 2020 7372 632e 7772 6974 655f        src.write_
+00014c60: 7465 7874 2822 7072 696e 7428 2768 656c  text("print('hel
+00014c70: 6c6f 2729 222c 2065 6e63 6f64 696e 673d  lo')", encoding=
+00014c80: 2275 7466 2d38 2229 0a20 2020 2020 2020  "utf-8").       
+00014c90: 2020 2020 2077 6974 6820 7061 7463 6828       with patch(
+00014ca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014cb0: 2022 6365 7263 6973 2e63 6f6e 6375 7272   "cercis.concurr
+00014cc0: 656e 6379 2e4d 616e 6167 6572 222c 2077  ency.Manager", w
+00014cd0: 7261 7073 3d6d 756c 7469 7072 6f63 6573  raps=multiproces
+00014ce0: 7369 6e67 2e4d 616e 6167 6572 0a20 2020  sing.Manager.   
+00014cf0: 2020 2020 2020 2020 2029 2061 7320 6d67           ) as mg
+00014d00: 723a 0a20 2020 2020 2020 2020 2020 2020  r:.             
+00014d10: 2020 2063 6d64 203d 205b 222d 2d64 6966     cmd = ["--dif
+00014d20: 6622 2c20 7374 7228 776f 726b 7370 6163  f", str(workspac
+00014d30: 6529 5d0a 2020 2020 2020 2020 2020 2020  e)].            
+00014d40: 2020 2020 6966 2063 6f6c 6f72 3a0a 2020      if color:.  
+00014d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014d60: 2020 636d 642e 6170 7065 6e64 2822 2d2d    cmd.append("--
+00014d70: 636f 6c6f 7222 290a 2020 2020 2020 2020  color").        
+00014d80: 2020 2020 2020 2020 696e 766f 6b65 426c          invokeBl
+00014d90: 6163 6b28 636d 642c 2065 7869 745f 636f  ack(cmd, exit_co
+00014da0: 6465 3d30 290a 2020 2020 2020 2020 2020  de=0).          
+00014db0: 2020 2020 2020 2320 7468 6973 2069 736e        # this isn
+00014dc0: 2774 2071 7569 7465 2064 6f69 6e67 2077  't quite doing w
+00014dd0: 6861 7420 7765 2077 616e 742c 2062 7574  hat we want, but
+00014de0: 2069 6620 6974 205f 6973 6e27 745f 0a20   if it _isn't_. 
+00014df0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00014e00: 2063 616c 6c65 6420 7468 656e 2077 6520   called then we 
+00014e10: 6361 6e6e 6f74 2062 6520 7573 696e 6720  cannot be using 
+00014e20: 7468 6520 6c6f 636b 2069 7420 7072 6f76  the lock it prov
+00014e30: 6964 6573 0a20 2020 2020 2020 2020 2020  ides.           
+00014e40: 2020 2020 206d 6772 2e61 7373 6572 745f       mgr.assert_
+00014e50: 6361 6c6c 6564 2829 0a0a 2020 2020 6465  called()..    de
+00014e60: 6620 7465 7374 5f6e 6f5f 6361 6368 655f  f test_no_cache_
+00014e70: 7768 656e 5f73 7464 696e 2873 656c 6629  when_stdin(self)
+00014e80: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00014e90: 2020 6d6f 6465 203d 2044 4546 4155 4c54    mode = DEFAULT
+00014ea0: 5f4d 4f44 450a 2020 2020 2020 2020 7769  _MODE.        wi
+00014eb0: 7468 2063 6163 6865 5f64 6972 2829 3a0a  th cache_dir():.
+00014ec0: 2020 2020 2020 2020 2020 2020 7265 7375              resu
+00014ed0: 6c74 203d 2043 6c69 5275 6e6e 6572 2829  lt = CliRunner()
+00014ee0: 2e69 6e76 6f6b 6528 0a20 2020 2020 2020  .invoke(.       
+00014ef0: 2020 2020 2020 2020 2063 6572 6369 732e           cercis.
+00014f00: 6d61 696e 2c20 5b22 2d22 5d2c 2069 6e70  main, ["-"], inp
+00014f10: 7574 3d42 7974 6573 494f 2862 2270 7269  ut=BytesIO(b"pri
+00014f20: 6e74 2827 6865 6c6c 6f27 2922 290a 2020  nt('hello')").  
+00014f30: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00014f40: 2020 2020 2020 2020 6173 7365 7274 206e          assert n
+00014f50: 6f74 2072 6573 756c 742e 6578 6974 5f63  ot result.exit_c
+00014f60: 6f64 650a 2020 2020 2020 2020 2020 2020  ode.            
+00014f70: 6361 6368 655f 6669 6c65 203d 2067 6574  cache_file = get
+00014f80: 5f63 6163 6865 5f66 696c 6528 6d6f 6465  _cache_file(mode
+00014f90: 290a 2020 2020 2020 2020 2020 2020 6173  ).            as
+00014fa0: 7365 7274 206e 6f74 2063 6163 6865 5f66  sert not cache_f
+00014fb0: 696c 652e 6578 6973 7473 2829 0a0a 2020  ile.exists()..  
+00014fc0: 2020 6465 6620 7465 7374 5f72 6561 645f    def test_read_
+00014fd0: 6361 6368 655f 6e6f 5f63 6163 6865 6669  cache_no_cachefi
+00014fe0: 6c65 2873 656c 6629 202d 3e20 4e6f 6e65  le(self) -> None
+00014ff0: 3a0a 2020 2020 2020 2020 6d6f 6465 203d  :.        mode =
+00015000: 2044 4546 4155 4c54 5f4d 4f44 450a 2020   DEFAULT_MODE.  
+00015010: 2020 2020 2020 7769 7468 2063 6163 6865        with cache
+00015020: 5f64 6972 2829 3a0a 2020 2020 2020 2020  _dir():.        
+00015030: 2020 2020 6173 7365 7274 2063 6572 6369      assert cerci
+00015040: 732e 7265 6164 5f63 6163 6865 286d 6f64  s.read_cache(mod
+00015050: 6529 203d 3d20 7b7d 0a0a 2020 2020 6465  e) == {}..    de
+00015060: 6620 7465 7374 5f77 7269 7465 5f63 6163  f test_write_cac
+00015070: 6865 5f72 6561 645f 6361 6368 6528 7365  he_read_cache(se
+00015080: 6c66 2920 2d3e 204e 6f6e 653a 0a20 2020  lf) -> None:.   
+00015090: 2020 2020 206d 6f64 6520 3d20 4445 4641       mode = DEFA
+000150a0: 554c 545f 4d4f 4445 0a20 2020 2020 2020  ULT_MODE.       
+000150b0: 2077 6974 6820 6361 6368 655f 6469 7228   with cache_dir(
+000150c0: 2920 6173 2077 6f72 6b73 7061 6365 3a0a  ) as workspace:.
+000150d0: 2020 2020 2020 2020 2020 2020 7372 6320              src 
+000150e0: 3d20 2877 6f72 6b73 7061 6365 202f 2022  = (workspace / "
+000150f0: 7465 7374 2e70 7922 292e 7265 736f 6c76  test.py").resolv
+00015100: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
+00015110: 7372 632e 746f 7563 6828 290a 2020 2020  src.touch().    
+00015120: 2020 2020 2020 2020 6365 7263 6973 2e77          cercis.w
+00015130: 7269 7465 5f63 6163 6865 287b 7d2c 205b  rite_cache({}, [
+00015140: 7372 635d 2c20 6d6f 6465 290a 2020 2020  src], mode).    
+00015150: 2020 2020 2020 2020 6361 6368 6520 3d20          cache = 
+00015160: 6365 7263 6973 2e72 6561 645f 6361 6368  cercis.read_cach
+00015170: 6528 6d6f 6465 290a 2020 2020 2020 2020  e(mode).        
+00015180: 2020 2020 6173 7365 7274 2073 7472 2873      assert str(s
+00015190: 7263 2920 696e 2063 6163 6865 0a20 2020  rc) in cache.   
+000151a0: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+000151b0: 6361 6368 655b 7374 7228 7372 6329 5d20  cache[str(src)] 
+000151c0: 3d3d 2063 6572 6369 732e 6765 745f 6361  == cercis.get_ca
+000151d0: 6368 655f 696e 666f 2873 7263 290a 0a20  che_info(src).. 
+000151e0: 2020 2064 6566 2074 6573 745f 6669 6c74     def test_filt
+000151f0: 6572 5f63 6163 6865 6428 7365 6c66 2920  er_cached(self) 
+00015200: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00015210: 2077 6974 6820 5465 6d70 6f72 6172 7944   with TemporaryD
+00015220: 6972 6563 746f 7279 2829 2061 7320 776f  irectory() as wo
+00015230: 726b 7370 6163 653a 0a20 2020 2020 2020  rkspace:.       
+00015240: 2020 2020 2070 6174 6820 3d20 5061 7468       path = Path
+00015250: 2877 6f72 6b73 7061 6365 290a 2020 2020  (workspace).    
+00015260: 2020 2020 2020 2020 756e 6361 6368 6564          uncached
+00015270: 203d 2028 7061 7468 202f 2022 756e 6361   = (path / "unca
+00015280: 6368 6564 2229 2e72 6573 6f6c 7665 2829  ched").resolve()
+00015290: 0a20 2020 2020 2020 2020 2020 2063 6163  .            cac
+000152a0: 6865 6420 3d20 2870 6174 6820 2f20 2263  hed = (path / "c
+000152b0: 6163 6865 6422 292e 7265 736f 6c76 6528  ached").resolve(
+000152c0: 290a 2020 2020 2020 2020 2020 2020 6361  ).            ca
+000152d0: 6368 6564 5f62 7574 5f63 6861 6e67 6564  ched_but_changed
+000152e0: 203d 2028 7061 7468 202f 2022 6368 616e   = (path / "chan
+000152f0: 6765 6422 292e 7265 736f 6c76 6528 290a  ged").resolve().
+00015300: 2020 2020 2020 2020 2020 2020 756e 6361              unca
+00015310: 6368 6564 2e74 6f75 6368 2829 0a20 2020  ched.touch().   
+00015320: 2020 2020 2020 2020 2063 6163 6865 642e           cached.
+00015330: 746f 7563 6828 290a 2020 2020 2020 2020  touch().        
+00015340: 2020 2020 6361 6368 6564 5f62 7574 5f63      cached_but_c
+00015350: 6861 6e67 6564 2e74 6f75 6368 2829 0a20  hanged.touch(). 
+00015360: 2020 2020 2020 2020 2020 2063 6163 6865             cache
+00015370: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+00015380: 2020 2020 2073 7472 2863 6163 6865 6429       str(cached)
+00015390: 3a20 6365 7263 6973 2e67 6574 5f63 6163  : cercis.get_cac
+000153a0: 6865 5f69 6e66 6f28 6361 6368 6564 292c  he_info(cached),
+000153b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000153c0: 2073 7472 2863 6163 6865 645f 6275 745f   str(cached_but_
+000153d0: 6368 616e 6765 6429 3a20 2830 2e30 2c20  changed): (0.0, 
+000153e0: 3029 2c0a 2020 2020 2020 2020 2020 2020  0),.            
+000153f0: 7d0a 2020 2020 2020 2020 2020 2020 746f  }.            to
+00015400: 646f 2c20 646f 6e65 203d 2063 6572 6369  do, done = cerci
+00015410: 732e 6361 6368 652e 6669 6c74 6572 5f63  s.cache.filter_c
+00015420: 6163 6865 6428 0a20 2020 2020 2020 2020  ached(.         
+00015430: 2020 2020 2020 2063 6163 6865 2c20 7b75         cache, {u
+00015440: 6e63 6163 6865 642c 2063 6163 6865 642c  ncached, cached,
+00015450: 2063 6163 6865 645f 6275 745f 6368 616e   cached_but_chan
+00015460: 6765 647d 0a20 2020 2020 2020 2020 2020  ged}.           
+00015470: 2029 0a20 2020 2020 2020 2020 2020 2061   ).            a
+00015480: 7373 6572 7420 746f 646f 203d 3d20 7b75  ssert todo == {u
+00015490: 6e63 6163 6865 642c 2063 6163 6865 645f  ncached, cached_
+000154a0: 6275 745f 6368 616e 6765 647d 0a20 2020  but_changed}.   
+000154b0: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+000154c0: 646f 6e65 203d 3d20 7b63 6163 6865 647d  done == {cached}
+000154d0: 0a0a 2020 2020 6465 6620 7465 7374 5f77  ..    def test_w
+000154e0: 7269 7465 5f63 6163 6865 5f63 7265 6174  rite_cache_creat
+000154f0: 6573 5f64 6972 6563 746f 7279 5f69 665f  es_directory_if_
+00015500: 6e65 6564 6564 2873 656c 6629 202d 3e20  needed(self) -> 
+00015510: 4e6f 6e65 3a0a 2020 2020 2020 2020 6d6f  None:.        mo
+00015520: 6465 203d 2044 4546 4155 4c54 5f4d 4f44  de = DEFAULT_MOD
+00015530: 450a 2020 2020 2020 2020 7769 7468 2063  E.        with c
+00015540: 6163 6865 5f64 6972 2865 7869 7374 733d  ache_dir(exists=
+00015550: 4661 6c73 6529 2061 7320 776f 726b 7370  False) as worksp
+00015560: 6163 653a 0a20 2020 2020 2020 2020 2020  ace:.           
+00015570: 2061 7373 6572 7420 6e6f 7420 776f 726b   assert not work
+00015580: 7370 6163 652e 6578 6973 7473 2829 0a20  space.exists(). 
+00015590: 2020 2020 2020 2020 2020 2063 6572 6369             cerci
+000155a0: 732e 7772 6974 655f 6361 6368 6528 7b7d  s.write_cache({}
+000155b0: 2c20 5b5d 2c20 6d6f 6465 290a 2020 2020  , [], mode).    
+000155c0: 2020 2020 2020 2020 6173 7365 7274 2077          assert w
+000155d0: 6f72 6b73 7061 6365 2e65 7869 7374 7328  orkspace.exists(
+000155e0: 290a 0a20 2020 2040 6576 656e 745f 6c6f  )..    @event_lo
+000155f0: 6f70 2829 0a20 2020 2064 6566 2074 6573  op().    def tes
+00015600: 745f 6661 696c 6564 5f66 6f72 6d61 7474  t_failed_formatt
+00015610: 696e 675f 646f 6573 5f6e 6f74 5f67 6574  ing_does_not_get
+00015620: 5f63 6163 6865 6428 7365 6c66 2920 2d3e  _cached(self) ->
+00015630: 204e 6f6e 653a 0a20 2020 2020 2020 206d   None:.        m
+00015640: 6f64 6520 3d20 4445 4641 554c 545f 4d4f  ode = DEFAULT_MO
+00015650: 4445 0a20 2020 2020 2020 2077 6974 6820  DE.        with 
+00015660: 6361 6368 655f 6469 7228 2920 6173 2077  cache_dir() as w
+00015670: 6f72 6b73 7061 6365 2c20 7061 7463 6828  orkspace, patch(
+00015680: 0a20 2020 2020 2020 2020 2020 2022 636f  .            "co
+00015690: 6e63 7572 7265 6e74 2e66 7574 7572 6573  ncurrent.futures
+000156a0: 2e50 726f 6365 7373 506f 6f6c 4578 6563  .ProcessPoolExec
+000156b0: 7574 6f72 222c 206e 6577 3d54 6872 6561  utor", new=Threa
+000156c0: 6450 6f6f 6c45 7865 6375 746f 720a 2020  dPoolExecutor.  
+000156d0: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+000156e0: 2020 2020 2066 6169 6c69 6e67 203d 2028       failing = (
+000156f0: 776f 726b 7370 6163 6520 2f20 2266 6169  workspace / "fai
+00015700: 6c69 6e67 2e70 7922 292e 7265 736f 6c76  ling.py").resolv
+00015710: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
+00015720: 6661 696c 696e 672e 7772 6974 655f 7465  failing.write_te
+00015730: 7874 2822 6e6f 7420 6163 7475 616c 6c79  xt("not actually
+00015740: 2070 7974 686f 6e22 2c20 656e 636f 6469   python", encodi
+00015750: 6e67 3d22 7574 662d 3822 290a 2020 2020  ng="utf-8").    
+00015760: 2020 2020 2020 2020 636c 6561 6e20 3d20          clean = 
+00015770: 2877 6f72 6b73 7061 6365 202f 2022 636c  (workspace / "cl
+00015780: 6561 6e2e 7079 2229 2e72 6573 6f6c 7665  ean.py").resolve
+00015790: 2829 0a20 2020 2020 2020 2020 2020 2063  ().            c
+000157a0: 6c65 616e 2e77 7269 7465 5f74 6578 7428  lean.write_text(
+000157b0: 2770 7269 6e74 2822 6865 6c6c 6f22 295c  'print("hello")\
+000157c0: 6e27 2c20 656e 636f 6469 6e67 3d22 7574  n', encoding="ut
+000157d0: 662d 3822 290a 2020 2020 2020 2020 2020  f-8").          
+000157e0: 2020 696e 766f 6b65 426c 6163 6b28 5b73    invokeBlack([s
+000157f0: 7472 2877 6f72 6b73 7061 6365 295d 2c20  tr(workspace)], 
+00015800: 6578 6974 5f63 6f64 653d 3132 3329 0a20  exit_code=123). 
+00015810: 2020 2020 2020 2020 2020 2063 6163 6865             cache
+00015820: 203d 2063 6572 6369 732e 7265 6164 5f63   = cercis.read_c
+00015830: 6163 6865 286d 6f64 6529 0a20 2020 2020  ache(mode).     
+00015840: 2020 2020 2020 2061 7373 6572 7420 7374         assert st
+00015850: 7228 6661 696c 696e 6729 206e 6f74 2069  r(failing) not i
+00015860: 6e20 6361 6368 650a 2020 2020 2020 2020  n cache.        
+00015870: 2020 2020 6173 7365 7274 2073 7472 2863      assert str(c
+00015880: 6c65 616e 2920 696e 2063 6163 6865 0a0a  lean) in cache..
+00015890: 2020 2020 6465 6620 7465 7374 5f77 7269      def test_wri
+000158a0: 7465 5f63 6163 6865 5f77 7269 7465 5f66  te_cache_write_f
+000158b0: 6169 6c28 7365 6c66 2920 2d3e 204e 6f6e  ail(self) -> Non
+000158c0: 653a 0a20 2020 2020 2020 206d 6f64 6520  e:.        mode 
+000158d0: 3d20 4445 4641 554c 545f 4d4f 4445 0a20  = DEFAULT_MODE. 
+000158e0: 2020 2020 2020 2077 6974 6820 6361 6368         with cach
+000158f0: 655f 6469 7228 292c 2070 6174 6368 2e6f  e_dir(), patch.o
+00015900: 626a 6563 7428 5061 7468 2c20 226f 7065  bject(Path, "ope
+00015910: 6e22 2920 6173 206d 6f63 6b3a 0a20 2020  n") as mock:.   
+00015920: 2020 2020 2020 2020 206d 6f63 6b2e 7369           mock.si
+00015930: 6465 5f65 6666 6563 7420 3d20 4f53 4572  de_effect = OSEr
+00015940: 726f 720a 2020 2020 2020 2020 2020 2020  ror.            
+00015950: 6365 7263 6973 2e77 7269 7465 5f63 6163  cercis.write_cac
+00015960: 6865 287b 7d2c 205b 5d2c 206d 6f64 6529  he({}, [], mode)
+00015970: 0a0a 2020 2020 6465 6620 7465 7374 5f72  ..    def test_r
+00015980: 6561 645f 6361 6368 655f 6c69 6e65 5f6c  ead_cache_line_l
+00015990: 656e 6774 6873 2873 656c 6629 202d 3e20  engths(self) -> 
+000159a0: 4e6f 6e65 3a0a 2020 2020 2020 2020 6d6f  None:.        mo
+000159b0: 6465 203d 2044 4546 4155 4c54 5f4d 4f44  de = DEFAULT_MOD
+000159c0: 450a 2020 2020 2020 2020 7368 6f72 745f  E.        short_
+000159d0: 6d6f 6465 203d 2072 6570 6c61 6365 2844  mode = replace(D
+000159e0: 4546 4155 4c54 5f4d 4f44 452c 206c 696e  EFAULT_MODE, lin
+000159f0: 655f 6c65 6e67 7468 3d31 290a 2020 2020  e_length=1).    
+00015a00: 2020 2020 7769 7468 2063 6163 6865 5f64      with cache_d
+00015a10: 6972 2829 2061 7320 776f 726b 7370 6163  ir() as workspac
+00015a20: 653a 0a20 2020 2020 2020 2020 2020 2070  e:.            p
+00015a30: 6174 6820 3d20 2877 6f72 6b73 7061 6365  ath = (workspace
+00015a40: 202f 2022 6669 6c65 2e70 7922 292e 7265   / "file.py").re
+00015a50: 736f 6c76 6528 290a 2020 2020 2020 2020  solve().        
+00015a60: 2020 2020 7061 7468 2e74 6f75 6368 2829      path.touch()
+00015a70: 0a20 2020 2020 2020 2020 2020 2063 6572  .            cer
+00015a80: 6369 732e 7772 6974 655f 6361 6368 6528  cis.write_cache(
+00015a90: 7b7d 2c20 5b70 6174 685d 2c20 6d6f 6465  {}, [path], mode
+00015aa0: 290a 2020 2020 2020 2020 2020 2020 6f6e  ).            on
+00015ab0: 6520 3d20 6365 7263 6973 2e72 6561 645f  e = cercis.read_
+00015ac0: 6361 6368 6528 6d6f 6465 290a 2020 2020  cache(mode).    
+00015ad0: 2020 2020 2020 2020 6173 7365 7274 2073          assert s
+00015ae0: 7472 2870 6174 6829 2069 6e20 6f6e 650a  tr(path) in one.
+00015af0: 2020 2020 2020 2020 2020 2020 7477 6f20              two 
+00015b00: 3d20 6365 7263 6973 2e72 6561 645f 6361  = cercis.read_ca
+00015b10: 6368 6528 7368 6f72 745f 6d6f 6465 290a  che(short_mode).
+00015b20: 2020 2020 2020 2020 2020 2020 6173 7365              asse
+00015b30: 7274 2073 7472 2870 6174 6829 206e 6f74  rt str(path) not
+00015b40: 2069 6e20 7477 6f0a 0a0a 6465 6620 6173   in two...def as
+00015b50: 7365 7274 5f63 6f6c 6c65 6374 6564 5f73  sert_collected_s
+00015b60: 6f75 7263 6573 280a 2020 2020 2020 2020  ources(.        
+00015b70: 7372 633a 2053 6571 7565 6e63 655b 556e  src: Sequence[Un
+00015b80: 696f 6e5b 7374 722c 2050 6174 685d 5d2c  ion[str, Path]],
+00015b90: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
+00015ba0: 643a 2053 6571 7565 6e63 655b 556e 696f  d: Sequence[Unio
+00015bb0: 6e5b 7374 722c 2050 6174 685d 5d2c 0a20  n[str, Path]],. 
+00015bc0: 2020 2020 2020 202a 2c0a 2020 2020 2020         *,.      
+00015bd0: 2020 6374 783a 204f 7074 696f 6e61 6c5b    ctx: Optional[
+00015be0: 4661 6b65 436f 6e74 6578 745d 203d 204e  FakeContext] = N
+00015bf0: 6f6e 652c 0a20 2020 2020 2020 2065 7863  one,.        exc
+00015c00: 6c75 6465 3a20 4f70 7469 6f6e 616c 5b73  lude: Optional[s
+00015c10: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
+00015c20: 2020 2020 696e 636c 7564 653a 204f 7074      include: Opt
 00015c30: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
-00015c40: 652c 0a29 202d 3e20 4e6f 6e65 3a0a 2020  e,.) -> None:.  
-00015c50: 2020 6773 5f73 7263 203d 2074 7570 6c65    gs_src = tuple
-00015c60: 2873 7472 2850 6174 6828 7329 2920 666f  (str(Path(s)) fo
-00015c70: 7220 7320 696e 2073 7263 290a 2020 2020  r s in src).    
-00015c80: 6773 5f65 7870 6563 7465 6420 3d20 5b50  gs_expected = [P
-00015c90: 6174 6828 7329 2066 6f72 2073 2069 6e20  ath(s) for s in 
-00015ca0: 6578 7065 6374 6564 5d0a 2020 2020 6773  expected].    gs
-00015cb0: 5f65 7863 6c75 6465 203d 204e 6f6e 6520  _exclude = None 
-00015cc0: 6966 2065 7863 6c75 6465 2069 7320 4e6f  if exclude is No
-00015cd0: 6e65 2065 6c73 6520 636f 6d70 696c 655f  ne else compile_
-00015ce0: 7061 7474 6572 6e28 6578 636c 7564 6529  pattern(exclude)
-00015cf0: 0a20 2020 2067 735f 696e 636c 7564 6520  .    gs_include 
-00015d00: 3d20 4445 4641 554c 545f 494e 434c 5544  = DEFAULT_INCLUD
-00015d10: 4520 6966 2069 6e63 6c75 6465 2069 7320  E if include is 
-00015d20: 4e6f 6e65 2065 6c73 6520 636f 6d70 696c  None else compil
-00015d30: 655f 7061 7474 6572 6e28 696e 636c 7564  e_pattern(includ
-00015d40: 6529 0a20 2020 2067 735f 6578 7465 6e64  e).    gs_extend
-00015d50: 5f65 7863 6c75 6465 203d 2028 0a20 2020  _exclude = (.   
-00015d60: 2020 2020 204e 6f6e 6520 6966 2065 7874       None if ext
-00015d70: 656e 645f 6578 636c 7564 6520 6973 204e  end_exclude is N
-00015d80: 6f6e 6520 656c 7365 2063 6f6d 7069 6c65  one else compile
-00015d90: 5f70 6174 7465 726e 2865 7874 656e 645f  _pattern(extend_
-00015da0: 6578 636c 7564 6529 0a20 2020 2029 0a20  exclude).    ). 
-00015db0: 2020 2067 735f 666f 7263 655f 6578 636c     gs_force_excl
-00015dc0: 7564 6520 3d20 4e6f 6e65 2069 6620 666f  ude = None if fo
-00015dd0: 7263 655f 6578 636c 7564 6520 6973 204e  rce_exclude is N
-00015de0: 6f6e 6520 656c 7365 2063 6f6d 7069 6c65  one else compile
-00015df0: 5f70 6174 7465 726e 2866 6f72 6365 5f65  _pattern(force_e
-00015e00: 7863 6c75 6465 290a 2020 2020 636f 6c6c  xclude).    coll
-00015e10: 6563 7465 6420 3d20 6365 7263 6973 2e67  ected = cercis.g
-00015e20: 6574 5f73 6f75 7263 6573 280a 2020 2020  et_sources(.    
-00015e30: 2020 2020 6374 783d 6374 7820 6f72 2046      ctx=ctx or F
-00015e40: 616b 6543 6f6e 7465 7874 2829 2c0a 2020  akeContext(),.  
-00015e50: 2020 2020 2020 7372 633d 6773 5f73 7263        src=gs_src
-00015e60: 2c0a 2020 2020 2020 2020 7175 6965 743d  ,.        quiet=
-00015e70: 4661 6c73 652c 0a20 2020 2020 2020 2076  False,.        v
-00015e80: 6572 626f 7365 3d46 616c 7365 2c0a 2020  erbose=False,.  
-00015e90: 2020 2020 2020 696e 636c 7564 653d 6773        include=gs
-00015ea0: 5f69 6e63 6c75 6465 2c0a 2020 2020 2020  _include,.      
-00015eb0: 2020 6578 636c 7564 653d 6773 5f65 7863    exclude=gs_exc
-00015ec0: 6c75 6465 2c0a 2020 2020 2020 2020 6578  lude,.        ex
-00015ed0: 7465 6e64 5f65 7863 6c75 6465 3d67 735f  tend_exclude=gs_
-00015ee0: 6578 7465 6e64 5f65 7863 6c75 6465 2c0a  extend_exclude,.
-00015ef0: 2020 2020 2020 2020 666f 7263 655f 6578          force_ex
-00015f00: 636c 7564 653d 6773 5f66 6f72 6365 5f65  clude=gs_force_e
-00015f10: 7863 6c75 6465 2c0a 2020 2020 2020 2020  xclude,.        
-00015f20: 7265 706f 7274 3d63 6572 6369 732e 5265  report=cercis.Re
-00015f30: 706f 7274 2829 2c0a 2020 2020 2020 2020  port(),.        
-00015f40: 7374 6469 6e5f 6669 6c65 6e61 6d65 3d73  stdin_filename=s
-00015f50: 7464 696e 5f66 696c 656e 616d 652c 0a20  tdin_filename,. 
-00015f60: 2020 2029 0a20 2020 2061 7373 6572 7420     ).    assert 
-00015f70: 736f 7274 6564 2863 6f6c 6c65 6374 6564  sorted(collected
-00015f80: 2920 3d3d 2073 6f72 7465 6428 6773 5f65  ) == sorted(gs_e
-00015f90: 7870 6563 7465 6429 0a0a 0a63 6c61 7373  xpected)...class
-00015fa0: 2054 6573 7446 696c 6543 6f6c 6c65 6374   TestFileCollect
-00015fb0: 696f 6e3a 0a20 2020 2064 6566 2074 6573  ion:.    def tes
-00015fc0: 745f 696e 636c 7564 655f 6578 636c 7564  t_include_exclud
-00015fd0: 6528 7365 6c66 2920 2d3e 204e 6f6e 653a  e(self) -> None:
-00015fe0: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
-00015ff0: 5448 4953 5f44 4952 202f 2022 6461 7461  THIS_DIR / "data
-00016000: 2220 2f20 2269 6e63 6c75 6465 5f65 7863  " / "include_exc
-00016010: 6c75 6465 5f74 6573 7473 220a 2020 2020  lude_tests".    
-00016020: 2020 2020 7372 6320 3d20 5b70 6174 685d      src = [path]
-00016030: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
-00016040: 6420 3d20 5b0a 2020 2020 2020 2020 2020  d = [.          
-00016050: 2020 5061 7468 2870 6174 6820 2f20 2262    Path(path / "b
-00016060: 2f64 6f6e 745f 6578 636c 7564 652f 612e  /dont_exclude/a.
-00016070: 7079 2229 2c0a 2020 2020 2020 2020 2020  py"),.          
-00016080: 2020 5061 7468 2870 6174 6820 2f20 2262    Path(path / "b
-00016090: 2f64 6f6e 745f 6578 636c 7564 652f 612e  /dont_exclude/a.
-000160a0: 7079 6922 292c 0a20 2020 2020 2020 205d  pyi"),.        ]
-000160b0: 0a20 2020 2020 2020 2061 7373 6572 745f  .        assert_
-000160c0: 636f 6c6c 6563 7465 645f 736f 7572 6365  collected_source
-000160d0: 7328 0a20 2020 2020 2020 2020 2020 2073  s(.            s
-000160e0: 7263 2c0a 2020 2020 2020 2020 2020 2020  rc,.            
-000160f0: 6578 7065 6374 6564 2c0a 2020 2020 2020  expected,.      
-00016100: 2020 2020 2020 696e 636c 7564 653d 7222        include=r"
-00016110: 5c2e 7079 693f 2422 2c0a 2020 2020 2020  \.pyi?$",.      
-00016120: 2020 2020 2020 6578 636c 7564 653d 7222        exclude=r"
-00016130: 2f65 7863 6c75 6465 2f7c 2f5c 2e64 6566  /exclude/|/\.def
-00016140: 696e 6974 656c 795f 6578 636c 7564 652f  initely_exclude/
-00016150: 222c 0a20 2020 2020 2020 2029 0a0a 2020  ",.        )..  
-00016160: 2020 6465 6620 7465 7374 5f67 6974 6967    def test_gitig
-00016170: 6e6f 7265 5f75 7365 645f 6173 5f64 6566  nore_used_as_def
-00016180: 6175 6c74 2873 656c 6629 202d 3e20 4e6f  ault(self) -> No
-00016190: 6e65 3a0a 2020 2020 2020 2020 6261 7365  ne:.        base
-000161a0: 203d 2050 6174 6828 4441 5441 5f44 4952   = Path(DATA_DIR
-000161b0: 202f 2022 696e 636c 7564 655f 6578 636c   / "include_excl
-000161c0: 7564 655f 7465 7374 7322 290a 2020 2020  ude_tests").    
-000161d0: 2020 2020 6578 7065 6374 6564 203d 205b      expected = [
-000161e0: 0a20 2020 2020 2020 2020 2020 2062 6173  .            bas
-000161f0: 6520 2f20 2262 2f2e 6465 6669 6e69 7465  e / "b/.definite
-00016200: 6c79 5f65 7863 6c75 6465 2f61 2e70 7922  ly_exclude/a.py"
-00016210: 2c0a 2020 2020 2020 2020 2020 2020 6261  ,.            ba
-00016220: 7365 202f 2022 622f 2e64 6566 696e 6974  se / "b/.definit
-00016230: 656c 795f 6578 636c 7564 652f 612e 7079  ely_exclude/a.py
-00016240: 6922 2c0a 2020 2020 2020 2020 5d0a 2020  i",.        ].  
-00016250: 2020 2020 2020 7372 6320 3d20 5b62 6173        src = [bas
-00016260: 6520 2f20 2262 2f22 5d0a 2020 2020 2020  e / "b/"].      
-00016270: 2020 6374 7820 3d20 4661 6b65 436f 6e74    ctx = FakeCont
-00016280: 6578 7428 290a 2020 2020 2020 2020 6374  ext().        ct
-00016290: 782e 6f62 6a5b 2272 6f6f 7422 5d20 3d20  x.obj["root"] = 
-000162a0: 6261 7365 0a20 2020 2020 2020 2061 7373  base.        ass
-000162b0: 6572 745f 636f 6c6c 6563 7465 645f 736f  ert_collected_so
-000162c0: 7572 6365 7328 7372 632c 2065 7870 6563  urces(src, expec
-000162d0: 7465 642c 2063 7478 3d63 7478 2c20 6578  ted, ctx=ctx, ex
-000162e0: 7465 6e64 5f65 7863 6c75 6465 3d72 222f  tend_exclude=r"/
-000162f0: 6578 636c 7564 652f 2229 0a0a 2020 2020  exclude/")..    
-00016300: 6465 6620 7465 7374 5f67 6974 6967 6e6f  def test_gitigno
-00016310: 7265 5f75 7365 645f 6f6e 5f6d 756c 7469  re_used_on_multi
-00016320: 706c 655f 736f 7572 6365 7328 7365 6c66  ple_sources(self
-00016330: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-00016340: 2020 2072 6f6f 7420 3d20 5061 7468 2844     root = Path(D
-00016350: 4154 415f 4449 5220 2f20 2267 6974 6967  ATA_DIR / "gitig
-00016360: 6e6f 7265 5f75 7365 645f 6f6e 5f6d 756c  nore_used_on_mul
-00016370: 7469 706c 655f 736f 7572 6365 7322 290a  tiple_sources").
-00016380: 2020 2020 2020 2020 6578 7065 6374 6564          expected
-00016390: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
-000163a0: 2072 6f6f 7420 2f20 2264 6972 3122 202f   root / "dir1" /
-000163b0: 2022 622e 7079 222c 0a20 2020 2020 2020   "b.py",.       
-000163c0: 2020 2020 2072 6f6f 7420 2f20 2264 6972       root / "dir
-000163d0: 3222 202f 2022 622e 7079 222c 0a20 2020  2" / "b.py",.   
-000163e0: 2020 2020 205d 0a20 2020 2020 2020 2063       ].        c
-000163f0: 7478 203d 2046 616b 6543 6f6e 7465 7874  tx = FakeContext
-00016400: 2829 0a20 2020 2020 2020 2063 7478 2e6f  ().        ctx.o
-00016410: 626a 5b22 726f 6f74 225d 203d 2072 6f6f  bj["root"] = roo
-00016420: 740a 2020 2020 2020 2020 7372 6320 3d20  t.        src = 
-00016430: 5b72 6f6f 7420 2f20 2264 6972 3122 2c20  [root / "dir1", 
-00016440: 726f 6f74 202f 2022 6469 7232 225d 0a20  root / "dir2"]. 
-00016450: 2020 2020 2020 2061 7373 6572 745f 636f         assert_co
-00016460: 6c6c 6563 7465 645f 736f 7572 6365 7328  llected_sources(
-00016470: 7372 632c 2065 7870 6563 7465 642c 2063  src, expected, c
-00016480: 7478 3d63 7478 290a 0a20 2020 2040 7061  tx=ctx)..    @pa
-00016490: 7463 6828 2263 6572 6369 732e 6669 6e64  tch("cercis.find
-000164a0: 5f70 726f 6a65 6374 5f72 6f6f 7422 2c20  _project_root", 
-000164b0: 6c61 6d62 6461 202a 6172 6773 3a20 2854  lambda *args: (T
-000164c0: 4849 535f 4449 522e 7265 736f 6c76 6528  HIS_DIR.resolve(
-000164d0: 292c 204e 6f6e 6529 290a 2020 2020 6465  ), None)).    de
-000164e0: 6620 7465 7374 5f65 7863 6c75 6465 5f66  f test_exclude_f
-000164f0: 6f72 5f69 7373 7565 5f31 3537 3228 7365  or_issue_1572(se
-00016500: 6c66 2920 2d3e 204e 6f6e 653a 0a20 2020  lf) -> None:.   
-00016510: 2020 2020 2023 2045 7863 6c75 6465 2073       # Exclude s
-00016520: 686f 756c 646e 2774 2074 6f75 6368 2066  houldn't touch f
-00016530: 696c 6573 2074 6861 7420 7765 7265 2065  iles that were e
-00016540: 7870 6c69 6369 746c 7920 6769 7665 6e20  xplicitly given 
-00016550: 746f 2042 6c61 636b 2074 6872 6f75 6768  to Black through
-00016560: 2074 6865 0a20 2020 2020 2020 2023 2043   the.        # C
-00016570: 4c49 2e20 4578 636c 7564 6520 6973 2073  LI. Exclude is s
-00016580: 7570 706f 7365 6420 746f 206f 6e6c 7920  upposed to only 
-00016590: 6170 706c 7920 746f 2074 6865 2072 6563  apply to the rec
-000165a0: 7572 7369 7665 2064 6973 636f 7665 7279  ursive discovery
-000165b0: 206f 6620 6669 6c65 732e 0a20 2020 2020   of files..     
-000165c0: 2020 2023 2068 7474 7073 3a2f 2f67 6974     # https://git
-000165d0: 6875 622e 636f 6d2f 7073 662f 626c 6163  hub.com/psf/blac
-000165e0: 6b2f 6973 7375 6573 2f31 3537 320a 2020  k/issues/1572.  
-000165f0: 2020 2020 2020 7061 7468 203d 2044 4154        path = DAT
-00016600: 415f 4449 5220 2f20 2269 6e63 6c75 6465  A_DIR / "include
-00016610: 5f65 7863 6c75 6465 5f74 6573 7473 220a  _exclude_tests".
-00016620: 2020 2020 2020 2020 7372 6320 3d20 5b70          src = [p
-00016630: 6174 6820 2f20 2262 2f65 7863 6c75 6465  ath / "b/exclude
-00016640: 2f61 2e70 7922 5d0a 2020 2020 2020 2020  /a.py"].        
-00016650: 6578 7065 6374 6564 203d 205b 7061 7468  expected = [path
-00016660: 202f 2022 622f 6578 636c 7564 652f 612e   / "b/exclude/a.
-00016670: 7079 225d 0a20 2020 2020 2020 2061 7373  py"].        ass
-00016680: 6572 745f 636f 6c6c 6563 7465 645f 736f  ert_collected_so
-00016690: 7572 6365 7328 7372 632c 2065 7870 6563  urces(src, expec
-000166a0: 7465 642c 2069 6e63 6c75 6465 3d22 222c  ted, include="",
-000166b0: 2065 7863 6c75 6465 3d72 222f 6578 636c   exclude=r"/excl
-000166c0: 7564 652f 7c61 5c2e 7079 2229 0a0a 2020  ude/|a\.py")..  
-000166d0: 2020 6465 6620 7465 7374 5f67 6974 6967    def test_gitig
-000166e0: 6e6f 7265 5f65 7863 6c75 6465 2873 656c  nore_exclude(sel
-000166f0: 6629 202d 3e20 4e6f 6e65 3a0a 2020 2020  f) -> None:.    
-00016700: 2020 2020 7061 7468 203d 2054 4849 535f      path = THIS_
-00016710: 4449 5220 2f20 2264 6174 6122 202f 2022  DIR / "data" / "
-00016720: 696e 636c 7564 655f 6578 636c 7564 655f  include_exclude_
-00016730: 7465 7374 7322 0a20 2020 2020 2020 2069  tests".        i
-00016740: 6e63 6c75 6465 203d 2072 652e 636f 6d70  nclude = re.comp
-00016750: 696c 6528 7222 5c2e 7079 693f 2422 290a  ile(r"\.pyi?$").
-00016760: 2020 2020 2020 2020 6578 636c 7564 6520          exclude 
-00016770: 3d20 7265 2e63 6f6d 7069 6c65 2872 2222  = re.compile(r""
-00016780: 290a 2020 2020 2020 2020 7265 706f 7274  ).        report
-00016790: 203d 2063 6572 6369 732e 5265 706f 7274   = cercis.Report
-000167a0: 2829 0a20 2020 2020 2020 2067 6974 6967  ().        gitig
-000167b0: 6e6f 7265 203d 2050 6174 6853 7065 632e  nore = PathSpec.
-000167c0: 6672 6f6d 5f6c 696e 6573 280a 2020 2020  from_lines(.    
-000167d0: 2020 2020 2020 2020 2267 6974 7769 6c64          "gitwild
-000167e0: 6d61 7463 6822 2c20 5b22 6578 636c 7564  match", ["exclud
-000167f0: 652f 222c 2022 2e64 6566 696e 6974 656c  e/", ".definitel
-00016800: 795f 6578 636c 7564 6522 5d0a 2020 2020  y_exclude"].    
-00016810: 2020 2020 290a 2020 2020 2020 2020 736f      ).        so
-00016820: 7572 6365 733a 204c 6973 745b 5061 7468  urces: List[Path
-00016830: 5d20 3d20 5b5d 0a20 2020 2020 2020 2065  ] = [].        e
-00016840: 7870 6563 7465 6420 3d20 5b0a 2020 2020  xpected = [.    
-00016850: 2020 2020 2020 2020 5061 7468 2870 6174          Path(pat
-00016860: 6820 2f20 2262 2f64 6f6e 745f 6578 636c  h / "b/dont_excl
-00016870: 7564 652f 612e 7079 2229 2c0a 2020 2020  ude/a.py"),.    
-00016880: 2020 2020 2020 2020 5061 7468 2870 6174          Path(pat
-00016890: 6820 2f20 2262 2f64 6f6e 745f 6578 636c  h / "b/dont_excl
-000168a0: 7564 652f 612e 7079 6922 292c 0a20 2020  ude/a.pyi"),.   
-000168b0: 2020 2020 205d 0a20 2020 2020 2020 2074       ].        t
-000168c0: 6869 735f 6162 7320 3d20 5448 4953 5f44  his_abs = THIS_D
-000168d0: 4952 2e72 6573 6f6c 7665 2829 0a20 2020  IR.resolve().   
-000168e0: 2020 2020 2073 6f75 7263 6573 2e65 7874       sources.ext
-000168f0: 656e 6428 0a20 2020 2020 2020 2020 2020  end(.           
-00016900: 2063 6572 6369 732e 6765 6e5f 7079 7468   cercis.gen_pyth
-00016910: 6f6e 5f66 696c 6573 280a 2020 2020 2020  on_files(.      
-00016920: 2020 2020 2020 2020 2020 7061 7468 2e69            path.i
-00016930: 7465 7264 6972 2829 2c0a 2020 2020 2020  terdir(),.      
-00016940: 2020 2020 2020 2020 2020 7468 6973 5f61            this_a
-00016950: 6273 2c0a 2020 2020 2020 2020 2020 2020  bs,.            
-00016960: 2020 2020 696e 636c 7564 652c 0a20 2020      include,.   
-00016970: 2020 2020 2020 2020 2020 2020 2065 7863               exc
-00016980: 6c75 6465 2c0a 2020 2020 2020 2020 2020  lude,.          
-00016990: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
-000169a0: 2020 2020 2020 2020 2020 2020 4e6f 6e65              None
-000169b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000169c0: 2020 7265 706f 7274 2c0a 2020 2020 2020    report,.      
-000169d0: 2020 2020 2020 2020 2020 7b70 6174 683a            {path:
-000169e0: 2067 6974 6967 6e6f 7265 7d2c 0a20 2020   gitignore},.   
-000169f0: 2020 2020 2020 2020 2020 2020 2076 6572               ver
-00016a00: 626f 7365 3d46 616c 7365 2c0a 2020 2020  bose=False,.    
-00016a10: 2020 2020 2020 2020 2020 2020 7175 6965              quie
-00016a20: 743d 4661 6c73 652c 0a20 2020 2020 2020  t=False,.       
-00016a30: 2020 2020 2029 0a20 2020 2020 2020 2029       ).        )
-00016a40: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00016a50: 736f 7274 6564 2865 7870 6563 7465 6429  sorted(expected)
-00016a60: 203d 3d20 736f 7274 6564 2873 6f75 7263   == sorted(sourc
-00016a70: 6573 290a 0a20 2020 2064 6566 2074 6573  es)..    def tes
-00016a80: 745f 6e65 7374 6564 5f67 6974 6967 6e6f  t_nested_gitigno
-00016a90: 7265 2873 656c 6629 202d 3e20 4e6f 6e65  re(self) -> None
-00016aa0: 3a0a 2020 2020 2020 2020 7061 7468 203d  :.        path =
-00016ab0: 2050 6174 6828 5448 4953 5f44 4952 202f   Path(THIS_DIR /
-00016ac0: 2022 6461 7461 2220 2f20 226e 6573 7465   "data" / "neste
-00016ad0: 645f 6769 7469 676e 6f72 655f 7465 7374  d_gitignore_test
-00016ae0: 7322 290a 2020 2020 2020 2020 696e 636c  s").        incl
-00016af0: 7564 6520 3d20 7265 2e63 6f6d 7069 6c65  ude = re.compile
-00016b00: 2872 225c 2e70 7969 3f24 2229 0a20 2020  (r"\.pyi?$").   
-00016b10: 2020 2020 2065 7863 6c75 6465 203d 2072       exclude = r
-00016b20: 652e 636f 6d70 696c 6528 7222 2229 0a20  e.compile(r""). 
-00016b30: 2020 2020 2020 2072 6f6f 745f 6769 7469         root_giti
-00016b40: 676e 6f72 6520 3d20 6365 7263 6973 2e66  gnore = cercis.f
-00016b50: 696c 6573 2e67 6574 5f67 6974 6967 6e6f  iles.get_gitigno
-00016b60: 7265 2870 6174 6829 0a20 2020 2020 2020  re(path).       
-00016b70: 2072 6570 6f72 7420 3d20 6365 7263 6973   report = cercis
-00016b80: 2e52 6570 6f72 7428 290a 2020 2020 2020  .Report().      
-00016b90: 2020 6578 7065 6374 6564 3a20 4c69 7374    expected: List
-00016ba0: 5b50 6174 685d 203d 205b 0a20 2020 2020  [Path] = [.     
-00016bb0: 2020 2020 2020 2050 6174 6828 7061 7468         Path(path
-00016bc0: 202f 2022 782e 7079 2229 2c0a 2020 2020   / "x.py"),.    
-00016bd0: 2020 2020 2020 2020 5061 7468 2870 6174          Path(pat
-00016be0: 6820 2f20 2272 6f6f 742f 622e 7079 2229  h / "root/b.py")
-00016bf0: 2c0a 2020 2020 2020 2020 2020 2020 5061  ,.            Pa
-00016c00: 7468 2870 6174 6820 2f20 2272 6f6f 742f  th(path / "root/
-00016c10: 632e 7079 2229 2c0a 2020 2020 2020 2020  c.py"),.        
-00016c20: 2020 2020 5061 7468 2870 6174 6820 2f20      Path(path / 
-00016c30: 2272 6f6f 742f 6368 696c 642f 632e 7079  "root/child/c.py
-00016c40: 2229 2c0a 2020 2020 2020 2020 5d0a 2020  "),.        ].  
-00016c50: 2020 2020 2020 7468 6973 5f61 6273 203d        this_abs =
-00016c60: 2054 4849 535f 4449 522e 7265 736f 6c76   THIS_DIR.resolv
-00016c70: 6528 290a 2020 2020 2020 2020 736f 7572  e().        sour
-00016c80: 6365 7320 3d20 6c69 7374 280a 2020 2020  ces = list(.    
-00016c90: 2020 2020 2020 2020 6365 7263 6973 2e67          cercis.g
-00016ca0: 656e 5f70 7974 686f 6e5f 6669 6c65 7328  en_python_files(
-00016cb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016cc0: 2070 6174 682e 6974 6572 6469 7228 292c   path.iterdir(),
-00016cd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016ce0: 2074 6869 735f 6162 732c 0a20 2020 2020   this_abs,.     
-00016cf0: 2020 2020 2020 2020 2020 2069 6e63 6c75             inclu
-00016d00: 6465 2c0a 2020 2020 2020 2020 2020 2020  de,.            
-00016d10: 2020 2020 6578 636c 7564 652c 0a20 2020      exclude,.   
-00016d20: 2020 2020 2020 2020 2020 2020 204e 6f6e               Non
-00016d30: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00016d40: 2020 204e 6f6e 652c 0a20 2020 2020 2020     None,.       
-00016d50: 2020 2020 2020 2020 2072 6570 6f72 742c           report,
-00016d60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016d70: 207b 7061 7468 3a20 726f 6f74 5f67 6974   {path: root_git
-00016d80: 6967 6e6f 7265 7d2c 0a20 2020 2020 2020  ignore},.       
-00016d90: 2020 2020 2020 2020 2076 6572 626f 7365           verbose
-00016da0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-00016db0: 2020 2020 2020 2020 7175 6965 743d 4661          quiet=Fa
-00016dc0: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-00016dd0: 2029 0a20 2020 2020 2020 2029 0a20 2020   ).        ).   
-00016de0: 2020 2020 2061 7373 6572 7420 736f 7274       assert sort
-00016df0: 6564 2865 7870 6563 7465 6429 203d 3d20  ed(expected) == 
-00016e00: 736f 7274 6564 2873 6f75 7263 6573 290a  sorted(sources).
-00016e10: 0a20 2020 2064 6566 2074 6573 745f 6e65  .    def test_ne
-00016e20: 7374 6564 5f67 6974 6967 6e6f 7265 5f64  sted_gitignore_d
-00016e30: 6972 6563 746c 795f 696e 5f73 6f75 7263  irectly_in_sourc
-00016e40: 655f 6469 7265 6374 6f72 7928 7365 6c66  e_directory(self
-00016e50: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-00016e60: 2020 2023 2068 7474 7073 3a2f 2f67 6974     # https://git
-00016e70: 6875 622e 636f 6d2f 7073 662f 626c 6163  hub.com/psf/blac
-00016e80: 6b2f 6973 7375 6573 2f32 3539 380a 2020  k/issues/2598.  
-00016e90: 2020 2020 2020 7061 7468 203d 2050 6174        path = Pat
-00016ea0: 6828 4441 5441 5f44 4952 202f 2022 6e65  h(DATA_DIR / "ne
-00016eb0: 7374 6564 5f67 6974 6967 6e6f 7265 5f74  sted_gitignore_t
-00016ec0: 6573 7473 2229 0a20 2020 2020 2020 2073  ests").        s
-00016ed0: 7263 203d 2050 6174 6828 7061 7468 202f  rc = Path(path /
-00016ee0: 2022 726f 6f74 2220 2f20 2263 6869 6c64   "root" / "child
-00016ef0: 2229 0a20 2020 2020 2020 2065 7870 6563  ").        expec
-00016f00: 7465 6420 3d20 5b73 7263 202f 2022 612e  ted = [src / "a.
-00016f10: 7079 222c 2073 7263 202f 2022 632e 7079  py", src / "c.py
-00016f20: 225d 0a20 2020 2020 2020 2061 7373 6572  "].        asser
-00016f30: 745f 636f 6c6c 6563 7465 645f 736f 7572  t_collected_sour
-00016f40: 6365 7328 5b73 7263 5d2c 2065 7870 6563  ces([src], expec
-00016f50: 7465 6429 0a0a 2020 2020 6465 6620 7465  ted)..    def te
-00016f60: 7374 5f69 6e76 616c 6964 5f67 6974 6967  st_invalid_gitig
-00016f70: 6e6f 7265 2873 656c 6629 202d 3e20 4e6f  nore(self) -> No
-00016f80: 6e65 3a0a 2020 2020 2020 2020 7061 7468  ne:.        path
-00016f90: 203d 2054 4849 535f 4449 5220 2f20 2264   = THIS_DIR / "d
-00016fa0: 6174 6122 202f 2022 696e 7661 6c69 645f  ata" / "invalid_
-00016fb0: 6769 7469 676e 6f72 655f 7465 7374 7322  gitignore_tests"
-00016fc0: 0a20 2020 2020 2020 2065 6d70 7479 5f63  .        empty_c
-00016fd0: 6f6e 6669 6720 3d20 7061 7468 202f 2022  onfig = path / "
-00016fe0: 7079 7072 6f6a 6563 742e 746f 6d6c 220a  pyproject.toml".
-00016ff0: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
-00017000: 2042 6c61 636b 5275 6e6e 6572 2829 2e69   BlackRunner().i
-00017010: 6e76 6f6b 6528 0a20 2020 2020 2020 2020  nvoke(.         
-00017020: 2020 2063 6572 6369 732e 6d61 696e 2c20     cercis.main, 
-00017030: 5b22 2d2d 7665 7262 6f73 6522 2c20 222d  ["--verbose", "-
-00017040: 2d63 6f6e 6669 6722 2c20 7374 7228 656d  -config", str(em
-00017050: 7074 795f 636f 6e66 6967 292c 2073 7472  pty_config), str
-00017060: 2870 6174 6829 5d0a 2020 2020 2020 2020  (path)].        
-00017070: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
-00017080: 2072 6573 756c 742e 6578 6974 5f63 6f64   result.exit_cod
-00017090: 6520 3d3d 2031 0a20 2020 2020 2020 2061  e == 1.        a
-000170a0: 7373 6572 7420 7265 7375 6c74 2e73 7464  ssert result.std
-000170b0: 6572 725f 6279 7465 7320 6973 206e 6f74  err_bytes is not
-000170c0: 204e 6f6e 650a 0a20 2020 2020 2020 2067   None..        g
-000170d0: 6974 6967 6e6f 7265 203d 2070 6174 6820  itignore = path 
-000170e0: 2f20 222e 6769 7469 676e 6f72 6522 0a20  / ".gitignore". 
-000170f0: 2020 2020 2020 2061 7373 6572 7420 6622         assert f"
-00017100: 436f 756c 6420 6e6f 7420 7061 7273 6520  Could not parse 
-00017110: 7b67 6974 6967 6e6f 7265 7d22 2069 6e20  {gitignore}" in 
-00017120: 7265 7375 6c74 2e73 7464 6572 725f 6279  result.stderr_by
-00017130: 7465 732e 6465 636f 6465 2829 0a0a 2020  tes.decode()..  
-00017140: 2020 6465 6620 7465 7374 5f69 6e76 616c    def test_inval
-00017150: 6964 5f6e 6573 7465 645f 6769 7469 676e  id_nested_gitign
-00017160: 6f72 6528 7365 6c66 2920 2d3e 204e 6f6e  ore(self) -> Non
-00017170: 653a 0a20 2020 2020 2020 2070 6174 6820  e:.        path 
-00017180: 3d20 5448 4953 5f44 4952 202f 2022 6461  = THIS_DIR / "da
-00017190: 7461 2220 2f20 2269 6e76 616c 6964 5f6e  ta" / "invalid_n
-000171a0: 6573 7465 645f 6769 7469 676e 6f72 655f  ested_gitignore_
-000171b0: 7465 7374 7322 0a20 2020 2020 2020 2065  tests".        e
-000171c0: 6d70 7479 5f63 6f6e 6669 6720 3d20 7061  mpty_config = pa
-000171d0: 7468 202f 2022 7079 7072 6f6a 6563 742e  th / "pyproject.
-000171e0: 746f 6d6c 220a 2020 2020 2020 2020 7265  toml".        re
-000171f0: 7375 6c74 203d 2042 6c61 636b 5275 6e6e  sult = BlackRunn
-00017200: 6572 2829 2e69 6e76 6f6b 6528 0a20 2020  er().invoke(.   
-00017210: 2020 2020 2020 2020 2063 6572 6369 732e           cercis.
-00017220: 6d61 696e 2c20 5b22 2d2d 7665 7262 6f73  main, ["--verbos
-00017230: 6522 2c20 222d 2d63 6f6e 6669 6722 2c20  e", "--config", 
-00017240: 7374 7228 656d 7074 795f 636f 6e66 6967  str(empty_config
-00017250: 292c 2073 7472 2870 6174 6829 5d0a 2020  ), str(path)].  
-00017260: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00017270: 6173 7365 7274 2072 6573 756c 742e 6578  assert result.ex
-00017280: 6974 5f63 6f64 6520 3d3d 2031 0a20 2020  it_code == 1.   
-00017290: 2020 2020 2061 7373 6572 7420 7265 7375       assert resu
-000172a0: 6c74 2e73 7464 6572 725f 6279 7465 7320  lt.stderr_bytes 
-000172b0: 6973 206e 6f74 204e 6f6e 650a 0a20 2020  is not None..   
-000172c0: 2020 2020 2067 6974 6967 6e6f 7265 203d       gitignore =
-000172d0: 2070 6174 6820 2f20 2261 2220 2f20 222e   path / "a" / ".
-000172e0: 6769 7469 676e 6f72 6522 0a20 2020 2020  gitignore".     
-000172f0: 2020 2061 7373 6572 7420 6622 436f 756c     assert f"Coul
-00017300: 6420 6e6f 7420 7061 7273 6520 7b67 6974  d not parse {git
-00017310: 6967 6e6f 7265 7d22 2069 6e20 7265 7375  ignore}" in resu
-00017320: 6c74 2e73 7464 6572 725f 6279 7465 732e  lt.stderr_bytes.
-00017330: 6465 636f 6465 2829 0a0a 2020 2020 6465  decode()..    de
-00017340: 6620 7465 7374 5f67 6974 6967 6e6f 7265  f test_gitignore
-00017350: 5f74 6861 745f 6967 6e6f 7265 735f 7375  _that_ignores_su
-00017360: 6266 6f6c 6465 7273 2873 656c 6629 202d  bfolders(self) -
-00017370: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00017380: 2320 4966 2067 6974 6967 6e6f 7265 2077  # If gitignore w
-00017390: 6974 6820 2a2f 2a20 6973 2069 6e20 726f  ith */* is in ro
-000173a0: 6f74 0a20 2020 2020 2020 2072 6f6f 7420  ot.        root 
-000173b0: 3d20 5061 7468 2844 4154 415f 4449 5220  = Path(DATA_DIR 
-000173c0: 2f20 2269 676e 6f72 655f 7375 6266 6f6c  / "ignore_subfol
-000173d0: 6465 7273 5f67 6974 6967 6e6f 7265 5f74  ders_gitignore_t
-000173e0: 6573 7473 2220 2f20 2273 7562 6469 7222  ests" / "subdir"
-000173f0: 290a 2020 2020 2020 2020 6578 7065 6374  ).        expect
-00017400: 6564 203d 205b 726f 6f74 202f 2022 622e  ed = [root / "b.
-00017410: 7079 225d 0a20 2020 2020 2020 2063 7478  py"].        ctx
-00017420: 203d 2046 616b 6543 6f6e 7465 7874 2829   = FakeContext()
-00017430: 0a20 2020 2020 2020 2063 7478 2e6f 626a  .        ctx.obj
-00017440: 5b22 726f 6f74 225d 203d 2072 6f6f 740a  ["root"] = root.
-00017450: 2020 2020 2020 2020 6173 7365 7274 5f63          assert_c
-00017460: 6f6c 6c65 6374 6564 5f73 6f75 7263 6573  ollected_sources
-00017470: 285b 726f 6f74 5d2c 2065 7870 6563 7465  ([root], expecte
-00017480: 642c 2063 7478 3d63 7478 290a 0a20 2020  d, ctx=ctx)..   
-00017490: 2020 2020 2023 2049 6620 2e67 6974 6967       # If .gitig
-000174a0: 6e6f 7265 2077 6974 6820 2a2f 2a20 6973  nore with */* is
-000174b0: 206e 6573 7465 640a 2020 2020 2020 2020   nested.        
-000174c0: 726f 6f74 203d 2050 6174 6828 4441 5441  root = Path(DATA
-000174d0: 5f44 4952 202f 2022 6967 6e6f 7265 5f73  _DIR / "ignore_s
-000174e0: 7562 666f 6c64 6572 735f 6769 7469 676e  ubfolders_gitign
-000174f0: 6f72 655f 7465 7374 7322 290a 2020 2020  ore_tests").    
-00017500: 2020 2020 6578 7065 6374 6564 203d 205b      expected = [
-00017510: 0a20 2020 2020 2020 2020 2020 2072 6f6f  .            roo
-00017520: 7420 2f20 2261 2e70 7922 2c0a 2020 2020  t / "a.py",.    
-00017530: 2020 2020 2020 2020 726f 6f74 202f 2022          root / "
-00017540: 7375 6264 6972 2220 2f20 2262 2e70 7922  subdir" / "b.py"
-00017550: 2c0a 2020 2020 2020 2020 5d0a 2020 2020  ,.        ].    
-00017560: 2020 2020 6374 7820 3d20 4661 6b65 436f      ctx = FakeCo
-00017570: 6e74 6578 7428 290a 2020 2020 2020 2020  ntext().        
-00017580: 6374 782e 6f62 6a5b 2272 6f6f 7422 5d20  ctx.obj["root"] 
-00017590: 3d20 726f 6f74 0a20 2020 2020 2020 2061  = root.        a
-000175a0: 7373 6572 745f 636f 6c6c 6563 7465 645f  ssert_collected_
-000175b0: 736f 7572 6365 7328 5b72 6f6f 745d 2c20  sources([root], 
-000175c0: 6578 7065 6374 6564 2c20 6374 783d 6374  expected, ctx=ct
-000175d0: 7829 0a0a 2020 2020 2020 2020 2320 4966  x)..        # If
-000175e0: 2063 6f6d 6d61 6e64 2069 7320 6578 6563   command is exec
-000175f0: 7574 6564 2066 726f 6d20 6f75 7465 7220  uted from outer 
-00017600: 6469 720a 2020 2020 2020 2020 726f 6f74  dir.        root
-00017610: 203d 2050 6174 6828 4441 5441 5f44 4952   = Path(DATA_DIR
-00017620: 202f 2022 6967 6e6f 7265 5f73 7562 666f   / "ignore_subfo
-00017630: 6c64 6572 735f 6769 7469 676e 6f72 655f  lders_gitignore_
-00017640: 7465 7374 7322 290a 2020 2020 2020 2020  tests").        
-00017650: 7461 7267 6574 203d 2072 6f6f 7420 2f20  target = root / 
-00017660: 2273 7562 6469 7222 0a20 2020 2020 2020  "subdir".       
-00017670: 2065 7870 6563 7465 6420 3d20 5b74 6172   expected = [tar
-00017680: 6765 7420 2f20 2262 2e70 7922 5d0a 2020  get / "b.py"].  
-00017690: 2020 2020 2020 6374 7820 3d20 4661 6b65        ctx = Fake
-000176a0: 436f 6e74 6578 7428 290a 2020 2020 2020  Context().      
-000176b0: 2020 6374 782e 6f62 6a5b 2272 6f6f 7422    ctx.obj["root"
-000176c0: 5d20 3d20 726f 6f74 0a20 2020 2020 2020  ] = root.       
-000176d0: 2061 7373 6572 745f 636f 6c6c 6563 7465   assert_collecte
-000176e0: 645f 736f 7572 6365 7328 5b74 6172 6765  d_sources([targe
-000176f0: 745d 2c20 6578 7065 6374 6564 2c20 6374  t], expected, ct
-00017700: 783d 6374 7829 0a0a 2020 2020 6465 6620  x=ctx)..    def 
-00017710: 7465 7374 5f65 6d70 7479 5f69 6e63 6c75  test_empty_inclu
-00017720: 6465 2873 656c 6629 202d 3e20 4e6f 6e65  de(self) -> None
-00017730: 3a0a 2020 2020 2020 2020 7061 7468 203d  :.        path =
-00017740: 2044 4154 415f 4449 5220 2f20 2269 6e63   DATA_DIR / "inc
-00017750: 6c75 6465 5f65 7863 6c75 6465 5f74 6573  lude_exclude_tes
-00017760: 7473 220a 2020 2020 2020 2020 7372 6320  ts".        src 
-00017770: 3d20 5b70 6174 685d 0a20 2020 2020 2020  = [path].       
-00017780: 2065 7870 6563 7465 6420 3d20 5b0a 2020   expected = [.  
-00017790: 2020 2020 2020 2020 2020 5061 7468 2870            Path(p
-000177a0: 6174 6820 2f20 2262 2f65 7863 6c75 6465  ath / "b/exclude
-000177b0: 2f61 2e70 6965 2229 2c0a 2020 2020 2020  /a.pie"),.      
-000177c0: 2020 2020 2020 5061 7468 2870 6174 6820        Path(path 
-000177d0: 2f20 2262 2f65 7863 6c75 6465 2f61 2e70  / "b/exclude/a.p
-000177e0: 7922 292c 0a20 2020 2020 2020 2020 2020  y"),.           
-000177f0: 2050 6174 6828 7061 7468 202f 2022 622f   Path(path / "b/
-00017800: 6578 636c 7564 652f 612e 7079 6922 292c  exclude/a.pyi"),
-00017810: 0a20 2020 2020 2020 2020 2020 2050 6174  .            Pat
-00017820: 6828 7061 7468 202f 2022 622f 646f 6e74  h(path / "b/dont
-00017830: 5f65 7863 6c75 6465 2f61 2e70 6965 2229  _exclude/a.pie")
-00017840: 2c0a 2020 2020 2020 2020 2020 2020 5061  ,.            Pa
-00017850: 7468 2870 6174 6820 2f20 2262 2f64 6f6e  th(path / "b/don
-00017860: 745f 6578 636c 7564 652f 612e 7079 2229  t_exclude/a.py")
-00017870: 2c0a 2020 2020 2020 2020 2020 2020 5061  ,.            Pa
-00017880: 7468 2870 6174 6820 2f20 2262 2f64 6f6e  th(path / "b/don
-00017890: 745f 6578 636c 7564 652f 612e 7079 6922  t_exclude/a.pyi"
-000178a0: 292c 0a20 2020 2020 2020 2020 2020 2050  ),.            P
-000178b0: 6174 6828 7061 7468 202f 2022 622f 2e64  ath(path / "b/.d
-000178c0: 6566 696e 6974 656c 795f 6578 636c 7564  efinitely_exclud
-000178d0: 652f 612e 7069 6522 292c 0a20 2020 2020  e/a.pie"),.     
-000178e0: 2020 2020 2020 2050 6174 6828 7061 7468         Path(path
-000178f0: 202f 2022 622f 2e64 6566 696e 6974 656c   / "b/.definitel
-00017900: 795f 6578 636c 7564 652f 612e 7079 2229  y_exclude/a.py")
-00017910: 2c0a 2020 2020 2020 2020 2020 2020 5061  ,.            Pa
-00017920: 7468 2870 6174 6820 2f20 2262 2f2e 6465  th(path / "b/.de
-00017930: 6669 6e69 7465 6c79 5f65 7863 6c75 6465  finitely_exclude
-00017940: 2f61 2e70 7969 2229 2c0a 2020 2020 2020  /a.pyi"),.      
-00017950: 2020 2020 2020 5061 7468 2870 6174 6820        Path(path 
-00017960: 2f20 222e 6769 7469 676e 6f72 6522 292c  / ".gitignore"),
-00017970: 0a20 2020 2020 2020 2020 2020 2050 6174  .            Pat
-00017980: 6828 7061 7468 202f 2022 7079 7072 6f6a  h(path / "pyproj
-00017990: 6563 742e 746f 6d6c 2229 2c0a 2020 2020  ect.toml"),.    
-000179a0: 2020 2020 5d0a 2020 2020 2020 2020 2320      ].        # 
-000179b0: 5365 7474 696e 6720 6578 636c 7564 6520  Setting exclude 
-000179c0: 6578 706c 6963 6974 6c79 2074 6f20 616e  explicitly to an
-000179d0: 2065 6d70 7479 2073 7472 696e 6720 746f   empty string to
-000179e0: 2062 6c6f 636b 202e 6769 7469 676e 6f72   block .gitignor
-000179f0: 6520 7573 6167 652e 0a20 2020 2020 2020  e usage..       
-00017a00: 2061 7373 6572 745f 636f 6c6c 6563 7465   assert_collecte
-00017a10: 645f 736f 7572 6365 7328 7372 632c 2065  d_sources(src, e
-00017a20: 7870 6563 7465 642c 2069 6e63 6c75 6465  xpected, include
-00017a30: 3d22 222c 2065 7863 6c75 6465 3d22 2229  ="", exclude="")
-00017a40: 0a0a 2020 2020 6465 6620 7465 7374 5f65  ..    def test_e
-00017a50: 7874 656e 645f 6578 636c 7564 6528 7365  xtend_exclude(se
-00017a60: 6c66 2920 2d3e 204e 6f6e 653a 0a20 2020  lf) -> None:.   
-00017a70: 2020 2020 2070 6174 6820 3d20 4441 5441       path = DATA
-00017a80: 5f44 4952 202f 2022 696e 636c 7564 655f  _DIR / "include_
-00017a90: 6578 636c 7564 655f 7465 7374 7322 0a20  exclude_tests". 
-00017aa0: 2020 2020 2020 2073 7263 203d 205b 7061         src = [pa
-00017ab0: 7468 5d0a 2020 2020 2020 2020 6578 7065  th].        expe
-00017ac0: 6374 6564 203d 205b 0a20 2020 2020 2020  cted = [.       
-00017ad0: 2020 2020 2050 6174 6828 7061 7468 202f       Path(path /
-00017ae0: 2022 622f 6578 636c 7564 652f 612e 7079   "b/exclude/a.py
-00017af0: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
-00017b00: 5061 7468 2870 6174 6820 2f20 2262 2f64  Path(path / "b/d
-00017b10: 6f6e 745f 6578 636c 7564 652f 612e 7079  ont_exclude/a.py
-00017b20: 2229 2c0a 2020 2020 2020 2020 5d0a 2020  "),.        ].  
-00017b30: 2020 2020 2020 6173 7365 7274 5f63 6f6c        assert_col
-00017b40: 6c65 6374 6564 5f73 6f75 7263 6573 280a  lected_sources(.
-00017b50: 2020 2020 2020 2020 2020 2020 7372 632c              src,
-00017b60: 2065 7870 6563 7465 642c 2065 7863 6c75   expected, exclu
-00017b70: 6465 3d72 225c 2e70 7969 2422 2c20 6578  de=r"\.pyi$", ex
-00017b80: 7465 6e64 5f65 7863 6c75 6465 3d72 225c  tend_exclude=r"\
-00017b90: 2e64 6566 696e 6974 656c 795f 6578 636c  .definitely_excl
-00017ba0: 7564 6522 0a20 2020 2020 2020 2029 0a0a  ude".        )..
-00017bb0: 2020 2020 4070 7974 6573 742e 6d61 726b      @pytest.mark
-00017bc0: 2e69 6e63 6f6d 7061 7469 626c 655f 7769  .incompatible_wi
-00017bd0: 7468 5f6d 7970 7963 0a20 2020 2064 6566  th_mypyc.    def
-00017be0: 2074 6573 745f 7379 6d6c 696e 6b5f 6f75   test_symlink_ou
-00017bf0: 745f 6f66 5f72 6f6f 745f 6469 7265 6374  t_of_root_direct
-00017c00: 6f72 7928 7365 6c66 2920 2d3e 204e 6f6e  ory(self) -> Non
-00017c10: 653a 0a20 2020 2020 2020 2070 6174 6820  e:.        path 
-00017c20: 3d20 4d61 6769 634d 6f63 6b28 290a 2020  = MagicMock().  
-00017c30: 2020 2020 2020 726f 6f74 203d 2054 4849        root = THI
-00017c40: 535f 4449 522e 7265 736f 6c76 6528 290a  S_DIR.resolve().
-00017c50: 2020 2020 2020 2020 6368 696c 6420 3d20          child = 
-00017c60: 4d61 6769 634d 6f63 6b28 290a 2020 2020  MagicMock().    
-00017c70: 2020 2020 696e 636c 7564 6520 3d20 7265      include = re
-00017c80: 2e63 6f6d 7069 6c65 2863 6572 6369 732e  .compile(cercis.
-00017c90: 4445 4641 554c 545f 494e 434c 5544 4553  DEFAULT_INCLUDES
-00017ca0: 290a 2020 2020 2020 2020 6578 636c 7564  ).        exclud
-00017cb0: 6520 3d20 7265 2e63 6f6d 7069 6c65 2863  e = re.compile(c
-00017cc0: 6572 6369 732e 4445 4641 554c 545f 4558  ercis.DEFAULT_EX
-00017cd0: 434c 5544 4553 290a 2020 2020 2020 2020  CLUDES).        
-00017ce0: 7265 706f 7274 203d 2063 6572 6369 732e  report = cercis.
-00017cf0: 5265 706f 7274 2829 0a20 2020 2020 2020  Report().       
-00017d00: 2067 6974 6967 6e6f 7265 203d 2050 6174   gitignore = Pat
-00017d10: 6853 7065 632e 6672 6f6d 5f6c 696e 6573  hSpec.from_lines
-00017d20: 2822 6769 7477 696c 646d 6174 6368 222c  ("gitwildmatch",
-00017d30: 205b 5d29 0a20 2020 2020 2020 2023 2060   []).        # `
-00017d40: 6368 696c 6460 2073 686f 756c 6420 6265  child` should be
-00017d50: 6861 7665 206c 696b 6520 6120 7379 6d6c  have like a syml
-00017d60: 696e 6b20 7768 6963 6820 7265 736f 6c76  ink which resolv
-00017d70: 6564 2070 6174 6820 6973 2063 6c65 6172  ed path is clear
-00017d80: 6c79 0a20 2020 2020 2020 2023 206f 7574  ly.        # out
-00017d90: 7369 6465 206f 6620 7468 6520 6072 6f6f  side of the `roo
-00017da0: 7460 2064 6972 6563 746f 7279 2e0a 2020  t` directory..  
-00017db0: 2020 2020 2020 7061 7468 2e69 7465 7264        path.iterd
-00017dc0: 6972 2e72 6574 7572 6e5f 7661 6c75 6520  ir.return_value 
-00017dd0: 3d20 5b63 6869 6c64 5d0a 2020 2020 2020  = [child].      
-00017de0: 2020 6368 696c 642e 7265 736f 6c76 652e    child.resolve.
-00017df0: 7265 7475 726e 5f76 616c 7565 203d 2050  return_value = P
-00017e00: 6174 6828 222f 612f 622f 6322 290a 2020  ath("/a/b/c").  
-00017e10: 2020 2020 2020 6368 696c 642e 6173 5f70        child.as_p
-00017e20: 6f73 6978 2e72 6574 7572 6e5f 7661 6c75  osix.return_valu
-00017e30: 6520 3d20 222f 612f 622f 6322 0a20 2020  e = "/a/b/c".   
-00017e40: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
-00017e50: 2020 2020 2020 6c69 7374 280a 2020 2020        list(.    
-00017e60: 2020 2020 2020 2020 2020 2020 6365 7263              cerc
-00017e70: 6973 2e67 656e 5f70 7974 686f 6e5f 6669  is.gen_python_fi
-00017e80: 6c65 7328 0a20 2020 2020 2020 2020 2020  les(.           
-00017e90: 2020 2020 2020 2020 2070 6174 682e 6974           path.it
-00017ea0: 6572 6469 7228 292c 0a20 2020 2020 2020  erdir(),.       
-00017eb0: 2020 2020 2020 2020 2020 2020 2072 6f6f               roo
-00017ec0: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
-00017ed0: 2020 2020 2020 2069 6e63 6c75 6465 2c0a         include,.
-00017ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017ef0: 2020 2020 6578 636c 7564 652c 0a20 2020      exclude,.   
-00017f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017f10: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-00017f20: 2020 2020 2020 2020 2020 204e 6f6e 652c             None,
-00017f30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017f40: 2020 2020 2072 6570 6f72 742c 0a20 2020       report,.   
+00015c40: 652c 0a20 2020 2020 2020 2065 7874 656e  e,.        exten
+00015c50: 645f 6578 636c 7564 653a 204f 7074 696f  d_exclude: Optio
+00015c60: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
+00015c70: 0a20 2020 2020 2020 2066 6f72 6365 5f65  .        force_e
+00015c80: 7863 6c75 6465 3a20 4f70 7469 6f6e 616c  xclude: Optional
+00015c90: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
+00015ca0: 2020 2020 2020 7374 6469 6e5f 6669 6c65        stdin_file
+00015cb0: 6e61 6d65 3a20 4f70 7469 6f6e 616c 5b73  name: Optional[s
+00015cc0: 7472 5d20 3d20 4e6f 6e65 2c0a 2920 2d3e  tr] = None,.) ->
+00015cd0: 204e 6f6e 653a 0a20 2020 2067 735f 7372   None:.    gs_sr
+00015ce0: 6320 3d20 7475 706c 6528 7374 7228 5061  c = tuple(str(Pa
+00015cf0: 7468 2873 2929 2066 6f72 2073 2069 6e20  th(s)) for s in 
+00015d00: 7372 6329 0a20 2020 2067 735f 6578 7065  src).    gs_expe
+00015d10: 6374 6564 203d 205b 5061 7468 2873 2920  cted = [Path(s) 
+00015d20: 666f 7220 7320 696e 2065 7870 6563 7465  for s in expecte
+00015d30: 645d 0a20 2020 2067 735f 6578 636c 7564  d].    gs_exclud
+00015d40: 6520 3d20 4e6f 6e65 2069 6620 6578 636c  e = None if excl
+00015d50: 7564 6520 6973 204e 6f6e 6520 656c 7365  ude is None else
+00015d60: 2063 6f6d 7069 6c65 5f70 6174 7465 726e   compile_pattern
+00015d70: 2865 7863 6c75 6465 290a 2020 2020 6773  (exclude).    gs
+00015d80: 5f69 6e63 6c75 6465 203d 2044 4546 4155  _include = DEFAU
+00015d90: 4c54 5f49 4e43 4c55 4445 2069 6620 696e  LT_INCLUDE if in
+00015da0: 636c 7564 6520 6973 204e 6f6e 6520 656c  clude is None el
+00015db0: 7365 2063 6f6d 7069 6c65 5f70 6174 7465  se compile_patte
+00015dc0: 726e 2869 6e63 6c75 6465 290a 2020 2020  rn(include).    
+00015dd0: 6773 5f65 7874 656e 645f 6578 636c 7564  gs_extend_exclud
+00015de0: 6520 3d20 280a 2020 2020 2020 2020 4e6f  e = (.        No
+00015df0: 6e65 2069 6620 6578 7465 6e64 5f65 7863  ne if extend_exc
+00015e00: 6c75 6465 2069 7320 4e6f 6e65 2065 6c73  lude is None els
+00015e10: 6520 636f 6d70 696c 655f 7061 7474 6572  e compile_patter
+00015e20: 6e28 6578 7465 6e64 5f65 7863 6c75 6465  n(extend_exclude
+00015e30: 290a 2020 2020 290a 2020 2020 6773 5f66  ).    ).    gs_f
+00015e40: 6f72 6365 5f65 7863 6c75 6465 203d 204e  orce_exclude = N
+00015e50: 6f6e 6520 6966 2066 6f72 6365 5f65 7863  one if force_exc
+00015e60: 6c75 6465 2069 7320 4e6f 6e65 2065 6c73  lude is None els
+00015e70: 6520 636f 6d70 696c 655f 7061 7474 6572  e compile_patter
+00015e80: 6e28 666f 7263 655f 6578 636c 7564 6529  n(force_exclude)
+00015e90: 0a20 2020 2063 6f6c 6c65 6374 6564 203d  .    collected =
+00015ea0: 2063 6572 6369 732e 6765 745f 736f 7572   cercis.get_sour
+00015eb0: 6365 7328 0a20 2020 2020 2020 2063 7478  ces(.        ctx
+00015ec0: 3d63 7478 206f 7220 4661 6b65 436f 6e74  =ctx or FakeCont
+00015ed0: 6578 7428 292c 0a20 2020 2020 2020 2073  ext(),.        s
+00015ee0: 7263 3d67 735f 7372 632c 0a20 2020 2020  rc=gs_src,.     
+00015ef0: 2020 2071 7569 6574 3d46 616c 7365 2c0a     quiet=False,.
+00015f00: 2020 2020 2020 2020 7665 7262 6f73 653d          verbose=
+00015f10: 4661 6c73 652c 0a20 2020 2020 2020 2069  False,.        i
+00015f20: 6e63 6c75 6465 3d67 735f 696e 636c 7564  nclude=gs_includ
+00015f30: 652c 0a20 2020 2020 2020 2065 7863 6c75  e,.        exclu
+00015f40: 6465 3d67 735f 6578 636c 7564 652c 0a20  de=gs_exclude,. 
+00015f50: 2020 2020 2020 2065 7874 656e 645f 6578         extend_ex
+00015f60: 636c 7564 653d 6773 5f65 7874 656e 645f  clude=gs_extend_
+00015f70: 6578 636c 7564 652c 0a20 2020 2020 2020  exclude,.       
+00015f80: 2066 6f72 6365 5f65 7863 6c75 6465 3d67   force_exclude=g
+00015f90: 735f 666f 7263 655f 6578 636c 7564 652c  s_force_exclude,
+00015fa0: 0a20 2020 2020 2020 2072 6570 6f72 743d  .        report=
+00015fb0: 6365 7263 6973 2e52 6570 6f72 7428 292c  cercis.Report(),
+00015fc0: 0a20 2020 2020 2020 2073 7464 696e 5f66  .        stdin_f
+00015fd0: 696c 656e 616d 653d 7374 6469 6e5f 6669  ilename=stdin_fi
+00015fe0: 6c65 6e61 6d65 2c0a 2020 2020 290a 2020  lename,.    ).  
+00015ff0: 2020 6173 7365 7274 2073 6f72 7465 6428    assert sorted(
+00016000: 636f 6c6c 6563 7465 6429 203d 3d20 736f  collected) == so
+00016010: 7274 6564 2867 735f 6578 7065 6374 6564  rted(gs_expected
+00016020: 290a 0a0a 636c 6173 7320 5465 7374 4669  )...class TestFi
+00016030: 6c65 436f 6c6c 6563 7469 6f6e 3a0a 2020  leCollection:.  
+00016040: 2020 6465 6620 7465 7374 5f69 6e63 6c75    def test_inclu
+00016050: 6465 5f65 7863 6c75 6465 2873 656c 6629  de_exclude(self)
+00016060: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+00016070: 2020 7061 7468 203d 2054 4849 535f 4449    path = THIS_DI
+00016080: 5220 2f20 2264 6174 6122 202f 2022 696e  R / "data" / "in
+00016090: 636c 7564 655f 6578 636c 7564 655f 7465  clude_exclude_te
+000160a0: 7374 7322 0a20 2020 2020 2020 2073 7263  sts".        src
+000160b0: 203d 205b 7061 7468 5d0a 2020 2020 2020   = [path].      
+000160c0: 2020 6578 7065 6374 6564 203d 205b 0a20    expected = [. 
+000160d0: 2020 2020 2020 2020 2020 2050 6174 6828             Path(
+000160e0: 7061 7468 202f 2022 622f 646f 6e74 5f65  path / "b/dont_e
+000160f0: 7863 6c75 6465 2f61 2e70 7922 292c 0a20  xclude/a.py"),. 
+00016100: 2020 2020 2020 2020 2020 2050 6174 6828             Path(
+00016110: 7061 7468 202f 2022 622f 646f 6e74 5f65  path / "b/dont_e
+00016120: 7863 6c75 6465 2f61 2e70 7969 2229 2c0a  xclude/a.pyi"),.
+00016130: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
+00016140: 2020 6173 7365 7274 5f63 6f6c 6c65 6374    assert_collect
+00016150: 6564 5f73 6f75 7263 6573 280a 2020 2020  ed_sources(.    
+00016160: 2020 2020 2020 2020 7372 632c 0a20 2020          src,.   
+00016170: 2020 2020 2020 2020 2065 7870 6563 7465           expecte
+00016180: 642c 0a20 2020 2020 2020 2020 2020 2069  d,.            i
+00016190: 6e63 6c75 6465 3d72 225c 2e70 7969 3f24  nclude=r"\.pyi?$
+000161a0: 222c 0a20 2020 2020 2020 2020 2020 2065  ",.            e
+000161b0: 7863 6c75 6465 3d72 222f 6578 636c 7564  xclude=r"/exclud
+000161c0: 652f 7c2f 5c2e 6465 6669 6e69 7465 6c79  e/|/\.definitely
+000161d0: 5f65 7863 6c75 6465 2f22 2c0a 2020 2020  _exclude/",.    
+000161e0: 2020 2020 290a 0a20 2020 2064 6566 2074      )..    def t
+000161f0: 6573 745f 6769 7469 676e 6f72 655f 7573  est_gitignore_us
+00016200: 6564 5f61 735f 6465 6661 756c 7428 7365  ed_as_default(se
+00016210: 6c66 2920 2d3e 204e 6f6e 653a 0a20 2020  lf) -> None:.   
+00016220: 2020 2020 2062 6173 6520 3d20 5061 7468       base = Path
+00016230: 2844 4154 415f 4449 5220 2f20 2269 6e63  (DATA_DIR / "inc
+00016240: 6c75 6465 5f65 7863 6c75 6465 5f74 6573  lude_exclude_tes
+00016250: 7473 2229 0a20 2020 2020 2020 2065 7870  ts").        exp
+00016260: 6563 7465 6420 3d20 5b0a 2020 2020 2020  ected = [.      
+00016270: 2020 2020 2020 6261 7365 202f 2022 622f        base / "b/
+00016280: 2e64 6566 696e 6974 656c 795f 6578 636c  .definitely_excl
+00016290: 7564 652f 612e 7079 222c 0a20 2020 2020  ude/a.py",.     
+000162a0: 2020 2020 2020 2062 6173 6520 2f20 2262         base / "b
+000162b0: 2f2e 6465 6669 6e69 7465 6c79 5f65 7863  /.definitely_exc
+000162c0: 6c75 6465 2f61 2e70 7969 222c 0a20 2020  lude/a.pyi",.   
+000162d0: 2020 2020 205d 0a20 2020 2020 2020 2073       ].        s
+000162e0: 7263 203d 205b 6261 7365 202f 2022 622f  rc = [base / "b/
+000162f0: 225d 0a20 2020 2020 2020 2063 7478 203d  "].        ctx =
+00016300: 2046 616b 6543 6f6e 7465 7874 2829 0a20   FakeContext(). 
+00016310: 2020 2020 2020 2063 7478 2e6f 626a 5b22         ctx.obj["
+00016320: 726f 6f74 225d 203d 2062 6173 650a 2020  root"] = base.  
+00016330: 2020 2020 2020 6173 7365 7274 5f63 6f6c        assert_col
+00016340: 6c65 6374 6564 5f73 6f75 7263 6573 2873  lected_sources(s
+00016350: 7263 2c20 6578 7065 6374 6564 2c20 6374  rc, expected, ct
+00016360: 783d 6374 782c 2065 7874 656e 645f 6578  x=ctx, extend_ex
+00016370: 636c 7564 653d 7222 2f65 7863 6c75 6465  clude=r"/exclude
+00016380: 2f22 290a 0a20 2020 2064 6566 2074 6573  /")..    def tes
+00016390: 745f 6769 7469 676e 6f72 655f 7573 6564  t_gitignore_used
+000163a0: 5f6f 6e5f 6d75 6c74 6970 6c65 5f73 6f75  _on_multiple_sou
+000163b0: 7263 6573 2873 656c 6629 202d 3e20 4e6f  rces(self) -> No
+000163c0: 6e65 3a0a 2020 2020 2020 2020 726f 6f74  ne:.        root
+000163d0: 203d 2050 6174 6828 4441 5441 5f44 4952   = Path(DATA_DIR
+000163e0: 202f 2022 6769 7469 676e 6f72 655f 7573   / "gitignore_us
+000163f0: 6564 5f6f 6e5f 6d75 6c74 6970 6c65 5f73  ed_on_multiple_s
+00016400: 6f75 7263 6573 2229 0a20 2020 2020 2020  ources").       
+00016410: 2065 7870 6563 7465 6420 3d20 5b0a 2020   expected = [.  
+00016420: 2020 2020 2020 2020 2020 726f 6f74 202f            root /
+00016430: 2022 6469 7231 2220 2f20 2262 2e70 7922   "dir1" / "b.py"
+00016440: 2c0a 2020 2020 2020 2020 2020 2020 726f  ,.            ro
+00016450: 6f74 202f 2022 6469 7232 2220 2f20 2262  ot / "dir2" / "b
+00016460: 2e70 7922 2c0a 2020 2020 2020 2020 5d0a  .py",.        ].
+00016470: 2020 2020 2020 2020 6374 7820 3d20 4661          ctx = Fa
+00016480: 6b65 436f 6e74 6578 7428 290a 2020 2020  keContext().    
+00016490: 2020 2020 6374 782e 6f62 6a5b 2272 6f6f      ctx.obj["roo
+000164a0: 7422 5d20 3d20 726f 6f74 0a20 2020 2020  t"] = root.     
+000164b0: 2020 2073 7263 203d 205b 726f 6f74 202f     src = [root /
+000164c0: 2022 6469 7231 222c 2072 6f6f 7420 2f20   "dir1", root / 
+000164d0: 2264 6972 3222 5d0a 2020 2020 2020 2020  "dir2"].        
+000164e0: 6173 7365 7274 5f63 6f6c 6c65 6374 6564  assert_collected
+000164f0: 5f73 6f75 7263 6573 2873 7263 2c20 6578  _sources(src, ex
+00016500: 7065 6374 6564 2c20 6374 783d 6374 7829  pected, ctx=ctx)
+00016510: 0a0a 2020 2020 4070 6174 6368 2822 6365  ..    @patch("ce
+00016520: 7263 6973 2e66 696e 645f 7072 6f6a 6563  rcis.find_projec
+00016530: 745f 726f 6f74 222c 206c 616d 6264 6120  t_root", lambda 
+00016540: 2a61 7267 733a 2028 5448 4953 5f44 4952  *args: (THIS_DIR
+00016550: 2e72 6573 6f6c 7665 2829 2c20 4e6f 6e65  .resolve(), None
+00016560: 2929 0a20 2020 2064 6566 2074 6573 745f  )).    def test_
+00016570: 6578 636c 7564 655f 666f 725f 6973 7375  exclude_for_issu
+00016580: 655f 3135 3732 2873 656c 6629 202d 3e20  e_1572(self) -> 
+00016590: 4e6f 6e65 3a0a 2020 2020 2020 2020 2320  None:.        # 
+000165a0: 4578 636c 7564 6520 7368 6f75 6c64 6e27  Exclude shouldn'
+000165b0: 7420 746f 7563 6820 6669 6c65 7320 7468  t touch files th
+000165c0: 6174 2077 6572 6520 6578 706c 6963 6974  at were explicit
+000165d0: 6c79 2067 6976 656e 2074 6f20 426c 6163  ly given to Blac
+000165e0: 6b20 7468 726f 7567 6820 7468 650a 2020  k through the.  
+000165f0: 2020 2020 2020 2320 434c 492e 2045 7863        # CLI. Exc
+00016600: 6c75 6465 2069 7320 7375 7070 6f73 6564  lude is supposed
+00016610: 2074 6f20 6f6e 6c79 2061 7070 6c79 2074   to only apply t
+00016620: 6f20 7468 6520 7265 6375 7273 6976 6520  o the recursive 
+00016630: 6469 7363 6f76 6572 7920 6f66 2066 696c  discovery of fil
+00016640: 6573 2e0a 2020 2020 2020 2020 2320 6874  es..        # ht
+00016650: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
+00016660: 2f70 7366 2f62 6c61 636b 2f69 7373 7565  /psf/black/issue
+00016670: 732f 3135 3732 0a20 2020 2020 2020 2070  s/1572.        p
+00016680: 6174 6820 3d20 4441 5441 5f44 4952 202f  ath = DATA_DIR /
+00016690: 2022 696e 636c 7564 655f 6578 636c 7564   "include_exclud
+000166a0: 655f 7465 7374 7322 0a20 2020 2020 2020  e_tests".       
+000166b0: 2073 7263 203d 205b 7061 7468 202f 2022   src = [path / "
+000166c0: 622f 6578 636c 7564 652f 612e 7079 225d  b/exclude/a.py"]
+000166d0: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
+000166e0: 6420 3d20 5b70 6174 6820 2f20 2262 2f65  d = [path / "b/e
+000166f0: 7863 6c75 6465 2f61 2e70 7922 5d0a 2020  xclude/a.py"].  
+00016700: 2020 2020 2020 6173 7365 7274 5f63 6f6c        assert_col
+00016710: 6c65 6374 6564 5f73 6f75 7263 6573 2873  lected_sources(s
+00016720: 7263 2c20 6578 7065 6374 6564 2c20 696e  rc, expected, in
+00016730: 636c 7564 653d 2222 2c20 6578 636c 7564  clude="", exclud
+00016740: 653d 7222 2f65 7863 6c75 6465 2f7c 615c  e=r"/exclude/|a\
+00016750: 2e70 7922 290a 0a20 2020 2064 6566 2074  .py")..    def t
+00016760: 6573 745f 6769 7469 676e 6f72 655f 6578  est_gitignore_ex
+00016770: 636c 7564 6528 7365 6c66 2920 2d3e 204e  clude(self) -> N
+00016780: 6f6e 653a 0a20 2020 2020 2020 2070 6174  one:.        pat
+00016790: 6820 3d20 5448 4953 5f44 4952 202f 2022  h = THIS_DIR / "
+000167a0: 6461 7461 2220 2f20 2269 6e63 6c75 6465  data" / "include
+000167b0: 5f65 7863 6c75 6465 5f74 6573 7473 220a  _exclude_tests".
+000167c0: 2020 2020 2020 2020 696e 636c 7564 6520          include 
+000167d0: 3d20 7265 2e63 6f6d 7069 6c65 2872 225c  = re.compile(r"\
+000167e0: 2e70 7969 3f24 2229 0a20 2020 2020 2020  .pyi?$").       
+000167f0: 2065 7863 6c75 6465 203d 2072 652e 636f   exclude = re.co
+00016800: 6d70 696c 6528 7222 2229 0a20 2020 2020  mpile(r"").     
+00016810: 2020 2072 6570 6f72 7420 3d20 6365 7263     report = cerc
+00016820: 6973 2e52 6570 6f72 7428 290a 2020 2020  is.Report().    
+00016830: 2020 2020 6769 7469 676e 6f72 6520 3d20      gitignore = 
+00016840: 5061 7468 5370 6563 2e66 726f 6d5f 6c69  PathSpec.from_li
+00016850: 6e65 7328 0a20 2020 2020 2020 2020 2020  nes(.           
+00016860: 2022 6769 7477 696c 646d 6174 6368 222c   "gitwildmatch",
+00016870: 205b 2265 7863 6c75 6465 2f22 2c20 222e   ["exclude/", ".
+00016880: 6465 6669 6e69 7465 6c79 5f65 7863 6c75  definitely_exclu
+00016890: 6465 225d 0a20 2020 2020 2020 2029 0a20  de"].        ). 
+000168a0: 2020 2020 2020 2073 6f75 7263 6573 3a20         sources: 
+000168b0: 4c69 7374 5b50 6174 685d 203d 205b 5d0a  List[Path] = [].
+000168c0: 2020 2020 2020 2020 6578 7065 6374 6564          expected
+000168d0: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
+000168e0: 2050 6174 6828 7061 7468 202f 2022 622f   Path(path / "b/
+000168f0: 646f 6e74 5f65 7863 6c75 6465 2f61 2e70  dont_exclude/a.p
+00016900: 7922 292c 0a20 2020 2020 2020 2020 2020  y"),.           
+00016910: 2050 6174 6828 7061 7468 202f 2022 622f   Path(path / "b/
+00016920: 646f 6e74 5f65 7863 6c75 6465 2f61 2e70  dont_exclude/a.p
+00016930: 7969 2229 2c0a 2020 2020 2020 2020 5d0a  yi"),.        ].
+00016940: 2020 2020 2020 2020 7468 6973 5f61 6273          this_abs
+00016950: 203d 2054 4849 535f 4449 522e 7265 736f   = THIS_DIR.reso
+00016960: 6c76 6528 290a 2020 2020 2020 2020 736f  lve().        so
+00016970: 7572 6365 732e 6578 7465 6e64 280a 2020  urces.extend(.  
+00016980: 2020 2020 2020 2020 2020 6365 7263 6973            cercis
+00016990: 2e67 656e 5f70 7974 686f 6e5f 6669 6c65  .gen_python_file
+000169a0: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+000169b0: 2020 2070 6174 682e 6974 6572 6469 7228     path.iterdir(
+000169c0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+000169d0: 2020 2074 6869 735f 6162 732c 0a20 2020     this_abs,.   
+000169e0: 2020 2020 2020 2020 2020 2020 2069 6e63               inc
+000169f0: 6c75 6465 2c0a 2020 2020 2020 2020 2020  lude,.          
+00016a00: 2020 2020 2020 6578 636c 7564 652c 0a20        exclude,. 
+00016a10: 2020 2020 2020 2020 2020 2020 2020 204e                 N
+00016a20: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
+00016a30: 2020 2020 204e 6f6e 652c 0a20 2020 2020       None,.     
+00016a40: 2020 2020 2020 2020 2020 2072 6570 6f72             repor
+00016a50: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+00016a60: 2020 207b 7061 7468 3a20 6769 7469 676e     {path: gitign
+00016a70: 6f72 657d 2c0a 2020 2020 2020 2020 2020  ore},.          
+00016a80: 2020 2020 2020 7665 7262 6f73 653d 4661        verbose=Fa
+00016a90: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
+00016aa0: 2020 2020 2071 7569 6574 3d46 616c 7365       quiet=False
+00016ab0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+00016ac0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00016ad0: 2020 6173 7365 7274 2073 6f72 7465 6428    assert sorted(
+00016ae0: 6578 7065 6374 6564 2920 3d3d 2073 6f72  expected) == sor
+00016af0: 7465 6428 736f 7572 6365 7329 0a0a 2020  ted(sources)..  
+00016b00: 2020 6465 6620 7465 7374 5f6e 6573 7465    def test_neste
+00016b10: 645f 6769 7469 676e 6f72 6528 7365 6c66  d_gitignore(self
+00016b20: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00016b30: 2020 2070 6174 6820 3d20 5061 7468 2854     path = Path(T
+00016b40: 4849 535f 4449 5220 2f20 2264 6174 6122  HIS_DIR / "data"
+00016b50: 202f 2022 6e65 7374 6564 5f67 6974 6967   / "nested_gitig
+00016b60: 6e6f 7265 5f74 6573 7473 2229 0a20 2020  nore_tests").   
+00016b70: 2020 2020 2069 6e63 6c75 6465 203d 2072       include = r
+00016b80: 652e 636f 6d70 696c 6528 7222 5c2e 7079  e.compile(r"\.py
+00016b90: 693f 2422 290a 2020 2020 2020 2020 6578  i?$").        ex
+00016ba0: 636c 7564 6520 3d20 7265 2e63 6f6d 7069  clude = re.compi
+00016bb0: 6c65 2872 2222 290a 2020 2020 2020 2020  le(r"").        
+00016bc0: 726f 6f74 5f67 6974 6967 6e6f 7265 203d  root_gitignore =
+00016bd0: 2063 6572 6369 732e 6669 6c65 732e 6765   cercis.files.ge
+00016be0: 745f 6769 7469 676e 6f72 6528 7061 7468  t_gitignore(path
+00016bf0: 290a 2020 2020 2020 2020 7265 706f 7274  ).        report
+00016c00: 203d 2063 6572 6369 732e 5265 706f 7274   = cercis.Report
+00016c10: 2829 0a20 2020 2020 2020 2065 7870 6563  ().        expec
+00016c20: 7465 643a 204c 6973 745b 5061 7468 5d20  ted: List[Path] 
+00016c30: 3d20 5b0a 2020 2020 2020 2020 2020 2020  = [.            
+00016c40: 5061 7468 2870 6174 6820 2f20 2278 2e70  Path(path / "x.p
+00016c50: 7922 292c 0a20 2020 2020 2020 2020 2020  y"),.           
+00016c60: 2050 6174 6828 7061 7468 202f 2022 726f   Path(path / "ro
+00016c70: 6f74 2f62 2e70 7922 292c 0a20 2020 2020  ot/b.py"),.     
+00016c80: 2020 2020 2020 2050 6174 6828 7061 7468         Path(path
+00016c90: 202f 2022 726f 6f74 2f63 2e70 7922 292c   / "root/c.py"),
+00016ca0: 0a20 2020 2020 2020 2020 2020 2050 6174  .            Pat
+00016cb0: 6828 7061 7468 202f 2022 726f 6f74 2f63  h(path / "root/c
+00016cc0: 6869 6c64 2f63 2e70 7922 292c 0a20 2020  hild/c.py"),.   
+00016cd0: 2020 2020 205d 0a20 2020 2020 2020 2074       ].        t
+00016ce0: 6869 735f 6162 7320 3d20 5448 4953 5f44  his_abs = THIS_D
+00016cf0: 4952 2e72 6573 6f6c 7665 2829 0a20 2020  IR.resolve().   
+00016d00: 2020 2020 2073 6f75 7263 6573 203d 206c       sources = l
+00016d10: 6973 7428 0a20 2020 2020 2020 2020 2020  ist(.           
+00016d20: 2063 6572 6369 732e 6765 6e5f 7079 7468   cercis.gen_pyth
+00016d30: 6f6e 5f66 696c 6573 280a 2020 2020 2020  on_files(.      
+00016d40: 2020 2020 2020 2020 2020 7061 7468 2e69            path.i
+00016d50: 7465 7264 6972 2829 2c0a 2020 2020 2020  terdir(),.      
+00016d60: 2020 2020 2020 2020 2020 7468 6973 5f61            this_a
+00016d70: 6273 2c0a 2020 2020 2020 2020 2020 2020  bs,.            
+00016d80: 2020 2020 696e 636c 7564 652c 0a20 2020      include,.   
+00016d90: 2020 2020 2020 2020 2020 2020 2065 7863               exc
+00016da0: 6c75 6465 2c0a 2020 2020 2020 2020 2020  lude,.          
+00016db0: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
+00016dc0: 2020 2020 2020 2020 2020 2020 4e6f 6e65              None
+00016dd0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00016de0: 2020 7265 706f 7274 2c0a 2020 2020 2020    report,.      
+00016df0: 2020 2020 2020 2020 2020 7b70 6174 683a            {path:
+00016e00: 2072 6f6f 745f 6769 7469 676e 6f72 657d   root_gitignore}
+00016e10: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00016e20: 2020 7665 7262 6f73 653d 4661 6c73 652c    verbose=False,
+00016e30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016e40: 2071 7569 6574 3d46 616c 7365 2c0a 2020   quiet=False,.  
+00016e50: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00016e60: 2020 2020 290a 2020 2020 2020 2020 6173      ).        as
+00016e70: 7365 7274 2073 6f72 7465 6428 6578 7065  sert sorted(expe
+00016e80: 6374 6564 2920 3d3d 2073 6f72 7465 6428  cted) == sorted(
+00016e90: 736f 7572 6365 7329 0a0a 2020 2020 6465  sources)..    de
+00016ea0: 6620 7465 7374 5f6e 6573 7465 645f 6769  f test_nested_gi
+00016eb0: 7469 676e 6f72 655f 6469 7265 6374 6c79  tignore_directly
+00016ec0: 5f69 6e5f 736f 7572 6365 5f64 6972 6563  _in_source_direc
+00016ed0: 746f 7279 2873 656c 6629 202d 3e20 4e6f  tory(self) -> No
+00016ee0: 6e65 3a0a 2020 2020 2020 2020 2320 6874  ne:.        # ht
+00016ef0: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
+00016f00: 2f70 7366 2f62 6c61 636b 2f69 7373 7565  /psf/black/issue
+00016f10: 732f 3235 3938 0a20 2020 2020 2020 2070  s/2598.        p
+00016f20: 6174 6820 3d20 5061 7468 2844 4154 415f  ath = Path(DATA_
+00016f30: 4449 5220 2f20 226e 6573 7465 645f 6769  DIR / "nested_gi
+00016f40: 7469 676e 6f72 655f 7465 7374 7322 290a  tignore_tests").
+00016f50: 2020 2020 2020 2020 7372 6320 3d20 5061          src = Pa
+00016f60: 7468 2870 6174 6820 2f20 2272 6f6f 7422  th(path / "root"
+00016f70: 202f 2022 6368 696c 6422 290a 2020 2020   / "child").    
+00016f80: 2020 2020 6578 7065 6374 6564 203d 205b      expected = [
+00016f90: 7372 6320 2f20 2261 2e70 7922 2c20 7372  src / "a.py", sr
+00016fa0: 6320 2f20 2263 2e70 7922 5d0a 2020 2020  c / "c.py"].    
+00016fb0: 2020 2020 6173 7365 7274 5f63 6f6c 6c65      assert_colle
+00016fc0: 6374 6564 5f73 6f75 7263 6573 285b 7372  cted_sources([sr
+00016fd0: 635d 2c20 6578 7065 6374 6564 290a 0a20  c], expected).. 
+00016fe0: 2020 2064 6566 2074 6573 745f 696e 7661     def test_inva
+00016ff0: 6c69 645f 6769 7469 676e 6f72 6528 7365  lid_gitignore(se
+00017000: 6c66 2920 2d3e 204e 6f6e 653a 0a20 2020  lf) -> None:.   
+00017010: 2020 2020 2070 6174 6820 3d20 5448 4953       path = THIS
+00017020: 5f44 4952 202f 2022 6461 7461 2220 2f20  _DIR / "data" / 
+00017030: 2269 6e76 616c 6964 5f67 6974 6967 6e6f  "invalid_gitigno
+00017040: 7265 5f74 6573 7473 220a 2020 2020 2020  re_tests".      
+00017050: 2020 656d 7074 795f 636f 6e66 6967 203d    empty_config =
+00017060: 2070 6174 6820 2f20 2270 7970 726f 6a65   path / "pyproje
+00017070: 6374 2e74 6f6d 6c22 0a20 2020 2020 2020  ct.toml".       
+00017080: 2072 6573 756c 7420 3d20 426c 6163 6b52   result = BlackR
+00017090: 756e 6e65 7228 292e 696e 766f 6b65 280a  unner().invoke(.
+000170a0: 2020 2020 2020 2020 2020 2020 6365 7263              cerc
+000170b0: 6973 2e6d 6169 6e2c 205b 222d 2d76 6572  is.main, ["--ver
+000170c0: 626f 7365 222c 2022 2d2d 636f 6e66 6967  bose", "--config
+000170d0: 222c 2073 7472 2865 6d70 7479 5f63 6f6e  ", str(empty_con
+000170e0: 6669 6729 2c20 7374 7228 7061 7468 295d  fig), str(path)]
+000170f0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00017100: 2020 2061 7373 6572 7420 7265 7375 6c74     assert result
+00017110: 2e65 7869 745f 636f 6465 203d 3d20 310a  .exit_code == 1.
+00017120: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
+00017130: 6573 756c 742e 7374 6465 7272 5f62 7974  esult.stderr_byt
+00017140: 6573 2069 7320 6e6f 7420 4e6f 6e65 0a0a  es is not None..
+00017150: 2020 2020 2020 2020 6769 7469 676e 6f72          gitignor
+00017160: 6520 3d20 7061 7468 202f 2022 2e67 6974  e = path / ".git
+00017170: 6967 6e6f 7265 220a 2020 2020 2020 2020  ignore".        
+00017180: 6173 7365 7274 2066 2243 6f75 6c64 206e  assert f"Could n
+00017190: 6f74 2070 6172 7365 207b 6769 7469 676e  ot parse {gitign
+000171a0: 6f72 657d 2220 696e 2072 6573 756c 742e  ore}" in result.
+000171b0: 7374 6465 7272 5f62 7974 6573 2e64 6563  stderr_bytes.dec
+000171c0: 6f64 6528 290a 0a20 2020 2064 6566 2074  ode()..    def t
+000171d0: 6573 745f 696e 7661 6c69 645f 6e65 7374  est_invalid_nest
+000171e0: 6564 5f67 6974 6967 6e6f 7265 2873 656c  ed_gitignore(sel
+000171f0: 6629 202d 3e20 4e6f 6e65 3a0a 2020 2020  f) -> None:.    
+00017200: 2020 2020 7061 7468 203d 2054 4849 535f      path = THIS_
+00017210: 4449 5220 2f20 2264 6174 6122 202f 2022  DIR / "data" / "
+00017220: 696e 7661 6c69 645f 6e65 7374 6564 5f67  invalid_nested_g
+00017230: 6974 6967 6e6f 7265 5f74 6573 7473 220a  itignore_tests".
+00017240: 2020 2020 2020 2020 656d 7074 795f 636f          empty_co
+00017250: 6e66 6967 203d 2070 6174 6820 2f20 2270  nfig = path / "p
+00017260: 7970 726f 6a65 6374 2e74 6f6d 6c22 0a20  yproject.toml". 
+00017270: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+00017280: 426c 6163 6b52 756e 6e65 7228 292e 696e  BlackRunner().in
+00017290: 766f 6b65 280a 2020 2020 2020 2020 2020  voke(.          
+000172a0: 2020 6365 7263 6973 2e6d 6169 6e2c 205b    cercis.main, [
+000172b0: 222d 2d76 6572 626f 7365 222c 2022 2d2d  "--verbose", "--
+000172c0: 636f 6e66 6967 222c 2073 7472 2865 6d70  config", str(emp
+000172d0: 7479 5f63 6f6e 6669 6729 2c20 7374 7228  ty_config), str(
+000172e0: 7061 7468 295d 0a20 2020 2020 2020 2029  path)].        )
+000172f0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00017300: 7265 7375 6c74 2e65 7869 745f 636f 6465  result.exit_code
+00017310: 203d 3d20 310a 2020 2020 2020 2020 6173   == 1.        as
+00017320: 7365 7274 2072 6573 756c 742e 7374 6465  sert result.stde
+00017330: 7272 5f62 7974 6573 2069 7320 6e6f 7420  rr_bytes is not 
+00017340: 4e6f 6e65 0a0a 2020 2020 2020 2020 6769  None..        gi
+00017350: 7469 676e 6f72 6520 3d20 7061 7468 202f  tignore = path /
+00017360: 2022 6122 202f 2022 2e67 6974 6967 6e6f   "a" / ".gitigno
+00017370: 7265 220a 2020 2020 2020 2020 6173 7365  re".        asse
+00017380: 7274 2066 2243 6f75 6c64 206e 6f74 2070  rt f"Could not p
+00017390: 6172 7365 207b 6769 7469 676e 6f72 657d  arse {gitignore}
+000173a0: 2220 696e 2072 6573 756c 742e 7374 6465  " in result.stde
+000173b0: 7272 5f62 7974 6573 2e64 6563 6f64 6528  rr_bytes.decode(
+000173c0: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
+000173d0: 6769 7469 676e 6f72 655f 7468 6174 5f69  gitignore_that_i
+000173e0: 676e 6f72 6573 5f73 7562 666f 6c64 6572  gnores_subfolder
+000173f0: 7328 7365 6c66 2920 2d3e 204e 6f6e 653a  s(self) -> None:
+00017400: 0a20 2020 2020 2020 2023 2049 6620 6769  .        # If gi
+00017410: 7469 676e 6f72 6520 7769 7468 202a 2f2a  tignore with */*
+00017420: 2069 7320 696e 2072 6f6f 740a 2020 2020   is in root.    
+00017430: 2020 2020 726f 6f74 203d 2050 6174 6828      root = Path(
+00017440: 4441 5441 5f44 4952 202f 2022 6967 6e6f  DATA_DIR / "igno
+00017450: 7265 5f73 7562 666f 6c64 6572 735f 6769  re_subfolders_gi
+00017460: 7469 676e 6f72 655f 7465 7374 7322 202f  tignore_tests" /
+00017470: 2022 7375 6264 6972 2229 0a20 2020 2020   "subdir").     
+00017480: 2020 2065 7870 6563 7465 6420 3d20 5b72     expected = [r
+00017490: 6f6f 7420 2f20 2262 2e70 7922 5d0a 2020  oot / "b.py"].  
+000174a0: 2020 2020 2020 6374 7820 3d20 4661 6b65        ctx = Fake
+000174b0: 436f 6e74 6578 7428 290a 2020 2020 2020  Context().      
+000174c0: 2020 6374 782e 6f62 6a5b 2272 6f6f 7422    ctx.obj["root"
+000174d0: 5d20 3d20 726f 6f74 0a20 2020 2020 2020  ] = root.       
+000174e0: 2061 7373 6572 745f 636f 6c6c 6563 7465   assert_collecte
+000174f0: 645f 736f 7572 6365 7328 5b72 6f6f 745d  d_sources([root]
+00017500: 2c20 6578 7065 6374 6564 2c20 6374 783d  , expected, ctx=
+00017510: 6374 7829 0a0a 2020 2020 2020 2020 2320  ctx)..        # 
+00017520: 4966 202e 6769 7469 676e 6f72 6520 7769  If .gitignore wi
+00017530: 7468 202a 2f2a 2069 7320 6e65 7374 6564  th */* is nested
+00017540: 0a20 2020 2020 2020 2072 6f6f 7420 3d20  .        root = 
+00017550: 5061 7468 2844 4154 415f 4449 5220 2f20  Path(DATA_DIR / 
+00017560: 2269 676e 6f72 655f 7375 6266 6f6c 6465  "ignore_subfolde
+00017570: 7273 5f67 6974 6967 6e6f 7265 5f74 6573  rs_gitignore_tes
+00017580: 7473 2229 0a20 2020 2020 2020 2065 7870  ts").        exp
+00017590: 6563 7465 6420 3d20 5b0a 2020 2020 2020  ected = [.      
+000175a0: 2020 2020 2020 726f 6f74 202f 2022 612e        root / "a.
+000175b0: 7079 222c 0a20 2020 2020 2020 2020 2020  py",.           
+000175c0: 2072 6f6f 7420 2f20 2273 7562 6469 7222   root / "subdir"
+000175d0: 202f 2022 622e 7079 222c 0a20 2020 2020   / "b.py",.     
+000175e0: 2020 205d 0a20 2020 2020 2020 2063 7478     ].        ctx
+000175f0: 203d 2046 616b 6543 6f6e 7465 7874 2829   = FakeContext()
+00017600: 0a20 2020 2020 2020 2063 7478 2e6f 626a  .        ctx.obj
+00017610: 5b22 726f 6f74 225d 203d 2072 6f6f 740a  ["root"] = root.
+00017620: 2020 2020 2020 2020 6173 7365 7274 5f63          assert_c
+00017630: 6f6c 6c65 6374 6564 5f73 6f75 7263 6573  ollected_sources
+00017640: 285b 726f 6f74 5d2c 2065 7870 6563 7465  ([root], expecte
+00017650: 642c 2063 7478 3d63 7478 290a 0a20 2020  d, ctx=ctx)..   
+00017660: 2020 2020 2023 2049 6620 636f 6d6d 616e       # If comman
+00017670: 6420 6973 2065 7865 6375 7465 6420 6672  d is executed fr
+00017680: 6f6d 206f 7574 6572 2064 6972 0a20 2020  om outer dir.   
+00017690: 2020 2020 2072 6f6f 7420 3d20 5061 7468       root = Path
+000176a0: 2844 4154 415f 4449 5220 2f20 2269 676e  (DATA_DIR / "ign
+000176b0: 6f72 655f 7375 6266 6f6c 6465 7273 5f67  ore_subfolders_g
+000176c0: 6974 6967 6e6f 7265 5f74 6573 7473 2229  itignore_tests")
+000176d0: 0a20 2020 2020 2020 2074 6172 6765 7420  .        target 
+000176e0: 3d20 726f 6f74 202f 2022 7375 6264 6972  = root / "subdir
+000176f0: 220a 2020 2020 2020 2020 6578 7065 6374  ".        expect
+00017700: 6564 203d 205b 7461 7267 6574 202f 2022  ed = [target / "
+00017710: 622e 7079 225d 0a20 2020 2020 2020 2063  b.py"].        c
+00017720: 7478 203d 2046 616b 6543 6f6e 7465 7874  tx = FakeContext
+00017730: 2829 0a20 2020 2020 2020 2063 7478 2e6f  ().        ctx.o
+00017740: 626a 5b22 726f 6f74 225d 203d 2072 6f6f  bj["root"] = roo
+00017750: 740a 2020 2020 2020 2020 6173 7365 7274  t.        assert
+00017760: 5f63 6f6c 6c65 6374 6564 5f73 6f75 7263  _collected_sourc
+00017770: 6573 285b 7461 7267 6574 5d2c 2065 7870  es([target], exp
+00017780: 6563 7465 642c 2063 7478 3d63 7478 290a  ected, ctx=ctx).
+00017790: 0a20 2020 2064 6566 2074 6573 745f 656d  .    def test_em
+000177a0: 7074 795f 696e 636c 7564 6528 7365 6c66  pty_include(self
+000177b0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+000177c0: 2020 2070 6174 6820 3d20 4441 5441 5f44     path = DATA_D
+000177d0: 4952 202f 2022 696e 636c 7564 655f 6578  IR / "include_ex
+000177e0: 636c 7564 655f 7465 7374 7322 0a20 2020  clude_tests".   
+000177f0: 2020 2020 2073 7263 203d 205b 7061 7468       src = [path
+00017800: 5d0a 2020 2020 2020 2020 6578 7065 6374  ].        expect
+00017810: 6564 203d 205b 0a20 2020 2020 2020 2020  ed = [.         
+00017820: 2020 2050 6174 6828 7061 7468 202f 2022     Path(path / "
+00017830: 622f 6578 636c 7564 652f 612e 7069 6522  b/exclude/a.pie"
+00017840: 292c 0a20 2020 2020 2020 2020 2020 2050  ),.            P
+00017850: 6174 6828 7061 7468 202f 2022 622f 6578  ath(path / "b/ex
+00017860: 636c 7564 652f 612e 7079 2229 2c0a 2020  clude/a.py"),.  
+00017870: 2020 2020 2020 2020 2020 5061 7468 2870            Path(p
+00017880: 6174 6820 2f20 2262 2f65 7863 6c75 6465  ath / "b/exclude
+00017890: 2f61 2e70 7969 2229 2c0a 2020 2020 2020  /a.pyi"),.      
+000178a0: 2020 2020 2020 5061 7468 2870 6174 6820        Path(path 
+000178b0: 2f20 2262 2f64 6f6e 745f 6578 636c 7564  / "b/dont_exclud
+000178c0: 652f 612e 7069 6522 292c 0a20 2020 2020  e/a.pie"),.     
+000178d0: 2020 2020 2020 2050 6174 6828 7061 7468         Path(path
+000178e0: 202f 2022 622f 646f 6e74 5f65 7863 6c75   / "b/dont_exclu
+000178f0: 6465 2f61 2e70 7922 292c 0a20 2020 2020  de/a.py"),.     
+00017900: 2020 2020 2020 2050 6174 6828 7061 7468         Path(path
+00017910: 202f 2022 622f 646f 6e74 5f65 7863 6c75   / "b/dont_exclu
+00017920: 6465 2f61 2e70 7969 2229 2c0a 2020 2020  de/a.pyi"),.    
+00017930: 2020 2020 2020 2020 5061 7468 2870 6174          Path(pat
+00017940: 6820 2f20 2262 2f2e 6465 6669 6e69 7465  h / "b/.definite
+00017950: 6c79 5f65 7863 6c75 6465 2f61 2e70 6965  ly_exclude/a.pie
+00017960: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
+00017970: 5061 7468 2870 6174 6820 2f20 2262 2f2e  Path(path / "b/.
+00017980: 6465 6669 6e69 7465 6c79 5f65 7863 6c75  definitely_exclu
+00017990: 6465 2f61 2e70 7922 292c 0a20 2020 2020  de/a.py"),.     
+000179a0: 2020 2020 2020 2050 6174 6828 7061 7468         Path(path
+000179b0: 202f 2022 622f 2e64 6566 696e 6974 656c   / "b/.definitel
+000179c0: 795f 6578 636c 7564 652f 612e 7079 6922  y_exclude/a.pyi"
+000179d0: 292c 0a20 2020 2020 2020 2020 2020 2050  ),.            P
+000179e0: 6174 6828 7061 7468 202f 2022 2e67 6974  ath(path / ".git
+000179f0: 6967 6e6f 7265 2229 2c0a 2020 2020 2020  ignore"),.      
+00017a00: 2020 2020 2020 5061 7468 2870 6174 6820        Path(path 
+00017a10: 2f20 2270 7970 726f 6a65 6374 2e74 6f6d  / "pyproject.tom
+00017a20: 6c22 292c 0a20 2020 2020 2020 205d 0a20  l"),.        ]. 
+00017a30: 2020 2020 2020 2023 2053 6574 7469 6e67         # Setting
+00017a40: 2065 7863 6c75 6465 2065 7870 6c69 6369   exclude explici
+00017a50: 746c 7920 746f 2061 6e20 656d 7074 7920  tly to an empty 
+00017a60: 7374 7269 6e67 2074 6f20 626c 6f63 6b20  string to block 
+00017a70: 2e67 6974 6967 6e6f 7265 2075 7361 6765  .gitignore usage
+00017a80: 2e0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
+00017a90: 5f63 6f6c 6c65 6374 6564 5f73 6f75 7263  _collected_sourc
+00017aa0: 6573 2873 7263 2c20 6578 7065 6374 6564  es(src, expected
+00017ab0: 2c20 696e 636c 7564 653d 2222 2c20 6578  , include="", ex
+00017ac0: 636c 7564 653d 2222 290a 0a20 2020 2064  clude="")..    d
+00017ad0: 6566 2074 6573 745f 6578 7465 6e64 5f65  ef test_extend_e
+00017ae0: 7863 6c75 6465 2873 656c 6629 202d 3e20  xclude(self) -> 
+00017af0: 4e6f 6e65 3a0a 2020 2020 2020 2020 7061  None:.        pa
+00017b00: 7468 203d 2044 4154 415f 4449 5220 2f20  th = DATA_DIR / 
+00017b10: 2269 6e63 6c75 6465 5f65 7863 6c75 6465  "include_exclude
+00017b20: 5f74 6573 7473 220a 2020 2020 2020 2020  _tests".        
+00017b30: 7372 6320 3d20 5b70 6174 685d 0a20 2020  src = [path].   
+00017b40: 2020 2020 2065 7870 6563 7465 6420 3d20       expected = 
+00017b50: 5b0a 2020 2020 2020 2020 2020 2020 5061  [.            Pa
+00017b60: 7468 2870 6174 6820 2f20 2262 2f65 7863  th(path / "b/exc
+00017b70: 6c75 6465 2f61 2e70 7922 292c 0a20 2020  lude/a.py"),.   
+00017b80: 2020 2020 2020 2020 2050 6174 6828 7061           Path(pa
+00017b90: 7468 202f 2022 622f 646f 6e74 5f65 7863  th / "b/dont_exc
+00017ba0: 6c75 6465 2f61 2e70 7922 292c 0a20 2020  lude/a.py"),.   
+00017bb0: 2020 2020 205d 0a20 2020 2020 2020 2061       ].        a
+00017bc0: 7373 6572 745f 636f 6c6c 6563 7465 645f  ssert_collected_
+00017bd0: 736f 7572 6365 7328 0a20 2020 2020 2020  sources(.       
+00017be0: 2020 2020 2073 7263 2c20 6578 7065 6374       src, expect
+00017bf0: 6564 2c20 6578 636c 7564 653d 7222 5c2e  ed, exclude=r"\.
+00017c00: 7079 6924 222c 2065 7874 656e 645f 6578  pyi$", extend_ex
+00017c10: 636c 7564 653d 7222 5c2e 6465 6669 6e69  clude=r"\.defini
+00017c20: 7465 6c79 5f65 7863 6c75 6465 220a 2020  tely_exclude".  
+00017c30: 2020 2020 2020 290a 0a20 2020 2040 7079        )..    @py
+00017c40: 7465 7374 2e6d 6172 6b2e 696e 636f 6d70  test.mark.incomp
+00017c50: 6174 6962 6c65 5f77 6974 685f 6d79 7079  atible_with_mypy
+00017c60: 630a 2020 2020 6465 6620 7465 7374 5f73  c.    def test_s
+00017c70: 796d 6c69 6e6b 5f6f 7574 5f6f 665f 726f  ymlink_out_of_ro
+00017c80: 6f74 5f64 6972 6563 746f 7279 2873 656c  ot_directory(sel
+00017c90: 6629 202d 3e20 4e6f 6e65 3a0a 2020 2020  f) -> None:.    
+00017ca0: 2020 2020 7061 7468 203d 204d 6167 6963      path = Magic
+00017cb0: 4d6f 636b 2829 0a20 2020 2020 2020 2072  Mock().        r
+00017cc0: 6f6f 7420 3d20 5448 4953 5f44 4952 2e72  oot = THIS_DIR.r
+00017cd0: 6573 6f6c 7665 2829 0a20 2020 2020 2020  esolve().       
+00017ce0: 2063 6869 6c64 203d 204d 6167 6963 4d6f   child = MagicMo
+00017cf0: 636b 2829 0a20 2020 2020 2020 2069 6e63  ck().        inc
+00017d00: 6c75 6465 203d 2072 652e 636f 6d70 696c  lude = re.compil
+00017d10: 6528 6365 7263 6973 2e44 4546 4155 4c54  e(cercis.DEFAULT
+00017d20: 5f49 4e43 4c55 4445 5329 0a20 2020 2020  _INCLUDES).     
+00017d30: 2020 2065 7863 6c75 6465 203d 2072 652e     exclude = re.
+00017d40: 636f 6d70 696c 6528 6365 7263 6973 2e44  compile(cercis.D
+00017d50: 4546 4155 4c54 5f45 5843 4c55 4445 5329  EFAULT_EXCLUDES)
+00017d60: 0a20 2020 2020 2020 2072 6570 6f72 7420  .        report 
+00017d70: 3d20 6365 7263 6973 2e52 6570 6f72 7428  = cercis.Report(
+00017d80: 290a 2020 2020 2020 2020 6769 7469 676e  ).        gitign
+00017d90: 6f72 6520 3d20 5061 7468 5370 6563 2e66  ore = PathSpec.f
+00017da0: 726f 6d5f 6c69 6e65 7328 2267 6974 7769  rom_lines("gitwi
+00017db0: 6c64 6d61 7463 6822 2c20 5b5d 290a 2020  ldmatch", []).  
+00017dc0: 2020 2020 2020 2320 6063 6869 6c64 6020        # `child` 
+00017dd0: 7368 6f75 6c64 2062 6568 6176 6520 6c69  should behave li
+00017de0: 6b65 2061 2073 796d 6c69 6e6b 2077 6869  ke a symlink whi
+00017df0: 6368 2072 6573 6f6c 7665 6420 7061 7468  ch resolved path
+00017e00: 2069 7320 636c 6561 726c 790a 2020 2020   is clearly.    
+00017e10: 2020 2020 2320 6f75 7473 6964 6520 6f66      # outside of
+00017e20: 2074 6865 2060 726f 6f74 6020 6469 7265   the `root` dire
+00017e30: 6374 6f72 792e 0a20 2020 2020 2020 2070  ctory..        p
+00017e40: 6174 682e 6974 6572 6469 722e 7265 7475  ath.iterdir.retu
+00017e50: 726e 5f76 616c 7565 203d 205b 6368 696c  rn_value = [chil
+00017e60: 645d 0a20 2020 2020 2020 2063 6869 6c64  d].        child
+00017e70: 2e72 6573 6f6c 7665 2e72 6574 7572 6e5f  .resolve.return_
+00017e80: 7661 6c75 6520 3d20 5061 7468 2822 2f61  value = Path("/a
+00017e90: 2f62 2f63 2229 0a20 2020 2020 2020 2063  /b/c").        c
+00017ea0: 6869 6c64 2e61 735f 706f 7369 782e 7265  hild.as_posix.re
+00017eb0: 7475 726e 5f76 616c 7565 203d 2022 2f61  turn_value = "/a
+00017ec0: 2f62 2f63 220a 2020 2020 2020 2020 7472  /b/c".        tr
+00017ed0: 793a 0a20 2020 2020 2020 2020 2020 206c  y:.            l
+00017ee0: 6973 7428 0a20 2020 2020 2020 2020 2020  ist(.           
+00017ef0: 2020 2020 2063 6572 6369 732e 6765 6e5f       cercis.gen_
+00017f00: 7079 7468 6f6e 5f66 696c 6573 280a 2020  python_files(.  
+00017f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017f20: 2020 7061 7468 2e69 7465 7264 6972 2829    path.iterdir()
+00017f30: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00017f40: 2020 2020 2020 726f 6f74 2c0a 2020 2020        root,.    
 00017f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017f60: 207b 7061 7468 3a20 6769 7469 676e 6f72   {path: gitignor
-00017f70: 657d 2c0a 2020 2020 2020 2020 2020 2020  e},.            
-00017f80: 2020 2020 2020 2020 7665 7262 6f73 653d          verbose=
-00017f90: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
-00017fa0: 2020 2020 2020 2020 2020 2071 7569 6574             quiet
-00017fb0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-00017fc0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00017fd0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00017fe0: 6578 6365 7074 2056 616c 7565 4572 726f  except ValueErro
-00017ff0: 7220 6173 2076 653a 0a20 2020 2020 2020  r as ve:.       
-00018000: 2020 2020 2070 7974 6573 742e 6661 696c       pytest.fail
-00018010: 2866 2260 6765 745f 7079 7468 6f6e 5f66  (f"`get_python_f
-00018020: 696c 6573 5f69 6e5f 6469 7228 2960 2066  iles_in_dir()` f
-00018030: 6169 6c65 643a 207b 7665 7d22 290a 2020  ailed: {ve}").  
-00018040: 2020 2020 2020 7061 7468 2e69 7465 7264        path.iterd
-00018050: 6972 2e61 7373 6572 745f 6361 6c6c 6564  ir.assert_called
-00018060: 5f6f 6e63 6528 290a 2020 2020 2020 2020  _once().        
-00018070: 6368 696c 642e 7265 736f 6c76 652e 6173  child.resolve.as
-00018080: 7365 7274 5f63 616c 6c65 645f 6f6e 6365  sert_called_once
-00018090: 2829 0a0a 2020 2020 4070 6174 6368 2822  ()..    @patch("
-000180a0: 6365 7263 6973 2e66 696e 645f 7072 6f6a  cercis.find_proj
-000180b0: 6563 745f 726f 6f74 222c 206c 616d 6264  ect_root", lambd
-000180c0: 6120 2a61 7267 733a 2028 5448 4953 5f44  a *args: (THIS_D
-000180d0: 4952 2e72 6573 6f6c 7665 2829 2c20 4e6f  IR.resolve(), No
-000180e0: 6e65 2929 0a20 2020 2064 6566 2074 6573  ne)).    def tes
-000180f0: 745f 6765 745f 736f 7572 6365 735f 7769  t_get_sources_wi
-00018100: 7468 5f73 7464 696e 2873 656c 6629 202d  th_stdin(self) -
-00018110: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-00018120: 7372 6320 3d20 5b22 2d22 5d0a 2020 2020  src = ["-"].    
-00018130: 2020 2020 6578 7065 6374 6564 203d 205b      expected = [
-00018140: 222d 225d 0a20 2020 2020 2020 2061 7373  "-"].        ass
-00018150: 6572 745f 636f 6c6c 6563 7465 645f 736f  ert_collected_so
-00018160: 7572 6365 7328 7372 632c 2065 7870 6563  urces(src, expec
-00018170: 7465 642c 2069 6e63 6c75 6465 3d22 222c  ted, include="",
-00018180: 2065 7863 6c75 6465 3d72 222f 6578 636c   exclude=r"/excl
-00018190: 7564 652f 7c61 5c2e 7079 2229 0a0a 2020  ude/|a\.py")..  
-000181a0: 2020 4070 6174 6368 2822 6365 7263 6973    @patch("cercis
-000181b0: 2e66 696e 645f 7072 6f6a 6563 745f 726f  .find_project_ro
-000181c0: 6f74 222c 206c 616d 6264 6120 2a61 7267  ot", lambda *arg
-000181d0: 733a 2028 5448 4953 5f44 4952 2e72 6573  s: (THIS_DIR.res
-000181e0: 6f6c 7665 2829 2c20 4e6f 6e65 2929 0a20  olve(), None)). 
-000181f0: 2020 2064 6566 2074 6573 745f 6765 745f     def test_get_
-00018200: 736f 7572 6365 735f 7769 7468 5f73 7464  sources_with_std
-00018210: 696e 5f66 696c 656e 616d 6528 7365 6c66  in_filename(self
-00018220: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-00018230: 2020 2073 7263 203d 205b 222d 225d 0a20     src = ["-"]. 
-00018240: 2020 2020 2020 2073 7464 696e 5f66 696c         stdin_fil
-00018250: 656e 616d 6520 3d20 7374 7228 5448 4953  ename = str(THIS
-00018260: 5f44 4952 202f 2022 6461 7461 2f63 6f6c  _DIR / "data/col
-00018270: 6c65 6374 696f 6e73 2e70 7922 290a 2020  lections.py").  
-00018280: 2020 2020 2020 6578 7065 6374 6564 203d        expected =
-00018290: 205b 6622 5f5f 424c 4143 4b5f 5354 4449   [f"__BLACK_STDI
-000182a0: 4e5f 4649 4c45 4e41 4d45 5f5f 7b73 7464  N_FILENAME__{std
-000182b0: 696e 5f66 696c 656e 616d 657d 225d 0a20  in_filename}"]. 
-000182c0: 2020 2020 2020 2061 7373 6572 745f 636f         assert_co
-000182d0: 6c6c 6563 7465 645f 736f 7572 6365 7328  llected_sources(
-000182e0: 0a20 2020 2020 2020 2020 2020 2073 7263  .            src
-000182f0: 2c0a 2020 2020 2020 2020 2020 2020 6578  ,.            ex
-00018300: 7065 6374 6564 2c0a 2020 2020 2020 2020  pected,.        
-00018310: 2020 2020 6578 636c 7564 653d 7222 2f65      exclude=r"/e
-00018320: 7863 6c75 6465 2f61 5c2e 7079 222c 0a20  xclude/a\.py",. 
-00018330: 2020 2020 2020 2020 2020 2073 7464 696e             stdin
-00018340: 5f66 696c 656e 616d 653d 7374 6469 6e5f  _filename=stdin_
-00018350: 6669 6c65 6e61 6d65 2c0a 2020 2020 2020  filename,.      
-00018360: 2020 290a 0a20 2020 2040 7061 7463 6828    )..    @patch(
-00018370: 2263 6572 6369 732e 6669 6e64 5f70 726f  "cercis.find_pro
-00018380: 6a65 6374 5f72 6f6f 7422 2c20 6c61 6d62  ject_root", lamb
-00018390: 6461 202a 6172 6773 3a20 2854 4849 535f  da *args: (THIS_
-000183a0: 4449 522e 7265 736f 6c76 6528 292c 204e  DIR.resolve(), N
-000183b0: 6f6e 6529 290a 2020 2020 6465 6620 7465  one)).    def te
-000183c0: 7374 5f67 6574 5f73 6f75 7263 6573 5f77  st_get_sources_w
-000183d0: 6974 685f 7374 6469 6e5f 6669 6c65 6e61  ith_stdin_filena
-000183e0: 6d65 5f61 6e64 5f65 7863 6c75 6465 2873  me_and_exclude(s
-000183f0: 656c 6629 202d 3e20 4e6f 6e65 3a0a 2020  elf) -> None:.  
-00018400: 2020 2020 2020 2320 4578 636c 7564 6520        # Exclude 
-00018410: 7368 6f75 6c64 6e27 7420 6578 636c 7564  shouldn't exclud
-00018420: 6520 7374 6469 6e5f 6669 6c65 6e61 6d65  e stdin_filename
-00018430: 2073 696e 6365 2069 7420 6973 206d 696d   since it is mim
-00018440: 6963 6b69 6e67 2074 6865 0a20 2020 2020  icking the.     
-00018450: 2020 2023 2066 696c 6520 6265 696e 6720     # file being 
-00018460: 7061 7373 6564 2064 6972 6563 746c 792e  passed directly.
-00018470: 2054 6869 7320 6973 2074 6865 2073 616d   This is the sam
-00018480: 6520 6173 0a20 2020 2020 2020 2023 2074  e as.        # t
-00018490: 6573 745f 6578 636c 7564 655f 666f 725f  est_exclude_for_
-000184a0: 6973 7375 655f 3135 3732 0a20 2020 2020  issue_1572.     
-000184b0: 2020 2070 6174 6820 3d20 4441 5441 5f44     path = DATA_D
-000184c0: 4952 202f 2022 696e 636c 7564 655f 6578  IR / "include_ex
-000184d0: 636c 7564 655f 7465 7374 7322 0a20 2020  clude_tests".   
-000184e0: 2020 2020 2073 7263 203d 205b 222d 225d       src = ["-"]
-000184f0: 0a20 2020 2020 2020 2073 7464 696e 5f66  .        stdin_f
-00018500: 696c 656e 616d 6520 3d20 7374 7228 7061  ilename = str(pa
-00018510: 7468 202f 2022 622f 6578 636c 7564 652f  th / "b/exclude/
-00018520: 612e 7079 2229 0a20 2020 2020 2020 2065  a.py").        e
-00018530: 7870 6563 7465 6420 3d20 5b66 225f 5f42  xpected = [f"__B
-00018540: 4c41 434b 5f53 5444 494e 5f46 494c 454e  LACK_STDIN_FILEN
-00018550: 414d 455f 5f7b 7374 6469 6e5f 6669 6c65  AME__{stdin_file
-00018560: 6e61 6d65 7d22 5d0a 2020 2020 2020 2020  name}"].        
-00018570: 6173 7365 7274 5f63 6f6c 6c65 6374 6564  assert_collected
-00018580: 5f73 6f75 7263 6573 280a 2020 2020 2020  _sources(.      
-00018590: 2020 2020 2020 7372 632c 0a20 2020 2020        src,.     
-000185a0: 2020 2020 2020 2065 7870 6563 7465 642c         expected,
-000185b0: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
-000185c0: 6c75 6465 3d72 222f 6578 636c 7564 652f  lude=r"/exclude/
-000185d0: 7c61 5c2e 7079 222c 0a20 2020 2020 2020  |a\.py",.       
-000185e0: 2020 2020 2073 7464 696e 5f66 696c 656e       stdin_filen
-000185f0: 616d 653d 7374 6469 6e5f 6669 6c65 6e61  ame=stdin_filena
-00018600: 6d65 2c0a 2020 2020 2020 2020 290a 0a20  me,.        ).. 
-00018610: 2020 2040 7061 7463 6828 2263 6572 6369     @patch("cerci
-00018620: 732e 6669 6e64 5f70 726f 6a65 6374 5f72  s.find_project_r
-00018630: 6f6f 7422 2c20 6c61 6d62 6461 202a 6172  oot", lambda *ar
-00018640: 6773 3a20 2854 4849 535f 4449 522e 7265  gs: (THIS_DIR.re
-00018650: 736f 6c76 6528 292c 204e 6f6e 6529 290a  solve(), None)).
-00018660: 2020 2020 6465 6620 7465 7374 5f67 6574      def test_get
-00018670: 5f73 6f75 7263 6573 5f77 6974 685f 7374  _sources_with_st
-00018680: 6469 6e5f 6669 6c65 6e61 6d65 5f61 6e64  din_filename_and
-00018690: 5f65 7874 656e 645f 6578 636c 7564 6528  _extend_exclude(
-000186a0: 7365 6c66 2920 2d3e 204e 6f6e 653a 0a20  self) -> None:. 
-000186b0: 2020 2020 2020 2023 2045 7874 656e 6420         # Extend 
-000186c0: 6578 636c 7564 6520 7368 6f75 6c64 6e27  exclude shouldn'
-000186d0: 7420 6578 636c 7564 6520 7374 6469 6e5f  t exclude stdin_
-000186e0: 6669 6c65 6e61 6d65 2073 696e 6365 2069  filename since i
-000186f0: 7420 6973 206d 696d 6963 6b69 6e67 2074  t is mimicking t
-00018700: 6865 0a20 2020 2020 2020 2023 2066 696c  he.        # fil
-00018710: 6520 6265 696e 6720 7061 7373 6564 2064  e being passed d
-00018720: 6972 6563 746c 792e 2054 6869 7320 6973  irectly. This is
-00018730: 2074 6865 2073 616d 6520 6173 0a20 2020   the same as.   
-00018740: 2020 2020 2023 2074 6573 745f 6578 636c       # test_excl
-00018750: 7564 655f 666f 725f 6973 7375 655f 3135  ude_for_issue_15
-00018760: 3732 0a20 2020 2020 2020 2073 7263 203d  72.        src =
-00018770: 205b 222d 225d 0a20 2020 2020 2020 2070   ["-"].        p
-00018780: 6174 6820 3d20 5448 4953 5f44 4952 202f  ath = THIS_DIR /
-00018790: 2022 6461 7461 2220 2f20 2269 6e63 6c75   "data" / "inclu
-000187a0: 6465 5f65 7863 6c75 6465 5f74 6573 7473  de_exclude_tests
-000187b0: 220a 2020 2020 2020 2020 7374 6469 6e5f  ".        stdin_
-000187c0: 6669 6c65 6e61 6d65 203d 2073 7472 2870  filename = str(p
-000187d0: 6174 6820 2f20 2262 2f65 7863 6c75 6465  ath / "b/exclude
-000187e0: 2f61 2e70 7922 290a 2020 2020 2020 2020  /a.py").        
-000187f0: 6578 7065 6374 6564 203d 205b 6622 5f5f  expected = [f"__
-00018800: 424c 4143 4b5f 5354 4449 4e5f 4649 4c45  BLACK_STDIN_FILE
-00018810: 4e41 4d45 5f5f 7b73 7464 696e 5f66 696c  NAME__{stdin_fil
-00018820: 656e 616d 657d 225d 0a20 2020 2020 2020  ename}"].       
-00018830: 2061 7373 6572 745f 636f 6c6c 6563 7465   assert_collecte
-00018840: 645f 736f 7572 6365 7328 0a20 2020 2020  d_sources(.     
-00018850: 2020 2020 2020 2073 7263 2c0a 2020 2020         src,.    
-00018860: 2020 2020 2020 2020 6578 7065 6374 6564          expected
-00018870: 2c0a 2020 2020 2020 2020 2020 2020 6578  ,.            ex
-00018880: 7465 6e64 5f65 7863 6c75 6465 3d72 222f  tend_exclude=r"/
-00018890: 6578 636c 7564 652f 7c61 5c2e 7079 222c  exclude/|a\.py",
-000188a0: 0a20 2020 2020 2020 2020 2020 2073 7464  .            std
-000188b0: 696e 5f66 696c 656e 616d 653d 7374 6469  in_filename=stdi
-000188c0: 6e5f 6669 6c65 6e61 6d65 2c0a 2020 2020  n_filename,.    
-000188d0: 2020 2020 290a 0a20 2020 2040 7061 7463      )..    @patc
-000188e0: 6828 2263 6572 6369 732e 6669 6e64 5f70  h("cercis.find_p
-000188f0: 726f 6a65 6374 5f72 6f6f 7422 2c20 6c61  roject_root", la
-00018900: 6d62 6461 202a 6172 6773 3a20 2854 4849  mbda *args: (THI
-00018910: 535f 4449 522e 7265 736f 6c76 6528 292c  S_DIR.resolve(),
-00018920: 204e 6f6e 6529 290a 2020 2020 6465 6620   None)).    def 
-00018930: 7465 7374 5f67 6574 5f73 6f75 7263 6573  test_get_sources
-00018940: 5f77 6974 685f 7374 6469 6e5f 6669 6c65  _with_stdin_file
-00018950: 6e61 6d65 5f61 6e64 5f66 6f72 6365 5f65  name_and_force_e
-00018960: 7863 6c75 6465 2873 656c 6629 202d 3e20  xclude(self) -> 
-00018970: 4e6f 6e65 3a0a 2020 2020 2020 2020 2320  None:.        # 
-00018980: 466f 7263 6520 6578 636c 7564 6520 7368  Force exclude sh
-00018990: 6f75 6c64 2065 7863 6c75 6465 2074 6865  ould exclude the
-000189a0: 2066 696c 6520 7768 656e 2070 6173 7369   file when passi
-000189b0: 6e67 2069 7420 7468 726f 7567 680a 2020  ng it through.  
-000189c0: 2020 2020 2020 2320 7374 6469 6e5f 6669        # stdin_fi
-000189d0: 6c65 6e61 6d65 0a20 2020 2020 2020 2070  lename.        p
-000189e0: 6174 6820 3d20 5448 4953 5f44 4952 202f  ath = THIS_DIR /
-000189f0: 2022 6461 7461 2220 2f20 2269 6e63 6c75   "data" / "inclu
-00018a00: 6465 5f65 7863 6c75 6465 5f74 6573 7473  de_exclude_tests
-00018a10: 220a 2020 2020 2020 2020 7374 6469 6e5f  ".        stdin_
-00018a20: 6669 6c65 6e61 6d65 203d 2073 7472 2870  filename = str(p
-00018a30: 6174 6820 2f20 2262 2f65 7863 6c75 6465  ath / "b/exclude
-00018a40: 2f61 2e70 7922 290a 2020 2020 2020 2020  /a.py").        
-00018a50: 6173 7365 7274 5f63 6f6c 6c65 6374 6564  assert_collected
-00018a60: 5f73 6f75 7263 6573 280a 2020 2020 2020  _sources(.      
-00018a70: 2020 2020 2020 7372 633d 5b22 2d22 5d2c        src=["-"],
-00018a80: 0a20 2020 2020 2020 2020 2020 2065 7870  .            exp
-00018a90: 6563 7465 643d 5b5d 2c0a 2020 2020 2020  ected=[],.      
-00018aa0: 2020 2020 2020 666f 7263 655f 6578 636c        force_excl
-00018ab0: 7564 653d 7222 2f65 7863 6c75 6465 2f7c  ude=r"/exclude/|
-00018ac0: 615c 2e70 7922 2c0a 2020 2020 2020 2020  a\.py",.        
-00018ad0: 2020 2020 7374 6469 6e5f 6669 6c65 6e61      stdin_filena
-00018ae0: 6d65 3d73 7464 696e 5f66 696c 656e 616d  me=stdin_filenam
-00018af0: 652c 0a20 2020 2020 2020 2029 0a0a 0a74  e,.        )...t
-00018b00: 7279 3a0a 2020 2020 7769 7468 206f 7065  ry:.    with ope
-00018b10: 6e28 6365 7263 6973 2e5f 5f66 696c 655f  n(cercis.__file_
-00018b20: 5f2c 2022 7222 2c20 656e 636f 6469 6e67  _, "r", encoding
-00018b30: 3d22 7574 662d 3822 2920 6173 205f 6266  ="utf-8") as _bf
-00018b40: 3a0a 2020 2020 2020 2020 626c 6163 6b5f  :.        black_
-00018b50: 736f 7572 6365 5f6c 696e 6573 203d 205f  source_lines = _
-00018b60: 6266 2e72 6561 646c 696e 6573 2829 0a65  bf.readlines().e
-00018b70: 7863 6570 7420 556e 6963 6f64 6544 6563  xcept UnicodeDec
-00018b80: 6f64 6545 7272 6f72 3a0a 2020 2020 6966  odeError:.    if
-00018b90: 206e 6f74 2063 6572 6369 732e 434f 4d50   not cercis.COMP
-00018ba0: 494c 4544 3a0a 2020 2020 2020 2020 7261  ILED:.        ra
-00018bb0: 6973 650a 0a0a 6465 6620 7472 6163 6566  ise...def tracef
-00018bc0: 756e 6328 0a20 2020 2020 2020 2066 7261  unc(.        fra
-00018bd0: 6d65 3a20 7479 7065 732e 4672 616d 6554  me: types.FrameT
-00018be0: 7970 652c 2065 7665 6e74 3a20 7374 722c  ype, event: str,
-00018bf0: 2061 7267 3a20 416e 790a 2920 2d3e 2043   arg: Any.) -> C
-00018c00: 616c 6c61 626c 655b 5b74 7970 6573 2e46  allable[[types.F
-00018c10: 7261 6d65 5479 7065 2c20 7374 722c 2041  rameType, str, A
-00018c20: 6e79 5d2c 2041 6e79 5d3a 0a20 2020 2022  ny], Any]:.    "
-00018c30: 2222 5368 6f77 2066 756e 6374 696f 6e20  ""Show function 
-00018c40: 6361 6c6c 7320 6066 726f 6d20 6365 7263  calls `from cerc
-00018c50: 6973 2f5f 5f69 6e69 745f 5f2e 7079 6020  is/__init__.py` 
-00018c60: 6173 2074 6865 7920 6861 7070 656e 2e0a  as they happen..
-00018c70: 0a20 2020 2052 6567 6973 7465 7220 7468  .    Register th
-00018c80: 6973 2077 6974 6820 6073 7973 2e73 6574  is with `sys.set
-00018c90: 7472 6163 6528 2960 2069 6e20 6120 7465  trace()` in a te
-00018ca0: 7374 2079 6f75 2772 6520 6465 6275 6767  st you're debugg
-00018cb0: 696e 672e 0a20 2020 2022 2222 0a20 2020  ing..    """.   
-00018cc0: 2069 6620 6576 656e 7420 213d 2022 6361   if event != "ca
-00018cd0: 6c6c 223a 0a20 2020 2020 2020 2072 6574  ll":.        ret
-00018ce0: 7572 6e20 7472 6163 6566 756e 630a 0a20  urn tracefunc.. 
-00018cf0: 2020 2073 7461 636b 203d 206c 656e 2869     stack = len(i
-00018d00: 6e73 7065 6374 2e73 7461 636b 2829 2920  nspect.stack()) 
-00018d10: 2d20 3139 0a20 2020 2073 7461 636b 202a  - 19.    stack *
-00018d20: 3d20 320a 2020 2020 6669 6c65 6e61 6d65  = 2.    filename
-00018d30: 203d 2066 7261 6d65 2e66 5f63 6f64 652e   = frame.f_code.
-00018d40: 636f 5f66 696c 656e 616d 650a 2020 2020  co_filename.    
-00018d50: 6c69 6e65 6e6f 203d 2066 7261 6d65 2e66  lineno = frame.f
-00018d60: 5f6c 696e 656e 6f0a 2020 2020 6675 6e63  _lineno.    func
-00018d70: 5f73 6967 5f6c 696e 656e 6f20 3d20 6c69  _sig_lineno = li
-00018d80: 6e65 6e6f 202d 2031 0a20 2020 2066 756e  neno - 1.    fun
-00018d90: 636e 616d 6520 3d20 626c 6163 6b5f 736f  cname = black_so
-00018da0: 7572 6365 5f6c 696e 6573 5b66 756e 635f  urce_lines[func_
-00018db0: 7369 675f 6c69 6e65 6e6f 5d2e 7374 7269  sig_lineno].stri
-00018dc0: 7028 290a 2020 2020 7768 696c 6520 6675  p().    while fu
-00018dd0: 6e63 6e61 6d65 2e73 7461 7274 7377 6974  ncname.startswit
-00018de0: 6828 2240 2229 3a0a 2020 2020 2020 2020  h("@"):.        
-00018df0: 6675 6e63 5f73 6967 5f6c 696e 656e 6f20  func_sig_lineno 
-00018e00: 2b3d 2031 0a20 2020 2020 2020 2066 756e  += 1.        fun
-00018e10: 636e 616d 6520 3d20 626c 6163 6b5f 736f  cname = black_so
-00018e20: 7572 6365 5f6c 696e 6573 5b66 756e 635f  urce_lines[func_
-00018e30: 7369 675f 6c69 6e65 6e6f 5d2e 7374 7269  sig_lineno].stri
-00018e40: 7028 290a 2020 2020 6966 2022 6365 7263  p().    if "cerc
-00018e50: 6973 2f5f 5f69 6e69 745f 5f2e 7079 2220  is/__init__.py" 
-00018e60: 696e 2066 696c 656e 616d 653a 0a20 2020  in filename:.   
-00018e70: 2020 2020 2070 7269 6e74 2866 227b 2720       print(f"{' 
-00018e80: 2720 2a20 7374 6163 6b7d 7b6c 696e 656e  ' * stack}{linen
-00018e90: 6f7d 3a7b 6675 6e63 6e61 6d65 7d22 290a  o}:{funcname}").
-00018ea0: 2020 2020 7265 7475 726e 2074 7261 6365      return trace
-00018eb0: 6675 6e63 0a                             func.
+00017f60: 696e 636c 7564 652c 0a20 2020 2020 2020  include,.       
+00017f70: 2020 2020 2020 2020 2020 2020 2065 7863               exc
+00017f80: 6c75 6465 2c0a 2020 2020 2020 2020 2020  lude,.          
+00017f90: 2020 2020 2020 2020 2020 4e6f 6e65 2c0a            None,.
+00017fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017fb0: 2020 2020 4e6f 6e65 2c0a 2020 2020 2020      None,.      
+00017fc0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00017fd0: 706f 7274 2c0a 2020 2020 2020 2020 2020  port,.          
+00017fe0: 2020 2020 2020 2020 2020 7b70 6174 683a            {path:
+00017ff0: 2067 6974 6967 6e6f 7265 7d2c 0a20 2020   gitignore},.   
+00018000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018010: 2076 6572 626f 7365 3d46 616c 7365 2c0a   verbose=False,.
+00018020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018030: 2020 2020 7175 6965 743d 4661 6c73 652c      quiet=False,
+00018040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018050: 2029 0a20 2020 2020 2020 2020 2020 2029   ).            )
+00018060: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
+00018070: 5661 6c75 6545 7272 6f72 2061 7320 7665  ValueError as ve
+00018080: 3a0a 2020 2020 2020 2020 2020 2020 7079  :.            py
+00018090: 7465 7374 2e66 6169 6c28 6622 6067 6574  test.fail(f"`get
+000180a0: 5f70 7974 686f 6e5f 6669 6c65 735f 696e  _python_files_in
+000180b0: 5f64 6972 2829 6020 6661 696c 6564 3a20  _dir()` failed: 
+000180c0: 7b76 657d 2229 0a20 2020 2020 2020 2070  {ve}").        p
+000180d0: 6174 682e 6974 6572 6469 722e 6173 7365  ath.iterdir.asse
+000180e0: 7274 5f63 616c 6c65 645f 6f6e 6365 2829  rt_called_once()
+000180f0: 0a20 2020 2020 2020 2063 6869 6c64 2e72  .        child.r
+00018100: 6573 6f6c 7665 2e61 7373 6572 745f 6361  esolve.assert_ca
+00018110: 6c6c 6564 5f6f 6e63 6528 290a 0a20 2020  lled_once()..   
+00018120: 2040 7061 7463 6828 2263 6572 6369 732e   @patch("cercis.
+00018130: 6669 6e64 5f70 726f 6a65 6374 5f72 6f6f  find_project_roo
+00018140: 7422 2c20 6c61 6d62 6461 202a 6172 6773  t", lambda *args
+00018150: 3a20 2854 4849 535f 4449 522e 7265 736f  : (THIS_DIR.reso
+00018160: 6c76 6528 292c 204e 6f6e 6529 290a 2020  lve(), None)).  
+00018170: 2020 6465 6620 7465 7374 5f67 6574 5f73    def test_get_s
+00018180: 6f75 7263 6573 5f77 6974 685f 7374 6469  ources_with_stdi
+00018190: 6e28 7365 6c66 2920 2d3e 204e 6f6e 653a  n(self) -> None:
+000181a0: 0a20 2020 2020 2020 2073 7263 203d 205b  .        src = [
+000181b0: 222d 225d 0a20 2020 2020 2020 2065 7870  "-"].        exp
+000181c0: 6563 7465 6420 3d20 5b22 2d22 5d0a 2020  ected = ["-"].  
+000181d0: 2020 2020 2020 6173 7365 7274 5f63 6f6c        assert_col
+000181e0: 6c65 6374 6564 5f73 6f75 7263 6573 2873  lected_sources(s
+000181f0: 7263 2c20 6578 7065 6374 6564 2c20 696e  rc, expected, in
+00018200: 636c 7564 653d 2222 2c20 6578 636c 7564  clude="", exclud
+00018210: 653d 7222 2f65 7863 6c75 6465 2f7c 615c  e=r"/exclude/|a\
+00018220: 2e70 7922 290a 0a20 2020 2040 7061 7463  .py")..    @patc
+00018230: 6828 2263 6572 6369 732e 6669 6e64 5f70  h("cercis.find_p
+00018240: 726f 6a65 6374 5f72 6f6f 7422 2c20 6c61  roject_root", la
+00018250: 6d62 6461 202a 6172 6773 3a20 2854 4849  mbda *args: (THI
+00018260: 535f 4449 522e 7265 736f 6c76 6528 292c  S_DIR.resolve(),
+00018270: 204e 6f6e 6529 290a 2020 2020 6465 6620   None)).    def 
+00018280: 7465 7374 5f67 6574 5f73 6f75 7263 6573  test_get_sources
+00018290: 5f77 6974 685f 7374 6469 6e5f 6669 6c65  _with_stdin_file
+000182a0: 6e61 6d65 2873 656c 6629 202d 3e20 4e6f  name(self) -> No
+000182b0: 6e65 3a0a 2020 2020 2020 2020 7372 6320  ne:.        src 
+000182c0: 3d20 5b22 2d22 5d0a 2020 2020 2020 2020  = ["-"].        
+000182d0: 7374 6469 6e5f 6669 6c65 6e61 6d65 203d  stdin_filename =
+000182e0: 2073 7472 2854 4849 535f 4449 5220 2f20   str(THIS_DIR / 
+000182f0: 2264 6174 612f 636f 6c6c 6563 7469 6f6e  "data/collection
+00018300: 732e 7079 2229 0a20 2020 2020 2020 2065  s.py").        e
+00018310: 7870 6563 7465 6420 3d20 5b66 225f 5f42  xpected = [f"__B
+00018320: 4c41 434b 5f53 5444 494e 5f46 494c 454e  LACK_STDIN_FILEN
+00018330: 414d 455f 5f7b 7374 6469 6e5f 6669 6c65  AME__{stdin_file
+00018340: 6e61 6d65 7d22 5d0a 2020 2020 2020 2020  name}"].        
+00018350: 6173 7365 7274 5f63 6f6c 6c65 6374 6564  assert_collected
+00018360: 5f73 6f75 7263 6573 280a 2020 2020 2020  _sources(.      
+00018370: 2020 2020 2020 7372 632c 0a20 2020 2020        src,.     
+00018380: 2020 2020 2020 2065 7870 6563 7465 642c         expected,
+00018390: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
+000183a0: 6c75 6465 3d72 222f 6578 636c 7564 652f  lude=r"/exclude/
+000183b0: 615c 2e70 7922 2c0a 2020 2020 2020 2020  a\.py",.        
+000183c0: 2020 2020 7374 6469 6e5f 6669 6c65 6e61      stdin_filena
+000183d0: 6d65 3d73 7464 696e 5f66 696c 656e 616d  me=stdin_filenam
+000183e0: 652c 0a20 2020 2020 2020 2029 0a0a 2020  e,.        )..  
+000183f0: 2020 4070 6174 6368 2822 6365 7263 6973    @patch("cercis
+00018400: 2e66 696e 645f 7072 6f6a 6563 745f 726f  .find_project_ro
+00018410: 6f74 222c 206c 616d 6264 6120 2a61 7267  ot", lambda *arg
+00018420: 733a 2028 5448 4953 5f44 4952 2e72 6573  s: (THIS_DIR.res
+00018430: 6f6c 7665 2829 2c20 4e6f 6e65 2929 0a20  olve(), None)). 
+00018440: 2020 2064 6566 2074 6573 745f 6765 745f     def test_get_
+00018450: 736f 7572 6365 735f 7769 7468 5f73 7464  sources_with_std
+00018460: 696e 5f66 696c 656e 616d 655f 616e 645f  in_filename_and_
+00018470: 6578 636c 7564 6528 7365 6c66 2920 2d3e  exclude(self) ->
+00018480: 204e 6f6e 653a 0a20 2020 2020 2020 2023   None:.        #
+00018490: 2045 7863 6c75 6465 2073 686f 756c 646e   Exclude shouldn
+000184a0: 2774 2065 7863 6c75 6465 2073 7464 696e  't exclude stdin
+000184b0: 5f66 696c 656e 616d 6520 7369 6e63 6520  _filename since 
+000184c0: 6974 2069 7320 6d69 6d69 636b 696e 6720  it is mimicking 
+000184d0: 7468 650a 2020 2020 2020 2020 2320 6669  the.        # fi
+000184e0: 6c65 2062 6569 6e67 2070 6173 7365 6420  le being passed 
+000184f0: 6469 7265 6374 6c79 2e20 5468 6973 2069  directly. This i
+00018500: 7320 7468 6520 7361 6d65 2061 730a 2020  s the same as.  
+00018510: 2020 2020 2020 2320 7465 7374 5f65 7863        # test_exc
+00018520: 6c75 6465 5f66 6f72 5f69 7373 7565 5f31  lude_for_issue_1
+00018530: 3537 320a 2020 2020 2020 2020 7061 7468  572.        path
+00018540: 203d 2044 4154 415f 4449 5220 2f20 2269   = DATA_DIR / "i
+00018550: 6e63 6c75 6465 5f65 7863 6c75 6465 5f74  nclude_exclude_t
+00018560: 6573 7473 220a 2020 2020 2020 2020 7372  ests".        sr
+00018570: 6320 3d20 5b22 2d22 5d0a 2020 2020 2020  c = ["-"].      
+00018580: 2020 7374 6469 6e5f 6669 6c65 6e61 6d65    stdin_filename
+00018590: 203d 2073 7472 2870 6174 6820 2f20 2262   = str(path / "b
+000185a0: 2f65 7863 6c75 6465 2f61 2e70 7922 290a  /exclude/a.py").
+000185b0: 2020 2020 2020 2020 6578 7065 6374 6564          expected
+000185c0: 203d 205b 6622 5f5f 424c 4143 4b5f 5354   = [f"__BLACK_ST
+000185d0: 4449 4e5f 4649 4c45 4e41 4d45 5f5f 7b73  DIN_FILENAME__{s
+000185e0: 7464 696e 5f66 696c 656e 616d 657d 225d  tdin_filename}"]
+000185f0: 0a20 2020 2020 2020 2061 7373 6572 745f  .        assert_
+00018600: 636f 6c6c 6563 7465 645f 736f 7572 6365  collected_source
+00018610: 7328 0a20 2020 2020 2020 2020 2020 2073  s(.            s
+00018620: 7263 2c0a 2020 2020 2020 2020 2020 2020  rc,.            
+00018630: 6578 7065 6374 6564 2c0a 2020 2020 2020  expected,.      
+00018640: 2020 2020 2020 6578 636c 7564 653d 7222        exclude=r"
+00018650: 2f65 7863 6c75 6465 2f7c 615c 2e70 7922  /exclude/|a\.py"
+00018660: 2c0a 2020 2020 2020 2020 2020 2020 7374  ,.            st
+00018670: 6469 6e5f 6669 6c65 6e61 6d65 3d73 7464  din_filename=std
+00018680: 696e 5f66 696c 656e 616d 652c 0a20 2020  in_filename,.   
+00018690: 2020 2020 2029 0a0a 2020 2020 4070 6174       )..    @pat
+000186a0: 6368 2822 6365 7263 6973 2e66 696e 645f  ch("cercis.find_
+000186b0: 7072 6f6a 6563 745f 726f 6f74 222c 206c  project_root", l
+000186c0: 616d 6264 6120 2a61 7267 733a 2028 5448  ambda *args: (TH
+000186d0: 4953 5f44 4952 2e72 6573 6f6c 7665 2829  IS_DIR.resolve()
+000186e0: 2c20 4e6f 6e65 2929 0a20 2020 2064 6566  , None)).    def
+000186f0: 2074 6573 745f 6765 745f 736f 7572 6365   test_get_source
+00018700: 735f 7769 7468 5f73 7464 696e 5f66 696c  s_with_stdin_fil
+00018710: 656e 616d 655f 616e 645f 6578 7465 6e64  ename_and_extend
+00018720: 5f65 7863 6c75 6465 2873 656c 6629 202d  _exclude(self) -
+00018730: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00018740: 2320 4578 7465 6e64 2065 7863 6c75 6465  # Extend exclude
+00018750: 2073 686f 756c 646e 2774 2065 7863 6c75   shouldn't exclu
+00018760: 6465 2073 7464 696e 5f66 696c 656e 616d  de stdin_filenam
+00018770: 6520 7369 6e63 6520 6974 2069 7320 6d69  e since it is mi
+00018780: 6d69 636b 696e 6720 7468 650a 2020 2020  micking the.    
+00018790: 2020 2020 2320 6669 6c65 2062 6569 6e67      # file being
+000187a0: 2070 6173 7365 6420 6469 7265 6374 6c79   passed directly
+000187b0: 2e20 5468 6973 2069 7320 7468 6520 7361  . This is the sa
+000187c0: 6d65 2061 730a 2020 2020 2020 2020 2320  me as.        # 
+000187d0: 7465 7374 5f65 7863 6c75 6465 5f66 6f72  test_exclude_for
+000187e0: 5f69 7373 7565 5f31 3537 320a 2020 2020  _issue_1572.    
+000187f0: 2020 2020 7372 6320 3d20 5b22 2d22 5d0a      src = ["-"].
+00018800: 2020 2020 2020 2020 7061 7468 203d 2054          path = T
+00018810: 4849 535f 4449 5220 2f20 2264 6174 6122  HIS_DIR / "data"
+00018820: 202f 2022 696e 636c 7564 655f 6578 636c   / "include_excl
+00018830: 7564 655f 7465 7374 7322 0a20 2020 2020  ude_tests".     
+00018840: 2020 2073 7464 696e 5f66 696c 656e 616d     stdin_filenam
+00018850: 6520 3d20 7374 7228 7061 7468 202f 2022  e = str(path / "
+00018860: 622f 6578 636c 7564 652f 612e 7079 2229  b/exclude/a.py")
+00018870: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
+00018880: 6420 3d20 5b66 225f 5f42 4c41 434b 5f53  d = [f"__BLACK_S
+00018890: 5444 494e 5f46 494c 454e 414d 455f 5f7b  TDIN_FILENAME__{
+000188a0: 7374 6469 6e5f 6669 6c65 6e61 6d65 7d22  stdin_filename}"
+000188b0: 5d0a 2020 2020 2020 2020 6173 7365 7274  ].        assert
+000188c0: 5f63 6f6c 6c65 6374 6564 5f73 6f75 7263  _collected_sourc
+000188d0: 6573 280a 2020 2020 2020 2020 2020 2020  es(.            
+000188e0: 7372 632c 0a20 2020 2020 2020 2020 2020  src,.           
+000188f0: 2065 7870 6563 7465 642c 0a20 2020 2020   expected,.     
+00018900: 2020 2020 2020 2065 7874 656e 645f 6578         extend_ex
+00018910: 636c 7564 653d 7222 2f65 7863 6c75 6465  clude=r"/exclude
+00018920: 2f7c 615c 2e70 7922 2c0a 2020 2020 2020  /|a\.py",.      
+00018930: 2020 2020 2020 7374 6469 6e5f 6669 6c65        stdin_file
+00018940: 6e61 6d65 3d73 7464 696e 5f66 696c 656e  name=stdin_filen
+00018950: 616d 652c 0a20 2020 2020 2020 2029 0a0a  ame,.        )..
+00018960: 2020 2020 4070 6174 6368 2822 6365 7263      @patch("cerc
+00018970: 6973 2e66 696e 645f 7072 6f6a 6563 745f  is.find_project_
+00018980: 726f 6f74 222c 206c 616d 6264 6120 2a61  root", lambda *a
+00018990: 7267 733a 2028 5448 4953 5f44 4952 2e72  rgs: (THIS_DIR.r
+000189a0: 6573 6f6c 7665 2829 2c20 4e6f 6e65 2929  esolve(), None))
+000189b0: 0a20 2020 2064 6566 2074 6573 745f 6765  .    def test_ge
+000189c0: 745f 736f 7572 6365 735f 7769 7468 5f73  t_sources_with_s
+000189d0: 7464 696e 5f66 696c 656e 616d 655f 616e  tdin_filename_an
+000189e0: 645f 666f 7263 655f 6578 636c 7564 6528  d_force_exclude(
+000189f0: 7365 6c66 2920 2d3e 204e 6f6e 653a 0a20  self) -> None:. 
+00018a00: 2020 2020 2020 2023 2046 6f72 6365 2065         # Force e
+00018a10: 7863 6c75 6465 2073 686f 756c 6420 6578  xclude should ex
+00018a20: 636c 7564 6520 7468 6520 6669 6c65 2077  clude the file w
+00018a30: 6865 6e20 7061 7373 696e 6720 6974 2074  hen passing it t
+00018a40: 6872 6f75 6768 0a20 2020 2020 2020 2023  hrough.        #
+00018a50: 2073 7464 696e 5f66 696c 656e 616d 650a   stdin_filename.
+00018a60: 2020 2020 2020 2020 7061 7468 203d 2054          path = T
+00018a70: 4849 535f 4449 5220 2f20 2264 6174 6122  HIS_DIR / "data"
+00018a80: 202f 2022 696e 636c 7564 655f 6578 636c   / "include_excl
+00018a90: 7564 655f 7465 7374 7322 0a20 2020 2020  ude_tests".     
+00018aa0: 2020 2073 7464 696e 5f66 696c 656e 616d     stdin_filenam
+00018ab0: 6520 3d20 7374 7228 7061 7468 202f 2022  e = str(path / "
+00018ac0: 622f 6578 636c 7564 652f 612e 7079 2229  b/exclude/a.py")
+00018ad0: 0a20 2020 2020 2020 2061 7373 6572 745f  .        assert_
+00018ae0: 636f 6c6c 6563 7465 645f 736f 7572 6365  collected_source
+00018af0: 7328 0a20 2020 2020 2020 2020 2020 2073  s(.            s
+00018b00: 7263 3d5b 222d 225d 2c0a 2020 2020 2020  rc=["-"],.      
+00018b10: 2020 2020 2020 6578 7065 6374 6564 3d5b        expected=[
+00018b20: 5d2c 0a20 2020 2020 2020 2020 2020 2066  ],.            f
+00018b30: 6f72 6365 5f65 7863 6c75 6465 3d72 222f  orce_exclude=r"/
+00018b40: 6578 636c 7564 652f 7c61 5c2e 7079 222c  exclude/|a\.py",
+00018b50: 0a20 2020 2020 2020 2020 2020 2073 7464  .            std
+00018b60: 696e 5f66 696c 656e 616d 653d 7374 6469  in_filename=stdi
+00018b70: 6e5f 6669 6c65 6e61 6d65 2c0a 2020 2020  n_filename,.    
+00018b80: 2020 2020 290a 0a0a 7472 793a 0a20 2020      )...try:.   
+00018b90: 2077 6974 6820 6f70 656e 2863 6572 6369   with open(cerci
+00018ba0: 732e 5f5f 6669 6c65 5f5f 2c20 2272 222c  s.__file__, "r",
+00018bb0: 2065 6e63 6f64 696e 673d 2275 7466 2d38   encoding="utf-8
+00018bc0: 2229 2061 7320 5f62 663a 0a20 2020 2020  ") as _bf:.     
+00018bd0: 2020 2062 6c61 636b 5f73 6f75 7263 655f     black_source_
+00018be0: 6c69 6e65 7320 3d20 5f62 662e 7265 6164  lines = _bf.read
+00018bf0: 6c69 6e65 7328 290a 6578 6365 7074 2055  lines().except U
+00018c00: 6e69 636f 6465 4465 636f 6465 4572 726f  nicodeDecodeErro
+00018c10: 723a 0a20 2020 2069 6620 6e6f 7420 6365  r:.    if not ce
+00018c20: 7263 6973 2e43 4f4d 5049 4c45 443a 0a20  rcis.COMPILED:. 
+00018c30: 2020 2020 2020 2072 6169 7365 0a0a 0a64         raise...d
+00018c40: 6566 2074 7261 6365 6675 6e63 280a 2020  ef tracefunc(.  
+00018c50: 2020 2020 2020 6672 616d 653a 2074 7970        frame: typ
+00018c60: 6573 2e46 7261 6d65 5479 7065 2c20 6576  es.FrameType, ev
+00018c70: 656e 743a 2073 7472 2c20 6172 673a 2041  ent: str, arg: A
+00018c80: 6e79 0a29 202d 3e20 4361 6c6c 6162 6c65  ny.) -> Callable
+00018c90: 5b5b 7479 7065 732e 4672 616d 6554 7970  [[types.FrameTyp
+00018ca0: 652c 2073 7472 2c20 416e 795d 2c20 416e  e, str, Any], An
+00018cb0: 795d 3a0a 2020 2020 2222 2253 686f 7720  y]:.    """Show 
+00018cc0: 6675 6e63 7469 6f6e 2063 616c 6c73 2060  function calls `
+00018cd0: 6672 6f6d 2063 6572 6369 732f 5f5f 696e  from cercis/__in
+00018ce0: 6974 5f5f 2e70 7960 2061 7320 7468 6579  it__.py` as they
+00018cf0: 2068 6170 7065 6e2e 0a0a 2020 2020 5265   happen...    Re
+00018d00: 6769 7374 6572 2074 6869 7320 7769 7468  gister this with
+00018d10: 2060 7379 732e 7365 7474 7261 6365 2829   `sys.settrace()
+00018d20: 6020 696e 2061 2074 6573 7420 796f 7527  ` in a test you'
+00018d30: 7265 2064 6562 7567 6769 6e67 2e0a 2020  re debugging..  
+00018d40: 2020 2222 220a 2020 2020 6966 2065 7665    """.    if eve
+00018d50: 6e74 2021 3d20 2263 616c 6c22 3a0a 2020  nt != "call":.  
+00018d60: 2020 2020 2020 7265 7475 726e 2074 7261        return tra
+00018d70: 6365 6675 6e63 0a0a 2020 2020 7374 6163  cefunc..    stac
+00018d80: 6b20 3d20 6c65 6e28 696e 7370 6563 742e  k = len(inspect.
+00018d90: 7374 6163 6b28 2929 202d 2031 390a 2020  stack()) - 19.  
+00018da0: 2020 7374 6163 6b20 2a3d 2032 0a20 2020    stack *= 2.   
+00018db0: 2066 696c 656e 616d 6520 3d20 6672 616d   filename = fram
+00018dc0: 652e 665f 636f 6465 2e63 6f5f 6669 6c65  e.f_code.co_file
+00018dd0: 6e61 6d65 0a20 2020 206c 696e 656e 6f20  name.    lineno 
+00018de0: 3d20 6672 616d 652e 665f 6c69 6e65 6e6f  = frame.f_lineno
+00018df0: 0a20 2020 2066 756e 635f 7369 675f 6c69  .    func_sig_li
+00018e00: 6e65 6e6f 203d 206c 696e 656e 6f20 2d20  neno = lineno - 
+00018e10: 310a 2020 2020 6675 6e63 6e61 6d65 203d  1.    funcname =
+00018e20: 2062 6c61 636b 5f73 6f75 7263 655f 6c69   black_source_li
+00018e30: 6e65 735b 6675 6e63 5f73 6967 5f6c 696e  nes[func_sig_lin
+00018e40: 656e 6f5d 2e73 7472 6970 2829 0a20 2020  eno].strip().   
+00018e50: 2077 6869 6c65 2066 756e 636e 616d 652e   while funcname.
+00018e60: 7374 6172 7473 7769 7468 2822 4022 293a  startswith("@"):
+00018e70: 0a20 2020 2020 2020 2066 756e 635f 7369  .        func_si
+00018e80: 675f 6c69 6e65 6e6f 202b 3d20 310a 2020  g_lineno += 1.  
+00018e90: 2020 2020 2020 6675 6e63 6e61 6d65 203d        funcname =
+00018ea0: 2062 6c61 636b 5f73 6f75 7263 655f 6c69   black_source_li
+00018eb0: 6e65 735b 6675 6e63 5f73 6967 5f6c 696e  nes[func_sig_lin
+00018ec0: 656e 6f5d 2e73 7472 6970 2829 0a20 2020  eno].strip().   
+00018ed0: 2069 6620 2263 6572 6369 732f 5f5f 696e   if "cercis/__in
+00018ee0: 6974 5f5f 2e70 7922 2069 6e20 6669 6c65  it__.py" in file
+00018ef0: 6e61 6d65 3a0a 2020 2020 2020 2020 7072  name:.        pr
+00018f00: 696e 7428 6622 7b27 2027 202a 2073 7461  int(f"{' ' * sta
+00018f10: 636b 7d7b 6c69 6e65 6e6f 7d3a 7b66 756e  ck}{lineno}:{fun
+00018f20: 636e 616d 657d 2229 0a20 2020 2072 6574  cname}").    ret
+00018f30: 7572 6e20 7472 6163 6566 756e 630a       urn tracefunc.
```

### Comparing `cercis-0.1.7/tests/test_blackd.py` & `cercis-0.2.0/tests/test_blackd.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/test_format.py` & `cercis-0.2.0/tests/test_format.py`

 * *Files 1% similar despite different names*

```diff
@@ -49,14 +49,15 @@
         wrap_line_with_long_string=True,
         collapse_nested_brackets=False,
         single_quote=single_quote,
         wrap_comments=True,
         wrap_pragma_comments=True,
         keep_blank_lines_in_brackets=False,
         line_length=88,
+        is_pyi=filename.endswith("_pyi"),
     )
     check_file("simple_cases", filename, mode)
 
 
 @pytest.mark.parametrize("filename", all_data_cases("preview"))
 def test_preview_format(filename: str) -> None:
     mode = cercis.Mode(
@@ -494,7 +495,16 @@
         keep_blank_lines_in_brackets=kblib,
     )
     check_file(
         "configurable_cases/keep_blank_lines_in_brackets",
         filename,
         mode,
     )
+
+
+def test_playground() -> None:
+    mode = replace(
+        DEFAULT_MODE,
+        line_length=79,
+    )
+    filename = "playground/playground.py"
+    check_file("configurable_cases", filename=filename, mode=mode)
```

### Comparing `cercis-0.1.7/tests/test_ipynb.py` & `cercis-0.2.0/tests/test_ipynb.py`

 * *Files 1% similar despite different names*

```diff
@@ -73,15 +73,15 @@
 
 
 @pytest.mark.parametrize(
     "mode",
     [
         pytest.param(JUPYTER_MODE, id="default mode"),
         pytest.param(
-            replace(JUPYTER_MODE, python_cell_magics={"cust1", "cust1"}),
+            replace(JUPYTER_MODE, python_cell_magics={"cust1", "cust2"}),
             id="custom cell magics mode",
         ),
     ],
 )
 def test_cell_magic(mode: Mode) -> None:
     src = "%%time\nfoo =bar"
     result = format_cell(src, fast=True, mode=mode)
@@ -96,15 +96,15 @@
 
 
 @pytest.mark.parametrize(
     "mode",
     [
         pytest.param(JUPYTER_MODE, id="default mode"),
         pytest.param(
-            replace(JUPYTER_MODE, python_cell_magics={"cust1", "cust1"}),
+            replace(JUPYTER_MODE, python_cell_magics={"cust1", "cust2"}),
             id="custom cell magics mode",
         ),
     ],
 )
 @pytest.mark.parametrize(
     "src, expected",
     (
@@ -179,15 +179,15 @@
         pytest.param(
             JUPYTER_MODE,
             "%%custom_python_magic -n1 -n2\nx=2",
             pytest.raises(NothingChanged),
             id="No change when cell magic not registered",
         ),
         pytest.param(
-            replace(JUPYTER_MODE, python_cell_magics={"cust1", "cust1"}),
+            replace(JUPYTER_MODE, python_cell_magics={"cust1", "cust2"}),
             "%%custom_python_magic -n1 -n2\nx=2",
             pytest.raises(NothingChanged),
             id="No change when other cell magics registered",
         ),
         pytest.param(
             replace(JUPYTER_MODE, python_cell_magics={"custom_python_magic", "cust1"}),
             "%%custom_python_magic -n1 -n2\nx = 2",
@@ -441,16 +441,15 @@
 def test_cache_isnt_written_if_no_jupyter_deps_single(
         monkeypatch: MonkeyPatch, tmp_path: pathlib.Path
 ) -> None:
     # Check that the cache isn't written to if Jupyter dependencies aren't installed.
     jupyter_dependencies_are_installed.cache_clear()
     nb = get_case_path("jupyter", "notebook_trailing_newline.ipynb")
     tmp_nb = tmp_path / "notebook.ipynb"
-    with open(nb) as src, open(tmp_nb, "w") as dst:
-        dst.write(src.read())
+    tmp_nb.write_bytes(nb.read_bytes())
     monkeypatch.setattr(
         "cercis.jupyter_dependencies_are_installed", lambda verbose, quiet: False
     )
     result = runner.invoke(
         main, [str(tmp_path / "notebook.ipynb"), f"--config={EMPTY_CONFIG}"]
     )
     assert "No Python files are present to be formatted. Nothing to do" in result.output
@@ -467,16 +466,15 @@
 def test_cache_isnt_written_if_no_jupyter_deps_dir(
         monkeypatch: MonkeyPatch, tmp_path: pathlib.Path
 ) -> None:
     # Check that the cache isn't written to if Jupyter dependencies aren't installed.
     jupyter_dependencies_are_installed.cache_clear()
     nb = get_case_path("jupyter", "notebook_trailing_newline.ipynb")
     tmp_nb = tmp_path / "notebook.ipynb"
-    with open(nb) as src, open(tmp_nb, "w") as dst:
-        dst.write(src.read())
+    tmp_nb.write_bytes(nb.read_bytes())
     monkeypatch.setattr(
         "cercis.files.jupyter_dependencies_are_installed", lambda verbose, quiet: False
     )
     result = runner.invoke(main, [str(tmp_path), f"--config={EMPTY_CONFIG}"])
     assert "No Python files are present to be formatted. Nothing to do" in result.output
     jupyter_dependencies_are_installed.cache_clear()
     monkeypatch.setattr(
@@ -485,16 +483,15 @@
     result = runner.invoke(main, [str(tmp_path), f"--config={EMPTY_CONFIG}"])
     assert "reformatted" in result.output
 
 
 def test_ipynb_flag(tmp_path: pathlib.Path) -> None:
     nb = get_case_path("jupyter", "notebook_trailing_newline.ipynb")
     tmp_nb = tmp_path / "notebook.a_file_extension_which_is_definitely_not_ipynb"
-    with open(nb) as src, open(tmp_nb, "w") as dst:
-        dst.write(src.read())
+    tmp_nb.write_bytes(nb.read_bytes())
     result = runner.invoke(
         main,
         [
             str(tmp_nb),
             "--diff",
             "--ipynb",
             f"--config={EMPTY_CONFIG}",
```

### Comparing `cercis-0.1.7/tests/test_no_ipynb.py` & `cercis-0.2.0/tests/test_no_ipynb.py`

 * *Files 15% similar despite different names*

```diff
@@ -23,15 +23,14 @@
 
 
 def test_ipynb_diff_with_no_change_dir(tmp_path: pathlib.Path) -> None:
     jupyter_dependencies_are_installed.cache_clear()
     runner = CliRunner()
     nb = get_case_path("jupyter", "notebook_trailing_newline.ipynb")
     tmp_nb = tmp_path / "notebook.ipynb"
-    with open(nb) as src, open(tmp_nb, "w") as dst:
-        dst.write(src.read())
+    tmp_nb.write_bytes(nb.read_bytes())
     result = runner.invoke(main, [str(tmp_path)])
     expected_output = (
         "Skipping .ipynb files as Jupyter dependencies are not installed.\n"
         'You can fix this by running ``pip install "cercis[jupyter]"``\n'
     )
     assert expected_output in result.output
```

### Comparing `cercis-0.1.7/tests/test_trans.py` & `cercis-0.2.0/tests/test_trans.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/test_utils_line_wrapping.py` & `cercis-0.2.0/tests/test_utils_line_wrapping.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/util.py` & `cercis-0.2.0/tests/util.py`

 * *Files 2% similar despite different names*

```diff
@@ -26,15 +26,16 @@
     TargetVersion.PY36,
     TargetVersion.PY37,
     TargetVersion.PY38,
     TargetVersion.PY39,
 }
 
 DEFAULT_MODE = cercis.Mode()
-ff = partial(cercis.format_file_in_place, mode=DEFAULT_MODE, fast=True)
+DEFAULT_MODE_88 = replace(DEFAULT_MODE, line_length=88)
+ff = partial(cercis.format_file_in_place, mode=DEFAULT_MODE_88, fast=True)
 fs = partial(cercis.format_str, mode=DEFAULT_MODE)
 
 
 def _assert_format_equal(expected: str, actual: str) -> None:
     if actual != expected and not os.environ.get("SKIP_AST_PRINT"):
         bdv: DebugVisitor[Any]
         out("Expected tree:", fg="green")
```

### Comparing `cercis-0.1.7/tests/data/conditional_expression.py` & `cercis-0.2.0/tests/data/conditional_expression.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/closing_bracket_indent/extra_indent.py` & `cercis-0.2.0/tests/data/configurable_cases/closing_bracket_indent/extra_indent.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/closing_bracket_indent/no_extra_indent.py` & `cercis-0.2.0/tests/data/configurable_cases/closing_bracket_indent/no_extra_indent.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/func_def_indent/func_def_extra_indent.py` & `cercis-0.2.0/tests/data/configurable_cases/func_def_indent/func_def_extra_indent.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/func_def_indent/func_def_no_extra_indent.py` & `cercis-0.2.0/tests/data/configurable_cases/func_def_indent/func_def_no_extra_indent.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=1/fdei=False_olcei=False.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=1/fdei=False_olcei=False.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=1/fdei=False_olcei=True.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=1/fdei=False_olcei=True.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=1/fdei=True_olcei=False.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=1/fdei=True_olcei=False.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=1/fdei=True_olcei=True.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=1/fdei=True_olcei=True.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=2/fdei=False_olcei=False.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=2/fdei=False_olcei=False.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=2/fdei=False_olcei=True.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=2/fdei=False_olcei=True.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=2/fdei=True_olcei=False.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=2/fdei=True_olcei=False.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=2/fdei=True_olcei=True.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=2/fdei=True_olcei=True.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=3/fdei=False_olcei=False.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=3/fdei=False_olcei=False.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=3/fdei=False_olcei=True.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=3/fdei=False_olcei=True.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=3/fdei=True_olcei=False.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=3/fdei=True_olcei=False.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=3/fdei=True_olcei=True.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=3/fdei=True_olcei=True.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=4/fdei=False_olcei=False.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=4/fdei=False_olcei=False.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=4/fdei=False_olcei=True.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=4/fdei=False_olcei=True.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=4/fdei=True_olcei=False.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=4/fdei=True_olcei=False.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=4/fdei=True_olcei=True.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=4/fdei=True_olcei=True.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=8/fdei=False_olcei=False.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=8/fdei=False_olcei=False.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=8/fdei=False_olcei=True.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=8/fdei=False_olcei=True.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=8/fdei=True_olcei=False.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=8/fdei=True_olcei=False.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=8/fdei=True_olcei=True.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_extra_indent/base_indent_spaces=8/fdei=True_olcei=True.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=1/fdei=False_olcei=False.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=1/fdei=False_olcei=False.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=1/fdei=False_olcei=True.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=1/fdei=False_olcei=True.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=1/fdei=True_olcei=False.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=1/fdei=True_olcei=False.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=1/fdei=True_olcei=True.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=1/fdei=True_olcei=True.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=2/fdei=False_olcei=False.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=2/fdei=False_olcei=False.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=2/fdei=False_olcei=True.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=2/fdei=False_olcei=True.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=2/fdei=True_olcei=False.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=2/fdei=True_olcei=False.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=2/fdei=True_olcei=True.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=2/fdei=True_olcei=True.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=3/fdei=False_olcei=False.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=3/fdei=False_olcei=False.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=3/fdei=False_olcei=True.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=3/fdei=False_olcei=True.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=3/fdei=True_olcei=False.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=3/fdei=True_olcei=False.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=3/fdei=True_olcei=True.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=3/fdei=True_olcei=True.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=4/fdei=False_olcei=False.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=4/fdei=False_olcei=False.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=4/fdei=False_olcei=True.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=4/fdei=False_olcei=True.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=4/fdei=True_olcei=False.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=4/fdei=True_olcei=False.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=4/fdei=True_olcei=True.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=4/fdei=True_olcei=True.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=8/fdei=False_olcei=False.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=8/fdei=False_olcei=False.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=8/fdei=False_olcei=True.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=8/fdei=False_olcei=True.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=8/fdei=True_olcei=False.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=8/fdei=True_olcei=False.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=8/fdei=True_olcei=True.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_spaces/closing_bracket_no_extra_indent/base_indent_spaces=8/fdei=True_olcei=True.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_extra_indent/fdei=False_olcei=False.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_extra_indent/fdei=False_olcei=False.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_extra_indent/fdei=False_olcei=True.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_extra_indent/fdei=False_olcei=True.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_extra_indent/fdei=True_olcei=False.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_extra_indent/fdei=True_olcei=False.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_extra_indent/fdei=True_olcei=True.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_extra_indent/fdei=True_olcei=True.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_no_extra_indent/fdei=False_olcei=False.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_no_extra_indent/fdei=False_olcei=False.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_no_extra_indent/fdei=False_olcei=True.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_no_extra_indent/fdei=False_olcei=True.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_no_extra_indent/fdei=True_olcei=False.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_no_extra_indent/fdei=True_olcei=False.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_no_extra_indent/fdei=True_olcei=True.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_tabs/closing_bracket_no_extra_indent/fdei=True_olcei=True.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_tabs/line_length_calculation/tab_width_1.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_tabs/line_length_calculation/tab_width_1.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_tabs/line_length_calculation/tab_width_2.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_tabs/line_length_calculation/tab_width_2.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_tabs/line_length_calculation/tab_width_3.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_tabs/line_length_calculation/tab_width_3.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_tabs/line_length_calculation/tab_width_4.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_tabs/line_length_calculation/tab_width_4.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_tabs/line_length_calculation/tab_width_5.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_tabs/line_length_calculation/tab_width_5.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/indentation/use_tabs/line_length_calculation/tab_width_8.py` & `cercis-0.2.0/tests/data/configurable_cases/indentation/use_tabs/line_length_calculation/tab_width_8.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/keep_blank_lines_in_brackets/false.py` & `cercis-0.2.0/tests/data/configurable_cases/keep_blank_lines_in_brackets/false.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/keep_blank_lines_in_brackets/true.py` & `cercis-0.2.0/tests/data/configurable_cases/keep_blank_lines_in_brackets/true.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/line_with_long_string/edge_cases.py` & `cercis-0.2.0/tests/data/configurable_cases/line_with_long_string/edge_cases.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/line_with_long_string/long_strings_flag_disabled__Black_default.py` & `cercis-0.2.0/tests/data/configurable_cases/line_with_long_string/long_strings_flag_disabled__Black_default.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/line_with_long_string/long_strings_flag_disabled__Cercis_default.py` & `cercis-0.2.0/tests/data/configurable_cases/line_with_long_string/long_strings_flag_disabled__Cercis_default.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/line_with_long_string/test_cases__Black_default.py` & `cercis-0.2.0/tests/data/configurable_cases/line_with_long_string/test_cases__Black_default.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/line_with_long_string/test_cases__Cercis_default.py` & `cercis-0.2.0/tests/data/configurable_cases/line_with_long_string/test_cases__Cercis_default.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/nested_brackets/nested_brackets__Black_default.py` & `cercis-0.2.0/tests/data/configurable_cases/nested_brackets/nested_brackets__Black_default.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/nested_brackets/nested_brackets__Cercis_default.py` & `cercis-0.2.0/tests/data/configurable_cases/nested_brackets/nested_brackets__Cercis_default.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/nested_brackets/nested_brackets_explodes__Black_default.py` & `cercis-0.2.0/tests/data/configurable_cases/nested_brackets/nested_brackets_explodes__Black_default.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/nested_brackets/nested_brackets_explodes__Cercis_default.py` & `cercis-0.2.0/tests/data/configurable_cases/nested_brackets/nested_brackets_explodes__Cercis_default.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/pragma_comments/Black_default.py` & `cercis-0.2.0/tests/data/configurable_cases/pragma_comments/Black_default.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/pragma_comments/Black_default_2.py` & `cercis-0.2.0/tests/data/configurable_cases/pragma_comments/Black_default_2.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/pragma_comments/Cercis_default.py` & `cercis-0.2.0/tests/data/configurable_cases/pragma_comments/Cercis_default.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/pragma_comments/Cercis_default_2.py` & `cercis-0.2.0/tests/data/configurable_cases/pragma_comments/Cercis_default_2.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/single_quote/docstring.py` & `cercis-0.2.0/tests/data/configurable_cases/single_quote/docstring.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/single_quote/docstring_preview.py` & `cercis-0.2.0/tests/data/configurable_cases/single_quote/docstring_preview.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/single_quote/more_quotes.py` & `cercis-0.2.0/tests/data/configurable_cases/single_quote/more_quotes.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/single_quote/string_prefixes.py` & `cercis-0.2.0/tests/data/configurable_cases/single_quote/string_prefixes.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/configurable_cases/single_quote/torture.py` & `cercis-0.2.0/tests/data/configurable_cases/single_quote/torture.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/jupyter/notebook_no_trailing_newline.ipynb` & `cercis-0.2.0/tests/data/jupyter/notebook_no_trailing_newline.ipynb`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/jupyter/notebook_trailing_newline.ipynb` & `cercis-0.2.0/tests/data/jupyter/notebook_trailing_newline.ipynb`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/jupyter/notebook_without_changes.ipynb` & `cercis-0.2.0/tests/data/jupyter/notebook_without_changes.ipynb`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/miscellaneous/debug_visitor.out` & `cercis-0.2.0/tests/data/miscellaneous/debug_visitor.out`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/miscellaneous/debug_visitor.py` & `cercis-0.2.0/tests/data/miscellaneous/debug_visitor.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/miscellaneous/decorators.py` & `cercis-0.2.0/tests/data/miscellaneous/decorators.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/miscellaneous/docstring_no_string_normalization.py` & `cercis-0.2.0/tests/data/miscellaneous/docstring_no_string_normalization.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/miscellaneous/expression_skip_magic_trailing_comma.diff` & `cercis-0.2.0/tests/data/miscellaneous/expression_skip_magic_trailing_comma.diff`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/miscellaneous/force_py36.py` & `cercis-0.2.0/tests/data/miscellaneous/force_py36.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/miscellaneous/force_pyi.py` & `cercis-0.2.0/tests/data/miscellaneous/force_pyi.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/miscellaneous/long_strings_flag_disabled.py` & `cercis-0.2.0/tests/data/miscellaneous/long_strings_flag_disabled.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/miscellaneous/python2_detection.py` & `cercis-0.2.0/tests/data/miscellaneous/python2_detection.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/miscellaneous/string_quotes.py` & `cercis-0.2.0/tests/data/miscellaneous/string_quotes.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/miscellaneous/stub.pyi` & `cercis-0.2.0/tests/data/miscellaneous/stub.pyi`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/preview/cantfit.py` & `cercis-0.2.0/tests/data/preview/cantfit.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/preview/comments7.py` & `cercis-0.2.0/tests/data/preview/comments7.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/preview/format_unicode_escape_seq.py` & `cercis-0.2.0/tests/data/preview/format_unicode_escape_seq.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/preview/long_dict_values.py` & `cercis-0.2.0/tests/data/preview/long_dict_values.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/preview/long_strings.py` & `cercis-0.2.0/tests/data/preview/long_strings.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/preview/long_strings__east_asian_width.py` & `cercis-0.2.0/tests/data/preview/long_strings__east_asian_width.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/preview/long_strings__edge_case.py` & `cercis-0.2.0/tests/data/preview/long_strings__edge_case.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/preview/long_strings__regression.py` & `cercis-0.2.0/tests/data/preview/long_strings__regression.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/preview/long_strings__type_annotations.py` & `cercis-0.2.0/tests/data/preview/long_strings__type_annotations.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/preview/multiline_strings.py` & `cercis-0.2.0/tests/data/preview/multiline_strings.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/preview/no_blank_line_before_docstring.py` & `cercis-0.2.0/tests/data/preview/no_blank_line_before_docstring.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/preview/prefer_rhs_split.py` & `cercis-0.2.0/tests/data/preview/prefer_rhs_split.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/preview/trailing_comma.py` & `cercis-0.2.0/tests/data/preview/trailing_comma.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/preview_context_managers/targeting_py38.py` & `cercis-0.2.0/tests/data/preview_context_managers/targeting_py38.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/preview_context_managers/targeting_py39.py` & `cercis-0.2.0/tests/data/preview_context_managers/targeting_py39.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/preview_context_managers/auto_detect/features_3_10.py` & `cercis-0.2.0/tests/data/preview_context_managers/auto_detect/features_3_10.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/preview_context_managers/auto_detect/features_3_11.py` & `cercis-0.2.0/tests/data/preview_context_managers/auto_detect/features_3_11.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/preview_context_managers/auto_detect/features_3_8.py` & `cercis-0.2.0/tests/data/preview_context_managers/auto_detect/features_3_8.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/preview_context_managers/auto_detect/features_3_9.py` & `cercis-0.2.0/tests/data/preview_context_managers/auto_detect/features_3_9.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/py_310/parenthesized_context_managers.py` & `cercis-0.2.0/tests/data/py_310/parenthesized_context_managers.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/py_310/pattern_matching_complex.py` & `cercis-0.2.0/tests/data/py_310/pattern_matching_complex.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/py_310/pattern_matching_extras.py` & `cercis-0.2.0/tests/data/py_310/pattern_matching_extras.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/py_310/pattern_matching_generic.py` & `cercis-0.2.0/tests/data/py_310/pattern_matching_generic.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/py_310/pattern_matching_simple.py` & `cercis-0.2.0/tests/data/py_310/pattern_matching_simple.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/py_310/pattern_matching_style.py` & `cercis-0.2.0/tests/data/py_310/pattern_matching_style.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/py_311/pep_646.py` & `cercis-0.2.0/tests/data/py_311/pep_646.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/py_311/pep_654.py` & `cercis-0.2.0/tests/data/py_311/pep_654.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/py_311/pep_654_style.py` & `cercis-0.2.0/tests/data/py_311/pep_654_style.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/py_312/type_params.py` & `cercis-0.2.0/tests/data/py_312/type_params.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/py_36/numeric_literals.py` & `cercis-0.2.0/tests/data/py_36/numeric_literals.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/py_37/python37.py` & `cercis-0.2.0/tests/data/py_37/python37.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/py_38/pep_570.py` & `cercis-0.2.0/tests/data/py_38/pep_570.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/py_38/pep_572.py` & `cercis-0.2.0/tests/data/py_38/pep_572.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/py_38/pep_572_remove_parens.py` & `cercis-0.2.0/tests/data/py_38/pep_572_remove_parens.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/py_38/python38.py` & `cercis-0.2.0/tests/data/py_38/python38.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/py_39/python39.py` & `cercis-0.2.0/tests/data/py_39/python39.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/py_39/remove_with_brackets.py` & `cercis-0.2.0/tests/data/py_39/remove_with_brackets.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/attribute_access_on_number_literals.py` & `cercis-0.2.0/tests/data/simple_cases/attribute_access_on_number_literals.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/class_blank_parentheses.py` & `cercis-0.2.0/tests/data/simple_cases/class_blank_parentheses.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/class_methods_new_line.py` & `cercis-0.2.0/tests/data/simple_cases/class_methods_new_line.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/collections.py` & `cercis-0.2.0/tests/data/simple_cases/collections.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/comments.py` & `cercis-0.2.0/tests/data/simple_cases/comments.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/comments2.py` & `cercis-0.2.0/tests/data/simple_cases/comments2.py`

 * *Files 8% similar despite different names*

```diff
@@ -150,14 +150,17 @@
 
 class Test:
     def _init_host(self, parsed) -> None:
         if (parsed.hostname is None or  # type: ignore
                 not parsed.hostname.strip()):
             pass
 
+
+a = "type comment with trailing space"  # type: str   
+
 #######################
 ### SECTION COMMENT ###
 #######################
 
 
 instruction()#comment with bad spacing
 
@@ -328,14 +331,16 @@
 
 class Test:
     def _init_host(self, parsed) -> None:
         if parsed.hostname is None or not parsed.hostname.strip():  # type: ignore
             pass
 
 
+a = "type comment with trailing space"  # type: str
+
 #######################
 ### SECTION COMMENT ###
 #######################
 
 
 instruction()  # comment with bad spacing
```

### Comparing `cercis-0.1.7/tests/data/simple_cases/comments3.py` & `cercis-0.2.0/tests/data/simple_cases/comments3.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/comments4.py` & `cercis-0.2.0/tests/data/simple_cases/comments4.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/comments5.py` & `cercis-0.2.0/tests/data/simple_cases/comments5.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/comments6.py` & `cercis-0.2.0/tests/data/simple_cases/comments6.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/comments9.py` & `cercis-0.2.0/tests/data/simple_cases/comments9.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/comments_non_breaking_space.py` & `cercis-0.2.0/tests/data/simple_cases/comments_non_breaking_space.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/composition.py` & `cercis-0.2.0/tests/data/simple_cases/composition.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/composition_no_trailing_comma.py` & `cercis-0.2.0/tests/data/simple_cases/composition_no_trailing_comma.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/docstring.py` & `cercis-0.2.0/tests/data/simple_cases/docstring.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/docstring_preview.py` & `cercis-0.2.0/tests/data/simple_cases/docstring_preview.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/empty_lines.py` & `cercis-0.2.0/tests/data/simple_cases/empty_lines.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/expression.diff` & `cercis-0.2.0/tests/data/simple_cases/expression.diff`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/expression.py` & `cercis-0.2.0/tests/data/simple_cases/expression.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/fmtonoff.py` & `cercis-0.2.0/tests/data/simple_cases/fmtonoff.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/fmtonoff2.py` & `cercis-0.2.0/tests/data/simple_cases/fmtonoff2.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/fmtonoff5.py` & `cercis-0.2.0/tests/data/simple_cases/fmtonoff5.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/fmtskip2.py` & `cercis-0.2.0/tests/data/simple_cases/fmtskip2.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/fmtskip8.py` & `cercis-0.2.0/tests/data/simple_cases/fmtskip8.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/fstring.py` & `cercis-0.2.0/tests/data/simple_cases/fstring.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/function.py` & `cercis-0.2.0/tests/data/simple_cases/function.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/function2.py` & `cercis-0.2.0/tests/data/simple_cases/function2.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/function_trailing_comma.py` & `cercis-0.2.0/tests/data/simple_cases/function_trailing_comma.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/import_spacing.py` & `cercis-0.2.0/tests/data/simple_cases/import_spacing.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/one_element_subscript.py` & `cercis-0.2.0/tests/data/simple_cases/one_element_subscript.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/pep_604.py` & `cercis-0.2.0/tests/data/simple_cases/pep_604.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/power_op_spacing.py` & `cercis-0.2.0/tests/data/simple_cases/power_op_spacing.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/prefer_rhs_split_reformatted.py` & `cercis-0.2.0/tests/data/simple_cases/prefer_rhs_split_reformatted.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/remove_await_parens.py` & `cercis-0.2.0/tests/data/simple_cases/remove_await_parens.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/remove_except_parens.py` & `cercis-0.2.0/tests/data/simple_cases/remove_except_parens.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/remove_for_brackets.py` & `cercis-0.2.0/tests/data/simple_cases/remove_for_brackets.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/remove_newline_after_code_block_open.py` & `cercis-0.2.0/tests/data/simple_cases/remove_newline_after_code_block_open.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/remove_parens.py` & `cercis-0.2.0/tests/data/simple_cases/remove_parens.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/return_annotation_brackets.py` & `cercis-0.2.0/tests/data/simple_cases/return_annotation_brackets.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/skip_magic_trailing_comma.py` & `cercis-0.2.0/tests/data/simple_cases/skip_magic_trailing_comma.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/slices.py` & `cercis-0.2.0/tests/data/simple_cases/slices.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/string_prefixes.py` & `cercis-0.2.0/tests/data/simple_cases/string_prefixes.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/torture.py` & `cercis-0.2.0/tests/data/simple_cases/torture.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/trailing_comma_optional_parens1.py` & `cercis-0.2.0/tests/data/simple_cases/trailing_comma_optional_parens1.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/trailing_comma_optional_parens3.py` & `cercis-0.2.0/tests/data/simple_cases/trailing_comma_optional_parens3.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/tests/data/simple_cases/trailing_commas_in_leading_parts.py` & `cercis-0.2.0/tests/data/simple_cases/trailing_commas_in_leading_parts.py`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/LICENSE` & `cercis-0.2.0/LICENSE`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/LICENSE_ORIGINAL` & `cercis-0.2.0/LICENSE_ORIGINAL`

 * *Files identical despite different names*

### Comparing `cercis-0.1.7/pyproject.toml` & `cercis-0.2.0/pyproject.toml`

 * *Files 2% similar despite different names*

```diff
@@ -31,18 +31,18 @@
 
 [build-system]
 requires = ["hatchling>=1.8.0", "hatch-vcs", "hatch-fancy-pypi-readme"]
 build-backend = "hatchling.build"
 
 [project]
 name = "cercis"
-version = "0.1.7"
+version = "0.2.0"
 description = "A more configurable Python code formatter"
 license = { text = "MIT" }
-requires-python = ">=3.7"
+requires-python = ">=3.8"
 authors = [
   { name = "ukasz Langa", email = "lukasz@langa.pl" },
   { name = "jsh9", email = "" },
 ]
 keywords = [
   "automation",
   "autopep8",
@@ -56,30 +56,28 @@
   "Development Status :: 5 - Production/Stable",
   "Environment :: Console",
   "Intended Audience :: Developers",
   "License :: OSI Approved :: MIT License",
   "Operating System :: OS Independent",
   "Programming Language :: Python",
   "Programming Language :: Python :: 3 :: Only",
-  "Programming Language :: Python :: 3.7",
   "Programming Language :: Python :: 3.8",
   "Programming Language :: Python :: 3.9",
   "Programming Language :: Python :: 3.10",
   "Programming Language :: Python :: 3.11",
   "Topic :: Software Development :: Libraries :: Python Modules",
   "Topic :: Software Development :: Quality Assurance",
 ]
 dependencies = [
   "click>=8.0.0",
   "mypy_extensions>=0.4.3",
   "packaging>=22.0",
   "pathspec>=0.9.0",
   "platformdirs>=2",
   "tomli>=1.1.0; python_version < '3.11'",
-  "typed-ast>=1.4.2; python_version < '3.8' and implementation_name == 'cpython'",
   "typing_extensions>=3.10.0.0; python_version < '3.10'",
 ]
 dynamic = ["readme"]
 
 [project.optional-dependencies]
 colorama = ["colorama>=0.4.3"]
 uvloop = ["uvloop>=0.15.2"]
@@ -121,18 +119,17 @@
 [tool.hatch.build.targets.wheel]
 only-include = ["src"]
 sources = ["src"]
 
 [tool.hatch.build.targets.wheel.hooks.mypyc]
 enable-by-default = false
 dependencies = [
-  "hatch-mypyc>=0.13.0",
-  "mypy==0.991",
-  # Required stubs to be removed when the packages support PEP 561 themselves
-  "types-typed-ast>=1.4.2",
+  "hatch-mypyc>=0.16.0",
+  "mypy==1.3",
+  "click==8.1.3",  # avoid https://github.com/pallets/click/issues/2558
 ]
 require-runtime-dependencies = true
 exclude = [
   # There's no good reason for blackd to be compiled.
   "/src/blackd",
   # Not performance sensitive, so save bytes + compilation time:
   "/src/blib2to3/__init__.py",
@@ -147,15 +144,15 @@
   "/src/cercis/__main__.py",
 ]
 options = { debug_level = "0" }
 
 [tool.cibuildwheel]
 build-verbosity = 1
 # So these are the environments we target:
-# - Python: CPython 3.7+ only
+# - Python: CPython 3.8+ only
 # - Architecture (64-bit only): amd64 / x86_64, universal2, and arm64
 # - OS: Linux (no musl), Windows, and macOS
 build = "cp3*-*"
 skip = ["*-manylinux_i686", "*-musllinux_*", "*-win32", "pp-*"]
 # This is the bare minimum needed to run the test suite. Pulling in the full
 # test_requirements.txt would download a bunch of other packages not necessary
 # here and would slow down the testing step a fair bit.
@@ -210,16 +207,13 @@
     "error",
     # this is mitigated by a try/catch in https://github.com/psf/black/pull/2974/
     # this ignore can be removed when support for aiohttp 3.7 is dropped.
     '''ignore:Decorator `@unittest_run_loop` is no longer needed in aiohttp 3\.8\+:DeprecationWarning''',
     # this is mitigated by a try/catch in https://github.com/psf/black/pull/3198/
     # this ignore can be removed when support for aiohttp 3.x is dropped.
     '''ignore:Middleware decorator is deprecated since 4\.0 and its behaviour is default, you can simply remove this decorator:DeprecationWarning''',
-    # this is mitigated by https://github.com/python/cpython/issues/79071 in python 3.8+
-    # this ignore can be removed when support for 3.7 is dropped.
-    '''ignore:Bare functions are deprecated, use async ones:DeprecationWarning''',
     # aiohttp is using deprecated cgi modules - Safe to remove when fixed:
     # https://github.com/aio-libs/aiohttp/issues/6905
     '''ignore:'cgi' is deprecated and slated for removal in Python 3.13:DeprecationWarning''',
     # Work around https://github.com/pytest-dev/pytest/issues/10977 for Python 3.12
     '''ignore:(Attribute s|Attribute n|ast.Str|ast.Bytes|ast.NameConstant|ast.Num) is deprecated and will be removed in Python 3.14:DeprecationWarning'''
 ]
```

### Comparing `cercis-0.1.7/PKG-INFO` & `cercis-0.2.0/PKG-INFO`

 * *Files 5% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: cercis
-Version: 0.1.7
+Version: 0.2.0
 Summary: A more configurable Python code formatter
 Project-URL: Changelog, https://github.com/jsh9/cercis/blob/main/CHANGES.md
 Project-URL: Homepage, https://github.com/jsh9/cercis
 Author: jsh9
 Author-email: ukasz Langa <lukasz@langa.pl>
 License: MIT
 License-File: LICENSE
@@ -13,29 +13,27 @@
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Environment :: Console
 Classifier: Intended Audience :: Developers
 Classifier: License :: OSI Approved :: MIT License
 Classifier: Operating System :: OS Independent
 Classifier: Programming Language :: Python
 Classifier: Programming Language :: Python :: 3 :: Only
-Classifier: Programming Language :: Python :: 3.7
 Classifier: Programming Language :: Python :: 3.8
 Classifier: Programming Language :: Python :: 3.9
 Classifier: Programming Language :: Python :: 3.10
 Classifier: Programming Language :: Python :: 3.11
 Classifier: Topic :: Software Development :: Libraries :: Python Modules
 Classifier: Topic :: Software Development :: Quality Assurance
-Requires-Python: >=3.7
+Requires-Python: >=3.8
 Requires-Dist: click>=8.0.0
 Requires-Dist: mypy-extensions>=0.4.3
 Requires-Dist: packaging>=22.0
 Requires-Dist: pathspec>=0.9.0
 Requires-Dist: platformdirs>=2
 Requires-Dist: tomli>=1.1.0; python_version < '3.11'
-Requires-Dist: typed-ast>=1.4.2; python_version < '3.8' and implementation_name == 'cpython'
 Requires-Dist: typing-extensions>=3.10.0.0; python_version < '3.10'
 Provides-Extra: colorama
 Requires-Dist: colorama>=0.4.3; extra == 'colorama'
 Provides-Extra: d
 Requires-Dist: aiohttp>=3.7.4; extra == 'd'
 Provides-Extra: jupyter
 Requires-Dist: ipython>=7.8.0; extra == 'jupyter'
@@ -61,14 +59,49 @@
 _Cercis_ inherited Black's very comprehensive test cases, which means we are confident
 that our configurability addition does not introduce any undesirable side effects. We
 also thoroughly tested every configurable options that we added.
 
 In particular, via its configurable options, _Cercis_ can completely fall back to Black.
 See [Section 4.5](#45-how-to-fall-back-to-blacks-behavior) below for more details.
 
+**Table of Contents**
+
+<!--TOC-->
+
+- [1. Motivations](#1-motivations)
+- [2. Installation and usage](#2-installation-and-usage)
+  - [2.1. Installation](#21-installation)
+  - [2.2. Usage](#22-usage)
+    - [2.2.1. Command line usage](#221-command-line-usage)
+    - [2.2.2. As pre-commit hook](#222-as-pre-commit-hook)
+- [3. _Cercis_'s code style](#3-cerciss-code-style)
+  - [3.1. Line length](#31-line-length)
+  - [3.2. Single quote vs double quote](#32-single-quote-vs-double-quote)
+  - [3.3. Tabs vs spaces](#33-tabs-vs-spaces)
+  - [3.4. Base indentation spaces](#34-base-indentation-spaces)
+  - [3.5. Extra indentation at line continuations](#35-extra-indentation-at-line-continuations)
+    - [3.5.1. At function definition (`--function-definition-extra-indent`)](#351-at-function-definition---function-definition-extra-indent)
+    - [3.5.2. In other line continuations (`--other-line-continuation-extra-indent`)](#352-in-other-line-continuations---other-line-continuation-extra-indent)
+    - [3.5.3. At closing brackets (`--closing-bracket-extra-indent`)](#353-at-closing-brackets---closing-bracket-extra-indent)
+  - [3.6. "Simple" lines with long strings](#36-simple-lines-with-long-strings)
+  - [3.7. Collapse nested brackets](#37-collapse-nested-brackets)
+  - [3.8. Wrapping long lines ending with comments](#38-wrapping-long-lines-ending-with-comments)
+  - [3.9. Keep blank lines in brackets](#39-keep-blank-lines-in-brackets)
+- [4. How to configure _Cercis_](#4-how-to-configure-cercis)
+  - [4.1. Dynamically in the command line](#41-dynamically-in-the-command-line)
+  - [4.2. In your project's `pyproject.toml` file](#42-in-your-projects-pyprojecttoml-file)
+  - [4.3. In your project's `.pre-commit-config.yaml` file](#43-in-your-projects-pre-commit-configyaml-file)
+  - [4.4. Specify options in `tox.ini`](#44-specify-options-in-toxini)
+  - [4.5. How to fall back to Black's behavior](#45-how-to-fall-back-to-blacks-behavior)
+- [5. Maintainer resources](#5-maintainer-resources)
+  - [5.1. How to rebase on top of _Black_?](#51-how-to-rebase-on-top-of-black)
+  - [5.2. Change logs](#52-change-logs)
+
+<!--TOC-->
+
 ## 1. Motivations
 
 While we like the idea of auto-formatting and code readability, we take issue with some
 style choices and the lack of configurability of the Black formatter. Therefore,
 _Cercis_ aims at providing some configurability beyond Black's limited offering.
 
 ## 2. Installation and usage
@@ -129,29 +162,14 @@
 
 _Cercis_'s code style is largely consistent with the
 [style of of Black](https://black.readthedocs.io/en/stable/the_black_code_style/current_style.html).
 
 The main difference is that _Cercis_ provides several configurable options that Black
 doesn't. Configurability is our main motivation behind creating _Cercis_.
 
-_Cercis_ offers the following configurable options:
-
-1. [Line length](#31-line-length)
-2. [Single quote vs double quote](#32-single-quote-vs-double-quote)
-3. [Tabs vs spaces](#33-tabs-vs-spaces)
-4. [Base indentation spaces](#34-base-indentation-spaces)
-5. [Extra indentation at line continuation](#35-extra-indentation-at-line-continuation)
-   1. [At function definition](#351-at-function-definition---function-definition-extra-indent)
-   2. [In other line continuations](#352-in-other-line-continuations---other-line-continuation-extra-indent)
-   3. [At closing brackets](#353-at-closing-brackets---closing-bracket-extra-indent)
-6. ["Simple" lines with long strings](#36-simple-lines-with-long-strings)
-7. [Collapse nested brackets](#37-collapse-nested-brackets)
-8. [Wrap lines ending with comments](#38-wrapping-long-lines-ending-with-comments)
-9. [Keep blank lines in brackets](#39-keep-blank-lines-in-brackets)
-
 The next section ([How to configure _Cercis_](#4-how-to-configure-cercis)) contains
 detailed instructions of how to configure these options.
 
 ### 3.1. Line length
 
 _Cercis_ uses 79 characters as the line length limit, instead of 88 (Black's default).
 
@@ -753,16 +771,40 @@
 other-line-continuation-extra-indent = false
 closing-bracket-extra-indent = false
 wrap-line-with-long-string = true
 collapse-nested-brackets = false
 wrap-comments = true
 wrap-pragma-comments = true
 ```
+
+## 5. Maintainer resources
+
+Here are some resources and notes for maintainers of _Cercis_:
+
+### 5.1. How to rebase on top of _Black_?
+
+Please refer to the file [HOW_TO_REBASE.md](./HOW_TO_REBASE.md).
+
+### 5.2. Change logs
+
+There are 2 files in this repo: [CHANGELOG.md](./CHANGELOG.md) and
+[CHANGES.md](./CHANGES.md).
+
+The former tracks the changes of _Cercis_ (_Black_ does not have this file). The latter
+tracks the changes on _Black_ (it exists in the _Black_ repo as well).
 # Change Log
 
+## [0.2.0] - 2023-07-12
+
+- Changed
+  - Rebased `Cercis` to be head to head with `Black`
+    [version 23.7.0](https://github.com/psf/black/releases/tag/23.7.0)
+- Diff
+  - https://github.com/jsh9/cercis/compare/0.1.7...0.2.0
+
 ## [0.1.7] - 2023-06-19
 
 - Changed
   - Pulled in the latest changes from psf/black (code diff:
     https://github.com/jsh9/cercis/pull/27)
 
 ## [0.1.6] - 2023-05-23
```

